(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[437],{2729:function(){},5965:function(t,c,u){"use strict";/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function _iterableToArrayLimit(t,c){var u=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=u){var h,f,g,b,v=[],x=!0,w=!1;try{if(g=(u=u.call(t)).next,0===c){if(Object(u)!==u)return;x=!1}else for(;!(x=(h=g.call(u)).done)&&(v.push(h.value),v.length!==c);x=!0);}catch(t){w=!0,f=t}finally{try{if(!x&&null!=u.return&&(b=u.return(),Object(b)!==b))return}finally{if(w)throw f}}return v}}function ownKeys(t,c){var u=Object.keys(t);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);c&&(h=h.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),u.push.apply(u,h)}return u}function _objectSpread2(t){for(var c=1;c<arguments.length;c++){var u=null!=arguments[c]?arguments[c]:{};c%2?ownKeys(Object(u),!0).forEach(function(c){_defineProperty(t,c,u[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(u)):ownKeys(Object(u)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(u,c))})}return t}function _defineProperty(t,c,u){return(c=_toPropertyKey(c))in t?Object.defineProperty(t,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):t[c]=u,t}function _objectWithoutPropertiesLoose(t,c){if(null==t)return{};var u,h,f={},g=Object.keys(t);for(h=0;h<g.length;h++)u=g[h],c.indexOf(u)>=0||(f[u]=t[u]);return f}function _objectWithoutProperties(t,c){if(null==t)return{};var u,h,f=_objectWithoutPropertiesLoose(t,c);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(t);for(h=0;h<g.length;h++)u=g[h],!(c.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(t,u)&&(f[u]=t[u])}return f}function _slicedToArray(t,c){return _arrayWithHoles(t)||_iterableToArrayLimit(t,c)||_unsupportedIterableToArray(t,c)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _unsupportedIterableToArray(t,c){if(t){if("string"==typeof t)return _arrayLikeToArray(t,c);var u=Object.prototype.toString.call(t).slice(8,-1);if("Object"===u&&t.constructor&&(u=t.constructor.name),"Map"===u||"Set"===u)return Array.from(t);if("Arguments"===u||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u))return _arrayLikeToArray(t,c)}}function _arrayLikeToArray(t,c){(null==c||c>t.length)&&(c=t.length);for(var u=0,h=Array(c);u<c;u++)h[u]=t[u];return h}function _nonIterableSpread(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _toPrimitive(t,c){if("object"!=typeof t||null===t)return t;var u=t[Symbol.toPrimitive];if(void 0!==u){var h=u.call(t,c||"default");if("object"!=typeof h)return h;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===c?String:Number)(t)}function _toPropertyKey(t){var c=_toPrimitive(t,"string");return"symbol"==typeof c?c:String(c)}function canvasTest(t){var c,u,h=t.sizes.shift(),f=Math.max(Math.ceil(h[0]),1),g=Math.max(Math.ceil(h[1]),1),b=[f-1,g-1,1,1],v=Date.now(),x="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope;x?(c=new OffscreenCanvas(1,1),u=new OffscreenCanvas(f,g)):((c=document.createElement("canvas")).width=1,c.height=1,(u=document.createElement("canvas")).width=f,u.height=g);var w=c.getContext("2d"),_=u.getContext("2d");_&&(_.fillRect.apply(_,b),w.drawImage(u,f-1,g-1,1,1,0,0,1,1));var k=w&&0!==w.getImageData(0,0,1,1).data[3],E=Date.now()-v;return[c,u].forEach(function(t){t.height=0,t.width=0}),x?(postMessage({width:f,height:g,benchmark:E,isTestPass:k}),!k&&t.sizes.length&&canvasTest(t)):k?t.onSuccess(f,g,E):(t.onError(f,g,E),t.sizes.length&&canvasTest(t)),k}u.r(c),u.d(c,{default:function(){return v}});var h={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},f=["onError","onSuccess"],g={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},b={};function createSizesArray(t){var c=t.width===t.height,u=1===t.height,h=1===t.width,f=[];if(t.width&&t.height)for(var b=t.min||g.min,v=t.step||g.step,x=Math.max(t.width,t.height);x>=b;){var w=c||u?x:1,_=c||h?x:1;f.push([w,_]),x-=v}else t.sizes.forEach(function(t){var g=c||u?t:1,b=c||h?t:1;f.push([g,b])});return f}function handleMethod(t){var c=window&&"HTMLCanvasElement"in window,u=window&&"OffscreenCanvas"in window,h=Date.now(),g=t.onError,v=t.onSuccess,x=_objectWithoutProperties(t,f),w=null;if(!c)return!1;if(t.useWorker&&u){var _="\n            var canvasTest = ".concat(canvasTest.toString(),";\n            onmessage = function(e) {\n                canvasTest(e.data);\n            };\n        "),k=new Blob([_],{type:"application/javascript"}),E=URL.createObjectURL(k);w=new Worker(E),URL.revokeObjectURL(E),w.onmessage=function(t){var c=t.data,u=c.width,f=c.height,g=c.benchmark;c.isTestPass?(b[h].onSuccess(u,f,g),delete b[h]):b[h].onError(u,f,g)}}return t.usePromise?new Promise(function(c,u){var f=_objectSpread2(_objectSpread2({},t),{},{onError:function(c,h,f){var b;if(0===t.sizes.length)b=!0;else{var v=_slicedToArray(t.sizes.slice(-1),1),x=_slicedToArray(v[0],2),w=x[0],_=x[1];b=c===w&&h===_}g(c,h,f),b&&u({width:c,height:h,benchmark:f})},onSuccess:function(t,u,h){v(t,u,h),c({width:t,height:u,benchmark:h})}});if(w){var _=f.onError,k=f.onSuccess;b[h]={onError:_,onSuccess:k},w.postMessage(x)}else canvasTest(f)}):w?void(b[h]={onError:g,onSuccess:v},w.postMessage(x)):canvasTest(t)}var v={maxArea:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=createSizesArray({width:t.max,height:t.max,min:t.min,step:t.step,sizes:_toConsumableArray(h.area)});return handleMethod(_objectSpread2(_objectSpread2(_objectSpread2({},g),t),{},{sizes:c}))},maxHeight:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=createSizesArray({width:1,height:t.max,min:t.min,step:t.step,sizes:_toConsumableArray(h.height)});return handleMethod(_objectSpread2(_objectSpread2(_objectSpread2({},g),t),{},{sizes:c}))},maxWidth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=createSizesArray({width:t.max,height:1,min:t.min,step:t.step,sizes:_toConsumableArray(h.width)});return handleMethod(_objectSpread2(_objectSpread2(_objectSpread2({},g),t),{},{sizes:c}))},test:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=_objectSpread2(_objectSpread2({},g),t);return c.sizes=_toConsumableArray(c.sizes),c.width&&c.height&&(c.sizes=[[c.width,c.height]]),handleMethod(c)}}},4440:function(t,c){var u;/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/!function(){"use strict";var h={}.hasOwnProperty;function classNames(){for(var t=[],c=0;c<arguments.length;c++){var u=arguments[c];if(u){var f=typeof u;if("string"===f||"number"===f)t.push(u);else if(Array.isArray(u)){if(u.length){var g=classNames.apply(null,u);g&&t.push(g)}}else if("object"===f){if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]")){t.push(u.toString());continue}for(var b in u)h.call(u,b)&&u[b]&&t.push(b)}}}return t.join(" ")}t.exports?(classNames.default=classNames,t.exports=classNames):void 0!==(u=(function(){return classNames}).apply(c,[]))&&(t.exports=u)}()},8729:function(t){"use strict";var c=Object.prototype.hasOwnProperty,u="~";function Events(){}function EE(t,c,u){this.fn=t,this.context=c,this.once=u||!1}function addListener(t,c,h,f,g){if("function"!=typeof h)throw TypeError("The listener must be a function");var b=new EE(h,f||t,g),v=u?u+c:c;return t._events[v]?t._events[v].fn?t._events[v]=[t._events[v],b]:t._events[v].push(b):(t._events[v]=b,t._eventsCount++),t}function clearEvent(t,c){0==--t._eventsCount?t._events=new Events:delete t._events[c]}function EventEmitter(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),new Events().__proto__||(u=!1)),EventEmitter.prototype.eventNames=function(){var t,h,f=[];if(0===this._eventsCount)return f;for(h in t=this._events)c.call(t,h)&&f.push(u?h.slice(1):h);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(t)):f},EventEmitter.prototype.listeners=function(t){var c=u?u+t:t,h=this._events[c];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,g=h.length,b=Array(g);f<g;f++)b[f]=h[f].fn;return b},EventEmitter.prototype.listenerCount=function(t){var c=u?u+t:t,h=this._events[c];return h?h.fn?1:h.length:0},EventEmitter.prototype.emit=function(t,c,h,f,g,b){var v=u?u+t:t;if(!this._events[v])return!1;var x,w,_=this._events[v],k=arguments.length;if(_.fn){switch(_.once&&this.removeListener(t,_.fn,void 0,!0),k){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,c),!0;case 3:return _.fn.call(_.context,c,h),!0;case 4:return _.fn.call(_.context,c,h,f),!0;case 5:return _.fn.call(_.context,c,h,f,g),!0;case 6:return _.fn.call(_.context,c,h,f,g,b),!0}for(w=1,x=Array(k-1);w<k;w++)x[w-1]=arguments[w];_.fn.apply(_.context,x)}else{var E,$=_.length;for(w=0;w<$;w++)switch(_[w].once&&this.removeListener(t,_[w].fn,void 0,!0),k){case 1:_[w].fn.call(_[w].context);break;case 2:_[w].fn.call(_[w].context,c);break;case 3:_[w].fn.call(_[w].context,c,h);break;case 4:_[w].fn.call(_[w].context,c,h,f);break;default:if(!x)for(E=1,x=Array(k-1);E<k;E++)x[E-1]=arguments[E];_[w].fn.apply(_[w].context,x)}}return!0},EventEmitter.prototype.on=function(t,c,u){return addListener(this,t,c,u,!1)},EventEmitter.prototype.once=function(t,c,u){return addListener(this,t,c,u,!0)},EventEmitter.prototype.removeListener=function(t,c,h,f){var g=u?u+t:t;if(!this._events[g])return this;if(!c)return clearEvent(this,g),this;var b=this._events[g];if(b.fn)b.fn!==c||f&&!b.once||h&&b.context!==h||clearEvent(this,g);else{for(var v=0,x=[],w=b.length;v<w;v++)(b[v].fn!==c||f&&!b[v].once||h&&b[v].context!==h)&&x.push(b[v]);x.length?this._events[g]=1===x.length?x[0]:x:clearEvent(this,g)}return this},EventEmitter.prototype.removeAllListeners=function(t){var c;return t?(c=u?u+t:t,this._events[c]&&clearEvent(this,c)):(this._events=new Events,this._eventsCount=0),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prefixed=u,EventEmitter.EventEmitter=EventEmitter,t.exports=EventEmitter},9780:function(t,c,u){t=u.nmd(t);var h,f="__lodash_hash_undefined__",g="[object Arguments]",b="[object Array]",v="[object Boolean]",x="[object Date]",w="[object Error]",_="[object Function]",k="[object Map]",E="[object Number]",$="[object Object]",T="[object Promise]",I="[object RegExp]",M="[object Set]",j="[object String]",D="[object WeakMap]",F="[object ArrayBuffer]",L="[object DataView]",B=/^\[object .+?Constructor\]$/,G=/^(?:0|[1-9]\d*)$/,U={};U["[object Float32Array]"]=U["[object Float64Array]"]=U["[object Int8Array]"]=U["[object Int16Array]"]=U["[object Int32Array]"]=U["[object Uint8Array]"]=U["[object Uint8ClampedArray]"]=U["[object Uint16Array]"]=U["[object Uint32Array]"]=!0,U[g]=U[b]=U[F]=U[v]=U[L]=U[x]=U[w]=U[_]=U[k]=U[E]=U[$]=U[I]=U[M]=U[j]=U[D]=!1;var V="object"==typeof u.g&&u.g&&u.g.Object===Object&&u.g,K="object"==typeof self&&self&&self.Object===Object&&self,Z=V||K||Function("return this")(),Y=c&&!c.nodeType&&c,X=Y&&t&&!t.nodeType&&t,J=X&&X.exports===Y,Q=J&&V.process,ee=function(){try{return Q&&Q.binding&&Q.binding("util")}catch(t){}}(),et=ee&&ee.isTypedArray;function arrayFilter(t,c){for(var u=-1,h=null==t?0:t.length,f=0,g=[];++u<h;){var b=t[u];c(b,u,t)&&(g[f++]=b)}return g}function arrayPush(t,c){for(var u=-1,h=c.length,f=t.length;++u<h;)t[f+u]=c[u];return t}function arraySome(t,c){for(var u=-1,h=null==t?0:t.length;++u<h;)if(c(t[u],u,t))return!0;return!1}function baseTimes(t,c){for(var u=-1,h=Array(t);++u<t;)h[u]=c(u);return h}function baseUnary(t){return function(c){return t(c)}}function cacheHas(t,c){return t.has(c)}function getValue(t,c){return null==t?void 0:t[c]}function mapToArray(t){var c=-1,u=Array(t.size);return t.forEach(function(t,h){u[++c]=[h,t]}),u}function overArg(t,c){return function(u){return t(c(u))}}function setToArray(t){var c=-1,u=Array(t.size);return t.forEach(function(t){u[++c]=t}),u}var en=Array.prototype,er=Function.prototype,ei=Object.prototype,eo=Z["__core-js_shared__"],ea=er.toString,es=ei.hasOwnProperty,el=(h=/[^.]+$/.exec(eo&&eo.keys&&eo.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",ec=ei.toString,eu=RegExp("^"+ea.call(es).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ed=J?Z.Buffer:void 0,ep=Z.Symbol,eh=Z.Uint8Array,ef=ei.propertyIsEnumerable,eg=en.splice,em=ep?ep.toStringTag:void 0,eb=Object.getOwnPropertySymbols,ey=ed?ed.isBuffer:void 0,ev=overArg(Object.keys,Object),ex=getNative(Z,"DataView"),ew=getNative(Z,"Map"),eS=getNative(Z,"Promise"),e_=getNative(Z,"Set"),ek=getNative(Z,"WeakMap"),eC=getNative(Object,"create"),eP=toSource(ex),eE=toSource(ew),e$=toSource(eS),eT=toSource(e_),eI=toSource(ek),eA=ep?ep.prototype:void 0,eM=eA?eA.valueOf:void 0;function Hash(t){var c=-1,u=null==t?0:t.length;for(this.clear();++c<u;){var h=t[c];this.set(h[0],h[1])}}function hashClear(){this.__data__=eC?eC(null):{},this.size=0}function hashDelete(t){var c=this.has(t)&&delete this.__data__[t];return this.size-=c?1:0,c}function hashGet(t){var c=this.__data__;if(eC){var u=c[t];return u===f?void 0:u}return es.call(c,t)?c[t]:void 0}function hashHas(t){var c=this.__data__;return eC?void 0!==c[t]:es.call(c,t)}function hashSet(t,c){var u=this.__data__;return this.size+=this.has(t)?0:1,u[t]=eC&&void 0===c?f:c,this}function ListCache(t){var c=-1,u=null==t?0:t.length;for(this.clear();++c<u;){var h=t[c];this.set(h[0],h[1])}}function listCacheClear(){this.__data__=[],this.size=0}function listCacheDelete(t){var c=this.__data__,u=assocIndexOf(c,t);return!(u<0)&&(u==c.length-1?c.pop():eg.call(c,u,1),--this.size,!0)}function listCacheGet(t){var c=this.__data__,u=assocIndexOf(c,t);return u<0?void 0:c[u][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,c){var u=this.__data__,h=assocIndexOf(u,t);return h<0?(++this.size,u.push([t,c])):u[h][1]=c,this}function MapCache(t){var c=-1,u=null==t?0:t.length;for(this.clear();++c<u;){var h=t[c];this.set(h[0],h[1])}}function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(ew||ListCache),string:new Hash}}function mapCacheDelete(t){var c=getMapData(this,t).delete(t);return this.size-=c?1:0,c}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,c){var u=getMapData(this,t),h=u.size;return u.set(t,c),this.size+=u.size==h?0:1,this}function SetCache(t){var c=-1,u=null==t?0:t.length;for(this.__data__=new MapCache;++c<u;)this.add(t[c])}function setCacheAdd(t){return this.__data__.set(t,f),this}function setCacheHas(t){return this.__data__.has(t)}function Stack(t){var c=this.__data__=new ListCache(t);this.size=c.size}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var c=this.__data__,u=c.delete(t);return this.size=c.size,u}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}function stackSet(t,c){var u=this.__data__;if(u instanceof ListCache){var h=u.__data__;if(!ew||h.length<199)return h.push([t,c]),this.size=++u.size,this;u=this.__data__=new MapCache(h)}return u.set(t,c),this.size=u.size,this}function arrayLikeKeys(t,c){var u=eF(t),h=!u&&eO(t),f=!u&&!h&&eR(t),g=!u&&!h&&!f&&eL(t),b=u||h||f||g,v=b?baseTimes(t.length,String):[],x=v.length;for(var w in t)(c||es.call(t,w))&&!(b&&("length"==w||f&&("offset"==w||"parent"==w)||g&&("buffer"==w||"byteLength"==w||"byteOffset"==w)||isIndex(w,x)))&&v.push(w);return v}function assocIndexOf(t,c){for(var u=t.length;u--;)if(eq(t[u][0],c))return u;return -1}function baseGetAllKeys(t,c,u){var h=c(t);return eF(t)?h:arrayPush(h,u(t))}function baseGetTag(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":em&&em in Object(t)?getRawTag(t):objectToString(t)}function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==g}function baseIsEqual(t,c,u,h,f){return t===c||(null!=t&&null!=c&&(isObjectLike(t)||isObjectLike(c))?baseIsEqualDeep(t,c,u,h,baseIsEqual,f):t!=t&&c!=c)}function baseIsEqualDeep(t,c,u,h,f,v){var x=eF(t),w=eF(c),_=x?b:eD(t),k=w?b:eD(c);_=_==g?$:_,k=k==g?$:k;var E=_==$,T=k==$,I=_==k;if(I&&eR(t)){if(!eR(c))return!1;x=!0,E=!1}if(I&&!E)return v||(v=new Stack),x||eL(t)?equalArrays(t,c,u,h,f,v):equalByTag(t,c,_,u,h,f,v);if(!(1&u)){var M=E&&es.call(t,"__wrapped__"),j=T&&es.call(c,"__wrapped__");if(M||j){var D=M?t.value():t,F=j?c.value():c;return v||(v=new Stack),f(D,F,u,h,v)}}return!!I&&(v||(v=new Stack),equalObjects(t,c,u,h,f,v))}function baseIsNative(t){return!(!isObject(t)||isMasked(t))&&(isFunction(t)?eu:B).test(toSource(t))}function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!U[baseGetTag(t)]}function baseKeys(t){if(!isPrototype(t))return ev(t);var c=[];for(var u in Object(t))es.call(t,u)&&"constructor"!=u&&c.push(u);return c}function equalArrays(t,c,u,h,f,g){var b=1&u,v=t.length,x=c.length;if(v!=x&&!(b&&x>v))return!1;var w=g.get(t);if(w&&g.get(c))return w==c;var _=-1,k=!0,E=2&u?new SetCache:void 0;for(g.set(t,c),g.set(c,t);++_<v;){var $=t[_],T=c[_];if(h)var I=b?h(T,$,_,c,t,g):h($,T,_,t,c,g);if(void 0!==I){if(I)continue;k=!1;break}if(E){if(!arraySome(c,function(t,c){if(!cacheHas(E,c)&&($===t||f($,t,u,h,g)))return E.push(c)})){k=!1;break}}else if(!($===T||f($,T,u,h,g))){k=!1;break}}return g.delete(t),g.delete(c),k}function equalByTag(t,c,u,h,f,g,b){switch(u){case L:if(t.byteLength!=c.byteLength||t.byteOffset!=c.byteOffset)break;t=t.buffer,c=c.buffer;case F:if(t.byteLength!=c.byteLength||!g(new eh(t),new eh(c)))break;return!0;case v:case x:case E:return eq(+t,+c);case w:return t.name==c.name&&t.message==c.message;case I:case j:return t==c+"";case k:var _=mapToArray;case M:var $=1&h;if(_||(_=setToArray),t.size!=c.size&&!$)break;var T=b.get(t);if(T)return T==c;h|=2,b.set(t,c);var D=equalArrays(_(t),_(c),h,f,g,b);return b.delete(t),D;case"[object Symbol]":if(eM)return eM.call(t)==eM.call(c)}return!1}function equalObjects(t,c,u,h,f,g){var b=1&u,v=baseGetAllKeys(t,keys,ej),x=v.length;if(x!=baseGetAllKeys(c,keys,ej).length&&!b)return!1;for(var w=x;w--;){var _=v[w];if(!(b?_ in c:es.call(c,_)))return!1}var k=g.get(t);if(k&&g.get(c))return k==c;var E=!0;g.set(t,c),g.set(c,t);for(var $=b;++w<x;){var T=t[_=v[w]],I=c[_];if(h)var M=b?h(I,T,_,c,t,g):h(T,I,_,t,c,g);if(!(void 0===M?T===I||f(T,I,u,h,g):M)){E=!1;break}$||($="constructor"==_)}if(E&&!$){var j=t.constructor,D=c.constructor;j!=D&&"constructor"in t&&"constructor"in c&&!("function"==typeof j&&j instanceof j&&"function"==typeof D&&D instanceof D)&&(E=!1)}return g.delete(t),g.delete(c),E}function getMapData(t,c){var u=t.__data__;return isKeyable(c)?u["string"==typeof c?"string":"hash"]:u.map}function getNative(t,c){var u=getValue(t,c);return baseIsNative(u)?u:void 0}function getRawTag(t){var c=es.call(t,em),u=t[em];try{t[em]=void 0;var h=!0}catch(t){}var f=ec.call(t);return h&&(c?t[em]=u:delete t[em]),f}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var ej=eb?function(t){return null==t?[]:arrayFilter(eb(t=Object(t)),function(c){return ef.call(t,c)})}:stubArray,eD=baseGetTag;function isIndex(t,c){return!!(c=null==c?9007199254740991:c)&&("number"==typeof t||G.test(t))&&t>-1&&t%1==0&&t<c}function isKeyable(t){var c=typeof t;return"string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==t:null===t}function isMasked(t){return!!el&&el in t}function isPrototype(t){var c=t&&t.constructor;return t===("function"==typeof c&&c.prototype||ei)}function objectToString(t){return ec.call(t)}function toSource(t){if(null!=t){try{return ea.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function eq(t,c){return t===c||t!=t&&c!=c}(ex&&eD(new ex(new ArrayBuffer(1)))!=L||ew&&eD(new ew)!=k||eS&&eD(eS.resolve())!=T||e_&&eD(new e_)!=M||ek&&eD(new ek)!=D)&&(eD=function(t){var c=baseGetTag(t),u=c==$?t.constructor:void 0,h=u?toSource(u):"";if(h)switch(h){case eP:return L;case eE:return k;case e$:return T;case eT:return M;case eI:return D}return c});var eO=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&es.call(t,"callee")&&!ef.call(t,"callee")},eF=Array.isArray;function isArrayLike(t){return null!=t&&isLength(t.length)&&!isFunction(t)}var eR=ey||stubFalse;function isEqual(t,c){return baseIsEqual(t,c)}function isFunction(t){if(!isObject(t))return!1;var c=baseGetTag(t);return c==_||"[object GeneratorFunction]"==c||"[object AsyncFunction]"==c||"[object Proxy]"==c}function isLength(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function isObject(t){var c=typeof t;return null!=t&&("object"==c||"function"==c)}function isObjectLike(t){return null!=t&&"object"==typeof t}var eL=et?baseUnary(et):baseIsTypedArray;function keys(t){return isArrayLike(t)?arrayLikeKeys(t):baseKeys(t)}function stubArray(){return[]}function stubFalse(){return!1}t.exports=isEqual},6978:function(t,c,u){var h="Expected a function",f=0/0,g=/^\s+|\s+$/g,b=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,x=/^0o[0-7]+$/i,w=parseInt,_="object"==typeof u.g&&u.g&&u.g.Object===Object&&u.g,k="object"==typeof self&&self&&self.Object===Object&&self,E=_||k||Function("return this")(),$=Object.prototype.toString,T=Math.max,I=Math.min,now=function(){return E.Date.now()};function debounce(t,c,u){var f,g,b,v,x,w,_=0,k=!1,E=!1,$=!0;if("function"!=typeof t)throw TypeError(h);function invokeFunc(c){var u=f,h=g;return f=g=void 0,_=c,v=t.apply(h,u)}function leadingEdge(t){return _=t,x=setTimeout(timerExpired,c),k?invokeFunc(t):v}function remainingWait(t){var u=t-w,h=t-_,f=c-u;return E?I(f,b-h):f}function shouldInvoke(t){var u=t-w,h=t-_;return void 0===w||u>=c||u<0||E&&h>=b}function timerExpired(){var t=now();if(shouldInvoke(t))return trailingEdge(t);x=setTimeout(timerExpired,remainingWait(t))}function trailingEdge(t){return(x=void 0,$&&f)?invokeFunc(t):(f=g=void 0,v)}function cancel(){void 0!==x&&clearTimeout(x),_=0,f=w=g=x=void 0}function flush(){return void 0===x?v:trailingEdge(now())}function debounced(){var t=now(),u=shouldInvoke(t);if(f=arguments,g=this,w=t,u){if(void 0===x)return leadingEdge(w);if(E)return x=setTimeout(timerExpired,c),invokeFunc(w)}return void 0===x&&(x=setTimeout(timerExpired,c)),v}return c=toNumber(c)||0,isObject(u)&&(k=!!u.leading,b=(E="maxWait"in u)?T(toNumber(u.maxWait)||0,c):b,$="trailing"in u?!!u.trailing:$),debounced.cancel=cancel,debounced.flush=flush,debounced}function throttle(t,c,u){var f=!0,g=!0;if("function"!=typeof t)throw TypeError(h);return isObject(u)&&(f="leading"in u?!!u.leading:f,g="trailing"in u?!!u.trailing:g),debounce(t,c,{leading:f,maxWait:c,trailing:g})}function isObject(t){var c=typeof t;return!!t&&("object"==c||"function"==c)}function isObjectLike(t){return!!t&&"object"==typeof t}function isSymbol(t){return"symbol"==typeof t||isObjectLike(t)&&"[object Symbol]"==$.call(t)}function toNumber(t){if("number"==typeof t)return t;if(isSymbol(t))return f;if(isObject(t)){var c="function"==typeof t.valueOf?t.valueOf():t;t=isObject(c)?c+"":c}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(g,"");var u=v.test(t);return u||x.test(t)?w(t.slice(2),u?2:8):b.test(t)?f:+t}t.exports=throttle},528:function(t,c,u){var h,f="__lodash_hash_undefined__",g=/^\[object .+?Constructor\]$/,b="object"==typeof u.g&&u.g&&u.g.Object===Object&&u.g,v="object"==typeof self&&self&&self.Object===Object&&self,x=b||v||Function("return this")();function arrayIncludes(t,c){return!!(t?t.length:0)&&baseIndexOf(t,c,0)>-1}function arrayIncludesWith(t,c,u){for(var h=-1,f=t?t.length:0;++h<f;)if(u(c,t[h]))return!0;return!1}function baseFindIndex(t,c,u,h){for(var f=t.length,g=u+(h?1:-1);h?g--:++g<f;)if(c(t[g],g,t))return g;return -1}function baseIndexOf(t,c,u){if(c!=c)return baseFindIndex(t,baseIsNaN,u);for(var h=u-1,f=t.length;++h<f;)if(t[h]===c)return h;return -1}function baseIsNaN(t){return t!=t}function cacheHas(t,c){return t.has(c)}function getValue(t,c){return null==t?void 0:t[c]}function isHostObject(t){var c=!1;if(null!=t&&"function"!=typeof t.toString)try{c=!!(t+"")}catch(t){}return c}function setToArray(t){var c=-1,u=Array(t.size);return t.forEach(function(t){u[++c]=t}),u}var w=Array.prototype,_=Function.prototype,k=Object.prototype,E=x["__core-js_shared__"],$=(h=/[^.]+$/.exec(E&&E.keys&&E.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",T=_.toString,I=k.hasOwnProperty,M=k.toString,j=RegExp("^"+T.call(I).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=w.splice,F=getNative(x,"Map"),L=getNative(x,"Set"),B=getNative(Object,"create");function Hash(t){var c=-1,u=t?t.length:0;for(this.clear();++c<u;){var h=t[c];this.set(h[0],h[1])}}function hashClear(){this.__data__=B?B(null):{}}function hashDelete(t){return this.has(t)&&delete this.__data__[t]}function hashGet(t){var c=this.__data__;if(B){var u=c[t];return u===f?void 0:u}return I.call(c,t)?c[t]:void 0}function hashHas(t){var c=this.__data__;return B?void 0!==c[t]:I.call(c,t)}function hashSet(t,c){return this.__data__[t]=B&&void 0===c?f:c,this}function ListCache(t){var c=-1,u=t?t.length:0;for(this.clear();++c<u;){var h=t[c];this.set(h[0],h[1])}}function listCacheClear(){this.__data__=[]}function listCacheDelete(t){var c=this.__data__,u=assocIndexOf(c,t);return!(u<0)&&(u==c.length-1?c.pop():D.call(c,u,1),!0)}function listCacheGet(t){var c=this.__data__,u=assocIndexOf(c,t);return u<0?void 0:c[u][1]}function listCacheHas(t){return assocIndexOf(this.__data__,t)>-1}function listCacheSet(t,c){var u=this.__data__,h=assocIndexOf(u,t);return h<0?u.push([t,c]):u[h][1]=c,this}function MapCache(t){var c=-1,u=t?t.length:0;for(this.clear();++c<u;){var h=t[c];this.set(h[0],h[1])}}function mapCacheClear(){this.__data__={hash:new Hash,map:new(F||ListCache),string:new Hash}}function mapCacheDelete(t){return getMapData(this,t).delete(t)}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,c){return getMapData(this,t).set(t,c),this}function SetCache(t){var c=-1,u=t?t.length:0;for(this.__data__=new MapCache;++c<u;)this.add(t[c])}function setCacheAdd(t){return this.__data__.set(t,f),this}function setCacheHas(t){return this.__data__.has(t)}function assocIndexOf(t,c){for(var u=t.length;u--;)if(eq(t[u][0],c))return u;return -1}function baseIsNative(t){return!(!isObject(t)||isMasked(t))&&(isFunction(t)||isHostObject(t)?j:g).test(toSource(t))}function baseUniq(t,c,u){var h=-1,f=arrayIncludes,g=t.length,b=!0,v=[],x=v;if(u)b=!1,f=arrayIncludesWith;else if(g>=200){var w=c?null:G(t);if(w)return setToArray(w);b=!1,f=cacheHas,x=new SetCache}else x=c?[]:v;e:for(;++h<g;){var _=t[h],k=c?c(_):_;if(_=u||0!==_?_:0,b&&k==k){for(var E=x.length;E--;)if(x[E]===k)continue e;c&&x.push(k),v.push(_)}else f(x,k,u)||(x!==v&&x.push(k),v.push(_))}return v}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var G=L&&1/setToArray(new L([,-0]))[1]==1/0?function(t){return new L(t)}:noop;function getMapData(t,c){var u=t.__data__;return isKeyable(c)?u["string"==typeof c?"string":"hash"]:u.map}function getNative(t,c){var u=getValue(t,c);return baseIsNative(u)?u:void 0}function isKeyable(t){var c=typeof t;return"string"==c||"number"==c||"symbol"==c||"boolean"==c?"__proto__"!==t:null===t}function isMasked(t){return!!$&&$ in t}function toSource(t){if(null!=t){try{return T.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function uniq(t){return t&&t.length?baseUniq(t):[]}function eq(t,c){return t===c||t!=t&&c!=c}function isFunction(t){var c=isObject(t)?M.call(t):"";return"[object Function]"==c||"[object GeneratorFunction]"==c}function isObject(t){var c=typeof t;return!!t&&("object"==c||"function"==c)}function noop(){}t.exports=uniq},352:function(t,c,u){var h,f=function(){var t=String.fromCharCode,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",h={};function getBaseValue(t,c){if(!h[t]){h[t]={};for(var u=0;u<t.length;u++)h[t][t.charAt(u)]=u}return h[t][c]}var f={compressToBase64:function(t){if(null==t)return"";var u=f._compress(t,6,function(t){return c.charAt(t)});switch(u.length%4){default:case 0:return u;case 1:return u+"===";case 2:return u+"==";case 3:return u+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:f._decompress(t.length,32,function(u){return getBaseValue(c,t.charAt(u))})},compressToUTF16:function(c){return null==c?"":f._compress(c,15,function(c){return t(c+32)})+" "},decompressFromUTF16:function(t){return null==t?"":""==t?null:f._decompress(t.length,16384,function(c){return t.charCodeAt(c)-32})},compressToUint8Array:function(t){for(var c=f.compress(t),u=new Uint8Array(2*c.length),h=0,g=c.length;h<g;h++){var b=c.charCodeAt(h);u[2*h]=b>>>8,u[2*h+1]=b%256}return u},decompressFromUint8Array:function(c){if(null==c)return f.decompress(c);for(var u=Array(c.length/2),h=0,g=u.length;h<g;h++)u[h]=256*c[2*h]+c[2*h+1];var b=[];return u.forEach(function(c){b.push(t(c))}),f.decompress(b.join(""))},compressToEncodedURIComponent:function(t){return null==t?"":f._compress(t,6,function(t){return u.charAt(t)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),f._decompress(t.length,32,function(c){return getBaseValue(u,t.charAt(c))}))},compress:function(c){return f._compress(c,16,function(c){return t(c)})},_compress:function(t,c,u){if(null==t)return"";var h,f,g,b={},v={},x="",w="",_="",k=2,E=3,$=2,T=[],I=0,M=0;for(g=0;g<t.length;g+=1)if(x=t.charAt(g),Object.prototype.hasOwnProperty.call(b,x)||(b[x]=E++,v[x]=!0),w=_+x,Object.prototype.hasOwnProperty.call(b,w))_=w;else{if(Object.prototype.hasOwnProperty.call(v,_)){if(256>_.charCodeAt(0)){for(h=0;h<$;h++)I<<=1,M==c-1?(M=0,T.push(u(I)),I=0):M++;for(h=0,f=_.charCodeAt(0);h<8;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1}else{for(h=0,f=1;h<$;h++)I=I<<1|f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f=0;for(h=0,f=_.charCodeAt(0);h<16;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1}0==--k&&(k=Math.pow(2,$),$++),delete v[_]}else for(h=0,f=b[_];h<$;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1;0==--k&&(k=Math.pow(2,$),$++),b[w]=E++,_=String(x)}if(""!==_){if(Object.prototype.hasOwnProperty.call(v,_)){if(256>_.charCodeAt(0)){for(h=0;h<$;h++)I<<=1,M==c-1?(M=0,T.push(u(I)),I=0):M++;for(h=0,f=_.charCodeAt(0);h<8;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1}else{for(h=0,f=1;h<$;h++)I=I<<1|f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f=0;for(h=0,f=_.charCodeAt(0);h<16;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1}0==--k&&(k=Math.pow(2,$),$++),delete v[_]}else for(h=0,f=b[_];h<$;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1;0==--k&&(k=Math.pow(2,$),$++)}for(h=0,f=2;h<$;h++)I=I<<1|1&f,M==c-1?(M=0,T.push(u(I)),I=0):M++,f>>=1;for(;;){if(I<<=1,M==c-1){T.push(u(I));break}M++}return T.join("")},decompress:function(t){return null==t?"":""==t?null:f._decompress(t.length,32768,function(c){return t.charCodeAt(c)})},_decompress:function(c,u,h){var f,g,b,v,x,w,_,k=[],E=4,$=4,T=3,I="",M=[],j={val:h(0),position:u,index:1};for(f=0;f<3;f+=1)k[f]=f;for(b=0,x=4,w=1;w!=x;)v=j.val&j.position,j.position>>=1,0==j.position&&(j.position=u,j.val=h(j.index++)),b|=(v>0?1:0)*w,w<<=1;switch(b){case 0:for(b=0,x=256,w=1;w!=x;)v=j.val&j.position,j.position>>=1,0==j.position&&(j.position=u,j.val=h(j.index++)),b|=(v>0?1:0)*w,w<<=1;_=t(b);break;case 1:for(b=0,x=65536,w=1;w!=x;)v=j.val&j.position,j.position>>=1,0==j.position&&(j.position=u,j.val=h(j.index++)),b|=(v>0?1:0)*w,w<<=1;_=t(b);break;case 2:return""}for(k[3]=_,g=_,M.push(_);;){if(j.index>c)return"";for(b=0,x=Math.pow(2,T),w=1;w!=x;)v=j.val&j.position,j.position>>=1,0==j.position&&(j.position=u,j.val=h(j.index++)),b|=(v>0?1:0)*w,w<<=1;switch(_=b){case 0:for(b=0,x=256,w=1;w!=x;)v=j.val&j.position,j.position>>=1,0==j.position&&(j.position=u,j.val=h(j.index++)),b|=(v>0?1:0)*w,w<<=1;k[$++]=t(b),_=$-1,E--;break;case 1:for(b=0,x=65536,w=1;w!=x;)v=j.val&j.position,j.position>>=1,0==j.position&&(j.position=u,j.val=h(j.index++)),b|=(v>0?1:0)*w,w<<=1;k[$++]=t(b),_=$-1,E--;break;case 2:return M.join("")}if(0==E&&(E=Math.pow(2,T),T++),k[_])I=k[_];else{if(_!==$)return null;I=g+g.charAt(0)}M.push(I),k[$++]=g+I.charAt(0),E--,g=I,0==E&&(E=Math.pow(2,T),T++)}}};return f}();void 0!==(h=(function(){return f}).call(c,u,c,t))&&(t.exports=h)},2601:function(t,c,u){"use strict";var h,f;t.exports=(null==(h=u.g.process)?void 0:h.env)&&"object"==typeof(null==(f=u.g.process)?void 0:f.env)?u.g.process:u(8960)},8811:function(t,c,u){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return dynamic}});let h=u(1024);u(2265);let f=h._(u(7075));function convertModule(t){return{default:(null==t?void 0:t.default)||t}}function dynamic(t,c){let u=f.default,h={loading:t=>{let{error:c,isLoading:u,pastDelay:h}=t;return null}};"function"==typeof t&&(h.loader=t),Object.assign(h,c);let g=h.loader;return u({...h,loader:()=>null!=g?g().then(convertModule):Promise.resolve(convertModule(()=>null))})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),t.exports=c.default)},9167:function(t,c,u){"use strict";function NoSSR(t){let{children:c}=t;return c}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"NoSSR",{enumerable:!0,get:function(){return NoSSR}}),u(1283)},7075:function(t,c,u){"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return b}});let h=u(1024),f=h._(u(2265)),g=u(9167);function Loadable(t){let c=Object.assign({loader:null,loading:null,ssr:!0},t);function LoadableComponent(t){let u=c.loading,h=f.default.createElement(u,{isLoading:!0,pastDelay:!0,error:null}),b=c.ssr?f.default.Fragment:g.NoSSR,v=c.lazy;return f.default.createElement(f.default.Suspense,{fallback:h},f.default.createElement(b,null,f.default.createElement(v,t)))}return c.lazy=f.default.lazy(c.loader),LoadableComponent.displayName="LoadableComponent",LoadableComponent}let b=Loadable},1364:function(){},4559:function(){},8960:function(t){!function(){var c={229:function(t){var c,u,h,f=t.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(t){if(c===setTimeout)return setTimeout(t,0);if((c===defaultSetTimout||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(u){try{return c.call(null,t,0)}catch(u){return c.call(this,t,0)}}}function runClearTimeout(t){if(u===clearTimeout)return clearTimeout(t);if((u===defaultClearTimeout||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(c){try{return u.call(null,t)}catch(c){return u.call(this,t)}}}!function(){try{c="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(t){c=defaultSetTimout}try{u="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(t){u=defaultClearTimeout}}();var g=[],b=!1,v=-1;function cleanUpNextTick(){b&&h&&(b=!1,h.length?g=h.concat(g):v=-1,g.length&&drainQueue())}function drainQueue(){if(!b){var t=runTimeout(cleanUpNextTick);b=!0;for(var c=g.length;c;){for(h=g,g=[];++v<c;)h&&h[v].run();v=-1,c=g.length}h=null,b=!1,runClearTimeout(t)}}function Item(t,c){this.fun=t,this.array=c}function noop(){}f.nextTick=function(t){var c=Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)c[u-1]=arguments[u];g.push(new Item(t,c)),1!==g.length||b||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=noop,f.addListener=noop,f.once=noop,f.off=noop,f.removeListener=noop,f.removeAllListeners=noop,f.emit=noop,f.prependListener=noop,f.prependOnceListener=noop,f.listeners=function(t){return[]},f.binding=function(t){throw Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw Error("process.chdir is not supported")},f.umask=function(){return 0}}},u={};function __nccwpck_require__(t){var h=u[t];if(void 0!==h)return h.exports;var f=u[t]={exports:{}},g=!0;try{c[t](f,f.exports,__nccwpck_require__),g=!1}finally{g&&delete u[t]}return f.exports}__nccwpck_require__.ab="//";var h=__nccwpck_require__(229);t.exports=h}()},622:function(t,c,u){"use strict";/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h=u(2265),f=Symbol.for("react.element"),g=Symbol.for("react.fragment"),b=Object.prototype.hasOwnProperty,v=h.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x={key:!0,ref:!0,__self:!0,__source:!0};function q(t,c,u){var h,g={},w=null,_=null;for(h in void 0!==u&&(w=""+u),void 0!==c.key&&(w=""+c.key),void 0!==c.ref&&(_=c.ref),c)b.call(c,h)&&!x.hasOwnProperty(h)&&(g[h]=c[h]);if(t&&t.defaultProps)for(h in c=t.defaultProps)void 0===g[h]&&(g[h]=c[h]);return{$$typeof:f,type:t,key:w,ref:_,props:g,_owner:v.current}}c.Fragment=g,c.jsx=q,c.jsxs=q},7437:function(t,c,u){"use strict";t.exports=u(622)},1165:function(){!function(t){var c=/\/(?![/*])|\/\/.*[\r\n]|\/\*[^*]*(?:\*(?!\/)[^*]*)*\*\//.source,u=/@(?!")|"(?:[^\r\n\\"]|\\.)*"|@"(?:[^\\"]|""|\\[\s\S])*"(?!")/.source+"|"+/'(?:(?:[^\r\n'\\]|\\.|\\[Uux][\da-fA-F]{1,8})'|(?=[^\\](?!')))/.source;function nested(t,h){for(var f=0;f<h;f++)t=t.replace(/<self>/g,function(){return"(?:"+t+")"});return t.replace(/<self>/g,"[^\\s\\S]").replace(/<str>/g,"(?:"+u+")").replace(/<comment>/g,"(?:"+c+")")}var h=nested(/\((?:[^()'"@/]|<str>|<comment>|<self>)*\)/.source,2),f=nested(/\[(?:[^\[\]'"@/]|<str>|<comment>|<self>)*\]/.source,1),g=nested(/\{(?:[^{}'"@/]|<str>|<comment>|<self>)*\}/.source,2),b=nested(/<(?:[^<>'"@/]|<comment>|<self>)*>/.source,1),v=/@/.source+/(?:await\b\s*)?/.source+"(?:"+/(?!await\b)\w+\b/.source+"|"+h+")(?:"+/[?!]?\.\w+\b/.source+"|(?:"+b+")?"+h+"|"+f+")*"+/(?![?!\.(\[]|<(?!\/))/.source,x=/@(?![\w()])/.source+"|"+v,w="(?:"+/"[^"@]*"|'[^'@]*'|[^\s'"@>=]+(?=[\s>])/.source+"|[\"'][^\"'@]*(?:(?:"+x+")[^\"'@]*)+[\"'])",_=/(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*<tagAttrValue>|(?=[\s/>])))+)?/.source.replace(/<tagAttrValue>/,w),k=/(?!\d)[^\s>\/=$<%]+/.source+_+/\s*\/?>/.source,E=/\B@?/.source+"(?:"+/<([a-zA-Z][\w:]*)/.source+_+/\s*>/.source+"(?:"+(/[^<]/.source+"|"+/<\/?(?!\1\b)/.source)+k+"|"+nested(/<\1/.source+_+/\s*>/.source+"(?:"+(/[^<]/.source+"|")+/<\/?(?!\1\b)/.source+k+"|<self>)*"+/<\/\1\s*>/.source,2)+")*"+/<\/\1\s*>/.source+"|"+/</.source+k+")";t.languages.cshtml=t.languages.extend("markup",{});var $={pattern:/\S[\s\S]*/,alias:"language-csharp",inside:t.languages.insertBefore("csharp","string",{html:{pattern:RegExp(E),greedy:!0,inside:t.languages.cshtml}},{csharp:t.languages.extend("csharp",{})})},T={pattern:RegExp(/(^|[^@])/.source+v),lookbehind:!0,greedy:!0,alias:"variable",inside:{keyword:/^@/,csharp:$}};t.languages.cshtml.tag.pattern=RegExp(/<\/?/.source+k),t.languages.cshtml.tag.inside["attr-value"].pattern=RegExp(/=\s*/.source+w),t.languages.insertBefore("inside","punctuation",{value:T},t.languages.cshtml.tag.inside["attr-value"]),t.languages.insertBefore("cshtml","prolog",{"razor-comment":{pattern:/@\*[\s\S]*?\*@/,greedy:!0,alias:"comment"},block:{pattern:RegExp(/(^|[^@])@/.source+"(?:"+[g,/(?:code|functions)\s*/.source+g,/(?:for|foreach|lock|switch|using|while)\s*/.source+h+/\s*/.source+g,/do\s*/.source+g+/\s*while\s*/.source+h+/(?:\s*;)?/.source,/try\s*/.source+g+/\s*catch\s*/.source+h+/\s*/.source+g+/\s*finally\s*/.source+g,/if\s*/.source+h+/\s*/.source+g+"(?:"+/\s*else/.source+"(?:"+/\s+if\s*/.source+h+")?"+/\s*/.source+g+")*",/helper\s+\w+\s*/.source+h+/\s*/.source+g].join("|")+")"),lookbehind:!0,greedy:!0,inside:{keyword:/^@\w*/,csharp:$}},directive:{pattern:/^([ \t]*)@(?:addTagHelper|attribute|implements|inherits|inject|layout|model|namespace|page|preservewhitespace|removeTagHelper|section|tagHelperPrefix|using)(?=\s).*/m,lookbehind:!0,greedy:!0,inside:{keyword:/^@\w+/,csharp:$}},value:T,"delegate-operator":{pattern:/(^|[^@])@(?=<)/,lookbehind:!0,alias:"operator"}}),t.languages.razor=t.languages.cshtml}(Prism)},2686:function(t,c,u){/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var h,f,g=function(t){var c=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,u=0,h={},f={manual:t.Prism&&t.Prism.manual,disableWorkerMessageHandler:t.Prism&&t.Prism.disableWorkerMessageHandler,util:{encode:function encode(t){return t instanceof Token?new Token(t.type,encode(t.content),t.alias):Array.isArray(t)?t.map(encode):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(t){return Object.prototype.toString.call(t).slice(8,-1)},objId:function(t){return t.__id||Object.defineProperty(t,"__id",{value:++u}),t.__id},clone:function deepClone(t,c){var u,h;switch(c=c||{},f.util.type(t)){case"Object":if(c[h=f.util.objId(t)])return c[h];for(var g in u={},c[h]=u,t)t.hasOwnProperty(g)&&(u[g]=deepClone(t[g],c));return u;case"Array":if(c[h=f.util.objId(t)])return c[h];return u=[],c[h]=u,t.forEach(function(t,h){u[h]=deepClone(t,c)}),u;default:return t}},getLanguage:function(t){for(;t;){var u=c.exec(t.className);if(u)return u[1].toLowerCase();t=t.parentElement}return"none"},setLanguage:function(t,u){t.className=t.className.replace(RegExp(c,"gi"),""),t.classList.add("language-"+u)},currentScript:function(){if("undefined"==typeof document)return null;if("currentScript"in document)return document.currentScript;try{throw Error()}catch(h){var t=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(h.stack)||[])[1];if(t){var c=document.getElementsByTagName("script");for(var u in c)if(c[u].src==t)return c[u]}return null}},isActive:function(t,c,u){for(var h="no-"+c;t;){var f=t.classList;if(f.contains(c))return!0;if(f.contains(h))return!1;t=t.parentElement}return!!u}},languages:{plain:h,plaintext:h,text:h,txt:h,extend:function(t,c){var u=f.util.clone(f.languages[t]);for(var h in c)u[h]=c[h];return u},insertBefore:function(t,c,u,h){var g=(h=h||f.languages)[t],b={};for(var v in g)if(g.hasOwnProperty(v)){if(v==c)for(var x in u)u.hasOwnProperty(x)&&(b[x]=u[x]);u.hasOwnProperty(v)||(b[v]=g[v])}var w=h[t];return h[t]=b,f.languages.DFS(f.languages,function(c,u){u===w&&c!=t&&(this[c]=b)}),b},DFS:function DFS(t,c,u,h){h=h||{};var g=f.util.objId;for(var b in t)if(t.hasOwnProperty(b)){c.call(t,b,t[b],u||b);var v=t[b],x=f.util.type(v);"Object"!==x||h[g(v)]?"Array"!==x||h[g(v)]||(h[g(v)]=!0,DFS(v,c,b,h)):(h[g(v)]=!0,DFS(v,c,null,h))}}},plugins:{},highlightAll:function(t,c){f.highlightAllUnder(document,t,c)},highlightAllUnder:function(t,c,u){var h={callback:u,container:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};f.hooks.run("before-highlightall",h),h.elements=Array.prototype.slice.apply(h.container.querySelectorAll(h.selector)),f.hooks.run("before-all-elements-highlight",h);for(var g,b=0;g=h.elements[b++];)f.highlightElement(g,!0===c,h.callback)},highlightElement:function(c,u,h){var g=f.util.getLanguage(c),b=f.languages[g];f.util.setLanguage(c,g);var v=c.parentElement;v&&"pre"===v.nodeName.toLowerCase()&&f.util.setLanguage(v,g);var x=c.textContent,w={element:c,language:g,grammar:b,code:x};function insertHighlightedCode(t){w.highlightedCode=t,f.hooks.run("before-insert",w),w.element.innerHTML=w.highlightedCode,f.hooks.run("after-highlight",w),f.hooks.run("complete",w),h&&h.call(w.element)}if(f.hooks.run("before-sanity-check",w),(v=w.element.parentElement)&&"pre"===v.nodeName.toLowerCase()&&!v.hasAttribute("tabindex")&&v.setAttribute("tabindex","0"),!w.code){f.hooks.run("complete",w),h&&h.call(w.element);return}if(f.hooks.run("before-highlight",w),!w.grammar){insertHighlightedCode(f.util.encode(w.code));return}if(u&&t.Worker){var _=new Worker(f.filename);_.onmessage=function(t){insertHighlightedCode(t.data)},_.postMessage(JSON.stringify({language:w.language,code:w.code,immediateClose:!0}))}else insertHighlightedCode(f.highlight(w.code,w.grammar,w.language))},highlight:function(t,c,u){var h={code:t,grammar:c,language:u};if(f.hooks.run("before-tokenize",h),!h.grammar)throw Error('The language "'+h.language+'" has no grammar.');return h.tokens=f.tokenize(h.code,h.grammar),f.hooks.run("after-tokenize",h),Token.stringify(f.util.encode(h.tokens),h.language)},tokenize:function(t,c){var u=c.rest;if(u){for(var h in u)c[h]=u[h];delete c.rest}var f=new LinkedList;return addAfter(f,f.head,t),matchGrammar(t,f,c,f.head,0),toArray(f)},hooks:{all:{},add:function(t,c){var u=f.hooks.all;u[t]=u[t]||[],u[t].push(c)},run:function(t,c){var u=f.hooks.all[t];if(u&&u.length)for(var h,g=0;h=u[g++];)h(c)}},Token:Token};function Token(t,c,u,h){this.type=t,this.content=c,this.alias=u,this.length=0|(h||"").length}function matchPattern(t,c,u,h){t.lastIndex=c;var f=t.exec(u);if(f&&h&&f[1]){var g=f[1].length;f.index+=g,f[0]=f[0].slice(g)}return f}function matchGrammar(t,c,u,h,g,b){for(var v in u)if(u.hasOwnProperty(v)&&u[v]){var x=u[v];x=Array.isArray(x)?x:[x];for(var w=0;w<x.length;++w){if(b&&b.cause==v+","+w)return;var _=x[w],k=_.inside,E=!!_.lookbehind,$=!!_.greedy,T=_.alias;if($&&!_.pattern.global){var I=_.pattern.toString().match(/[imsuy]*$/)[0];_.pattern=RegExp(_.pattern.source,I+"g")}for(var M=_.pattern||_,j=h.next,D=g;j!==c.tail&&(!b||!(D>=b.reach));D+=j.value.length,j=j.next){var F,L=j.value;if(c.length>t.length)return;if(!(L instanceof Token)){var B=1;if($){if(!(F=matchPattern(M,D,t,E))||F.index>=t.length)break;var G=F.index,U=F.index+F[0].length,V=D;for(V+=j.value.length;G>=V;)V+=(j=j.next).value.length;if(V-=j.value.length,D=V,j.value instanceof Token)continue;for(var K=j;K!==c.tail&&(V<U||"string"==typeof K.value);K=K.next)B++,V+=K.value.length;B--,L=t.slice(D,V),F.index-=D}else if(!(F=matchPattern(M,0,L,E)))continue;var G=F.index,Z=F[0],Y=L.slice(0,G),X=L.slice(G+Z.length),J=D+L.length;b&&J>b.reach&&(b.reach=J);var Q=j.prev;if(Y&&(Q=addAfter(c,Q,Y),D+=Y.length),removeRange(c,Q,B),j=addAfter(c,Q,new Token(v,k?f.tokenize(Z,k):Z,T,Z)),X&&addAfter(c,j,X),B>1){var ee={cause:v+","+w,reach:J};matchGrammar(t,c,u,j.prev,D,ee),b&&ee.reach>b.reach&&(b.reach=ee.reach)}}}}}}function LinkedList(){var t={value:null,prev:null,next:null},c={value:null,prev:t,next:null};t.next=c,this.head=t,this.tail=c,this.length=0}function addAfter(t,c,u){var h=c.next,f={value:u,prev:c,next:h};return c.next=f,h.prev=f,t.length++,f}function removeRange(t,c,u){for(var h=c.next,f=0;f<u&&h!==t.tail;f++)h=h.next;c.next=h,h.prev=c,t.length-=f}function toArray(t){for(var c=[],u=t.head.next;u!==t.tail;)c.push(u.value),u=u.next;return c}if(t.Prism=f,Token.stringify=function stringify(t,c){if("string"==typeof t)return t;if(Array.isArray(t)){var u="";return t.forEach(function(t){u+=stringify(t,c)}),u}var h={type:t.type,content:stringify(t.content,c),tag:"span",classes:["token",t.type],attributes:{},language:c},g=t.alias;g&&(Array.isArray(g)?Array.prototype.push.apply(h.classes,g):h.classes.push(g)),f.hooks.run("wrap",h);var b="";for(var v in h.attributes)b+=" "+v+'="'+(h.attributes[v]||"").replace(/"/g,"&quot;")+'"';return"<"+h.tag+' class="'+h.classes.join(" ")+'"'+b+">"+h.content+"</"+h.tag+">"},!t.document)return t.addEventListener&&(f.disableWorkerMessageHandler||t.addEventListener("message",function(c){var u=JSON.parse(c.data),h=u.language,g=u.code,b=u.immediateClose;t.postMessage(f.highlight(g,f.languages[h],h)),b&&t.close()},!1)),f;var g=f.util.currentScript();function highlightAutomaticallyCallback(){f.manual||f.highlightAll()}if(g&&(f.filename=g.src,g.hasAttribute("data-manual")&&(f.manual=!0)),!f.manual){var b=document.readyState;"loading"===b||"interactive"===b&&g&&g.defer?document.addEventListener("DOMContentLoaded",highlightAutomaticallyCallback):window.requestAnimationFrame?window.requestAnimationFrame(highlightAutomaticallyCallback):window.setTimeout(highlightAutomaticallyCallback,16)}return f}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});t.exports&&(t.exports=g),void 0!==u.g&&(u.g.Prism=g),g.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},g.languages.markup.tag.inside["attr-value"].inside.entity=g.languages.markup.entity,g.languages.markup.doctype.inside["internal-subset"].inside=g.languages.markup,g.hooks.add("wrap",function(t){"entity"===t.type&&(t.attributes.title=t.content.replace(/&amp;/,"&"))}),Object.defineProperty(g.languages.markup.tag,"addInlined",{value:function(t,c){var u={};u["language-"+c]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:g.languages[c]},u.cdata=/^<!\[CDATA\[|\]\]>$/i;var h={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:u}};h["language-"+c]={pattern:/[\s\S]+/,inside:g.languages[c]};var f={};f[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:h},g.languages.insertBefore("markup","cdata",f)}}),Object.defineProperty(g.languages.markup.tag,"addAttribute",{value:function(t,c){g.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[c,"language-"+c],inside:g.languages[c]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),g.languages.html=g.languages.markup,g.languages.mathml=g.languages.markup,g.languages.svg=g.languages.markup,g.languages.xml=g.languages.extend("markup",{}),g.languages.ssml=g.languages.xml,g.languages.atom=g.languages.xml,g.languages.rss=g.languages.xml,h=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/,g.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+h.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+h.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+h.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+h.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:h,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},g.languages.css.atrule.inside.rest=g.languages.css,(f=g.languages.markup)&&(f.tag.addInlined("style","css"),f.tag.addAttribute("style","css")),g.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},g.languages.javascript=g.languages.extend("clike",{"class-name":[g.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|")+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),g.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,g.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:g.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:g.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:g.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:g.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:g.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),g.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:g.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),g.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),g.languages.markup&&(g.languages.markup.tag.addInlined("script","javascript"),g.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),g.languages.js=g.languages.javascript,function(){if(void 0!==g&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var t={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},c="data-src-status",u="loading",h="loaded",f="pre[data-src]:not(["+c+'="'+h+'"]):not(['+c+'="'+u+'"])';g.hooks.add("before-highlightall",function(t){t.selector+=", "+f}),g.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(f)){b.code="",v.setAttribute(c,u);var x=v.appendChild(document.createElement("CODE"));x.textContent="Loading…";var w=v.getAttribute("data-src"),_=b.language;if("none"===_){var k=(/\.(\w+)$/.exec(w)||[,"none"])[1];_=t[k]||k}g.util.setLanguage(x,_),g.util.setLanguage(v,_);var E=g.plugins.autoloader;E&&E.loadLanguages(_),loadFile(w,function(t){v.setAttribute(c,h);var u=parseRange(v.getAttribute("data-range"));if(u){var f=t.split(/\r\n?|\n/g),b=u[0],w=null==u[1]?f.length:u[1];b<0&&(b+=f.length),b=Math.max(0,Math.min(b-1,f.length)),w<0&&(w+=f.length),w=Math.max(0,Math.min(w,f.length)),t=f.slice(b,w).join("\n"),v.hasAttribute("data-start")||v.setAttribute("data-start",String(b+1))}x.textContent=t,g.highlightElement(x)},function(t){v.setAttribute(c,"failed"),x.textContent=t})}}),g.plugins.fileHighlight={highlight:function(t){for(var c,u=(t||document).querySelectorAll(f),h=0;c=u[h++];)g.highlightElement(c)}};var b=!1;g.fileHighlight=function(){b||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),b=!0),g.plugins.fileHighlight.highlight.apply(this,arguments)}}function loadFile(t,c,u){var h=new XMLHttpRequest;h.open("GET",t,!0),h.onreadystatechange=function(){4==h.readyState&&(h.status<400&&h.responseText?c(h.responseText):h.status>=400?u("✖ Error "+h.status+" while fetching file: "+h.statusText):u("✖ Error: File does not exist or is empty"))},h.send(null)}function parseRange(t){var c=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(t||"");if(c){var u=Number(c[1]),h=c[2],f=c[3];return h?f?[u,Number(f)]:[u,void 0]:[u,u]}}}()},9228:function(t,c,u){"use strict";u(7933);var h=u(9632);t.exports=h("Array","at")},5134:function(t,c,u){"use strict";u(7781),u(9328);var h=u(9632);t.exports=h("Array","flatMap")},1521:function(t,c,u){"use strict";u(3896),u(1767);var h=u(9632);t.exports=h("Array","flat")},7942:function(t,c,u){"use strict";u(4554);var h=u(9632);t.exports=h("String","at")},632:function(t,c,u){"use strict";u(789),u(1490),u(3510);var h=u(9632);t.exports=h("String","replaceAll")},6284:function(t,c,u){"use strict";var h=u(43),f=u(1747),g=TypeError;t.exports=function(t){if(h(t))return t;throw new g(f(t)+" is not a function")}},8609:function(t,c,u){"use strict";var h=u(1350),f=u(2957),g=u(4982).f,b=h("unscopables"),v=Array.prototype;void 0===v[b]&&g(v,b,{configurable:!0,value:f(null)}),t.exports=function(t){v[b][t]=!0}},2166:function(t,c,u){"use strict";var h=u(2068).charAt;t.exports=function(t,c,u){return c+(u?h(t,c).length:1)}},1485:function(t,c,u){"use strict";var h=u(6695),f=String,g=TypeError;t.exports=function(t){if(h(t))return t;throw new g(f(t)+" is not an object")}},8786:function(t,c,u){"use strict";var h=u(949),f=u(76),g=u(4464),createMethod=function(t){return function(c,u,b){var v,x=h(c),w=g(x),_=f(b,w);if(t&&u!=u){for(;w>_;)if((v=x[_++])!=v)return!0}else for(;w>_;_++)if((t||_ in x)&&x[_]===u)return t||_||0;return!t&&-1}};t.exports={includes:createMethod(!0),indexOf:createMethod(!1)}},665:function(t,c,u){"use strict";var h=u(7631),f=u(1357),g=u(6695),b=u(1350)("species"),v=Array;t.exports=function(t){var c;return h(t)&&(f(c=t.constructor)&&(c===v||h(c.prototype))?c=void 0:g(c)&&null===(c=c[b])&&(c=void 0)),void 0===c?v:c}},747:function(t,c,u){"use strict";var h=u(665);t.exports=function(t,c){return new(h(t))(0===c?0:c)}},6938:function(t,c,u){"use strict";var h=u(8842),f=h({}.toString),g=h("".slice);t.exports=function(t){return g(f(t),8,-1)}},9743:function(t,c,u){"use strict";var h=u(8830),f=u(43),g=u(6938),b=u(1350)("toStringTag"),v=Object,x="Arguments"===g(function(){return arguments}()),tryGet=function(t,c){try{return t[c]}catch(t){}};t.exports=h?g:function(t){var c,u,h;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(u=tryGet(c=v(t),b))?u:x?g(c):"Object"===(h=g(c))&&f(c.callee)?"Arguments":h}},783:function(t,c,u){"use strict";var h=u(9472),f=u(5191),g=u(5575),b=u(4982);t.exports=function(t,c,u){for(var v=f(c),x=b.f,w=g.f,_=0;_<v.length;_++){var k=v[_];h(t,k)||u&&h(u,k)||x(t,k,w(c,k))}}},549:function(t,c,u){"use strict";var h=u(2534),f=u(4982),g=u(9085);t.exports=h?function(t,c,u){return f.f(t,c,g(1,u))}:function(t,c,u){return t[c]=u,t}},9085:function(t){"use strict";t.exports=function(t,c){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:c}}},4897:function(t,c,u){"use strict";var h=u(43),f=u(4982),g=u(5412),b=u(2501);t.exports=function(t,c,u,v){v||(v={});var x=v.enumerable,w=void 0!==v.name?v.name:c;if(h(u)&&g(u,w,v),v.global)x?t[c]=u:b(c,u);else{try{v.unsafe?t[c]&&(x=!0):delete t[c]}catch(t){}x?t[c]=u:f.f(t,c,{value:u,enumerable:!1,configurable:!v.nonConfigurable,writable:!v.nonWritable})}return t}},2501:function(t,c,u){"use strict";var h=u(7738),f=Object.defineProperty;t.exports=function(t,c){try{f(h,t,{value:c,configurable:!0,writable:!0})}catch(u){h[t]=c}return c}},2534:function(t,c,u){"use strict";var h=u(4256);t.exports=!h(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},7310:function(t){"use strict";var c="object"==typeof document&&document.all;t.exports={all:c,IS_HTMLDDA:void 0===c&&void 0!==c}},7039:function(t,c,u){"use strict";var h=u(7738),f=u(6695),g=h.document,b=f(g)&&f(g.createElement);t.exports=function(t){return b?g.createElement(t):{}}},1960:function(t){"use strict";var c=TypeError;t.exports=function(t){if(t>9007199254740991)throw c("Maximum allowed index exceeded");return t}},7960:function(t){"use strict";t.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},4130:function(t,c,u){"use strict";var h,f,g=u(7738),b=u(7960),v=g.process,x=g.Deno,w=v&&v.versions||x&&x.version,_=w&&w.v8;_&&(f=(h=_.split("."))[0]>0&&h[0]<4?1:+(h[0]+h[1])),!f&&b&&(!(h=b.match(/Edge\/(\d+)/))||h[1]>=74)&&(h=b.match(/Chrome\/(\d+)/))&&(f=+h[1]),t.exports=f},9632:function(t,c,u){"use strict";var h=u(7738),f=u(8842);t.exports=function(t,c){return f(h[t].prototype[c])}},1971:function(t){"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},9272:function(t,c,u){"use strict";var h=u(7738),f=u(5575).f,g=u(549),b=u(4897),v=u(2501),x=u(783),w=u(1559);t.exports=function(t,c){var u,_,k,E,$,T=t.target,I=t.global,M=t.stat;if(u=I?h:M?h[T]||v(T,{}):(h[T]||{}).prototype)for(_ in c){if(E=c[_],k=t.dontCallGetSet?($=f(u,_))&&$.value:u[_],!w(I?_:T+(M?".":"#")+_,t.forced)&&void 0!==k){if(typeof E==typeof k)continue;x(E,k)}(t.sham||k&&k.sham)&&g(E,"sham",!0),b(u,_,E,t)}}},4256:function(t){"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},2571:function(t,c,u){"use strict";u(789);var h=u(6919),f=u(4897),g=u(3955),b=u(4256),v=u(1350),x=u(549),w=v("species"),_=RegExp.prototype;t.exports=function(t,c,u,k){var E=v(t),$=!b(function(){var c={};return c[E]=function(){return 7},7!==""[t](c)}),T=$&&!b(function(){var c=!1,u=/a/;return"split"===t&&((u={}).constructor={},u.constructor[w]=function(){return u},u.flags="",u[E]=/./[E]),u.exec=function(){return c=!0,null},u[E](""),!c});if(!$||!T||u){var I=h(/./[E]),M=c(E,""[t],function(t,c,u,f,b){var v=h(t),x=c.exec;return x===g||x===_.exec?$&&!b?{done:!0,value:I(c,u,f)}:{done:!0,value:v(u,c,f)}:{done:!1}});f(String.prototype,t,M[0]),f(_,E,M[1])}k&&x(_[E],"sham",!0)}},9162:function(t,c,u){"use strict";var h=u(7631),f=u(4464),g=u(1960),b=u(9668),flattenIntoArray=function(t,c,u,v,x,w,_,k){for(var E,$,T=x,I=0,M=!!_&&b(_,k);I<v;)I in u&&(E=M?M(u[I],I,c):u[I],w>0&&h(E)?($=f(E),T=flattenIntoArray(t,c,E,$,T,w-1)-1):(g(T+1),t[T]=E),T++),I++;return T};t.exports=flattenIntoArray},5815:function(t,c,u){"use strict";var h=u(1115),f=Function.prototype,g=f.apply,b=f.call;t.exports="object"==typeof Reflect&&Reflect.apply||(h?b.bind(g):function(){return b.apply(g,arguments)})},9668:function(t,c,u){"use strict";var h=u(6919),f=u(6284),g=u(1115),b=h(h.bind);t.exports=function(t,c){return f(t),void 0===c?t:g?b(t,c):function(){return t.apply(c,arguments)}}},1115:function(t,c,u){"use strict";var h=u(4256);t.exports=!h(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},5817:function(t,c,u){"use strict";var h=u(1115),f=Function.prototype.call;t.exports=h?f.bind(f):function(){return f.apply(f,arguments)}},6309:function(t,c,u){"use strict";var h=u(2534),f=u(9472),g=Function.prototype,b=h&&Object.getOwnPropertyDescriptor,v=f(g,"name"),x=v&&(!h||h&&b(g,"name").configurable);t.exports={EXISTS:v,PROPER:v&&"something"===(function(){}).name,CONFIGURABLE:x}},6919:function(t,c,u){"use strict";var h=u(6938),f=u(8842);t.exports=function(t){if("Function"===h(t))return f(t)}},8842:function(t,c,u){"use strict";var h=u(1115),f=Function.prototype,g=f.call,b=h&&f.bind.bind(g,g);t.exports=h?b:function(t){return function(){return g.apply(t,arguments)}}},5651:function(t,c,u){"use strict";var h=u(7738),f=u(43);t.exports=function(t,c){var u;return arguments.length<2?f(u=h[t])?u:void 0:h[t]&&h[t][c]}},2112:function(t,c,u){"use strict";var h=u(6284),f=u(6617);t.exports=function(t,c){var u=t[c];return f(u)?void 0:h(u)}},7175:function(t,c,u){"use strict";var h=u(8842),f=u(4405),g=Math.floor,b=h("".charAt),v=h("".replace),x=h("".slice),w=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,_=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,c,u,h,k,E){var $=u+t.length,T=h.length,I=_;return void 0!==k&&(k=f(k),I=w),v(E,I,function(f,v){var w;switch(b(v,0)){case"$":return"$";case"&":return t;case"`":return x(c,0,u);case"'":return x(c,$);case"<":w=k[x(v,1,-1)];break;default:var _=+v;if(0===_)return f;if(_>T){var E=g(_/10);if(0===E)return f;if(E<=T)return void 0===h[E-1]?b(v,1):h[E-1]+b(v,1);return f}w=h[_-1]}return void 0===w?"":w})}},7738:function(t,c,u){"use strict";var check=function(t){return t&&t.Math===Math&&t};t.exports=check("object"==typeof globalThis&&globalThis)||check("object"==typeof window&&window)||check("object"==typeof self&&self)||check("object"==typeof u.g&&u.g)||function(){return this}()||this||Function("return this")()},9472:function(t,c,u){"use strict";var h=u(8842),f=u(4405),g=h({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,c){return g(f(t),c)}},8347:function(t){"use strict";t.exports={}},1162:function(t,c,u){"use strict";var h=u(5651);t.exports=h("document","documentElement")},1149:function(t,c,u){"use strict";var h=u(2534),f=u(4256),g=u(7039);t.exports=!h&&!f(function(){return 7!==Object.defineProperty(g("div"),"a",{get:function(){return 7}}).a})},3910:function(t,c,u){"use strict";var h=u(8842),f=u(4256),g=u(6938),b=Object,v=h("".split);t.exports=f(function(){return!b("z").propertyIsEnumerable(0)})?function(t){return"String"===g(t)?v(t,""):b(t)}:b},2402:function(t,c,u){"use strict";var h=u(8842),f=u(43),g=u(9145),b=h(Function.toString);f(g.inspectSource)||(g.inspectSource=function(t){return b(t)}),t.exports=g.inspectSource},5230:function(t,c,u){"use strict";var h,f,g,b=u(9819),v=u(7738),x=u(6695),w=u(549),_=u(9472),k=u(9145),E=u(50),$=u(8347),T="Object already initialized",I=v.TypeError,M=v.WeakMap;if(b||k.state){var j=k.state||(k.state=new M);j.get=j.get,j.has=j.has,j.set=j.set,h=function(t,c){if(j.has(t))throw new I(T);return c.facade=t,j.set(t,c),c},f=function(t){return j.get(t)||{}},g=function(t){return j.has(t)}}else{var D=E("state");$[D]=!0,h=function(t,c){if(_(t,D))throw new I(T);return c.facade=t,w(t,D,c),c},f=function(t){return _(t,D)?t[D]:{}},g=function(t){return _(t,D)}}t.exports={set:h,get:f,has:g,enforce:function(t){return g(t)?f(t):h(t,{})},getterFor:function(t){return function(c){var u;if(!x(c)||(u=f(c)).type!==t)throw new I("Incompatible receiver, "+t+" required");return u}}}},7631:function(t,c,u){"use strict";var h=u(6938);t.exports=Array.isArray||function(t){return"Array"===h(t)}},43:function(t,c,u){"use strict";var h=u(7310),f=h.all;t.exports=h.IS_HTMLDDA?function(t){return"function"==typeof t||t===f}:function(t){return"function"==typeof t}},1357:function(t,c,u){"use strict";var h=u(8842),f=u(4256),g=u(43),b=u(9743),v=u(5651),x=u(2402),noop=function(){},w=[],_=v("Reflect","construct"),k=/^\s*(?:class|function)\b/,E=h(k.exec),$=!k.test(noop),isConstructorModern=function(t){if(!g(t))return!1;try{return _(noop,w,t),!0}catch(t){return!1}},isConstructorLegacy=function(t){if(!g(t))return!1;switch(b(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return $||!!E(k,x(t))}catch(t){return!0}};isConstructorLegacy.sham=!0,t.exports=!_||f(function(){var t;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern(function(){t=!0})||t})?isConstructorLegacy:isConstructorModern},1559:function(t,c,u){"use strict";var h=u(4256),f=u(43),g=/#|\.prototype\./,isForced=function(t,c){var u=v[b(t)];return u===w||u!==x&&(f(c)?h(c):!!c)},b=isForced.normalize=function(t){return String(t).replace(g,".").toLowerCase()},v=isForced.data={},x=isForced.NATIVE="N",w=isForced.POLYFILL="P";t.exports=isForced},6617:function(t){"use strict";t.exports=function(t){return null==t}},6695:function(t,c,u){"use strict";var h=u(43),f=u(7310),g=f.all;t.exports=f.IS_HTMLDDA?function(t){return"object"==typeof t?null!==t:h(t)||t===g}:function(t){return"object"==typeof t?null!==t:h(t)}},9168:function(t){"use strict";t.exports=!1},1059:function(t,c,u){"use strict";var h=u(6695),f=u(6938),g=u(1350)("match");t.exports=function(t){var c;return h(t)&&(void 0!==(c=t[g])?!!c:"RegExp"===f(t))}},5375:function(t,c,u){"use strict";var h=u(5651),f=u(43),g=u(112),b=u(327),v=Object;t.exports=b?function(t){return"symbol"==typeof t}:function(t){var c=h("Symbol");return f(c)&&g(c.prototype,v(t))}},4464:function(t,c,u){"use strict";var h=u(2510);t.exports=function(t){return h(t.length)}},5412:function(t,c,u){"use strict";var h=u(8842),f=u(4256),g=u(43),b=u(9472),v=u(2534),x=u(6309).CONFIGURABLE,w=u(2402),_=u(5230),k=_.enforce,E=_.get,$=String,T=Object.defineProperty,I=h("".slice),M=h("".replace),j=h([].join),D=v&&!f(function(){return 8!==T(function(){},"length",{value:8}).length}),F=String(String).split("String"),L=t.exports=function(t,c,u){"Symbol("===I($(c),0,7)&&(c="["+M($(c),/^Symbol\(([^)]*)\)/,"$1")+"]"),u&&u.getter&&(c="get "+c),u&&u.setter&&(c="set "+c),(!b(t,"name")||x&&t.name!==c)&&(v?T(t,"name",{value:c,configurable:!0}):t.name=c),D&&u&&b(u,"arity")&&t.length!==u.arity&&T(t,"length",{value:u.arity});try{u&&b(u,"constructor")&&u.constructor?v&&T(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var h=k(t);return b(h,"source")||(h.source=j(F,"string"==typeof c?c:"")),t};Function.prototype.toString=L(function(){return g(this)&&E(this).source||w(this)},"toString")},1325:function(t){"use strict";var c=Math.ceil,u=Math.floor;t.exports=Math.trunc||function(t){var h=+t;return(h>0?u:c)(h)}},2957:function(t,c,u){"use strict";var h,f=u(1485),g=u(9400),b=u(1971),v=u(8347),x=u(1162),w=u(7039),_=u(50),k="prototype",E="script",$=_("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(t){return"<"+E+">"+t+"</"+E+">"},NullProtoObjectViaActiveX=function(t){t.write(scriptTag("")),t.close();var c=t.parentWindow.Object;return t=null,c},NullProtoObjectViaIFrame=function(){var t,c=w("iframe");return c.style.display="none",x.appendChild(c),c.src=String("java"+E+":"),(t=c.contentWindow.document).open(),t.write(scriptTag("document.F=Object")),t.close(),t.F},NullProtoObject=function(){try{h=new ActiveXObject("htmlfile")}catch(t){}NullProtoObject="undefined"!=typeof document?document.domain&&h?NullProtoObjectViaActiveX(h):NullProtoObjectViaIFrame():NullProtoObjectViaActiveX(h);for(var t=b.length;t--;)delete NullProtoObject[k][b[t]];return NullProtoObject()};v[$]=!0,t.exports=Object.create||function(t,c){var u;return null!==t?(EmptyConstructor[k]=f(t),u=new EmptyConstructor,EmptyConstructor[k]=null,u[$]=t):u=NullProtoObject(),void 0===c?u:g.f(u,c)}},9400:function(t,c,u){"use strict";var h=u(2534),f=u(1887),g=u(4982),b=u(1485),v=u(949),x=u(5540);c.f=h&&!f?Object.defineProperties:function(t,c){b(t);for(var u,h=v(c),f=x(c),w=f.length,_=0;w>_;)g.f(t,u=f[_++],h[u]);return t}},4982:function(t,c,u){"use strict";var h=u(2534),f=u(1149),g=u(1887),b=u(1485),v=u(7843),x=TypeError,w=Object.defineProperty,_=Object.getOwnPropertyDescriptor,k="enumerable",E="configurable",$="writable";c.f=h?g?function(t,c,u){if(b(t),c=v(c),b(u),"function"==typeof t&&"prototype"===c&&"value"in u&&$ in u&&!u[$]){var h=_(t,c);h&&h[$]&&(t[c]=u.value,u={configurable:E in u?u[E]:h[E],enumerable:k in u?u[k]:h[k],writable:!1})}return w(t,c,u)}:w:function(t,c,u){if(b(t),c=v(c),b(u),f)try{return w(t,c,u)}catch(t){}if("get"in u||"set"in u)throw new x("Accessors not supported");return"value"in u&&(t[c]=u.value),t}},5575:function(t,c,u){"use strict";var h=u(2534),f=u(5817),g=u(6787),b=u(9085),v=u(949),x=u(7843),w=u(9472),_=u(1149),k=Object.getOwnPropertyDescriptor;c.f=h?k:function(t,c){if(t=v(t),c=x(c),_)try{return k(t,c)}catch(t){}if(w(t,c))return b(!f(g.f,t,c),t[c])}},7613:function(t,c,u){"use strict";var h=u(9852),f=u(1971).concat("length","prototype");c.f=Object.getOwnPropertyNames||function(t){return h(t,f)}},4531:function(t,c){"use strict";c.f=Object.getOwnPropertySymbols},112:function(t,c,u){"use strict";var h=u(8842);t.exports=h({}.isPrototypeOf)},9852:function(t,c,u){"use strict";var h=u(8842),f=u(9472),g=u(949),b=u(8786).indexOf,v=u(8347),x=h([].push);t.exports=function(t,c){var u,h=g(t),w=0,_=[];for(u in h)!f(v,u)&&f(h,u)&&x(_,u);for(;c.length>w;)f(h,u=c[w++])&&(~b(_,u)||x(_,u));return _}},5540:function(t,c,u){"use strict";var h=u(9852),f=u(1971);t.exports=Object.keys||function(t){return h(t,f)}},6787:function(t,c){"use strict";var u={}.propertyIsEnumerable,h=Object.getOwnPropertyDescriptor,f=h&&!u.call({1:2},1);c.f=f?function(t){var c=h(this,t);return!!c&&c.enumerable}:u},1823:function(t,c,u){"use strict";var h=u(5817),f=u(43),g=u(6695),b=TypeError;t.exports=function(t,c){var u,v;if("string"===c&&f(u=t.toString)&&!g(v=h(u,t))||f(u=t.valueOf)&&!g(v=h(u,t))||"string"!==c&&f(u=t.toString)&&!g(v=h(u,t)))return v;throw new b("Can't convert object to primitive value")}},5191:function(t,c,u){"use strict";var h=u(5651),f=u(8842),g=u(7613),b=u(4531),v=u(1485),x=f([].concat);t.exports=h("Reflect","ownKeys")||function(t){var c=g.f(v(t)),u=b.f;return u?x(c,u(t)):c}},8911:function(t,c,u){"use strict";var h=u(5817),f=u(1485),g=u(43),b=u(6938),v=u(3955),x=TypeError;t.exports=function(t,c){var u=t.exec;if(g(u)){var w=h(u,t,c);return null!==w&&f(w),w}if("RegExp"===b(t))return h(v,t,c);throw new x("RegExp#exec called on incompatible receiver")}},3955:function(t,c,u){"use strict";var h,f,g=u(5817),b=u(8842),v=u(2455),x=u(4045),w=u(9602),_=u(3801),k=u(2957),E=u(5230).get,$=u(7541),T=u(3349),I=_("native-string-replace",String.prototype.replace),M=RegExp.prototype.exec,j=M,D=b("".charAt),F=b("".indexOf),L=b("".replace),B=b("".slice),G=(f=/b*/g,g(M,h=/a/,"a"),g(M,f,"a"),0!==h.lastIndex||0!==f.lastIndex),U=w.BROKEN_CARET,V=void 0!==/()??/.exec("")[1];(G||V||U||$||T)&&(j=function(t){var c,u,h,f,b,w,_,$=E(this),T=v(t),K=$.raw;if(K)return K.lastIndex=this.lastIndex,c=g(j,K,T),this.lastIndex=K.lastIndex,c;var Z=$.groups,Y=U&&this.sticky,X=g(x,this),J=this.source,Q=0,ee=T;if(Y&&(-1===F(X=L(X,"y",""),"g")&&(X+="g"),ee=B(T,this.lastIndex),this.lastIndex>0&&(!this.multiline||this.multiline&&"\n"!==D(T,this.lastIndex-1))&&(J="(?: "+J+")",ee=" "+ee,Q++),u=RegExp("^(?:"+J+")",X)),V&&(u=RegExp("^"+J+"$(?!\\s)",X)),G&&(h=this.lastIndex),f=g(M,Y?u:this,ee),Y?f?(f.input=B(f.input,Q),f[0]=B(f[0],Q),f.index=this.lastIndex,this.lastIndex+=f[0].length):this.lastIndex=0:G&&f&&(this.lastIndex=this.global?f.index+f[0].length:h),V&&f&&f.length>1&&g(I,f[0],u,function(){for(b=1;b<arguments.length-2;b++)void 0===arguments[b]&&(f[b]=void 0)}),f&&Z)for(b=0,f.groups=w=k(null);b<Z.length;b++)w[(_=Z[b])[0]]=f[_[1]];return f}),t.exports=j},4045:function(t,c,u){"use strict";var h=u(1485);t.exports=function(){var t=h(this),c="";return t.hasIndices&&(c+="d"),t.global&&(c+="g"),t.ignoreCase&&(c+="i"),t.multiline&&(c+="m"),t.dotAll&&(c+="s"),t.unicode&&(c+="u"),t.unicodeSets&&(c+="v"),t.sticky&&(c+="y"),c}},290:function(t,c,u){"use strict";var h=u(5817),f=u(9472),g=u(112),b=u(4045),v=RegExp.prototype;t.exports=function(t){var c=t.flags;return!(void 0===c&&!("flags"in v)&&!f(t,"flags")&&g(v,t))?c:h(b,t)}},9602:function(t,c,u){"use strict";var h=u(4256),f=u(7738).RegExp,g=h(function(){var t=f("a","y");return t.lastIndex=2,null!==t.exec("abcd")}),b=g||h(function(){return!f("a","y").sticky}),v=g||h(function(){var t=f("^r","gy");return t.lastIndex=2,null!==t.exec("str")});t.exports={BROKEN_CARET:v,MISSED_STICKY:b,UNSUPPORTED_Y:g}},7541:function(t,c,u){"use strict";var h=u(4256),f=u(7738).RegExp;t.exports=h(function(){var t=f(".","s");return!(t.dotAll&&t.test("\n")&&"s"===t.flags)})},3349:function(t,c,u){"use strict";var h=u(4256),f=u(7738).RegExp;t.exports=h(function(){var t=f("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")})},2924:function(t,c,u){"use strict";var h=u(6617),f=TypeError;t.exports=function(t){if(h(t))throw new f("Can't call method on "+t);return t}},50:function(t,c,u){"use strict";var h=u(3801),f=u(7246),g=h("keys");t.exports=function(t){return g[t]||(g[t]=f(t))}},9145:function(t,c,u){"use strict";var h=u(7738),f=u(2501),g="__core-js_shared__",b=h[g]||f(g,{});t.exports=b},3801:function(t,c,u){"use strict";var h=u(9168),f=u(9145);(t.exports=function(t,c){return f[t]||(f[t]=void 0!==c?c:{})})("versions",[]).push({version:"3.33.2",mode:h?"pure":"global",copyright:"\xa9 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.2/LICENSE",source:"https://github.com/zloirock/core-js"})},2068:function(t,c,u){"use strict";var h=u(8842),f=u(5963),g=u(2455),b=u(2924),v=h("".charAt),x=h("".charCodeAt),w=h("".slice),createMethod=function(t){return function(c,u){var h,_,k=g(b(c)),E=f(u),$=k.length;return E<0||E>=$?t?"":void 0:(h=x(k,E))<55296||h>56319||E+1===$||(_=x(k,E+1))<56320||_>57343?t?v(k,E):h:t?w(k,E,E+2):(h-55296<<10)+(_-56320)+65536}};t.exports={codeAt:createMethod(!1),charAt:createMethod(!0)}},4072:function(t,c,u){"use strict";var h=u(4130),f=u(4256),g=u(7738).String;t.exports=!!Object.getOwnPropertySymbols&&!f(function(){var t=Symbol("symbol detection");return!g(t)||!(Object(t) instanceof Symbol)||!Symbol.sham&&h&&h<41})},76:function(t,c,u){"use strict";var h=u(5963),f=Math.max,g=Math.min;t.exports=function(t,c){var u=h(t);return u<0?f(u+c,0):g(u,c)}},949:function(t,c,u){"use strict";var h=u(3910),f=u(2924);t.exports=function(t){return h(f(t))}},5963:function(t,c,u){"use strict";var h=u(1325);t.exports=function(t){var c=+t;return c!=c||0===c?0:h(c)}},2510:function(t,c,u){"use strict";var h=u(5963),f=Math.min;t.exports=function(t){return t>0?f(h(t),9007199254740991):0}},4405:function(t,c,u){"use strict";var h=u(2924),f=Object;t.exports=function(t){return f(h(t))}},1777:function(t,c,u){"use strict";var h=u(5817),f=u(6695),g=u(5375),b=u(2112),v=u(1823),x=u(1350),w=TypeError,_=x("toPrimitive");t.exports=function(t,c){if(!f(t)||g(t))return t;var u,x=b(t,_);if(x){if(void 0===c&&(c="default"),!f(u=h(x,t,c))||g(u))return u;throw new w("Can't convert object to primitive value")}return void 0===c&&(c="number"),v(t,c)}},7843:function(t,c,u){"use strict";var h=u(1777),f=u(5375);t.exports=function(t){var c=h(t,"string");return f(c)?c:c+""}},8830:function(t,c,u){"use strict";var h=u(1350)("toStringTag"),f={};f[h]="z",t.exports="[object z]"===String(f)},2455:function(t,c,u){"use strict";var h=u(9743),f=String;t.exports=function(t){if("Symbol"===h(t))throw TypeError("Cannot convert a Symbol value to a string");return f(t)}},1747:function(t){"use strict";var c=String;t.exports=function(t){try{return c(t)}catch(t){return"Object"}}},7246:function(t,c,u){"use strict";var h=u(8842),f=0,g=Math.random(),b=h(1..toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+b(++f+g,36)}},327:function(t,c,u){"use strict";var h=u(4072);t.exports=h&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},1887:function(t,c,u){"use strict";var h=u(2534),f=u(4256);t.exports=h&&f(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},9819:function(t,c,u){"use strict";var h=u(7738),f=u(43),g=h.WeakMap;t.exports=f(g)&&/native code/.test(String(g))},1350:function(t,c,u){"use strict";var h=u(7738),f=u(3801),g=u(9472),b=u(7246),v=u(4072),x=u(327),w=h.Symbol,_=f("wks"),k=x?w.for||w:w&&w.withoutSetter||b;t.exports=function(t){return g(_,t)||(_[t]=v&&g(w,t)?w[t]:k("Symbol."+t)),_[t]}},7933:function(t,c,u){"use strict";var h=u(9272),f=u(4405),g=u(4464),b=u(5963),v=u(8609);h({target:"Array",proto:!0},{at:function(t){var c=f(this),u=g(c),h=b(t),v=h>=0?h:u+h;return v<0||v>=u?void 0:c[v]}}),v("at")},7781:function(t,c,u){"use strict";var h=u(9272),f=u(9162),g=u(6284),b=u(4405),v=u(4464),x=u(747);h({target:"Array",proto:!0},{flatMap:function(t){var c,u=b(this),h=v(u);return g(t),(c=x(u,0)).length=f(c,u,u,h,0,1,t,arguments.length>1?arguments[1]:void 0),c}})},3896:function(t,c,u){"use strict";var h=u(9272),f=u(9162),g=u(4405),b=u(4464),v=u(5963),x=u(747);h({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,c=g(this),u=b(c),h=x(c,0);return h.length=f(h,c,c,u,0,void 0===t?1:v(t)),h}})},9328:function(t,c,u){"use strict";u(8609)("flatMap")},1767:function(t,c,u){"use strict";u(8609)("flat")},789:function(t,c,u){"use strict";var h=u(9272),f=u(3955);h({target:"RegExp",proto:!0,forced:/./.exec!==f},{exec:f})},4554:function(t,c,u){"use strict";var h=u(9272),f=u(8842),g=u(2924),b=u(5963),v=u(2455),x=u(4256),w=f("".charAt);h({target:"String",proto:!0,forced:x(function(){return"\uD842"!=="\uD842\uDFB7".at(-2)})},{at:function(t){var c=v(g(this)),u=c.length,h=b(t),f=h>=0?h:u+h;return f<0||f>=u?void 0:w(c,f)}})},3510:function(t,c,u){"use strict";var h=u(9272),f=u(5817),g=u(8842),b=u(2924),v=u(43),x=u(6617),w=u(1059),_=u(2455),k=u(2112),E=u(290),$=u(7175),T=u(1350),I=u(9168),M=T("replace"),j=TypeError,D=g("".indexOf),F=g("".replace),L=g("".slice),B=Math.max,stringIndexOf=function(t,c,u){return u>t.length?-1:""===c?u:D(t,c,u)};h({target:"String",proto:!0},{replaceAll:function(t,c){var u,h,g,T,G,U,V,K,Z=b(this),Y=0,X=0,J="";if(!x(t)){if((u=w(t))&&!~D(_(b(E(t))),"g"))throw new j("`.replaceAll` does not allow non-global regexes");if(h=k(t,M))return f(h,t,Z,c);if(I&&u)return F(_(Z),t,c)}for(g=_(Z),T=_(t),(G=v(c))||(c=_(c)),V=B(1,U=T.length),Y=stringIndexOf(g,T,0);-1!==Y;)K=G?_(c(T,Y,g)):$(T,g,Y,[],void 0,c),J+=L(g,X,Y)+K,X=Y+U,Y=stringIndexOf(g,T,Y+V);return X<g.length&&(J+=L(g,X)),J}})},1490:function(t,c,u){"use strict";var h=u(5815),f=u(5817),g=u(8842),b=u(2571),v=u(4256),x=u(1485),w=u(43),_=u(6617),k=u(5963),E=u(2510),$=u(2455),T=u(2924),I=u(2166),M=u(2112),j=u(7175),D=u(8911),F=u(1350)("replace"),L=Math.max,B=Math.min,G=g([].concat),U=g([].push),V=g("".indexOf),K=g("".slice),Z="$0"==="a".replace(/./,"$0"),Y=!!/./[F]&&""===/./[F]("a","$0");b("replace",function(t,c,u){var g=Y?"$":"$0";return[function(t,u){var h=T(this),g=_(t)?void 0:M(t,F);return g?f(g,t,h,u):f(c,$(h),t,u)},function(t,f){var b=x(this),v=$(t);if("string"==typeof f&&-1===V(f,g)&&-1===V(f,"$<")){var _=u(c,b,v,f);if(_.done)return _.value}var T=w(f);T||(f=$(f));var M=b.global;M&&(Q=b.unicode,b.lastIndex=0);for(var F=[];null!==(ee=D(b,v))&&(U(F,ee),M);)""===$(ee[0])&&(b.lastIndex=I(v,E(b.lastIndex),Q));for(var Z="",Y=0,X=0;X<F.length;X++){for(var J,Q,ee,et,en=$((ee=F[X])[0]),er=L(B(k(ee.index),v.length),0),ei=[],eo=1;eo<ee.length;eo++)U(ei,void 0===(J=ee[eo])?J:String(J));var ea=ee.groups;if(T){var es=G([en],ei,er,v);void 0!==ea&&U(es,ea),et=$(h(f,void 0,es))}else et=j(en,v,er,ei,ea,f);er>=Y&&(Z+=K(v,Y,er)+et,Y=er+en.length)}return Z+K(v,Y)}]},!!v(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})||!Z||Y)},9645:function(t,c,u){"use strict";var h=u(9228);t.exports=h},6930:function(t,c,u){"use strict";var h=u(5134);t.exports=h},4770:function(t,c,u){"use strict";var h=u(1521);t.exports=h},2880:function(t,c,u){"use strict";var h=u(7942);t.exports=h},9304:function(t,c,u){"use strict";var h=u(632);t.exports=h},7295:function(t,c,u){"use strict";u.d(c,{g:function(){return SVGContainer}});var h=u(7437);function SVGContainer({children:t,className:c="",...u}){return(0,h.jsx)("svg",{...u,className:`tl-svg-container ${c}`,children:t})}},5894:function(t,c,u){"use strict";u.d(c,{A6:function(){return E},JM:function(){return getUserPreferences},MO:function(){return getFreshUserPreferences},ks:function(){return $},ng:function(){return userPrefersDarkUI},yu:function(){return setUserPreferences}});var h=u(9957),f=u(932),g=u(6579),b=u(5958),v=u(1034);u(2601);let x="TLDRAW_USER_DATA_v3",w=b.T.object({id:b.T.string,name:b.T.string.nullable().optional(),locale:b.T.string.nullable().optional(),color:b.T.string.nullable().optional(),isDarkMode:b.T.boolean.nullable().optional(),animationSpeed:b.T.number.nullable().optional(),isSnapMode:b.T.boolean.nullable().optional()}),_={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3},k=(0,f.zn)({currentVersion:_.MakeFieldsNullable,migrators:{[_.AddAnimationSpeed]:{up:t=>({...t,animationSpeed:1}),down:({animationSpeed:t,...c})=>c},[_.AddIsSnapMode]:{up:t=>({...t,isSnapMode:!1}),down:({isSnapMode:t,...c})=>c},[_.MakeFieldsNullable]:{up:t=>t,down:t=>({id:t.id,name:t.name??$.name,locale:t.locale??$.locale,color:t.color??$.color,isDarkMode:t.isDarkMode??$.isDarkMode,animationSpeed:t.animationSpeed??$.animationSpeed,isSnapMode:t.isSnapMode??$.isSnapMode})}}}),E=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function getRandomColor(){return E[Math.floor(Math.random()*E.length)]}function userPrefersDarkUI(){return"undefined"!=typeof window&&(window.matchMedia?.("(prefers-color-scheme: dark)")?.matches??!1)}function userPrefersReducedMotion(){return"undefined"!=typeof window&&(window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches??!1)}let $=Object.freeze({name:"New User",locale:(0,g.Bz)(),color:getRandomColor(),isDarkMode:!1,animationSpeed:userPrefersReducedMotion()?0:1,isSnapMode:!1});function getFreshUserPreferences(){return{id:(0,v.E)()}}function migrateUserPreferences(t){if(null===t||"object"!=typeof t||!("version"in t)||!("user"in t)||"number"!=typeof t.version)return getFreshUserPreferences();let c=(0,f.Te)({value:t.user,fromVersion:t.version,toVersion:k.currentVersion??0,migrations:k});if("error"===c.type)return getFreshUserPreferences();try{w.validate(c.value)}catch(t){return getFreshUserPreferences()}return c.value}function loadUserPreferences(){let t="undefined"==typeof window?null:JSON.parse(window?.localStorage?.getItem(x)||"null")??null;return migrateUserPreferences(t)}let T=(0,h.cn)("globalUserData",loadUserPreferences());function storeUserPreferences(){"undefined"!=typeof window&&window.localStorage&&window.localStorage.setItem(x,JSON.stringify({version:k.currentVersion,user:T.value}))}function setUserPreferences(t){w.validate(t),T.set(t),storeUserPreferences(),broadcastUserPreferencesChange()}let I="undefined"==typeof BroadcastChannel?null:new BroadcastChannel("tldraw-user-sync");I?.addEventListener("message",t=>{let c=t.data;c?.type===j&&c?.origin!==M&&T.set(migrateUserPreferences(c.data))});let M=(0,v.E)(),j="tldraw-user-preferences-change";function broadcastUserPreferencesChange(){I?.postMessage({type:j,origin:M,data:{user:T.value,version:k.currentVersion}})}function getUserPreferences(){return T.value}},7217:function(t,c,u){"use strict";u.d(c,{L:function(){return createTLUser}});var h=u(9957),f=u(5894);function createTLUser(t={}){return{derivePresenceState:t.derivePresenceState??(()=>(0,h.Fl)("presence",()=>null)),userPreferences:t.userPreferences??(0,h.Fl)("userPreferences",()=>(0,f.JM)()),setUserPreferences:t.setUserPreferences??f.yu}}},9968:function(t,c,u){"use strict";u.d(c,{m:function(){return checkShapesAndAddCore},u:function(){return f}});var h=u(2772);let f=[h.Q],g=new Set(f.map(t=>t.type));function checkShapesAndAddCore(t){let c=[...f],u=new Set;for(let h of t){if(g.has(h.type))throw Error(`Shape type "${h.type}" is a core shapes type and cannot be overridden`);if(u.has(h.type))throw Error(`Shape type "${h.type}" is defined more than once`);c.push(h),u.add(h.type)}return c}},7655:function(t,c,u){"use strict";u.d(c,{$G:function(){return U},CK:function(){return X},CN:function(){return k},E:function(){return x},Et:function(){return g},KD:function(){return v},MN:function(){return Y},Ns:function(){return T},O8:function(){return Z},Pz:function(){return j},Qd:function(){return $},RH:function(){return I},RZ:function(){return K},Sk:function(){return F},UD:function(){return D},Xy:function(){return G},Zj:function(){return w},aR:function(){return Q},dW:function(){return V},iF:function(){return B},kx:function(){return f},qV:function(){return M},sZ:function(){return _},s_:function(){return L},uJ:function(){return b},wM:function(){return ee},wi:function(){return E},yV:function(){return J}});var h=u(1986);let f=2e3,g=40,b=80,v=320,x=[.1,.25,.5,1,2,4,8],w=.1,_=8,k=.5,E=.1,$=.2,T=.005,I=.05,M=450,j=200,D=6,F=4,L=32,B={};for(let t=1;t<=Math.ceil(_);t++)B[t+"_dark"]=`hash_pattern_zoom_${t}_dark`,B[t+"_light"]=`hash_pattern_zoom_${t}_light`;let G={duration:0,easing:h.L.easeInOutCubic},U=.09,V=[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],K=6e4,Z=3e3,Y=1200,X={CAMERA_MOVE:-10},J=64,Q=620,ee=8},6912:function(t,c,u){"use strict";u.d(c,{w:function(){return arrowBindingsIndex}});var h=u(9957);let arrowBindingsIndex=t=>{let{store:c}=t,u=c.query.filterHistory("shape"),f=c.query.records("shape",()=>({type:{eq:"arrow"}}));function fromScratch(){let t=f.value,c={};for(let u of t){let{start:t,end:h}=u.props;if("binding"===t.type){let h=c[t.boundShapeId];h?h.push({arrowId:u.id,handleId:"start"}):c[t.boundShapeId]=[{arrowId:u.id,handleId:"start"}]}if("binding"===h.type){let t=c[h.boundShapeId];t?t.push({arrowId:u.id,handleId:"end"}):c[h.boundShapeId]=[{arrowId:u.id,handleId:"end"}]}}return c}return(0,h.Fl)("arrowBindingsIndex",(c,f)=>{let g;if((0,h.e1)(c))return fromScratch();let b=u.getDiffSince(f);if(b===h.SB)return fromScratch();function ensureNewArray(t){g||(g={...c}),g[t]?g[t]===c[t]&&(g[t]=[...g[t]]):g[t]=[]}function removingBinding(t,c,u){ensureNewArray(t),g[t]=g[t].filter(t=>t.arrowId!==c||t.handleId!==u),0===g[t].length&&delete g[t]}function addBinding(t,c,u){ensureNewArray(t),g[t].push({arrowId:c,handleId:u})}for(let c of b){for(let u of Object.values(c.added))if(t.isShapeOfType(u,"arrow")){let{start:t,end:c}=u.props;"binding"===t.type&&addBinding(t.boundShapeId,u.id,"start"),"binding"===c.type&&addBinding(c.boundShapeId,u.id,"end")}for(let[u,h]of Object.values(c.updated))if(t.isShapeOfType(u,"arrow")&&t.isShapeOfType(h,"arrow"))for(let t of["start","end"]){let c=u.props[t],f=h.props[t];"binding"===c.type&&"point"===f.type?removingBinding(c.boundShapeId,u.id,t):"point"===c.type&&"binding"===f.type?addBinding(f.boundShapeId,h.id,t):"binding"===c.type&&"binding"===f.type&&c.boundShapeId!==f.boundShapeId&&(removingBinding(c.boundShapeId,u.id,t),addBinding(f.boundShapeId,h.id,t))}for(let u of Object.values(c.removed))if(t.isShapeOfType(u,"arrow")){let{start:t,end:c}=u.props;"binding"===t.type&&removingBinding(t.boundShapeId,u.id,"start"),"binding"===c.type&&removingBinding(c.boundShapeId,u.id,"end")}}return g??c})}},9078:function(t,c,u){"use strict";u.d(c,{s:function(){return parentsToChildren}});var h=u(9957),f=u(6579),g=u(7110),b=u(4078);let parentsToChildren=t=>{let c=t.query.ids("shape");function fromScratch(){let u={},h=c.value,f=Array(h.size);return h.forEach(c=>f.push(t.get(c))),f.sort(b.hl),f.forEach(t=>{u[t.parentId]||(u[t.parentId]=[]),u[t.parentId].push(t.id)}),u}return(0,h.Fl)("parentsToChildrenWithIndexes",(c,u)=>{let v;if((0,h.e1)(c))return fromScratch();let x=t.history.getDiffSince(u);if(x===h.SB)return fromScratch();if(0===x.length)return c;let w=null,ensureNewArray=t=>{w||(w={...c}),w[t]?w[t]===c[t]&&(w[t]=[...w[t]]):w[t]=[]},_=new Set;for(let t=0,c=x.length;t<c;t++){for(let c of Object.values((v=x[t]).added))(0,f.VV)(c)&&(ensureNewArray(c.parentId),w[c.parentId].push(c.id),_.add(w[c.parentId]));for(let[t,c]of Object.values(v.updated))if((0,f.VV)(c)&&(0,f.VV)(t)){if(t.parentId!==c.parentId)ensureNewArray(t.parentId),ensureNewArray(c.parentId),w[t.parentId].splice(w[t.parentId].indexOf(c.id),1),w[c.parentId].push(c.id),_.add(w[c.parentId]);else if(t.index!==c.index){ensureNewArray(c.parentId);let t=w[c.parentId].indexOf(c.id);w[c.parentId][t]=c.id,_.add(w[c.parentId])}}for(let t of Object.values(v.removed))(0,f.VV)(t)&&(ensureNewArray(t.parentId),w[t.parentId].splice(w[t.parentId].indexOf(t.id),1))}for(let c of _){let u=(0,g.oA)(c.map(c=>t.get(c)));u.sort(b.hl),c.splice(0,c.length,...u.map(t=>t.id))}return w??c})}},4211:function(t,c,u){"use strict";u.d(c,{Q:function(){return deriveShapeIdsInCurrentPage}});var h=u(9957),f=u(932),g=u(6579);let isShapeInPage=(t,c,u)=>{for(;!(0,g.r5)(u.parentId);){let c=t.get(u.parentId);if(!c)return!1;u=c}return u.parentId===c},deriveShapeIdsInCurrentPage=(t,c)=>{let u=t.query.ids("shape"),b=null;function fromScratch(){let h=c();return b=h,new Set([...u.value].filter(c=>isShapeInPage(t,h,t.get(c))))}return(0,h.Fl)("_shapeIdsInCurrentPage",(u,v)=>{if((0,h.e1)(u))return fromScratch();let x=c();if(x!==b)return fromScratch();let w=t.history.getDiffSince(v);if(w===h.SB)return fromScratch();let _=new f.mW(u);for(let c of w){for(let u of Object.values(c.added))(0,g.VV)(u)&&isShapeInPage(t,x,u)&&_.add(u.id);for(let[u,h]of Object.values(c.updated))(0,g.VV)(h)&&(isShapeInPage(t,x,h)?_.add(h.id):_.remove(h.id));for(let t of Object.keys(c.removed))(0,g.YT)(t)&&_.remove(t)}let k=_.get();return k?(0,h.qo)(k.value,k.diff):u})}},829:function(t,c,u){"use strict";u.d(c,{o:function(){return ClickManager}});var h=u(7655),f=u(6799),g=u(1034);let ClickManager=class ClickManager{constructor(t){this.editor=t}_clickId="";_clickTimeout;_clickScreenPoint;_previousScreenPoint;_getClickTimeout=(t,c=(0,g.E)())=>{this._clickId=c,clearTimeout(this._clickTimeout),this._clickTimeout=setTimeout(()=>{if(this._clickState===t&&this._clickId===c){switch(this._clickState){case"pendingTriple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break;case"pendingQuadruple":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break;case"pendingOverflow":this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"})}this._clickState="idle"}},"idle"===t||"pendingDouble"===t?h.qV:h.Pz)};_clickState="idle";get clickState(){return this._clickState}lastPointerInfo={};transformPointerDownEvent=t=>{if(!this._clickState)return t;switch(this._clickScreenPoint=f.G.From(t.point),this._previousScreenPoint&&this._previousScreenPoint.dist(this._clickScreenPoint)>40&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=t,this._clickState){case"idle":return this._clickState="pendingDouble",this._clickTimeout=this._getClickTimeout(this._clickState),t;case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...t,type:"click",name:"quadruple_click",phase:"down"};case"pendingOverflow":return this._clickState="overflow",this._clickTimeout=this._getClickTimeout(this._clickState),t;default:return this._clickTimeout=this._getClickTimeout(this._clickState),t}};transformPointerUpEvent=t=>{if(!this._clickState)return t;switch(this._clickScreenPoint=f.G.From(t.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"};default:return t}};cancelDoubleClickTimeout=()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"};handleMove=()=>{"idle"!==this._clickState&&this._clickScreenPoint&&this._clickScreenPoint.dist(this.editor.inputs.currentScreenPoint)>(this.editor.instanceState.isCoarsePointer?h.UD:h.Sk)&&this.cancelDoubleClickTimeout()}}},106:function(t,c,u){"use strict";u.d(c,{l:function(){return EnvironmentManager}});let EnvironmentManager=class EnvironmentManager{constructor(t){this.editor=t,"undefined"!=typeof window&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}isSafari;isIos;isChromeForIos;isFirefox;isAndroid}},7055:function(t,c,u){"use strict";u.d(c,{E:function(){return HistoryManager}});var h=u(9957),f=u(932),g=u(1034);function stack(t){if(t){let c=b;for(;t.length;)c=c.push(t.pop());return c}return b}let EmptyStackItem=class EmptyStackItem{length=0;head=null;tail=this;push(t){return new StackItem(t,this)}toArray(){return h.LZ}[Symbol.iterator](){return{next:()=>({value:void 0,done:!0})}}};let b=new EmptyStackItem;let StackItem=class StackItem{constructor(t,c){this.head=t,this.tail=c,this.length=c.length+1}length;push(t){return new StackItem(t,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let t=this;return{next(){if(!t.length)return{value:void 0,done:!0};{let c=t.head;return t=t.tail,{value:c,done:!1}}}}}};let HistoryManager=class HistoryManager{constructor(t,c){this.ctx=t,this.annotateError=c}_undos=(0,h.cn)("HistoryManager.undos",stack());_redos=(0,h.cn)("HistoryManager.redos",stack());_batchDepth=0;onBatchComplete=()=>void 0;_commands={};get numUndos(){return this._undos.value.length}get numRedos(){return this._redos.value.length}createCommand=(t,c,u)=>{if(this._commands[t])throw Error(`Duplicate command: ${t}`);this._commands[t]=u;let exec=(...h)=>{if(!this._batchDepth)return this.batch(()=>exec(...h)),this.ctx;let b=c(...h);if(!b)return this.ctx;let{data:v,ephemeral:x,squashing:w,preservesRedoStack:_}=b;if(this.ignoringUpdates((t,c)=>(u.do(v),{undos:t,redos:c})),!x){let c=this._undos.value.head;w&&c&&"command"===c.type&&c.name===t&&c.preservesRedoStack===_?this._undos.update(t=>t.tail.push({...c,id:(0,g.E)(),data:(0,f.ZV)(u.squash(c.data,v))})):this._undos.update(c=>c.push({type:"command",name:t,data:(0,f.ZV)(v),id:(0,g.E)(),preservesRedoStack:_})),b.preservesRedoStack||this._redos.set(stack()),this.ctx.emit("change-history",{reason:"push"})}return this.ctx};return exec};batch=t=>{try{this._batchDepth++,1===this._batchDepth?(0,h.ay)(()=>{let c=this._undos.value.head?.id;t(),c!==this._undos.value.head?.id&&this.onBatchComplete()}):t()}catch(t){throw this.annotateError(t),t}finally{this._batchDepth--}return this};ignoringUpdates=t=>{let c=this._undos.value,u=this._redos.value;this._undos.set(stack()),this._redos.set(stack());try{({undos:c,redos:u}=(0,h.ay)(()=>t(c,u)))}finally{this._undos.set(c),this._redos.set(u)}};_undo=({pushToRedoStack:t,toMark:c})=>(this.ignoringUpdates((u,h)=>{if(0===u.length)return{undos:u,redos:h};for(;u.head?.type==="STOP";){let f=u.head;if(u=u.tail,t&&(h=h.push(f)),f.id===c)return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:c}),{undos:u,redos:h}}if(0===u.length)return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:c}),{undos:u,redos:h};for(;u.head;){let f=u.head;if(u=u.tail,t&&(h=h.push(f)),"STOP"===f.type){if(f.onUndo&&(!c||f.id===c))break}else{let t=this._commands[f.name];t.undo(f.data)}}return this.ctx.emit("change-history",t?{reason:"undo"}:{reason:"bail",markId:c}),{undos:u,redos:h}}),this);undo=()=>(this._undo({pushToRedoStack:!0}),this);redo=()=>(this.ignoringUpdates((t,c)=>{if(0===c.length)return{undos:t,redos:c};for(;c.head?.type==="STOP";)t=t.push(c.head),c=c.tail;if(0===c.length)return this.ctx.emit("change-history",{reason:"redo"}),{undos:t,redos:c};for(;c.head;){let u=c.head;if(t=t.push(c.head),c=c.tail,"STOP"===u.type){if(u.onRedo)break}else{let t=this._commands[u.name];t.redo?t.redo(u.data):t.do(u.data)}}return this.ctx.emit("change-history",{reason:"redo"}),{undos:t,redos:c}}),this);bail=()=>(this._undo({pushToRedoStack:!1}),this);bailToMark=t=>(this._undo({pushToRedoStack:!1,toMark:t}),this);mark=(t=(0,g.E)(),c=!0,u=!0)=>{let h=this._undos.value.head;return h&&"STOP"===h.type&&h.id===t&&h.onUndo===c&&h.onRedo===u?h.id:(this._undos.update(h=>h.push({type:"STOP",id:t,onUndo:c,onRedo:u})),this.ctx.emit("mark-history",{id:t}),t)};clear(){this._undos.set(stack()),this._redos.set(stack())}}},5084:function(t,c,u){"use strict";u.d(c,{Y:function(){return SideEffectManager}});let SideEffectManager=class SideEffectManager{constructor(t){this.editor=t,t.store.onBeforeCreate=(t,c)=>{let u=this._beforeCreateHandlers[t.typeName];if(u){let h=t;for(let t of u)h=t(h,c);return h}return t},t.store.onAfterCreate=(t,c)=>{let u=this._afterCreateHandlers[t.typeName];if(u)for(let h of u)h(t,c)},t.store.onBeforeChange=(t,c,u)=>{let h=this._beforeChangeHandlers[c.typeName];if(h){let f=c;for(let c of h)f=c(t,f,u);return f}return c};let c=0;t.store.onAfterChange=(t,u,h)=>{if(++c>1e3)console.error("[CleanupManager.onAfterChange] Maximum update depth exceeded, bailing out.");else{let c=this._afterChangeHandlers[u.typeName];if(c)for(let f of c)f(t,u,h)}c--},t.store.onBeforeDelete=(t,c)=>{let u=this._beforeDeleteHandlers[t.typeName];if(u){for(let h of u)if(!1===h(t,c))return!1}},t.store.onAfterDelete=(t,c)=>{let u=this._afterDeleteHandlers[t.typeName];if(u)for(let h of u)h(t,c)},t.history.onBatchComplete=()=>{this._batchCompleteHandlers.forEach(t=>t())}}_beforeCreateHandlers={};_afterCreateHandlers={};_beforeChangeHandlers={};_afterChangeHandlers={};_beforeDeleteHandlers={};_afterDeleteHandlers={};_batchCompleteHandlers=[];registerBeforeCreateHandler(t,c){let u=this._beforeCreateHandlers[t];return u||(this._beforeCreateHandlers[t]=[]),this._beforeCreateHandlers[t].push(c),()=>remove(this._beforeCreateHandlers[t],c)}registerAfterCreateHandler(t,c){let u=this._afterCreateHandlers[t];return u||(this._afterCreateHandlers[t]=[]),this._afterCreateHandlers[t].push(c),()=>remove(this._afterCreateHandlers[t],c)}registerBeforeChangeHandler(t,c){let u=this._beforeChangeHandlers[t];return u||(this._beforeChangeHandlers[t]=[]),this._beforeChangeHandlers[t].push(c),()=>remove(this._beforeChangeHandlers[t],c)}registerAfterChangeHandler(t,c){let u=this._afterChangeHandlers[t];return u||(this._afterChangeHandlers[t]=[]),this._afterChangeHandlers[t].push(c),()=>remove(this._afterChangeHandlers[t],c)}registerBeforeDeleteHandler(t,c){let u=this._beforeDeleteHandlers[t];return u||(this._beforeDeleteHandlers[t]=[]),this._beforeDeleteHandlers[t].push(c),()=>remove(this._beforeDeleteHandlers[t],c)}registerAfterDeleteHandler(t,c){let u=this._afterDeleteHandlers[t];return u||(this._afterDeleteHandlers[t]=[]),this._afterDeleteHandlers[t].push(c),()=>remove(this._afterDeleteHandlers[t],c)}registerBatchCompleteHandler(t){return this._batchCompleteHandlers.push(t),()=>remove(this._batchCompleteHandlers,t)}};function remove(t,c){let u=t.indexOf(c);u>=0&&t.splice(u,1)}},2278:function(t,c,u){"use strict";u.d(c,{f:function(){return SnapManager}});var h=u(9957),f=u(7110),g=u(9303),b=u(498),v=u(6166),x=u(6799),w=u(1034),_=Object.defineProperty,k=Object.getOwnPropertyDescriptor,__decorateClass=(t,c,u,h)=>{for(var f,g=h>1?void 0:h?k(c,u):c,b=t.length-1;b>=0;b--)(f=t[b])&&(g=(h?f(c,u,g):f(g))||g);return h&&g&&_(c,u,g),g};let round=t=>Math.round(1e8*t)/1e8;function findAdjacentGaps(t,c,u,h,f){let g=t.filter(t=>("forward"===h?t.startNode.id===c:t.endNode.id===c)&&round(t.length)===round(u)&&(0,v.mW)(t.breadthIntersection[0],t.breadthIntersection[1],f[0],f[1]));if(0===g.length)return[];let b=new Set;return g.forEach(c=>{let x="forward"===h?c.endNode.id:c.startNode.id;if(!b.has(x)){b.add(x);let w=findAdjacentGaps(t,x,u,h,(0,v.mW)(c.breadthIntersection[0],c.breadthIntersection[1],f[0],f[1]));g.push(...w)}}),g}function dedupeGapSnaps(t){t.sort((t,c)=>c.gaps.length-t.gaps.length);for(let c=t.length-1;c>0;c--){let u=t[c];for(let h=c-1;h>=0;h--){let f=t[h];if(f.direction===u.direction&&u.gaps.every(t=>f.gaps.some(c=>round(t.startEdge[0].x)===round(c.startEdge[0].x)&&round(t.startEdge[0].y)===round(c.startEdge[0].y)&&round(t.startEdge[1].x)===round(c.startEdge[1].x)&&round(t.startEdge[1].y)===round(c.startEdge[1].y))&&f.gaps.some(c=>round(t.endEdge[0].x)===round(c.endEdge[0].x)&&round(t.endEdge[0].y)===round(c.endEdge[0].y)&&round(t.endEdge[1].x)===round(c.endEdge[1].x)&&round(t.endEdge[1].y)===round(c.endEdge[1].y)))){t.splice(c,1);break}}}}let SnapManager=class SnapManager{constructor(t){this.editor=t}_snapLines=(0,h.cn)("snapLines",void 0);get lines(){return this._snapLines.value??h.LZ}clear(){this.lines.length&&this._snapLines.set(void 0)}setLines(t){this._snapLines.set(t)}get snapPointsCache(){let{editor:t}=this;return t.store.createComputedCache("snapPoints",c=>{let u=t.getShapePageTransform(c.id);if(!u)return;let h=this.editor.getShapeGeometry(c).snapPoints;return h.map((t,h)=>{let{x:f,y:g}=b.y.applyToPoint(u,t);return{x:f,y:g,id:`${c.id}:${h}`}})})}get snapThreshold(){return 8/this.editor.zoomLevel}get snappableShapes(){let{editor:t}=this,{selectedShapeIds:c,renderingBounds:u}=t,h=[],collectSnappableShapesFromParent=f=>{let g=t.getSortedChildIdsForParent(f);for(let f of g){if(c.includes(f))continue;let g=t.getShape(f);if(!g)continue;let b=t.getShapeUtil(g);if(!b.canSnap(g))continue;let v=t.getShapePageBounds(f);if(v&&u.includes(v)){if(t.isShapeOfType(g,"group")){collectSnappableShapesFromParent(f);continue}h.push({id:f,pageBounds:v,isClosed:t.getShapeGeometry(g).isClosed})}}};return collectSnappableShapesFromParent(this.currentCommonAncestor??t.currentPageId),h}get currentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.selectedShapes)}get snappablePoints(){let{snappableShapes:t,snapPointsCache:c}=this,u=[];return t.forEach(t=>{let h=c.get(t.id);h&&u.push(...h)}),u}get visibleGaps(){let t,c;let u=[],h=[],f=this.snappableShapes.sort((t,c)=>t.pageBounds.minX-c.pageBounds.minX);for(let h=0;h<f.length;h++){t=f[h];for(let g=h+1;g<f.length;g++)c=f[g],t.pageBounds.maxX<c.pageBounds.minX&&(0,v.ep)(t.pageBounds.minY,t.pageBounds.maxY,c.pageBounds.minY,c.pageBounds.maxY)&&u.push({startNode:t,endNode:c,startEdge:[new x.G(t.pageBounds.maxX,t.pageBounds.minY),new x.G(t.pageBounds.maxX,t.pageBounds.maxY)],endEdge:[new x.G(c.pageBounds.minX,c.pageBounds.minY),new x.G(c.pageBounds.minX,c.pageBounds.maxY)],length:c.pageBounds.minX-t.pageBounds.maxX,breadthIntersection:(0,v.mW)(t.pageBounds.minY,t.pageBounds.maxY,c.pageBounds.minY,c.pageBounds.maxY)})}let g=f.sort((t,c)=>t.pageBounds.minY-c.pageBounds.minY);for(let u=0;u<g.length;u++){t=g[u];for(let f=u+1;f<g.length;f++)c=g[f],t.pageBounds.maxY<c.pageBounds.minY&&(0,v.ep)(t.pageBounds.minX,t.pageBounds.maxX,c.pageBounds.minX,c.pageBounds.maxX)&&h.push({startNode:t,endNode:c,startEdge:[new x.G(t.pageBounds.minX,t.pageBounds.maxY),new x.G(t.pageBounds.maxX,t.pageBounds.maxY)],endEdge:[new x.G(c.pageBounds.minX,c.pageBounds.minY),new x.G(c.pageBounds.maxX,c.pageBounds.minY)],length:c.pageBounds.minY-t.pageBounds.maxY,breadthIntersection:(0,v.mW)(t.pageBounds.minX,t.pageBounds.maxX,c.pageBounds.minX,c.pageBounds.maxX)})}return{horizontal:u,vertical:h}}snapTranslate({lockedAxis:t,initialSelectionPageBounds:c,initialSelectionSnapPoints:u,dragDelta:h}){let{snappablePoints:f,snapThreshold:g}=this,b=c.clone().translate(h),v=u.map(({x:t,y:c},u)=>({id:"selection:"+u,x:t+h.x,y:c+h.y})),w=[],_=[],k=new x.G(g,g);this.collectPointSnaps({minOffset:k,nearestSnapsX:w,nearestSnapsY:_,otherNodeSnapPoints:f,selectionSnapPoints:v}),this.collectGapSnaps({selectionPageBounds:b,nearestSnapsX:w,nearestSnapsY:_,minOffset:k});let E=new x.G("x"===t?0:w[0]?.nudge??0,"y"===t?0:_[0]?.nudge??0);k.x=0,k.y=0,w.length=0,_.length=0,v.forEach(t=>{t.x+=E.x,t.y+=E.y}),b.translate(E),this.collectPointSnaps({minOffset:k,nearestSnapsX:w,nearestSnapsY:_,otherNodeSnapPoints:f,selectionSnapPoints:v}),this.collectGapSnaps({selectionPageBounds:b,nearestSnapsX:w,nearestSnapsY:_,minOffset:k});let $=this.getPointSnapLines({nearestSnapsX:w,nearestSnapsY:_}),T=this.getGapSnapLines({selectionPageBounds:b,nearestSnapsX:w,nearestSnapsY:_});return this._snapLines.set([...T,...$]),{nudge:E}}get outlinesInPageSpace(){return this.snappableShapes.map(({id:t,isClosed:c})=>{let u=(0,f.p$)(this.editor.getShapeGeometry(t).vertices);c&&u.push(u[0]);let h=this.editor.getShapePageTransform(t);if(!h)throw Error("No page transform");return b.y.applyToPoints(h,u)})}getSnappingHandleDelta({handlePoint:t,additionalSegments:c}){let u,h,f,g;let{outlinesInPageSpace:b,snapThreshold:v}=this,_=v,k=null,E=[...b,...c];for(let c of E)for(let b=0;b<c.length-1;b++)u=c[b],h=c[b+1],f=x.G.NearestPointOnLineSegment(u,h,t),!isNaN(g=x.G.Dist(t,f))&&g<_&&(_=g,k=f);return k?(this._snapLines.set([{id:(0,w.E)(),type:"points",points:[k]}]),x.G.Sub(k,t)):null}snapResize({initialSelectionPageBounds:t,dragDelta:c,handle:u,isAspectRatioLocked:h,isResizingFromCenter:f}){let{snapThreshold:b}=this,{box:v,scaleX:w,scaleY:_}=g.No.Resize(t,u,f?2*c.x:c.x,f?2*c.y:c.y,h),k=u;w<0&&(k=(0,g.Ee)(k)),_<0&&(k=(0,g.Op)(k)),f&&(v.center=t.center);let E="top"===k||"bottom"===k,$="left"===k||"right"===k,T=getResizeSnapPointsForHandle(k,v),I=this.snappablePoints,M=[],j=[],D=new x.G(b,b);this.collectPointSnaps({minOffset:D,nearestSnapsX:M,nearestSnapsY:j,otherNodeSnapPoints:I,selectionSnapPoints:T});let F=new x.G(E?0:M[0]?.nudge??0,$?0:j[0]?.nudge??0);if(h&&(0,g.m3)(k)&&0!==F.len()){let c=M.length&&j.length?Math.abs(F.x)<Math.abs(F.y)?"x":"y":M.length?"x":"y",u=t.aspectRatio;"x"===c?(j.length=0,F.y=F.x/u,("bottom_left"===k||"top_right"===k)&&(F.y=-F.y)):(M.length=0,F.x=F.y*u,("bottom_left"===k||"top_right"===k)&&(F.x=-F.x))}let L=x.G.Add(c,F),{box:B}=g.No.Resize(t,u,f?2*L.x:L.x,f?2*L.y:L.y,h);f&&(B.center=t.center);let G=getResizeSnapPointsForHandle("any",B);M.length=0,j.length=0,D.x=0,D.y=0,this.collectPointSnaps({minOffset:D,nearestSnapsX:M,nearestSnapsY:j,otherNodeSnapPoints:I,selectionSnapPoints:G});let U=this.getPointSnapLines({nearestSnapsX:M,nearestSnapsY:j});return this._snapLines.set([...U]),{nudge:F}}collectPointSnaps({selectionSnapPoints:t,otherNodeSnapPoints:c,minOffset:u,nearestSnapsX:h,nearestSnapsY:f}){for(let g of t)for(let t of c){let c=x.G.Sub(g,t),b=Math.abs(c.x),v=Math.abs(c.y);round(b)<=round(u.x)&&(round(b)<round(u.x)&&(h.length=0),h.push({type:"points",points:{thisPoint:g,otherPoint:t},nudge:t.x-g.x}),u.x=b),round(v)<=round(u.y)&&(round(v)<round(u.y)&&(f.length=0),f.push({type:"points",points:{thisPoint:g,otherPoint:t},nudge:t.y-g.y}),u.y=v)}}collectGapSnaps({selectionPageBounds:t,minOffset:c,nearestSnapsX:u,nearestSnapsY:h}){let{horizontal:f,vertical:g}=this.visibleGaps;for(let h of f){if(!(0,v.ep)(h.breadthIntersection[0],h.breadthIntersection[1],t.minY,t.maxY))continue;let f=h.startEdge[0].x+h.length/2,g=f-t.center.x,b=h.length>t.width;if(b&&round(Math.abs(g))<=round(c.x)){round(Math.abs(g))<round(c.x)&&(u.length=0),c.x=Math.abs(g);let t={type:"gap_center",gap:h,nudge:g},f=u.find(({type:t})=>"gap_center"===t),b=f&&(0,v.mW)(h.breadthIntersection[0],h.breadthIntersection[1],f.gap.breadthIntersection[0],f.gap.breadthIntersection[1]);f&&f.gap.length>h.length&&b?u[u.indexOf(f)]=t:f&&b||u.push(t)}let x=h.startNode.pageBounds.minX-h.length,w=t.maxX,_=x-w;round(Math.abs(_))<=round(c.x)&&(round(Math.abs(_))<round(c.x)&&(u.length=0),c.x=Math.abs(_),u.push({type:"gap_duplicate",gap:h,protrusionDirection:"left",nudge:_}));let k=h.endNode.pageBounds.maxX+h.length,E=t.minX,$=k-E;round(Math.abs($))<=round(c.x)&&(round(Math.abs($))<round(c.x)&&(u.length=0),c.x=Math.abs($),u.push({type:"gap_duplicate",gap:h,protrusionDirection:"right",nudge:$}))}for(let u of g){if(!(0,v.ep)(u.breadthIntersection[0],u.breadthIntersection[1],t.minX,t.maxX))continue;let f=u.startEdge[0].y+u.length/2,g=f-t.center.y,b=u.length>t.height;if(b&&round(Math.abs(g))<=round(c.y)){round(Math.abs(g))<round(c.y)&&(h.length=0),c.y=Math.abs(g);let t={type:"gap_center",gap:u,nudge:g},f=h.find(({type:t})=>"gap_center"===t),b=f&&(0,v.ep)(f.gap.breadthIntersection[0],f.gap.breadthIntersection[1],u.breadthIntersection[0],u.breadthIntersection[1]);f&&f.gap.length>u.length&&b?h[h.indexOf(f)]=t:f&&b||h.push(t);continue}let x=u.startNode.pageBounds.minY-u.length,w=t.maxY,_=x-w;round(Math.abs(_))<=round(c.y)&&(round(Math.abs(_))<round(c.y)&&(h.length=0),c.y=Math.abs(_),h.push({type:"gap_duplicate",gap:u,protrusionDirection:"top",nudge:_}));let k=u.endNode.pageBounds.maxY+u.length,E=t.minY,$=k-E;round(Math.abs($))<=round(c.y)&&(round(Math.abs($))<round(c.y)&&(h.length=0),c.y=Math.abs($),h.push({type:"gap_duplicate",gap:u,protrusionDirection:"bottom",nudge:$}))}}getPointSnapLines({nearestSnapsX:t,nearestSnapsY:c}){let u={},h={};if(t.length>0){for(let c of t)if("points"===c.type){let t=round(c.points.otherPoint.x);u[t]||(u[t]=[]),u[t].push(c.points)}}if(c.length>0){for(let t of c)if("points"===t.type){let c=round(t.points.otherPoint.y);h[c]||(h[c]=[]),h[c].push(t.points)}}return Object.values(u).concat(Object.values(h)).map(t=>({id:(0,w.E)(),type:"points",points:(0,f.D8)(t.map(t=>x.G.From(t.otherPoint)).concat(t.map(t=>x.G.From(t.thisPoint))),(t,c)=>t.equals(c))}))}getGapSnapLines({selectionPageBounds:t,nearestSnapsX:c,nearestSnapsY:u}){let{vertical:h,horizontal:f}=this.visibleGaps,g={top:t.sides[0],right:t.sides[1],bottom:[t.corners[3],t.corners[2]],left:[t.corners[0],t.corners[3]]},b=[];if(c.length>0)for(let u of c){if("points"===u.type)continue;let{gap:{breadthIntersection:c,startEdge:h,startNode:x,endNode:_,length:k,endEdge:E}}=u;switch(u.type){case"gap_center":{let u=(k-t.width)/2,$=(0,v.mW)(c[0],c[1],t.minY,t.maxY);b.push({type:"gaps",direction:"horizontal",id:(0,w.E)(),gaps:[...findAdjacentGaps(f,x.id,u,"backward",$),{startEdge:h,endEdge:g.left},{startEdge:g.right,endEdge:E},...findAdjacentGaps(f,_.id,u,"forward",$)]});break}case"gap_duplicate":{let $=(0,v.mW)(c[0],c[1],t.minY,t.maxY);b.push({type:"gaps",direction:"horizontal",id:(0,w.E)(),gaps:"left"===u.protrusionDirection?[{startEdge:g.right,endEdge:h.map(t=>t.clone().addXY(-x.pageBounds.width,0))},{startEdge:h,endEdge:E},...findAdjacentGaps(f,_.id,k,"forward",$)]:[...findAdjacentGaps(f,x.id,k,"backward",$),{startEdge:h,endEdge:E},{startEdge:E.map(t=>t.clone().addXY(u.gap.endNode.pageBounds.width,0)),endEdge:g.left}]})}}}if(u.length>0)for(let c of u){if("points"===c.type)continue;let{gap:{breadthIntersection:u,startEdge:f,startNode:x,endNode:_,length:k,endEdge:E}}=c;switch(c.type){case"gap_center":{let _=(k-t.height)/2,$=(0,v.mW)(u[0],u[1],t.minX,t.maxX);b.push({type:"gaps",direction:"vertical",id:(0,w.E)(),gaps:[...findAdjacentGaps(h,x.id,_,"backward",$),{startEdge:f,endEdge:g.top},{startEdge:g.bottom,endEdge:E},...findAdjacentGaps(h,c.gap.endNode.id,_,"forward",$)]});break}case"gap_duplicate":{let $=(0,v.mW)(u[0],u[1],t.minX,t.maxX);b.push({type:"gaps",direction:"vertical",id:(0,w.E)(),gaps:"top"===c.protrusionDirection?[{startEdge:g.bottom,endEdge:f.map(t=>t.clone().addXY(0,-x.pageBounds.height))},{startEdge:f,endEdge:E},...findAdjacentGaps(h,_.id,k,"forward",$)]:[...findAdjacentGaps(h,x.id,k,"backward",$),{startEdge:f,endEdge:E},{startEdge:E.map(t=>t.clone().addXY(0,_.pageBounds.height)),endEdge:g.top}]})}}}return dedupeGapSnaps(b),b}};function getResizeSnapPointsForHandle(t,c){let{minX:u,maxX:h,minY:f,maxY:g}=c,b=[];switch(t){case"top":case"left":case"top_left":case"any":b.push({id:"top_left",handle:"top_left",x:u,y:f})}switch(t){case"top":case"right":case"top_right":case"any":b.push({id:"top_right",handle:"top_right",x:h,y:f})}switch(t){case"bottom":case"right":case"bottom_right":case"any":b.push({id:"bottom_right",handle:"bottom_right",x:h,y:g})}switch(t){case"bottom":case"left":case"bottom_left":case"any":b.push({id:"bottom_left",handle:"bottom_left",x:u,y:g})}return b}__decorateClass([h.Fl],SnapManager.prototype,"snapPointsCache",1),__decorateClass([h.Fl],SnapManager.prototype,"snapThreshold",1),__decorateClass([h.Fl],SnapManager.prototype,"snappableShapes",1),__decorateClass([h.Fl],SnapManager.prototype,"currentCommonAncestor",1),__decorateClass([h.Fl],SnapManager.prototype,"snappablePoints",1),__decorateClass([h.Fl],SnapManager.prototype,"visibleGaps",1),__decorateClass([h.Fl],SnapManager.prototype,"outlinesInPageSpace",1)},3197:function(t,c,u){"use strict";u.d(c,{R:function(){return TextManager}});var h=u(1034);let f=/\r?\n|\r/g;function normalizeTextForDom(t){return t.replace(f,"\n").split("\n").map(t=>t||" ").join("\n")}let g={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},b=/\s/;let TextManager=class TextManager{constructor(t){this.editor=t}getTextElement(){let t=document.querySelector(".tl-text-measure");t?.remove();let c=document.createElement("div");return this.editor.getContainer().appendChild(c),c.id=`__textMeasure_${(0,h.E)()}`,c.classList.add("tl-text"),c.classList.add("tl-text-measure"),c.tabIndex=-1,c}measureText=(t,c)=>{let u=this.getTextElement();u.setAttribute("dir","ltr"),u.style.setProperty("font-family",c.fontFamily),u.style.setProperty("font-style",c.fontStyle),u.style.setProperty("font-weight",c.fontWeight),u.style.setProperty("font-size",c.fontSize+"px"),u.style.setProperty("line-height",c.lineHeight*c.fontSize+"px"),u.style.setProperty("max-width",null===c.maxWidth?null:c.maxWidth+"px"),u.style.setProperty("min-width",c.minWidth??null),u.style.setProperty("padding",c.padding),u.textContent=normalizeTextForDom(t);let h=u.getBoundingClientRect();return{x:0,y:0,w:h.width,h:h.height}};measureElementTextNodeSpans(t,{shouldTruncateToFirstLine:c=!1}={}){let u=[],h=t.getBoundingClientRect(),f=-h.left,g=-h.top,v=new Range,x=t.childNodes[0],w=0,_=null,k=null,E=0,$=!1;for(let h of t.childNodes)if(h.nodeType===Node.TEXT_NODE)for(let t of h.textContent??""){v.setStart(x,w),v.setEnd(x,w+t.length);let h=v.getClientRects(),T=h[h.length-1],I=T.top+g,M=T.left+f,j=T.right+f,D=b.test(t);if(D===k&&I===E&&_)_.box.w=j-_.box.x,_.text+=t;else{if(_){if(c&&I!==E){$=!0;break}u.push(_)}_={box:{x:M,y:I,w:T.width,h:T.height},text:t}}k=D,E=I,w+=t.length}return _&&u.push(_),{spans:u,didTruncate:$}}measureTextSpans(t,c){if(""===t)return[];let u="truncate-ellipsis"===c.overflow||"truncate-clip"===c.overflow,h=this.getTextElement(),f=Math.ceil(c.width-2*c.padding);h.style.setProperty("width",`${f}px`),h.style.setProperty("height","min-content"),h.style.setProperty("dir","ltr"),h.style.setProperty("font-size",`${c.fontSize}px`),h.style.setProperty("font-family",c.fontFamily),h.style.setProperty("font-weight",c.fontWeight),h.style.setProperty("line-height",`${c.lineHeight*c.fontSize}px`),h.style.setProperty("text-align",g[c.textAlign]),u&&(h.style.setProperty("overflow-wrap","anywhere"),h.style.setProperty("word-break","break-all")),t=normalizeTextForDom(t),h.textContent=t;let{spans:b,didTruncate:v}=this.measureElementTextNodeSpans(h,{shouldTruncateToFirstLine:u});if("truncate-ellipsis"===c.overflow&&v){h.textContent="…";let u=Math.ceil(this.measureElementTextNodeSpans(h).spans[0].box.w);h.style.setProperty("width",`${f-u}px`),h.textContent=t;let g=this.measureElementTextNodeSpans(h,{shouldTruncateToFirstLine:!0}).spans,b=g[g.length-1];return g.push({text:"…",box:{x:Math.min(b.box.x+b.box.w,c.width-c.padding-u),y:b.box.y,w:u,h:b.box.h}}),g}return h.remove(),b}}},6541:function(t,c,u){"use strict";u.d(c,{r:function(){return TickManager}});var h=u(6799);let TickManager=class TickManager{constructor(t){this.editor=t,this.editor.disposables.add(this.dispose),this.start()}raf;isPaused=!0;last=0;t=0;start=()=>{this.isPaused=!1,cancelAnimationFrame(this.raf),this.raf=requestAnimationFrame(this.tick),this.last=Date.now()};tick=()=>{if(this.isPaused)return;let t=Date.now(),c=t-this.last;if(this.last=t,this.t+=c,this.editor.emit("frame",c),this.t<16){this.raf=requestAnimationFrame(this.tick);return}this.t-=16,this.updatePointerVelocity(c),this.editor.emit("tick",c),this.raf=requestAnimationFrame(this.tick)};dispose=()=>{this.isPaused=!0,cancelAnimationFrame(this.raf)};prevPoint=new h.G;updatePointerVelocity=t=>{let{prevPoint:c,editor:{inputs:{currentScreenPoint:u,pointerVelocity:f}}}=this;if(0===t)return;let g=h.G.Sub(u,c);this.prevPoint=u.clone();let b=g.len(),v=b?g.div(b):new h.G(0,0),x=f.clone().lrp(v.mul(b/t),.5);.01>Math.abs(x.x)&&(x.x=0),.01>Math.abs(x.y)&&(x.y=0),f.equals(x)||(this.editor.inputs.pointerVelocity=x)}}},6393:function(t,c,u){"use strict";u.d(c,{K:function(){return UserPreferencesManager}});var h=u(9957),f=u(5894),g=Object.defineProperty,b=Object.getOwnPropertyDescriptor,__decorateClass=(t,c,u,h)=>{for(var f,v=h>1?void 0:h?b(c,u):c,x=t.length-1;x>=0;x--)(f=t[x])&&(v=(h?f(c,u,v):f(v))||v);return h&&v&&g(c,u,v),v};let UserPreferencesManager=class UserPreferencesManager{constructor(t,c){this.user=t,this.inferDarkMode=c}updateUserPreferences=t=>{this.user.setUserPreferences({...this.user.userPreferences.value,...t})};get userPreferences(){return{id:this.id,name:this.name,locale:this.locale,color:this.color,isDarkMode:this.isDarkMode,animationSpeed:this.animationSpeed,isSnapMode:this.isSnapMode}}get isDarkMode(){return this.user.userPreferences.value.isDarkMode??(!!this.inferDarkMode&&(0,f.ng)())}get animationSpeed(){return this.user.userPreferences.value.animationSpeed??f.ks.animationSpeed}get id(){return this.user.userPreferences.value.id}get name(){return this.user.userPreferences.value.name??f.ks.name}get locale(){return this.user.userPreferences.value.locale??f.ks.locale}get color(){return this.user.userPreferences.value.color??f.ks.color}get isSnapMode(){return this.user.userPreferences.value.isSnapMode??f.ks.isSnapMode}};__decorateClass([h.Fl],UserPreferencesManager.prototype,"userPreferences",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"isDarkMode",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"animationSpeed",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"id",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"name",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"locale",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"color",1),__decorateClass([h.Fl],UserPreferencesManager.prototype,"isSnapMode",1)},5859:function(t,c,u){"use strict";u.d(c,{E:function(){return ShapeUtil}});let ShapeUtil=class ShapeUtil{constructor(t){this.editor=t}static props;static migrations;static type;canSnap=()=>!0;canScroll=()=>!1;canUnmount=()=>!0;canBind=(t,c)=>!0;canEdit=()=>!1;canResize=()=>!0;canEditInReadOnly=()=>!1;canCrop=()=>!1;providesBackgroundForChildren(t){return!1}hideResizeHandles=()=>!1;hideRotateHandle=()=>!1;hideSelectionBoundsBg=()=>!1;hideSelectionBoundsFg=()=>!1;isAspectRatioLocked=()=>!1;getOutlineSegments(t){return[this.editor.getShapeGeometry(t).vertices]}canReceiveNewChildrenOfType(t,c){return!1}canDropShapes(t,c){return!1}expandSelectionOutlinePx(t){return 0}getCanvasSvgDefs(){return[]}onBeforeCreate;onBeforeUpdate;onDragShapesOver;onDragShapesOut;onDropShapesOver;onResizeStart;onResize;onResizeEnd;onTranslateStart;onTranslate;onTranslateEnd;onRotateStart;onRotate;onRotateEnd;onHandleChange;onBindingChange;onChildrenChange;onDoubleClickHandle;onDoubleClickEdge;onDoubleClick;onClick;onEditEnd}},2772:function(t,c,u){"use strict";u.d(c,{Q:function(){return GroupShapeUtil}});var h=u(7437),f=u(6579),g=u(7295),b=u(7684),v=u(2042),x=u(6368),w=u(9234),_=u(5859),k=u(9957),E=u(3373);function getPerfectDashProps(t,c,u={}){let{closed:h=!1,snap:f=1,start:g="outset",end:b="outset",lengthRatio:v=2,style:x="dashed"}=u,w=0,_=0,k=1,E=0,$=0;switch(x){case"dashed":k=1,w=Math.min(c*v,t/4);break;case"dotted":w=c/(k=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return h||("outset"===g?(t+=w/2,$+=w/2):"skip"===g&&(t-=w,$-=w),"outset"===b?t+=w/2:"skip"!==b||(t-=w)),_=Math.floor(t/w/(2*k)),(_-=_%f)<3&&"dashed"===x?t/c<5?(w=t,_=1,E=0):(w=.333*t,E=.333*t):(w=t/(_=Math.max(_,3))/(2*k),h?($=w/2,E=(t-_*w)/_):E=(t-_*w)/Math.max(1,_-1)),{strokeDasharray:[w,E].join(" "),strokeDashoffset:$.toString()}}function DashedOutlineBox({bounds:t,className:c}){let u=(0,E.j)(),f=(0,k.Hg)("zoom level",()=>u.zoomLevel,[u]);return(0,h.jsx)("g",{className:c,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((t,c)=>{let{strokeDasharray:u,strokeDashoffset:g}=getPerfectDashProps(t[0].dist(t[1]),1/f,{style:"dashed",lengthRatio:4});return(0,h.jsx)("line",{x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y,strokeDasharray:u,strokeDashoffset:g},c)})})}let GroupShapeUtil=class GroupShapeUtil extends _.E{static type="group";static props=f.A7;static migrations=f.c4;hideSelectionBoundsFg=()=>!0;canBind=()=>!1;getDefaultProps(){return{}}getGeometry(t){let c=this.editor.getSortedChildIdsForParent(t.id);return 0===c.length?new w.z({width:1,height:1,isFilled:!1}):new b.m({children:c.map(t=>{let c=this.editor.getShape(t),u=this.editor.getShapeGeometry(t),h=this.editor.getShapeLocalTransform(c).applyToPoints(u.vertices);return u.isClosed?new v.w({points:h,isFilled:!0}):new x.q({points:h})})})}component(t){let c=this.editor.erasingShapeIds.includes(t.id),{hintingShapeIds:u}=this.editor.currentPageState,f=u.length>0&&u.some(c=>c!==t.id&&this.editor.isShapeOfType(this.editor.getShape(c),"group")),b=this.editor.currentPageState.focusedGroupId!==t.id;if(!c&&(b||f))return null;let v=this.editor.getShapeGeometry(t).bounds;return(0,h.jsx)(g.g,{id:t.id,children:(0,h.jsx)(DashedOutlineBox,{className:"tl-group",bounds:v})})}indicator(t){let c=this.editor.getShapeGeometry(t).bounds;return(0,h.jsx)(DashedOutlineBox,{className:"",bounds:c})}onChildrenChange=t=>{let c=this.editor.getSortedChildIdsForParent(t.id);if(0===c.length){this.editor.currentPageState.focusedGroupId===t.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([t.id]);return}if(1===c.length){this.editor.currentPageState.focusedGroupId===t.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(c,t.parentId),this.editor.deleteShapes([t.id]);return}}}},4214:function(t,c,u){"use strict";u.d(c,{dz:function(){return getCurvedArrowHandlePath},pe:function(){return getCurvedArrowInfo},t9:function(){return getSolidCurvedArrowPath}}),u(9303);var h=u(498),f=u(6799),g=u(224),b=u(6166),v=u(7761),x=u(3308);function getCurvedArrowInfo(t,c,u=0){let{arrowheadEnd:w,arrowheadStart:_}=c.props,k=c.props.bend+u;if(Math.abs(k)>Math.abs(c.props.bend*v.Od))return(0,x.rc)(t,c);let E=(0,v.Qs)(t,c),$=f.G.Med(E.start,E.end),T=f.G.Sub(E.end,E.start).uni(),I=f.G.Add($,T.per().mul(-k)),M=(0,v.Up)(t,c.props.start),j=(0,v.Up)(t,c.props.end),D=E.start.clone(),F=E.end.clone(),L=I.clone(),B=c.props.bend<0,G=B?b.VK:b.pc,U=getArcInfo(D,F,L),V=f.G.Angle(U.center,D),K=f.G.Angle(U.center,F),Z=G(V,K);if(0===U.length||0===U.size||!(0,b.AV)(U.length)||!(0,b.AV)(U.size))return(0,x.rc)(t,c);let Y=D.clone(),X=F.clone(),J=L.clone(),Q=t.getShapePageTransform(c),ee=0,et=0;if(M&&!M.isExact){let u;let f=h.y.applyToPoint(Q,Y),b=h.y.applyToPoint(Q,U.center),x=h.y.applyToPoint(Q,X),w=h.y.Inverse(M.transform),k=h.y.applyToPoint(w,f),E=h.y.applyToPoint(w,b),$=h.y.applyToPoint(w,x),{isClosed:T}=M,I=T?g.h9:g.XS,j=I(E,U.radius,M.outline);if(j){let t=E.angle(k),c=E.angle($),h=G(t,c);j=j.filter(c=>G(t,E.angle(c))<=h);let f=.25*h;j.sort(T?(c,u)=>Math.abs(G(t,E.angle(c))-f)<Math.abs(G(t,E.angle(u))-f)?-1:1:(c,u)=>G(t,E.angle(c))<G(t,E.angle(u))?-1:1),u=j[0]??(T?void 0:k)}else u=T?void 0:k;u&&(Y.setTo(t.getPointInShapeSpace(c,h.y.applyToPoint(M.transform,u))),M.didIntersect=!0,"none"!==_&&(ee=v.oF+v.L$[c.props.size]/2+("size"in M.shape.props?v.L$[M.shape.props.size]/2:0)))}if(j&&!j.isExact){let u;let f=h.y.applyToPoint(Q,Y),b=h.y.applyToPoint(Q,X),x=h.y.applyToPoint(Q,U.center),_=h.y.Inverse(j.transform),k=h.y.applyToPoint(_,f),E=h.y.applyToPoint(_,x),$=h.y.applyToPoint(_,b),T=j.isClosed,I=T?g.h9:g.XS,M=I(E,U.radius,j.outline);if(M){let t=E.angle(k),c=E.angle($),h=G(t,c),f=.75*h;(M=M.filter(c=>G(t,E.angle(c))<=h)).sort(T?(c,u)=>Math.abs(G(t,E.angle(c))-f)<Math.abs(G(t,E.angle(u))-f)?-1:1:(c,u)=>G(t,E.angle(c))<G(t,E.angle(u))?-1:1),u=M[0]?M[0]:T?void 0:$}else u=T?void 0:$;u&&(X.setTo(t.getPointInShapeSpace(c,h.y.applyToPoint(j.transform,u))),j.didIntersect=!0,"none"!==w&&(et=v.oF+v.L$[c.props.size]/2+("size"in j.shape.props?v.L$[j.shape.props.size]/2:0)))}let en=f.G.Angle(U.center,Y),er=f.G.Angle(U.center,X),ei=G(en,er),eo=ei*U.radius,ea=Y.clone(),es=X.clone();if(0!==ee){let t=ee/eo*(B?1:-1),c=f.G.FromAngle(en+ei*t);ea.setTo(U.center).add(c.mul(U.radius))}if(0!==et){let t=et/eo*(B?-1:1),c=f.G.FromAngle(er+ei*t);es.setTo(U.center).add(c.mul(U.radius))}let el=f.G.Dist(ea,es);if(el<v.Kn&&(0!==ee&&0!==et?(ee*=-1.5,et*=-1.5):0!==ee?ee*=-2:0!==et?et*=-2:el<10&&(M?ee=-(10-el):j&&(et=-(10-el)))),0!==ee){let t=ee/eo*(B?1:-1),c=f.G.FromAngle(en+ei*t);Y.setTo(U.center).add(c.mul(U.radius))}if(0!==et){let t=et/eo*(B?-1:1),c=f.G.FromAngle(er+ei*t);X.setTo(U.center).add(c.mul(U.radius))}if(M&&j&&!M.isExact&&!j.isExact){if(eo=(ei=G(en=f.G.Angle(U.center,Y),er=f.G.Angle(U.center,X)))*U.radius,M.shape===j.shape)eo<100&&(Y.setTo(D),X.setTo(F),J.setTo(L));else if(M&&!M.didIntersect&&Y.setTo(D),j&&!j.didIntersect||G(V,en)>G(V,er)){let t=Math.min(.9,v.Kn/eo)*(B?1:-1),c=f.G.FromAngle(en+ei*t);X.setTo(U.center).add(c.mul(U.radius))}}placeCenterHandle(U.center,U.radius,Y,X,J,Z,B),Y.equals(X)&&(Y.setTo(J.clone().addXY(1,1)),X.setTo(J.clone().subXY(1,1))),D.setTo(Y),F.setTo(X),L.setTo(J);let ec=getArcInfo(D,F,L);return{isStraight:!1,start:{point:D,handle:E.start,arrowhead:c.props.arrowheadStart},end:{point:F,handle:E.end,arrowhead:c.props.arrowheadEnd},middle:L,handleArc:U,bodyArc:ec,isValid:0!==ec.length&&isFinite(ec.center.x)&&isFinite(ec.center.y)}}function getCurvedArrowHandlePath(t){let{start:c,end:u,handleArc:{radius:h,largeArcFlag:f,sweepFlag:g}}=t;return`M${c.handle.x},${c.handle.y} A${h} ${h} 0 ${f} ${g} ${u.handle.x},${u.handle.y}`}function getSolidCurvedArrowPath(t){let{start:c,end:u,bodyArc:{radius:h,largeArcFlag:f,sweepFlag:g}}=t;return`M${c.point.x},${c.point.y} A${h} ${h} 0 ${f} ${g} ${u.point.x},${u.point.y}`}function getArcInfo(t,c,u){let h=-2*(t.x*(c.y-u.y)-t.y*(c.x-u.x)+c.x*u.y-u.x*c.y),g={x:((t.x*t.x+t.y*t.y)*(u.y-c.y)+(c.x*c.x+c.y*c.y)*(t.y-u.y)+(u.x*u.x+u.y*u.y)*(c.y-t.y))/h,y:((t.x*t.x+t.y*t.y)*(c.x-u.x)+(c.x*c.x+c.y*c.y)*(u.x-t.x)+(u.x*u.x+u.y*u.y)*(t.x-c.x))/h},v=f.G.Dist(g,t),x=+f.G.Clockwise(t,u,c),w=Math.hypot(t.y-c.y,t.x-c.x),_=Math.hypot(c.y-u.y,c.x-u.x),k=Math.hypot(u.y-t.y,u.x-t.x),E=2*Math.acos((_*_+k*k-w*w)/(2*_*k)),$=+(b.PI>E),T=(b.yo-E)*(x?1:-1);return{center:g,radius:v,size:T,length:T*v,largeArcFlag:$,sweepFlag:x}}function placeCenterHandle(t,c,u,h,g,v,x){let w=f.G.Angle(t,u),_=f.G.Angle(t,h),k=(0,b.VK)(w,_);x||(k=b.yo-k);let E=f.G.FromAngle(w+k*(.5*(x?1:-1)));if(g.setTo(t).add(E.mul(c)),k>v){g.rotWith(t,b.PI);let c=h.clone();h.setTo(u),u.setTo(c)}}},7761:function(t,c,u){"use strict";u.d(c,{Kn:function(){return b},L$:function(){return w},Od:function(){return x},Qs:function(){return getArrowTerminalsInArrowSpace},Up:function(){return getBoundShapeInfoForTerminal},el:function(){return getIsArrowStraight},oF:function(){return v}});var h=u(498),f=u(6799),g=u(7684);function getIsArrowStraight(t){return 8>Math.abs(t.props.bend)}function getBoundShapeInfoForTerminal(t,c){if("point"===c.type)return;let u=t.getShape(c.boundShapeId),h=t.getShapePageTransform(u),f=t.getShapeGeometry(u),b=f instanceof g.m?f.children[0].vertices:f.vertices;return{shape:u,transform:h,isClosed:f.isClosed,isExact:c.isExact,didIntersect:!1,outline:b}}function getArrowTerminalInArrowSpace(t,c,u){if("point"===u.type)return f.G.From(u);let g=t.getShape(u.boundShapeId);if(!g)return new f.G(0,0);{let{point:b,size:v}=t.getShapeGeometry(g).bounds,x=f.G.Add(b,f.G.MulV(u.normalizedAnchor,v)),w=h.y.applyToPoint(t.getShapePageTransform(g),x),_=h.y.applyToPoint(h.y.Inverse(c),w);return _}}function getArrowTerminalsInArrowSpace(t,c){let u=t.getShapePageTransform(c),h=getArrowTerminalInArrowSpace(t,u,c.props.start),f=getArrowTerminalInArrowSpace(t,u,c.props.end);return{start:h,end:f}}let b=32,v=10,x=10,w={s:2,m:3.5,l:5,xl:10}},3308:function(t,c,u){"use strict";u.d(c,{$w:function(){return getStraightArrowHandlePath},N7:function(){return getSolidStraightArrowPath},rc:function(){return getStraightArrowInfo}}),u(9303);var h=u(498),f=u(6799),g=u(224),b=u(7761);function getStraightArrowInfo(t,c){let{start:u,end:h,arrowheadStart:g,arrowheadEnd:v}=c.props,x=(0,b.Qs)(t,c),w=x.start.clone(),_=x.end.clone(),k=f.G.Med(w,_),E=f.G.Sub(_,w).uni(),$=(0,b.Up)(t,u),T=(0,b.Up)(t,h),I=t.getShapePageTransform(c);updateArrowheadPointWithBoundShape(_,x.start,I,T),updateArrowheadPointWithBoundShape(w,x.end,I,$);let M=0,j=0,D=$&&T&&$.shape===T.shape;$&&T&&!D&&!$.isExact&&!T.isExact&&(T.didIntersect&&!$.didIntersect?$.isClosed&&w.setTo(_.clone().add(E.clone().mul(b.Kn))):!T.didIntersect&&T.isClosed&&_.setTo(w.clone().sub(E.clone().mul(b.Kn))));let F=f.G.Sub(_,w).uni(),L=!f.G.Equals(F,E);D||($&&"none"!==g&&!$.isExact&&(M=b.oF+b.L$[c.props.size]/2+("size"in $.shape.props?b.L$[$.shape.props.size]/2:0)),!T||"none"===v||T.isExact||(j=b.oF+b.L$[c.props.size]/2+("size"in T.shape.props?b.L$[T.shape.props.size]/2:0)));let B=w.clone().add(F.clone().mul(M*(L?-1:1))),G=_.clone().sub(F.clone().mul(j*(L?-1:1))),U=f.G.Dist(B,G);U<b.Kn&&(0!==M&&0!==j?(M*=-1.5,j*=-1.5):0!==M?M*=-2:0!==j?j*=-2:U<10&&($?M=-(10-U):T&&(j=-(10-U)))),w.add(F.clone().mul(M*(L?-1:1))),_.sub(F.clone().mul(j*(L?-1:1))),L?($&&T&&_.setTo(f.G.Add(w,F.clone().mul(-b.Kn))),k.setTo(f.G.Med(x.start,x.end))):k.setTo(f.G.Med(w,_));let V=f.G.Dist(w,_);return{isStraight:!0,start:{handle:x.start,point:w,arrowhead:c.props.arrowheadStart},end:{handle:x.end,point:_,arrowhead:c.props.arrowheadEnd},middle:k,isValid:V>0,length:V}}function updateArrowheadPointWithBoundShape(t,c,u,b){let v;if(void 0===b||b.isExact)return;let x=h.y.applyToPoint(u,c),w=h.y.applyToPoint(u,t),_=h.y.applyToPoint(h.y.Inverse(b.transform),x),k=h.y.applyToPoint(h.y.Inverse(b.transform),w),E=b.isClosed,$=E?g.qZ:g.Gc,T=$(_,k,b.outline);if(null!==T&&(v=T.sort((t,c)=>f.G.Dist(t,_)-f.G.Dist(c,_))[0]??(E?void 0:k)),void 0===v)return;let I=h.y.applyToPoint(b.transform,v),M=h.y.applyToPoint(h.y.Inverse(u),I);t.setTo(M),b.didIntersect=!0}function getStraightArrowHandlePath(t){return getArrowPath(t.start.handle,t.end.handle)}function getSolidStraightArrowPath(t){return getArrowPath(t.start.point,t.end.point)}function getArrowPath(t,c){return`M${t.x},${t.y}L${c.x},${c.y}`}},9040:function(t,c,u){"use strict";u.d(c,{m:function(){return RootState}});var h=u(2797);let RootState=class RootState extends h.n{static id="root";static initial="";static children=()=>[];onKeyDown=t=>{if("KeyZ"===t.code&&!(t.shiftKey||t.ctrlKey)){let c=this.current.value;c&&c.current.value?.id==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...t,onInteractionEnd:c.id})}}}},2797:function(t,c,u){"use strict";u.d(c,{n:function(){return StateNode}});var h=u(9957),f=u(521),g=Object.defineProperty,b=Object.getOwnPropertyDescriptor;let StateNode=class StateNode{constructor(t,c){this.editor=t;let{id:u,children:f,initial:g}=this.constructor;this.id=u,this.current=(0,h.cn)("toolState"+this.id,void 0),this.path=(0,h.Fl)("toolPath"+this.id,()=>{let t=this.current.value;return this.id+(t?`.${t.path.value}`:"")}),this.parent=c??{},this.parent?f&&g?(this.type="branch",this.initial=g,this.children=Object.fromEntries(f().map(t=>[t.id,new t(this.editor,this)])),this.current.set(this.children[this.initial])):this.type="leaf":(this.type="root",f&&g&&(this.initial=g,this.children=Object.fromEntries(f().map(t=>[t.id,new t(this.editor,this)])),this.current.set(this.children[this.initial])))}path;static id;static initial;static children;id;current;type;shapeType;initial;children;parent;isActive=!1;transition=(t,c)=>{let u=t.split("."),h=this;for(let t=0;t<u.length;t++){let f=u[t],g=h.current.value,b=h.children?.[f];if(!b)throw Error(`${h.id} - no child state exists with the id ${f}.`);if(g?.id!==b.id&&(g?.exit(c,f),h.current.set(b),b.enter(c,g?.id||"initial"),!b.isActive))break;h=b}return this};handleEvent=t=>{let c=f.J[t.name],u=this.current.value;this[c]?.(t),this.current.value===u&&this.isActive&&u?.handleEvent(t)};enter=(t,c)=>{if(this.isActive=!0,this.onEnter?.(t,c),this.children&&this.initial&&this.isActive){let u=this.children[this.initial];this.current.set(u),u.enter(t,c)}};exit=(t,c)=>{this.isActive=!1,this.onExit?.(t,c),this.isActive||this.current.value?.exit(t,c)};_currentToolIdMask=(0,h.cn)("curent tool id mask",void 0);get currentToolIdMask(){return this._currentToolIdMask.value}set currentToolIdMask(t){this._currentToolIdMask.set(t)}onWheel;onPointerDown;onPointerMove;onPointerUp;onDoubleClick;onTripleClick;onQuadrupleClick;onRightClick;onMiddleClick;onKeyDown;onKeyUp;onKeyRepeat;onCancel;onComplete;onInterrupt;onEnter;onExit};((t,c,u,h)=>{for(var f,v=h>1?void 0:h?b(c,u):c,x=t.length-1;x>=0;x--)(f=t[x])&&(v=(h?f(c,u,v):f(v))||v);return h&&v&&g(c,u,v)})([h.Fl],StateNode.prototype,"currentToolIdMask",1)},521:function(t,c,u){"use strict";u.d(c,{J:function(){return h}});let h={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick"}},3373:function(t,c,u){"use strict";u.d(c,{j:function(){return useEditor},r:function(){return f}});var h=u(2265);let f=h.createContext({}),useEditor=()=>h.useContext(f)},9303:function(t,c,u){"use strict";u.d(c,{Ee:function(){return flipSelectionHandleX},No:function(){return Box2d},Op:function(){return flipSelectionHandleY},dC:function(){return rotateSelectionHandle},m3:function(){return isSelectionCorner},rf:function(){return b}});var h=u(6799),f=u(6166);let Box2d=class Box2d{constructor(t=0,c=0,u=0,h=0){this.x=t,this.y=c,this.w=u,this.h=h}x=0;y=0;w=0;h=0;get point(){return new h.G(this.x,this.y)}set point(t){this.x=t.x,this.y=t.y}get minX(){return this.x}set minX(t){this.x=t}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(t){this.y=t}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(t){this.w=t}get height(){return this.h}set height(t){this.h=t}get aspectRatio(){return this.width/this.height}get center(){return new h.G(this.midX,this.midY)}set center(t){this.minX=t.x-this.width/2,this.minY=t.y-this.height/2}get corners(){return[new h.G(this.minX,this.minY),new h.G(this.maxX,this.minY),new h.G(this.maxX,this.maxY),new h.G(this.minX,this.maxY)]}get snapPoints(){return[new h.G(this.minX,this.minY),new h.G(this.maxX,this.minY),new h.G(this.maxX,this.maxY),new h.G(this.minX,this.maxY),this.center]}get sides(){let{corners:t}=this;return[[t[0],t[1]],[t[1],t[2]],[t[2],t[3]],[t[3],t[0]]]}get size(){return new h.G(this.w,this.h)}toFixed(){return this.x=(0,f.Zd)(this.x),this.y=(0,f.Zd)(this.y),this.w=(0,f.Zd)(this.w),this.h=(0,f.Zd)(this.h),this}setTo(t){return this.x=t.x,this.y=t.y,this.w=t.w,this.h=t.h,this}set(t=0,c=0,u=0,h=0){return this.x=t,this.y=c,this.w=u,this.h=h,this}expand(t){let c=Math.min(this.minX,t.minX),u=Math.min(this.minY,t.minY),h=Math.max(this.maxX,t.maxX),f=Math.max(this.maxY,t.maxY);return this.x=c,this.y=u,this.w=h-c,this.h=f-u,this}expandBy(t){return this.x-=t,this.y-=t,this.w+=2*t,this.h+=2*t,this}scale(t){return this.x/=t,this.y/=t,this.w/=t,this.h/=t,this}clone(){let{x:t,y:c,w:u,h}=this;return new Box2d(t,c,u,h)}translate(t){return this.x+=t.x,this.y+=t.y,this}snapToGrid(t){let c=Math.round(this.minX/t)*t,u=Math.round(this.minY/t)*t,h=Math.round(this.maxX/t)*t,f=Math.round(this.maxY/t)*t;this.minX=c,this.minY=u,this.width=Math.max(1,h-c),this.height=Math.max(1,f-u)}collides(t){return Box2d.Collides(this,t)}contains(t){return Box2d.Contains(this,t)}includes(t){return Box2d.Includes(this,t)}containsPoint(t,c=0){return Box2d.ContainsPoint(this,t,c)}getHandlePoint(t){switch(t){case"top_left":return new h.G(this.minX,this.minY);case"top_right":return new h.G(this.maxX,this.minY);case"bottom_left":return new h.G(this.minX,this.maxY);case"bottom_right":return new h.G(this.maxX,this.maxY);case"top":return new h.G(this.midX,this.minY);case"right":return new h.G(this.maxX,this.midY);case"bottom":return new h.G(this.midX,this.maxY);case"left":return new h.G(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(t,c,u){let{minX:h,minY:f,maxX:g,maxY:b}=this,{minX:v,minY:x,maxX:w,maxY:_}=this;switch(t){case"left":case"top_left":case"bottom_left":v+=c;break;case"right":case"top_right":case"bottom_right":w+=c}switch(t){case"top":case"top_left":case"top_right":x+=u;break;case"bottom":case"bottom_left":case"bottom_right":_+=u}let k=(w-v)/(g-h),E=(_-x)/(b-f);if(k<0){let t=w;w=v,v=t}if(E<0){let t=_;_=x,x=t}this.minX=v,this.minY=x,this.width=Math.abs(w-v),this.height=Math.abs(_-x)}union(t){let c=Math.min(this.minX,t.x),u=Math.min(this.minY,t.y),h=Math.max(this.maxX,t.w+t.x),f=Math.max(this.maxY,t.h+t.y);return this.x=c,this.y=u,this.width=h-c,this.height=f-u,this}static From(t){return new Box2d(t.x,t.y,t.w,t.h)}static FromPoints(t){let c;if(0===t.length)return new Box2d;let u=1/0,h=1/0,f=-1/0,g=-1/0;for(let b=0,v=t.length;b<v;b++)u=Math.min((c=t[b]).x,u),h=Math.min(c.y,h),f=Math.max(c.x,f),g=Math.max(c.y,g);return new Box2d(u,h,f-u,g-h)}static Expand(t,c){let u=Math.min(c.minX,t.minX),h=Math.min(c.minY,t.minY),f=Math.max(c.maxX,t.maxX),g=Math.max(c.maxY,t.maxY);return new Box2d(u,h,f-u,g-h)}static ExpandBy(t,c){return new Box2d(t.minX-c,t.minY-c,t.width+2*c,t.height+2*c)}static Collides=(t,c)=>!(t.maxX<c.minX||t.minX>c.maxX||t.maxY<c.minY||t.minY>c.maxY);static Contains=(t,c)=>t.minX<c.minX&&t.minY<c.minY&&t.maxY>c.maxY&&t.maxX>c.maxX;static Includes=(t,c)=>Box2d.Collides(t,c)||Box2d.Contains(t,c);static ContainsPoint=(t,c,u=0)=>!(c.x<t.minX-u||c.y<t.minY-u||c.x>t.maxX+u||c.y>t.maxY+u);static Common=t=>{let c=1/0,u=1/0,h=-1/0,f=-1/0;for(let g=0;g<t.length;g++){let b=t[g];c=Math.min(c,b.minX),u=Math.min(u,b.minY),h=Math.max(h,b.maxX),f=Math.max(f,b.maxY)}return new Box2d(c,u,h-c,f-u)};static Sides=(t,c=0)=>{let{corners:u}=t;return[[u[0],u[1]],[u[1],u[2]],[u[2],u[3]],[u[3],u[0]]]};static Resize(t,c,u,h,f=!1){let{minX:g,minY:b,maxX:v,maxY:x}=t,{minX:w,minY:_,maxX:k,maxY:E}=t;switch(c){case"left":case"top_left":case"bottom_left":w+=u;break;case"right":case"top_right":case"bottom_right":k+=u}switch(c){case"top":case"top_left":case"top_right":_+=h;break;case"bottom":case"bottom_left":case"bottom_right":E+=h}let $=(k-w)/(v-g),T=(E-_)/(x-b);if(f){let t=(v-g)/(x-b),u=Math.abs(k-w),h=Math.abs(E-_),f=u*(T<0?1:-1)*(1/t),I=h*($<0?1:-1)*t,M=t<u/h;switch(c){case"top_left":M?_=E+f:w=k+I;break;case"top_right":M?_=E+f:k=w-I;break;case"bottom_right":M?E=_-f:k=w-I;break;case"bottom_left":M?E=_-f:w=k+I;break;case"bottom":case"top":{let c=(w+k)/2,u=h*t;w=c-u/2,k=c+u/2;break}case"left":case"right":{let c=(_+E)/2,h=u/t;_=c-h/2,E=c+h/2}}}if($<0){let t=k;k=w,w=t}if(T<0){let t=E;E=_,_=t}let I=new Box2d(w,_,Math.abs(k-w),Math.abs(E-_));return{box:I,scaleX:+(I.width/t.width*($>0?1:-1)).toFixed(5),scaleY:+(I.height/t.height*(T>0?1:-1)).toFixed(5)}}equals(t){return Box2d.Equals(this,t)}static Equals(t,c){return c.x===t.x&&c.y===t.y&&c.w===t.w&&c.h===t.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(t){return new Box2d(t.x,t.y,Math.max(1,t.w),Math.max(1,t.h))}};function flipSelectionHandleY(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return t}}function flipSelectionHandleX(t){switch(t){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return t}}let g=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function rotateSelectionHandle(t,c){c%=f.yo;let u=Math.round(c/(f.PI/4)),h=g.indexOf(t);return g[(h+u)%g.length]}function isSelectionCorner(t){return"top_left"===t||"top_right"===t||"bottom_right"===t||"bottom_left"===t}let b={top_left_rotate:"top_left",top_right_rotate:"top_right",bottom_right_rotate:"bottom_right",bottom_left_rotate:"bottom_left",mobile_rotate:"top_left"}},498:function(t,c,u){"use strict";u.d(c,{y:function(){return Matrix2d}});var h=u(9303),f=u(6166),g=u(6799);let Matrix2d=class Matrix2d{constructor(t,c,u,h,f,g){this.a=t,this.b=c,this.c=u,this.d=h,this.e=f,this.f=g}a=1;b=0;c=0;d=1;e=0;f=0;equals(t){return this.a===t.a&&this.b===t.b&&this.c===t.c&&this.d===t.d&&this.e===t.e&&this.f===t.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(t){let{a:c,b:u,c:h,d:f,e:g,f:b}=this;return this.a=c*t.a+h*t.b,this.c=c*t.c+h*t.d,this.e=c*t.e+h*t.f+g,this.b=u*t.a+f*t.b,this.d=u*t.c+f*t.d,this.f=u*t.e+f*t.f+b,this}rotate(t,c,u){return 0===t?this:void 0===c?this.multiply(Matrix2d.Rotate(t)):this.translate(c,u).multiply(Matrix2d.Rotate(t)).translate(-c,-u)}translate(t,c){return this.multiply(Matrix2d.Translate(t,c))}scale(t,c){return this.multiply(Matrix2d.Scale(t,c))}invert(){let{a:t,b:c,c:u,d:h,e:f,f:g}=this,b=t*h-c*u;return this.a=h/b,this.b=-(c/b),this.c=-(u/b),this.d=t/b,this.e=-((h*f-u*g)/b),this.f=(c*f-t*g)/b,this}applyToPoint(t){return Matrix2d.applyToPoint(this,t)}applyToPoints(t){return Matrix2d.applyToPoints(this,t)}rotation(){return Matrix2d.Rotation(this)}point(){return Matrix2d.Point(this)}decomposed(){return Matrix2d.Decompose(this)}toCssString(){return Matrix2d.toCssString(this)}setTo(t){return Object.assign(this,t),this}decompose(){return Matrix2d.Decompose(this)}clone(){return new Matrix2d(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new Matrix2d(1,0,0,1,0,0)}static Translate(t,c){return new Matrix2d(1,0,0,1,t,c)}static Rotate(t,c,u){if(0===t)return Matrix2d.Identity();let h=Math.cos(t),f=Math.sin(t),g=new Matrix2d(h,f,-f,h,0,0);return void 0===c?g:Matrix2d.Compose(Matrix2d.Translate(c,u),g,Matrix2d.Translate(-c,-u))}static Scale=(t,c,u,h)=>{let f=new Matrix2d(t,0,0,0,c,0);return void 0===u?f:Matrix2d.Compose(Matrix2d.Translate(u,h),f,Matrix2d.Translate(-u,-h))};static Multiply(t,c){return{a:t.a*c.a+t.c*c.b,c:t.a*c.c+t.c*c.d,e:t.a*c.e+t.c*c.f+t.e,b:t.b*c.a+t.d*c.b,d:t.b*c.c+t.d*c.d,f:t.b*c.e+t.d*c.f+t.f}}static Inverse(t){let c=t.a*t.d-t.b*t.c;return{a:t.d/c,b:-(t.b/c),c:-(t.c/c),d:t.a/c,e:-((t.d*t.e-t.c*t.f)/c),f:(t.b*t.e-t.a*t.f)/c}}static Absolute(t){let c=t.a*t.d-t.b*t.c;return{a:t.d/c,b:-(t.b/c),c:-(t.c/c),d:t.a/c,e:(t.d*t.e-t.c*t.f)/c,f:-((t.b*t.e-t.a*t.f)/c)}}static Compose(...t){let c=Matrix2d.Identity();for(let u=0,h=t.length;u<h;u++)c.multiply(t[u]);return c}static Point(t){return new g.G(t.e,t.f)}static Rotation(t){let c;if(0!==t.a||0!==t.c){let u=Math.hypot(t.a,t.c);c=Math.acos(t.a/u)*(t.c>0?-1:1)}else if(0!==t.b||0!==t.d){let u=Math.hypot(t.b,t.d);c=f.gc+Math.acos(t.b/u)*(t.d>0?-1:1)}else c=0;return(0,f.Ci)(c)}static Decompose(t){let c,u,h;if(0!==t.a||0!==t.c){let f=Math.hypot(t.a,t.c);c=f,u=(t.a*t.d-t.b*t.c)/f,h=Math.acos(t.a/f)*(t.c>0?-1:1)}else if(0!==t.b||0!==t.d){let g=Math.hypot(t.b,t.d);c=(t.a*t.d-t.b*t.c)/g,u=g,h=f.gc+Math.acos(t.b/g)*(t.d>0?-1:1)}else c=0,u=0,h=0;return{x:t.e,y:t.f,scaleX:c,scaleY:u,rotation:(0,f.Ci)(h)}}static Smooth(t,c=1e10){return t.a=Math.round(t.a*c)/c,t.b=Math.round(t.b*c)/c,t.c=Math.round(t.c*c)/c,t.d=Math.round(t.d*c)/c,t.e=Math.round(t.e*c)/c,t.f=Math.round(t.f*c)/c,t}static toCssString(t){return`matrix(${(0,f.$Z)(t.a)}, ${(0,f.$Z)(t.b)}, ${(0,f.$Z)(t.c)}, ${(0,f.$Z)(t.d)}, ${(0,f.$Z)(t.e)}, ${(0,f.$Z)(t.f)})`}static applyToPoint(t,c){return new g.G(t.a*c.x+t.c*c.y+t.e,t.b*c.x+t.d*c.y+t.f,c.z)}static applyToXY(t,c,u){return[t.a*c+t.c*u+t.e,t.b*c+t.d*u+t.f]}static applyToPoints(t,c){return c.map(c=>new g.G(t.a*c.x+t.c*c.y+t.e,t.b*c.x+t.d*c.y+t.f,c.z))}static applyToBounds(t,c){return new h.No(t.e+c.minX,t.f+c.minY,c.width,c.height)}static From(t){return new Matrix2d(t.a,t.b,t.c,t.d,t.e,t.f)}static Cast(t){return t instanceof Matrix2d?t:Matrix2d.From(t)}}},6799:function(t,c,u){"use strict";u.d(c,{G:function(){return Vec2d}});var h=u(1986);let Vec2d=class Vec2d{constructor(t=0,c=0,u=1){this.x=t,this.y=c,this.z=u}get pressure(){return this.z}set(t=this.x,c=this.y,u=this.z){return this.x=t,this.y=c,this.z=u,this}setTo({x:t=0,y:c=0,z:u=1}){return this.x=t,this.y=c,this.z=u,this}rot(t){if(0===t)return this;let{x:c,y:u}=this,h=Math.sin(t),f=Math.cos(t);return this.x=c*f-u*h,this.y=c*h+u*f,this}rotWith(t,c){if(0===c)return this;let u=this.x-t.x,h=this.y-t.y,f=Math.sin(c),g=Math.cos(c);return this.x=t.x+(u*g-h*f),this.y=t.y+(u*f+h*g),this}clone(){let{x:t,y:c,z:u}=this;return new Vec2d(t,c,u)}sub(t){return this.x-=t.x,this.y-=t.y,this}subXY(t,c){return this.x-=t,this.y-=c,this}subScalar(t){return this.x-=t,this.y-=t,this}add(t){return this.x+=t.x,this.y+=t.y,this}addXY(t,c){return this.x+=t,this.y+=c,this}addScalar(t){return this.x+=t,this.y+=t,this}clamp(t,c){return this.x=Math.max(this.x,t),this.y=Math.max(this.y,t),void 0!==c&&(this.x=Math.min(this.x,c),this.y=Math.min(this.y,c)),this}div(t){return this.x/=t,this.y/=t,this}divV(t){return this.x/=t.x,this.y/=t.y,this}mul(t){return this.x*=t,this.y*=t,this}mulV(t){return this.x*=t.x,this.y*=t.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(t,c){let u=Vec2d.Tan(t,this);return this.add(u.mul(c))}neg(){return this.x*=-1,this.y*=-1,this}cross(t){return this.x=this.y*t.z-this.z*t.y,this.y=this.z*t.x-this.x*t.z,this}dpr(t){return Vec2d.Dpr(this,t)}cpr(t){return Vec2d.Cpr(this,t)}len2(){return Vec2d.Len2(this)}len(){return Vec2d.Len(this)}pry(t){return Vec2d.Pry(this,t)}per(){let{x:t,y:c}=this;return this.x=c,this.y=-t,this}uni(){return Vec2d.Uni(this)}tan(t){return Vec2d.Tan(this,t)}dist(t){return Vec2d.Dist(this,t)}distanceToLineSegment(t,c){return Vec2d.DistanceToLineSegment(t,c,this)}slope(t){return Vec2d.Slope(this,t)}snapToGrid(t){return this.x=Math.round(this.x/t)*t,this.y=Math.round(this.y/t)*t,this}angle(t){return Vec2d.Angle(this,t)}toAngle(){return Vec2d.ToAngle(this)}lrp(t,c){return this.x=this.x+(t.x-this.x)*c,this.y=this.y+(t.y-this.y)*c,this}equals(t){return Vec2d.Equals(this,t)}equalsXY(t,c){return Vec2d.EqualsXY(this,t,c)}norm(){let t=this.len();return this.x=0===t?0:this.x/t,this.y=0===t?0:this.y/t,this}toFixed(){return Vec2d.ToFixed(this)}toString(){return Vec2d.ToString(Vec2d.ToFixed(this))}toJson(){return Vec2d.ToJson(this)}toArray(){return Vec2d.ToArray(this)}static Add(t,c){return new Vec2d(t.x+c.x,t.y+c.y)}static AddXY(t,c,u){return new Vec2d(t.x+c,t.y+u)}static Sub(t,c){return new Vec2d(t.x-c.x,t.y-c.y)}static SubXY(t,c,u){return new Vec2d(t.x-c,t.y-u)}static AddScalar(t,c){return new Vec2d(t.x+c,t.y+c)}static SubScalar(t,c){return new Vec2d(t.x-c,t.y-c)}static Div(t,c){return new Vec2d(t.x/c,t.y/c)}static Mul(t,c){return new Vec2d(t.x*c,t.y*c)}static DivV(t,c){return new Vec2d(t.x/c.x,t.y/c.y)}static MulV(t,c){return new Vec2d(t.x*c.x,t.y*c.y)}static Neg(t){return new Vec2d(-t.x,-t.y)}static Per(t){return new Vec2d(t.y,-t.x)}static Dist2(t,c){return Vec2d.Sub(t,c).len2()}static Abs(t){return new Vec2d(Math.abs(t.x),Math.abs(t.y))}static Dist(t,c){return Math.hypot(t.y-c.y,t.x-c.x)}static Dpr(t,c){return t.x*c.x+t.y*c.y}static Cross(t,c){return new Vec2d(t.y*c.z-t.z*c.y,t.z*c.x-t.x*c.z)}static Cpr(t,c){return t.x*c.y-c.x*t.y}static Len2(t){return t.x*t.x+t.y*t.y}static Len(t){return Math.hypot(t.x,t.y)}static Pry(t,c){return Vec2d.Dpr(t,c)/Vec2d.Len(c)}static Uni(t){return Vec2d.Div(t,Vec2d.Len(t))}static Tan(t,c){return Vec2d.Uni(Vec2d.Sub(t,c))}static Min(t,c){return new Vec2d(Math.min(t.x,c.x),Math.min(t.y,c.y))}static Max(t,c){return new Vec2d(Math.max(t.x,c.x),Math.max(t.y,c.y))}static From({x:t,y:c,z:u=1}){return new Vec2d(t,c,u)}static FromArray(t){return new Vec2d(t[0],t[1])}static Rot(t,c=0){let u=Math.sin(c),h=Math.cos(c);return new Vec2d(t.x*h-t.y*u,t.x*u+t.y*h)}static RotWith(t,c,u){let h=t.x-c.x,f=t.y-c.y,g=Math.sin(u),b=Math.cos(u);return new Vec2d(c.x+(h*b-f*g),c.y+(h*g+f*b))}static NearestPointOnLineThroughPoint(t,c,u){return Vec2d.Mul(c,Vec2d.Sub(u,t).pry(c)).add(t)}static NearestPointOnLineSegment(t,c,u,h=!0){let f=Vec2d.Tan(c,t),g=Vec2d.Add(t,Vec2d.Mul(f,Vec2d.Sub(u,t).pry(f)));if(h){if(g.x<Math.min(t.x,c.x))return Vec2d.Cast(t.x<c.x?t:c);if(g.x>Math.max(t.x,c.x))return Vec2d.Cast(t.x>c.x?t:c);if(g.y<Math.min(t.y,c.y))return Vec2d.Cast(t.y<c.y?t:c);if(g.y>Math.max(t.y,c.y))return Vec2d.Cast(t.y>c.y?t:c)}return g}static DistanceToLineThroughPoint(t,c,u){return Vec2d.Dist(u,Vec2d.NearestPointOnLineThroughPoint(t,c,u))}static DistanceToLineSegment(t,c,u,h=!0){return Vec2d.Dist(u,Vec2d.NearestPointOnLineSegment(t,c,u,h))}static Snap(t,c=1){return new Vec2d(Math.round(t.x/c)*c,Math.round(t.y/c)*c)}static Cast(t){return t instanceof Vec2d?t:Vec2d.From(t)}static Slope(t,c){return t.x===c.y?NaN:(t.y-c.y)/(t.x-c.x)}static Angle(t,c){return Math.atan2(c.y-t.y,c.x-t.x)}static Lrp(t,c,u){return Vec2d.Sub(c,t).mul(u).add(t)}static Med(t,c){return new Vec2d((t.x+c.x)/2,(t.y+c.y)/2)}static Equals(t,c){return 1e-4>Math.abs(t.x-c.x)&&1e-4>Math.abs(t.y-c.y)}static EqualsXY(t,c,u){return t.x===c&&t.y===u}static Clockwise(t,c,u){return(u.x-t.x)*(c.y-t.y)-(c.x-t.x)*(u.y-t.y)<0}static Rescale(t,c){let u=Vec2d.Len(t);return new Vec2d(c*t.x/u,c*t.y/u)}static ScaleWithOrigin(t,c,u){return Vec2d.Sub(t,u).mul(c).add(u)}static ToFixed(t,c=2){return new Vec2d(+t.x.toFixed(c),+t.y.toFixed(c),+t.z.toFixed(c))}static Nudge(t,c,u){return Vec2d.Add(t,Vec2d.Tan(c,t).mul(u))}static ToString(t){return`${t.x}, ${t.y}`}static ToAngle(t){let c=Math.atan2(t.y,t.x);return c<0&&(c+=2*Math.PI),c}static FromAngle(t,c=1){return new Vec2d(Math.cos(t)*c,Math.sin(t)*c)}static ToArray(t){return[t.x,t.y,t.z]}static ToJson(t){let{x:c,y:u,z:h}=t;return{x:c,y:u,z:h}}static Average(t){let c=t.length,u=new Vec2d(0,0);for(let h=0;h<c;h++)u.add(t[h]);return u.div(c)}static Clamp(t,c,u){return void 0===u?new Vec2d(Math.min(Math.max(t.x,c)),Math.min(Math.max(t.y,c))):new Vec2d(Math.min(Math.max(t.x,c),u),Math.min(Math.max(t.y,c),u))}static PointsBetween(t,c,u=6){let f=[];for(let g=0;g<u;g++){let b=h.L.easeInQuad(g/(u-1)),v=Vec2d.Lrp(t,c,b);v.z=Math.min(1,.5+.65*Math.abs(.5-ease(b))),f.push(v)}return f}static SnapToGrid(t,c=8){return new Vec2d(Math.round(t.x/c)*c,Math.round(t.y/c)*c)}};let ease=t=>t<.5?2*t*t:-1+(4-2*t)*t},1986:function(t,c,u){"use strict";u.d(c,{L:function(){return h}});let h={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t<=0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t>=1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t<=0?0:t>=1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2}},4137:function(t,c,u){"use strict";u.d(c,{W:function(){return Edge2d}});var h=u(6799),f=u(224),g=u(4519);let Edge2d=class Edge2d extends g.l{start;end;d;u;ul;constructor(t){super({...t,isClosed:!1,isFilled:!1});let{start:c,end:u}=t;this.start=c,this.end=u,this.d=c.clone().sub(u),this.u=this.d.clone().uni(),this.ul=this.u.len()}_length;get length(){return this._length?this._length:this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(t){let{start:c,end:u,u:f,ul:g}=this;if(0===g)return c;let b=h.G.Sub(t,c).dpr(f)/g,v=c.x+f.x*b;if(v<Math.min(c.x,u.x))return c.x<u.x?c:u;if(v>Math.max(c.x,u.x))return c.x>u.x?c:u;let x=c.y+f.y*b;return x<Math.min(c.y,u.y)?c.y<u.y?c:u:x>Math.max(c.y,u.y)?c.y>u.y?c:u:new h.G(v,x)}hitTestLineSegment(t,c,u){return(0,f.cB)(t,c,this.start,this.end)}}},4519:function(t,c,u){"use strict";u.d(c,{l:function(){return Geometry2d}});var h=u(9303),f=u(6799),g=u(6166);let Geometry2d=class Geometry2d{isFilled=!1;isClosed=!0;isLabel=!1;isSnappable=!0;constructor(t){this.isFilled=t.isFilled,this.isClosed=t.isClosed,this.isSnappable=t.isSnappable??!1,this.isLabel=t.isLabel??!1}hitTestPoint(t,c=0,u=!1){return this.distanceToPoint(t,u)<=c}distanceToPoint(t,c=!1){let u=t.dist(this.nearestPoint(t));return this.isClosed&&(this.isFilled||c)&&(0,g.Of)(t,this.vertices)?-u:u}distanceToLineSegment(t,c){let u=this.nearestPointOnLineSegment(t,c),h=f.G.DistanceToLineSegment(t,c,u);return this.isClosed&&this.isFilled&&(0,g.Of)(u,this.vertices)?-h:h}hitTestLineSegment(t,c,u=0){return this.distanceToLineSegment(t,c)<=u}nearestPointOnLineSegment(t,c){let u,h=1/0;for(let g=0;g<this.vertices.length;g++){let b=this.vertices[g],v=f.G.DistanceToLineSegment(t,c,b);v<h&&(h=v,u=b)}if(!u)throw Error("nearest point not found");return u}isPointInBounds(t,c=0){let{bounds:u}=this;return!(t.x<u.minX-c||t.y<u.minY-c||t.x>u.maxX+c||t.y>u.maxY+c)}_vertices;get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return h.No.FromPoints(this.vertices)}_bounds;get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}_snapPoints;get snapPoints(){return this._snapPoints||(this._snapPoints=this.bounds.snapPoints),this._snapPoints}get center(){return this.bounds.center}_area;get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;let{vertices:t}=this,c=0;for(let u=0,h=t.length;u<h;u++){let f=t[u],g=t[(u+1)%h];c+=f.x*g.y-g.x*f.y}return c/2}toSimpleSvgPath(){let t="",{vertices:c}=this,u=c.length;if(0===u)return t;t+=`M${c[0].x},${c[0].y}`;for(let h=1;h<u;h++)t+=`L${c[h].x},${c[h].y}`;return this.isClosed&&(t+="Z"),t}}},7684:function(t,c,u){"use strict";u.d(c,{m:function(){return Group2d}});var h=u(9303),f=u(4519);let Group2d=class Group2d extends f.l{children;constructor(t){super({...t,isClosed:!0,isFilled:!1});let{children:c}=t;if(0===c.length)throw Error("Group2d must have at least one child");this.children=c}getVertices(){return this.children.filter(t=>!t.isLabel).flatMap(t=>t.vertices)}nearestPoint(t){let c,u=1/0,{children:h}=this;if(0===h.length)throw Error("no children");for(let f of h){let h=f.nearestPoint(t),g=h.dist(t);g<u&&(u=g,c=h)}if(!c)throw Error("nearest point not found");return c}distanceToPoint(t,c=!1){return Math.min(...this.children.map((u,h)=>u.distanceToPoint(t,c||h>0)))}hitTestPoint(t,c,u){return!!this.children.filter(t=>!t.isLabel).find(h=>h.hitTestPoint(t,c,u))}hitTestLineSegment(t,c,u){return!!this.children.filter(t=>!t.isLabel).find(h=>h.hitTestLineSegment(t,c,u))}getArea(){return this.children[0].area}toSimpleSvgPath(){let t="";for(let c of this.children)t+=c.toSimpleSvgPath();let c=h.No.FromPoints(this.vertices).corners;for(let u=0,h=c.length;u<h;u++){let f=c[u],g=c[(u-1+h)%h],b=f.dist(g),v=c[(u+1)%h],x=f.dist(v),w=f.clone().lrp(g,4/b),_=f.clone().lrp(v,4/x);t+=`M${w.x},${w.y} L${f.x},${f.y} L${_.x},${_.y} `}return t}}},2042:function(t,c,u){"use strict";u.d(c,{w:function(){return Polygon2d}});var h=u(6368);let Polygon2d=class Polygon2d extends h.q{constructor(t){super({...t}),this.isClosed=!0}}},6368:function(t,c,u){"use strict";u.d(c,{q:function(){return Polyline2d}});var h=u(4137),f=u(4519);let Polyline2d=class Polyline2d extends f.l{points;constructor(t){super({isClosed:!1,isFilled:!1,...t});let{points:c}=t;this.points=c}_segments;get segments(){if(!this._segments){this._segments=[];let{vertices:t}=this;for(let c=0,u=t.length-1;c<u;c++){let u=t[c],f=t[c+1];this._segments.push(new h.W({start:u,end:f}))}this.isClosed&&this._segments.push(new h.W({start:t[t.length-1],end:t[0]}))}return this._segments}_length;get length(){return this._length||(this._length=this.segments.reduce((t,c)=>t+c.length,0)),this._length}getVertices(){return this.points}nearestPoint(t){let c,u;let{segments:h}=this,f=this.points[0],g=1/0;for(let b=0;b<h.length;b++)(u=(c=h[b].nearestPoint(t)).dist(t))<g&&(f=c,g=u);return f}hitTestLineSegment(t,c,u){return this.segments.some(h=>h.hitTestLineSegment(t,c,u))}}},9234:function(t,c,u){"use strict";u.d(c,{z:function(){return Rectangle2d}});var h=u(9303),f=u(6799),g=u(2042);let Rectangle2d=class Rectangle2d extends g.w{x;y;w;h;constructor(t){let{x:c=0,y:u=0,width:h,height:g}=t;super({...t,points:[new f.G(c,u),new f.G(c+h,u),new f.G(c+h,u+g),new f.G(c,u+g)]}),this.x=c,this.y=u,this.w=h,this.h=g}getBounds(){return new h.No(this.x,this.y,this.w,this.h)}}},224:function(t,c,u){"use strict";u.d(c,{Gc:function(){return intersectLineSegmentPolyline},UQ:function(){return polygonsIntersect},XS:function(){return intersectCirclePolyline},ZM:function(){return intersectLineSegmentCircle},bO:function(){return intersectCircleCircle},cB:function(){return linesIntersect},h9:function(){return intersectCirclePolygon},qZ:function(){return intersectLineSegmentPolygon},tY:function(){return intersectPolygonPolygon}});var h=u(6166),f=u(6799);function intersectLineSegmentLineSegment(t,c,u,h){let g=t.x-u.x,b=t.y-u.y,v=h.x-u.x,x=h.y-u.y,w=c.x-t.x,_=c.y-t.y,k=v*b-x*g,E=w*b-_*g,$=x*w-v*_;if(0===k||0===E||0===$)return null;if(0!==$){let c=k/$,u=E/$;if(0<=c&&c<=1&&0<=u&&u<=1)return f.G.AddXY(t,c*w,c*_)}return null}function intersectLineSegmentCircle(t,c,u,h){let g=(c.x-t.x)*(c.x-t.x)+(c.y-t.y)*(c.y-t.y),b=2*((c.x-t.x)*(t.x-u.x)+(c.y-t.y)*(t.y-u.y)),v=u.x*u.x+u.y*u.y+t.x*t.x+t.y*t.y-2*(u.x*t.x+u.y*t.y)-h*h,x=b*b-4*g*v;if(x<0||0===x)return null;let w=Math.sqrt(x),_=(-b+w)/(2*g),k=(-b-w)/(2*g);if((_<0||_>1)&&(k<0||k>1))return null;let E=[];return(0<=_&&_<=1&&E.push(f.G.Lrp(t,c,_)),0<=k&&k<=1&&E.push(f.G.Lrp(t,c,k)),0===E.length)?null:E}function intersectLineSegmentPolyline(t,c,u){let h;let f=[];for(let g=0,b=u.length-1;g<b;g++)(h=intersectLineSegmentLineSegment(t,c,u[g],u[g+1]))&&f.push(h);return 0===f.length?null:f}function intersectLineSegmentPolygon(t,c,u){let h;let f=[];for(let g=1,b=u.length;g<b+1;g++)(h=intersectLineSegmentLineSegment(t,c,u[g-1],u[g%u.length]))&&f.push(h);return 0===f.length?null:f}function intersectCircleCircle(t,c,u,h){let g=u.x-t.x,b=u.y-t.y,v=Math.sqrt(g*g+b*b),x=(v*v-h*h+c*c)/(2*v),w=Math.sqrt(c*c-x*x);return g/=v,b/=v,[new f.G(t.x+g*x-b*w,t.y+b*x+g*w),new f.G(t.x+g*x+b*w,t.y+b*x-g*w)]}function intersectCirclePolygon(t,c,u){let h;let f=[];for(let g=0,b=u.length;g<b;g++)(h=intersectLineSegmentCircle(u[g],u[(g+1)%u.length],t,c))&&f.push(...h);return 0===f.length?null:f}function intersectCirclePolyline(t,c,u){let h;let f=[];for(let g=1,b=u.length;g<b;g++)(h=intersectLineSegmentCircle(u[g-1],u[g],t,c))&&f.push(...h);return 0===f.length?null:f}function ccw(t,c,u){return(u.y-t.y)*(c.x-t.x)>(c.y-t.y)*(u.x-t.x)}function linesIntersect(t,c,u,h){return ccw(t,u,h)!==ccw(c,u,h)&&ccw(t,c,u)!==ccw(t,c,h)}function intersectPolygonPolygon(t,c){let u,f,g,b;let v=[];for(let f=0,g=t.length;f<g;f++)u=t[f],(0,h.Of)(u,c)&&v.push(u);for(let f=0,g=c.length;f<g;f++)u=c[f],(0,h.Of)(u,t)&&v.push(u);for(let h=0,x=t.length;h<x;h++){u=t[h],f=t[(h+1)%t.length];for(let t=0,h=c.length;t<h;t++){g=c[t],b=c[(t+1)%c.length];let h=intersectLineSegmentLineSegment(u,f,g,b);null!==h&&v.push(h)}}return 0===v.length?null:orderClockwise(v)}function orderClockwise(t){let c=f.G.Average(t);return t.sort((t,u)=>f.G.Angle(c,t)-f.G.Angle(c,u))}function polygonsIntersect(t,c){let u,h;for(let f=0,g=t.length;f<g;f++){u=t[f],h=t[(f+1)%g];for(let t=0,f=c.length;t<f;t++)if(linesIntersect(u,h,c[t],c[(t+1)%f]))return!0}return!1}},6166:function(t,c,u){"use strict";u.d(c,{$Z:function(){return toDomPrecision},AV:function(){return isSafeFloat},C2:function(){return approximately},Cc:function(){return angleDelta},Ci:function(){return clampRadians},FH:function(){return toFixed},FO:function(){return isAngleBetween},Ht:function(){return degreesToRadians},Ib:function(){return x},KP:function(){return pointNearToLineSegment},LP:function(){return getStarBounds},M7:function(){return lerpAngles},Oe:function(){return getPolygonVertices},Of:function(){return pointInPolygon},PI:function(){return g},Pl:function(){return getArcLength},Rp:function(){return perimeterOfEllipse},V7:function(){return pointInPolyline},VK:function(){return clockwiseAngleDist},WU:function(){return pointInEllipse},XD:function(){return getPointOnCircle},Xh:function(){return pointNearToPolyline},Y8:function(){return average},Yk:function(){return precise},Z7:function(){return shortAngleDist},Zd:function(){return toPrecision},_G:function(){return areAnglesCompatible},dv:function(){return w},ep:function(){return rangesOverlap},f5:function(){return canonicalizeRotation},gc:function(){return b},hQ:function(){return getSweep},mD:function(){return pointInCircle},mW:function(){return rangeIntersection},nD:function(){return snapAngle},pc:function(){return counterClockwiseAngleDist},qr:function(){return pointInRect},uZ:function(){return clamp},vi:function(){return radiansToDegrees},wM:function(){return pointInBounds},yE:function(){return longAngleDist},yo:function(){return v}});var h=u(9303),f=u(6799);function precise(t){return`${toDomPrecision(t.x)},${toDomPrecision(t.y)} `}function average(t,c){return`${toDomPrecision((t.x+c.x)/2)},${toDomPrecision((t.y+c.y)/2)} `}let g=Math.PI,b=g/2,v=2*g,x=Math.PI/180,w=Math.sin;function clamp(t,c,u){return Math.max(c,void 0!==u?Math.min(t,u):t)}function toPrecision(t,c=1e10){return t?Math.round(t*c)/c:0}function approximately(t,c,u=1e-6){return Math.abs(t-c)<=u}function perimeterOfEllipse(t,c){let u=Math.pow(t-c,2)/Math.pow(t+c,2);return g*(t+c)*(1+3*u/(10+Math.sqrt(4-3*u)))}function canonicalizeRotation(t){return(t%=v)<0?t+=v:0===t&&(t=0),t}function clockwiseAngleDist(t,c){return(t=canonicalizeRotation(t))>(c=canonicalizeRotation(c))&&(c+=v),c-t}function counterClockwiseAngleDist(t,c){return v-clockwiseAngleDist(t,c)}function shortAngleDist(t,c){let u=(c-t)%v;return 2*u%v-u}function longAngleDist(t,c){return v-shortAngleDist(t,c)}function lerpAngles(t,c,u){return t+shortAngleDist(t,c)*u}function angleDelta(t,c){return shortAngleDist(t,c)}function getSweep(t,c,u){return shortAngleDist(f.G.Angle(t,c),f.G.Angle(t,u))}function clampRadians(t){return(v+t)%v}function snapAngle(t,c){let u=v/c,h=Math.floor((clampRadians(t)+u/2)/u)*u%v;return h<g&&(h+=v),h>g&&(h-=v),h}function areAnglesCompatible(t,c){return t===c||approximately(t%(Math.PI/2)-c%(Math.PI/2),0)}function isAngleBetween(t,c,u){t=canonicalizeRotation(t),c=canonicalizeRotation(c),u=canonicalizeRotation(u);let h=Math.cos(t),f=Math.sin(t),g=Math.cos(c),b=Math.sin(c),v=Math.cos(u),x=Math.sin(u);return h*v+f*x>=0&&g*v+b*x>=0}function degreesToRadians(t){return t*g/180}function radiansToDegrees(t){return 180*t/g}function getArcLength(t,c,u,h){let f=getSweep(t,u,h);return c*v*(f/v)}function getPointOnCircle(t,c,u,h){return new f.G(t+u*Math.cos(h),c+u*Math.sin(h))}function getPolygonVertices(t,c,u){let h=t/2,g=c/2,x=[],w=1/0,_=1/0;for(let t=0;t<u;t++){let c=v/u,k=-b+t*c,E=h+h*Math.cos(k),$=g+g*Math.sin(k);E<w&&(w=E),$<_&&(_=$),x.push(new f.G(E,$))}if(0!==w||0!==_)for(let t=0;t<x.length;t++){let c=x[t];c.x-=w,c.y-=_}return x}function rangesOverlap(t,c,u,h){return t<h&&u<c}function rangeIntersection(t,c,u,h){let f=Math.max(t,u),g=Math.min(c,h);return f<=g?[f,g]:null}let getStarBounds=(t,c,u)=>{let f=v/t/2,g=2*Math.floor(t/4);return new h.No(0,0,Math.cos(-b+g*f)*c/2-Math.cos(-b+(2*t-g)*f)*c/2,Math.sin(-b+2*Math.floor(t/2)*f)*u/2-Math.sin(-b+0*f)*u/2)};function cross(t,c,u){return(c.x-t.x)*(u.y-t.y)-(u.x-t.x)*(c.y-t.y)}function pointInCircle(t,c,u){return f.G.Dist(t,c)<=u}function pointInEllipse(t,c,u,h,g=0){g=g||0;let b=Math.cos(g),v=Math.sin(g),x=f.G.Sub(t,c),w=b*x.x+v*x.y,_=v*x.x-b*x.y;return w*w/(u*u)+_*_/(h*h)<=1}function pointInRect(t,c,u){return!(t.x<c.x||t.x>c.x+u.x||t.y<c.y||t.y>c.y+u.y)}function pointInPolygon(t,c){let u,h,f=0;for(let g=0;g<c.length;g++)u=c[g],h=c[(g+1)%c.length],u.y<=t.y?h.y>t.y&&cross(u,h,t)>0&&(f+=1):h.y<=t.y&&0>cross(u,h,t)&&(f-=1);return 0!==f}function pointInBounds(t,c){return!(t.x<c.minX||t.x>c.maxX||t.y<c.minY||t.y>c.maxY)}function pointInPolyline(t,c,u=3){for(let h=1;h<c.length;h++)if(f.G.DistanceToLineSegment(c[h-1],c[h],t)<u)return!0;return!1}function pointNearToPolyline(t,c,u=8){let h=c.length;for(let g=1;g<h;g++){let h=c[g-1],b=c[g],v=f.G.DistanceToLineSegment(h,b,t);if(v<u)return!0}return!1}function pointNearToLineSegment(t,c,u,h=8){let g=f.G.DistanceToLineSegment(c,u,t);return g<h}function toDomPrecision(t){return+t.toFixed(4)}function toFixed(t){return+t.toFixed(2)}let isSafeFloat=t=>Math.abs(t)<Number.MAX_SAFE_INTEGER},7539:function(t,c,u){"use strict";u.d(c,{_:function(){return ReadonlySharedStyleMap},o:function(){return SharedStyleMap}});var h=u(7110);function sharedStyleEquals(t,c){if(!c)return!1;switch(t.type){case"mixed":return"mixed"===c.type;case"shared":return"shared"===c.type&&t.value===c.value;default:throw(0,h.iP)(t)}}let ReadonlySharedStyleMap=class ReadonlySharedStyleMap{map;constructor(t){this.map=new Map(t)}get(t){return this.map.get(t)}getAsKnownValue(t){let c=this.get(t);if(c&&"mixed"!==c.type)return c.value}get size(){return this.map.size}equals(t){if(this.size!==t.size)return!1;let c=new Set;for(let[u,h]of this){if(!sharedStyleEquals(h,t.get(u)))return!1;c.add(u)}for(let[u,h]of t)if(!c.has(u)&&!sharedStyleEquals(h,this.get(u)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}};let SharedStyleMap=class SharedStyleMap extends ReadonlySharedStyleMap{set(t,c){this.map.set(t,c)}applyValue(t,c){let u=this.get(t);if(!u){this.set(t,{type:"shared",value:c});return}switch(u.type){case"mixed":return;case"shared":u.value!==c&&this.set(t,{type:"mixed"});return;default:(0,h.iP)(u,"type")}}}},1230:function(t,c,u){"use strict";u.d(c,{_:function(){return WeakMapCache}});let WeakMapCache=class WeakMapCache{items=new WeakMap;get(t,c){return this.items.has(t)||this.items.set(t,c(t)),this.items.get(t)}access(t){return this.items.get(t)}set(t,c){this.items.set(t,c)}has(t){return this.items.has(t)}invalidate(t){this.items.delete(t)}bust(){this.items=new WeakMap}}},5279:function(t,c,u){"use strict";function dataUrlToFile(t,c,u){return fetch(t).then(function(t){return t.arrayBuffer()}).then(function(t){return new File([t],c,{type:u})})}u.d(c,{B:function(){return dataUrlToFile}})},1605:function(t,c,u){"use strict";function getIncrementedName(t,c){let u=t,h=new Set(c);for(;h.has(u);)u=/^.*(\d+)$/.exec(u)?.[1]?u.replace(/(\d+)(?=\D?)$/,t=>(+t+1).toString()):`${u} 1`;return u}u.d(c,{u:function(){return getIncrementedName}})},853:function(t,c,u){"use strict";u.d(c,{B:function(){return getReorderingShapesChanges}});var h=u(7110),f=u(4078);function getReorderingShapesChanges(t,c,u){if(0===u.length)return[];let f=new Map;for(let c of(0,h.oA)(u.map(c=>t.getShape(c)))){let{parentId:u}=c;f.has(u)||f.set(u,{children:(0,h.oA)(t.getSortedChildIdsForParent(u).map(c=>t.getShape(c))),moving:new Set}),f.get(u).moving.add(c)}let g=[];switch(c){case"toBack":f.forEach(({moving:t,children:c})=>reorderToBack(t,c,g));break;case"toFront":f.forEach(({moving:t,children:c})=>reorderToFront(t,c,g));break;case"forward":f.forEach(({moving:t,children:c})=>reorderForward(t,c,g));break;case"backward":f.forEach(({moving:t,children:c})=>reorderBackward(t,c,g))}return g}function reorderToBack(t,c,u){let h,g;let b=c.length;if(t.size!==b){for(let u=0;u<b;u++){let f=c[u];if(t.has(f))h=f.index,t.delete(f);else{g=f.index;break}}if(0===t.size)return;{let c=(0,f.Xv)(h,g,t.size);u.push(...Array.from(t.values()).sort(f.hl).map((t,u)=>({...t,index:c[u]})))}}}function reorderToFront(t,c,u){let h,g;let b=c.length;if(t.size!==b){for(let u=b-1;u>-1;u--){let f=c[u];if(t.has(f))g=f.index,t.delete(f);else{h=f.index;break}}if(0===t.size)return;{let c=(0,f.Xv)(h,g,t.size);u.push(...Array.from(t.values()).sort(f.hl).map((t,u)=>({...t,index:c[u]})))}}}function reorderForward(t,c,u){let h=c.length;if(t.size===h)return;let g={name:"skipping"};for(let b=0;b<h;b++){let h=t.has(c[b]);switch(g.name){case"skipping":if(!h)continue;g={name:"selecting",selectIndex:b};break;case"selecting":{if(h)continue;let{selectIndex:t}=g;(0,f.Xv)(c[b].index,c[b+1]?.index,b-t).forEach((h,f)=>u.push({...c[t+f],index:h})),g={name:"skipping"}}}}}function reorderBackward(t,c,u){let h=c.length;if(t.size===h)return;let g={name:"skipping"};for(let b=h-1;b>-1;b--){let h=t.has(c[b]);switch(g.name){case"skipping":if(!h)continue;g={name:"selecting",selectIndex:b};break;case"selecting":if(h)continue;(0,f.Xv)(c[b-1]?.index,c[b].index,g.selectIndex-b).forEach((t,h)=>{u.push({...c[b+h+1],index:t})}),g={name:"skipping"}}}}},4078:function(t,c,u){"use strict";u.d(c,{_L:function(){return getIndexAbove},Xg:function(){return getIndexBelow},eI:function(){return getIndexBetween},H$:function(){return getIndices},vw:function(){return getIndicesAbove},dk:function(){return getIndicesBelow},Xv:function(){return getIndicesBetween},hl:function(){return sortByIndex}});let h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",f="A00000000000000000000000000";function getIntegerLength(t){if(t>="a"&&t<="z")return t.charCodeAt(0)-97+2;if(t>="A"&&t<="Z")return 90-t.charCodeAt(0)+2;throw Error("Invalid index key head: "+t)}function validateInteger(t){if(t.length!==getIntegerLength(t.charAt(0)))throw Error("invalid integer part of index key: "+t)}function isNotUndefined(t){if(void 0===t)throw Error("n is undefined")}function incrementInteger(t){validateInteger(t);let[c,...u]=t.split(""),f=!0;for(let t=u.length-1;f&&t>=0;t--){let c=h.indexOf(u[t])+1;c===h.length?u[t]="0":(u[t]=h.charAt(c),f=!1)}if(!f)return c+u.join("");{if("Z"===c)return"a0";if("z"===c)return;let t=String.fromCharCode(c.charCodeAt(0)+1);return t>"a"?u.push("0"):u.pop(),t+u.join("")}}function decrementInteger(t){validateInteger(t);let[c,...u]=t.split(""),f=!0;for(let t=u.length-1;f&&t>=0;t--){let c=h.indexOf(u[t])-1;-1===c?u[t]=h.slice(-1):(u[t]=h.charAt(c),f=!1)}if(!f)return c+u.join("");{if("a"===c)return"Z"+h.slice(-1);if("A"===c)return;let t=String.fromCharCode(c.charCodeAt(0)-1);return t<"Z"?u.push(h.slice(-1)):u.pop(),t+u.join("")}}function midpoint(t,c){if(void 0!==c&&t>=c)throw Error(t+" >= "+c);if("0"===t.slice(-1)||c&&"0"===c.slice(-1))throw Error("trailing zero");if(c){let u=0;for(;(t.charAt(u)||"0")===c.charAt(u);)u++;if(u>0)return c.slice(0,u)+midpoint(t.slice(u),c.slice(u))}let u=t?h.indexOf(t.charAt(0)):0,f=void 0!==c?h.indexOf(c.charAt(0)):h.length;if(f-u>1){let t=Math.round(.5*(u+f));return h.charAt(t)}return c&&c.length>1?c.slice(0,1):h.charAt(u)+midpoint(t.slice(1),void 0)}function getIntegerPart(t){let c=getIntegerLength(t.charAt(0));if(c>t.length)throw Error("invalid index: "+t);return t.slice(0,c)}function validateOrder(t){if(t===f)throw Error("invalid index: "+t);let c=getIntegerPart(t),u=t.slice(c.length);if("0"===u.slice(-1))throw Error("invalid index: "+t)}function generateKeyBetween(t,c){if(void 0!==t&&validateOrder(t),void 0!==c&&validateOrder(c),void 0!==t&&void 0!==c&&t>=c)throw Error(t+" >= "+c);if(void 0===t&&void 0===c)return"a0";if(void 0===t){if(void 0===c)throw Error("b is undefined");let t=getIntegerPart(c),u=c.slice(t.length);if(t===f)return t+midpoint("",u);if(t<c)return t;let h=decrementInteger(t);return isNotUndefined(h),h}if(void 0===c){let c=getIntegerPart(t),u=t.slice(c.length),h=incrementInteger(c);return void 0===h?c+midpoint(u,void 0):h}let u=getIntegerPart(t),h=t.slice(u.length),g=getIntegerPart(c),b=c.slice(g.length);if(u===g)return u+midpoint(h,b);let v=incrementInteger(u);return isNotUndefined(v),v<c?v:u+midpoint(h,void 0)}function generateNKeysBetween(t,c,u){if(0===u)return[];if(1===u)return[generateKeyBetween(t,c)];if(void 0===c){let h=generateKeyBetween(t,c),f=[h];for(let t=0;t<u-1;t++)f.push(h=generateKeyBetween(h,c));return f}if(void 0===t){let h=generateKeyBetween(t,c),f=[h];for(let c=0;c<u-1;c++)f.push(h=generateKeyBetween(t,h));return f.reverse(),f}let h=Math.floor(u/2),f=generateKeyBetween(t,c);return[...generateNKeysBetween(t,f,h),f,...generateNKeysBetween(f,c,u-h-1)]}function getIndicesBetween(t,c,u){return generateNKeysBetween(t,c,u)}function getIndicesAbove(t,c){return generateNKeysBetween(t,void 0,c)}function getIndicesBelow(t,c){return generateNKeysBetween(void 0,t,c)}function getIndexBetween(t,c){return generateNKeysBetween(t,c,1)[0]}function getIndexAbove(t){return generateNKeysBetween(t,void 0,1)[0]}function getIndexBelow(t){return generateNKeysBetween(void 0,t,1)[0]}function getIndices(t,c="a1"){return[c,...generateNKeysBetween(c,void 0,t)]}function sortByIndex(t,c){return t.index<c.index?-1:t.index>c.index?1:0}},7556:function(t,c,u){"use strict";u.d(c,{Z:function(){return applyRotationToSnapshotShapes},o:function(){return getRotationSnapshot}});var h=u(6579),f=u(7110),g=u(498),b=u(6166),v=u(6799);function getRotationSnapshot({editor:t}){let{selectionRotation:c,selectionRotatedPageBounds:u,inputs:{originPagePoint:h},selectedShapes:g}=t;if(!u)return null;let b=u.center.clone().rotWith(u.point,c);return{selectionPageCenter:b,initialCursorAngle:b.angle(h),initialSelectionRotation:c,shapeSnapshots:g.map(c=>({shape:(0,f.v4)(c),initialPagePoint:t.getShapePageTransform(c.id).point()}))}}function applyRotationToSnapshotShapes({delta:t,editor:c,snapshot:u,stage:f}){let{selectionPageCenter:x,shapeSnapshots:w}=u;c.updateShapes(w.map(({shape:u,initialPagePoint:f})=>{let w=(0,h.YT)(u.parentId)?c.getShapePageTransform(u.parentId):g.y.Identity(),_=v.G.RotWith(f,x,t),k=g.y.applyToPoint(g.y.Inverse(w),_),E=(0,b.f5)(u.rotation+t);return{id:u.id,type:u.type,x:k.x,y:k.y,rotation:E}}));let _=[];w.forEach(({shape:t})=>{let u=c.getShape(t.id);if(!u)return;let h=c.getShapeUtil(t);if("start"===f||"one-off"===f){let c=h.onRotateStart?.(t);c&&_.push(c)}let g=h.onRotate?.(t,u);if(g&&_.push(g),"end"===f||"one-off"===f){let c=h.onRotateEnd?.(t,u);c&&_.push(c)}}),_.length>0&&c.updateShapes(_)}},1034:function(t,c,u){"use strict";u.d(c,{E:function(){return uniqueId}});let nanoid=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((t,c)=>((c&=63)<36?t+=c.toString(36):c<62?t+=(c-26).toString(36).toUpperCase():c>62?t+="-":t+="_",t),"");function uniqueId(){return nanoid()}},9957:function(t,c,u){"use strict";u.d(c,{LZ:function(){return h},R0:function(){return EffectScheduler},SB:function(){return v},cn:function(){return Atom_atom},Fl:function(){return computed},e1:function(){return isUninitialized},Ym:function(){return react},zH:function(){return reactor},j:function(){return track},ay:function(){return transact},PS:function(){return transaction},vc:function(){return useComputed},BK:function(){return useQuickReactor},vC:function(){return useReactor},uC:function(){return useStateTracking},Hg:function(){return useValue},iJ:function(){return whyAmIRunning},qo:function(){return withDiff}});let ArraySet=class ArraySet{arraySize=0;array=Array(8);set=null;get isEmpty(){if(this.array)return 0===this.arraySize;if(this.set)return 0===this.set.size;throw Error("no set or array")}add(t){if(this.array){let c=this.array.indexOf(t);return -1===c&&(this.arraySize<8?(this.array[this.arraySize]=t,this.arraySize++):(this.set=new Set(this.array),this.array=null,this.set.add(t)),!0)}if(this.set)return!this.set.has(t)&&(this.set.add(t),!0);throw Error("no set or array")}remove(t){if(this.array){let c=this.array.indexOf(t);return -1!==c&&(this.array[c]=void 0,this.arraySize--,c!==this.arraySize&&(this.array[c]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return!!this.set.has(t)&&(this.set.delete(t),!0);throw Error("no set or array")}visit(t){if(this.array){for(let c=0;c<this.arraySize;c++){let u=this.array[c];void 0!==u&&t(u)}return}if(this.set){this.set.forEach(t);return}throw Error("no set or array")}};function isChild(t){return t&&"object"==typeof t&&"parents"in t}function haveParentsChanged(t){for(let c=0,u=t.parents.length;c<u;c++)if(t.parents[c].__unsafe__getWithoutCapture(),t.parents[c].lastChangedEpoch!==t.parentEpochs[c])return!0;return!1}let detach=(t,c)=>{if(t.children.remove(c)&&t.children.isEmpty&&isChild(t))for(let c=0,u=t.parents.length;c<u;c++)detach(t.parents[c],t)},attach=(t,c)=>{if(t.children.add(c)&&isChild(t))for(let c=0,u=t.parents.length;c<u;c++)attach(t.parents[c],t)};function equals(t,c){let u=t===c||Object.is(t,c)||!!(t&&c&&"function"==typeof t.equals&&t.equals(c));return u}let h=Object.freeze([]),f=Symbol.for("__@tldraw/state__"),g=globalThis;g[f]?console.error('Multiple versions of @tldraw/state detected. This will cause unexpected behavior. Please add "resolutions" (yarn/pnpm) or "overrides" (npm) in your package.json to ensure only one version of @tldraw/state is loaded.'):g[f]=!0;let CaptureStackFrame=class CaptureStackFrame{constructor(t,c){this.below=t,this.child=c}offset=0;numNewParents=0;maybeRemoved};let b=null;function startCapturingParents(t){b=new CaptureStackFrame(b,t)}function stopCapturingParents(){let t=b;b=t.below;let c=t.numNewParents>0||t.offset!==t.child.parents.length;if(c){for(let c=t.offset;c<t.child.parents.length;c++){let u=t.child.parents[c],h=t.child.parents.indexOf(u)>=t.offset;h&&detach(u,t.child)}if(t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset,b?.maybeRemoved)for(let c=0;c<b.maybeRemoved.length;c++){let u=b.maybeRemoved[c];-1===t.child.parents.indexOf(u)&&detach(u,t.child)}}}function maybeCaptureParent(t){if(b){let c=b.child.parents.indexOf(t);if(c<0&&(b.numNewParents++,b.child.isActivelyListening&&attach(t,b.child)),c<0||c>=b.offset){if(c!==b.offset&&c>0){let t=b.child.parents[b.offset];b.maybeRemoved?-1===b.maybeRemoved.indexOf(t)&&b.maybeRemoved.push(t):b.maybeRemoved=[t]}b.child.parents[b.offset]=t,b.child.parentEpochs[b.offset]=t.lastChangedEpoch,b.offset++}}}function whyAmIRunning(){let t=b?.child;if(!t)throw Error("whyAmIRunning() called outside of a reactive context");let c=[];for(let u=0;u<t.parents.length;u++){let h=t.parents[u];h.lastChangedEpoch>t.parentEpochs[u]&&c.push(h)}if(0===c.length)console.log(t.name,"is running but none of the parents changed");else for(let u of(console.log(t.name,"is running because:"),c))console.log("	",u.name,"changed =>",u.__unsafe__getWithoutCapture())}let v=Symbol("RESET_VALUE");let HistoryBuffer=class HistoryBuffer{constructor(t){this.capacity=t,this.buffer=Array(t)}index=0;buffer;pushEntry(t,c,u){if(void 0!==u){if(u===v){this.clear();return}this.buffer[this.index]=[t,c,u],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(t){let{index:c,capacity:u,buffer:h}=this;for(let f=0;f<u;f++){let g=(c-1+u-f)%u,b=h[g];if(!b)break;let[v,x]=b;if(0===f&&t>=x)return[];if(v<=t&&t<x){let t=f+1,c=Array(t);for(let f=0;f<t;f++)c[f]=h[(g+f)%u][2];return c}}return v}};let x=0,w=!1;function advanceGlobalEpoch(){x++}let Transaction=class Transaction{constructor(t){this.parent=t}initialAtomValues=new Map;get isRoot(){return null===this.parent}commit(){if(this.isRoot){let t=this.initialAtomValues;this.initialAtomValues=new Map,flushChanges(t.keys())}else this.initialAtomValues.forEach((t,c)=>{this.parent.initialAtomValues.has(c)||this.parent.initialAtomValues.set(c,t)})}abort(){x++,this.initialAtomValues.forEach((t,c)=>{c.set(t),c.historyBuffer?.clear()}),this.commit()}};function flushChanges(t){if(w)throw Error("cannot change atoms during reaction cycle");try{w=!0;let c=new Set,traverse=t=>{t.lastTraversedEpoch!==x&&(t.lastTraversedEpoch=x,"maybeScheduleEffect"in t?c.add(t):t.children.visit(traverse))};for(let c of t)c.children.visit(traverse);for(let t of c)t.maybeScheduleEffect()}finally{w=!1}}function atomDidChange(t,c){_?_.initialAtomValues.has(t)||_.initialAtomValues.set(t,c):flushChanges([t])}let _=null;function transaction(t){let c=new Transaction(_);_=c;try{let u=!1,h=t(()=>u=!0);return u?c.abort():c.commit(),h}catch(t){throw c.abort(),t}finally{_=_.parent}}function transact(t){return _?t():transaction(t)}let Atom_Atom=class Atom_Atom{constructor(t,c,u){if(this.name=t,this.current=c,this.isEqual=u?.isEqual??null,!u)return;u.historyLength&&(this.historyBuffer=new HistoryBuffer(u.historyLength)),this.computeDiff=u.computeDiff}isEqual;computeDiff;lastChangedEpoch=x;children=new ArraySet;historyBuffer;__unsafe__getWithoutCapture(){return this.current}get value(){return maybeCaptureParent(this),this.current}set(t,c){if(this.isEqual?.(this.current,t)??equals(this.current,t))return this.current;advanceGlobalEpoch(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,x,c??this.computeDiff?.(this.current,t,this.lastChangedEpoch,x)??v),this.lastChangedEpoch=x;let u=this.current;return this.current=t,atomDidChange(this,u),t}update(t){return this.set(t(this.current))}getDiffSince(t){return(maybeCaptureParent(this),t>=this.lastChangedEpoch)?h:this.historyBuffer?.getChangesSince(t)??v}};function Atom_atom(t,c,u){return new Atom_Atom(t,c,u)}let k=Symbol("UNINITIALIZED"),isUninitialized=t=>t===k;let WithDiff=class WithDiff{constructor(t,c){this.value=t,this.diff=c}};function withDiff(t,c){return new WithDiff(t,c)}let Computed_Computed=class Computed_Computed{constructor(t,c,u){this.name=t,this.derive=c,u?.historyLength&&(this.historyBuffer=new HistoryBuffer(u.historyLength)),this.computeDiff=u?.computeDiff,this.isEqual=u?.isEqual??equals}lastChangedEpoch=-1;lastTraversedEpoch=-1;lastCheckedEpoch=-1;parents=[];parentEpochs=[];children=new ArraySet;get isActivelyListening(){return!this.children.isEmpty}historyBuffer;state=k;computeDiff;isEqual;__unsafe__getWithoutCapture(){let t=-1===this.lastChangedEpoch;if(!t&&(this.lastCheckedEpoch===x||!haveParentsChanged(this)))return this.lastCheckedEpoch=x,this.state;try{startCapturingParents(this);let c=this.derive(this.state,this.lastCheckedEpoch),u=c instanceof WithDiff?c.value:c;if(this.state===k||!this.isEqual(u,this.state)){if(this.historyBuffer&&!t){let t=c instanceof WithDiff?c.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,x,t??this.computeDiff?.(this.state,u,this.lastCheckedEpoch,x)??v)}this.lastChangedEpoch=x,this.state=u}return this.lastCheckedEpoch=x,this.state}finally{stopCapturingParents()}}get value(){let t=this.__unsafe__getWithoutCapture();return maybeCaptureParent(this),t}getDiffSince(t){return(this.value,t>=this.lastChangedEpoch)?h:this.historyBuffer?.getChangesSince(t)??v}};function computedAnnotation(t={},c,u,h){let f=h.get,g=Symbol.for("__@tldraw/state__computed__"+u);return h.get=function(){let c=this[g];return c||Object.defineProperty(this,g,{enumerable:!1,configurable:!1,writable:!1,value:c=new Computed_Computed(u,f.bind(this),t)}),c.value},h}function computed(){if(1==arguments.length){let t=arguments[0];return(c,u,h)=>computedAnnotation(t,c,u,h)}return"string"==typeof arguments[0]?new Computed_Computed(arguments[0],arguments[1],arguments[2]):computedAnnotation(void 0,arguments[0],arguments[1],arguments[2])}let EffectScheduler=class EffectScheduler{constructor(t,c,u){this.name=t,this.runEffect=c,this._scheduleEffect=u?.scheduleEffect}_isActivelyListening=!1;get isActivelyListening(){return this._isActivelyListening}lastTraversedEpoch=-1;lastReactedEpoch=-1;_scheduleCount=0;get scheduleCount(){return this._scheduleCount}parentEpochs=[];parents=[];_scheduleEffect;maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==x){if(this.parents.length&&!haveParentsChanged(this)){this.lastReactedEpoch=x;return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}maybeExecute=()=>{this._isActivelyListening&&this.execute()};attach(){this._isActivelyListening=!0;for(let t=0,c=this.parents.length;t<c;t++)attach(this.parents[t],this)}detach(){this._isActivelyListening=!1;for(let t=0,c=this.parents.length;t<c;t++)detach(this.parents[t],this)}execute(){try{startCapturingParents(this);let t=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=x,t}finally{stopCapturingParents()}}};function react(t,c,u){let h=new EffectScheduler(t,c,u);return h.attach(),h.scheduleEffect(),()=>{h.detach()}}function reactor(t,c,u){let h=new EffectScheduler(t,c,u);return{scheduler:h,start:t=>{let c=t?.force??!1;h.attach(),c?h.scheduleEffect():h.maybeScheduleEffect()},stop:()=>{h.detach()}}}var E=u(2265);function useStateTracking(t,c){let u=E.useRef(c);u.current=c;let[h,f,g]=E.useMemo(()=>{let c=null,h=new EffectScheduler(`useStateTracking(${t})`,()=>u.current?.(),{scheduleEffect(){c?.()}});return[h,t=>(c=t,()=>{c=null}),()=>h.scheduleCount]},[t]);return E.useSyncExternalStore(f,g,g),E.useEffect(()=>(h.attach(),h.maybeScheduleEffect(),()=>{h.detach()}),[h]),h.execute()}let $={apply:(t,c,u)=>useStateTracking(t.displayName??t.name??"tracked(???)",()=>t.apply(c,u))},T=Symbol.for("react.memo"),I=Symbol.for("react.forward_ref");function track(t){let c=null,u=t.$$typeof;return(u===T&&(c=(t=t.type).compare),u===I)?(0,E.memo)((0,E.forwardRef)(new Proxy(t.render,$))):(0,E.memo)(new Proxy(t,$),c)}function useComputed(){let t=arguments[0],c=arguments[1],u=3==arguments.length?void 0:arguments[2],h=3==arguments.length?arguments[2]:arguments[3];return(0,E.useMemo)(()=>computed(`useComputed(${t})`,c,u),h)}function useQuickReactor(t,c,u=h){(0,E.useEffect)(()=>{let u=new EffectScheduler(t,c);return u.attach(),u.execute(),()=>{u.detach()}},u)}function useReactor(t,c,u=[]){let h=(0,E.useMemo)(()=>new EffectScheduler(t,c,{scheduleEffect:t=>requestAnimationFrame(t)}),u);(0,E.useEffect)(()=>(h.attach(),h.execute(),()=>{h.detach()}),[h])}function useValue(){let t=arguments,c=3===t.length?t[2]:[t[0]],u=3===t.length?t[0]:`useValue(${t[0].name})`,h=(0,E.useRef)(!0);h.current=!0;let f=(0,E.useMemo)(()=>1===t.length?t[0]:computed(u,()=>{if(h.current)return t[1]();try{return t[1]()}catch{return{}}}),c);try{let{subscribe:t,getSnapshot:c}=(0,E.useMemo)(()=>({subscribe:t=>react(`useValue(${u})`,()=>{f.value,t()}),getSnapshot:()=>f.value}),[f]);return(0,E.useSyncExternalStore)(t,c,c)}finally{h.current=!1}}},932:function(t,c,u){"use strict";u.d(c,{mW:function(){return IncrementalSetConstructor},qx:function(){return v},oX:function(){return RecordType},yh:function(){return Store},sS:function(){return StoreSchema},lS:function(){return assertIdType},ix:function(){return compareRecordVersions},$F:function(){return compareSchemas},ju:function(){return createRecordType},zn:function(){return defineMigrations},ZV:function(){return devFreeze},C$:function(){return getRecordVersion},Te:function(){return migrate},wJ:function(){return migrateRecord},kJ:function(){return reverseRecordsDiff},bs:function(){return squashRecordDiffs}});let IncrementalSetConstructor=class IncrementalSetConstructor{constructor(t){this.previousValue=t}nextValue;diff;get(){let t=this.diff?.removed?.size??0,c=this.diff?.added?.size??0;if(0!==t||0!==c)return{value:this.nextValue,diff:this.diff}}_add(t,c){this.nextValue??=new Set(this.previousValue),this.nextValue.add(t),this.diff??={},c?this.diff.removed?.delete(t):(this.diff.added??=new Set,this.diff.added.add(t))}add(t){let c=this.previousValue.has(t);if(c){let u=this.diff?.removed?.has(t);if(!u)return;return this._add(t,c)}let u=this.nextValue?.has(t);u||this._add(t,c)}_remove(t,c){this.nextValue??=new Set(this.previousValue),this.nextValue.delete(t),this.diff??={},c?(this.diff.removed??=new Set,this.diff.removed.add(t)):this.diff.added?.delete(t)}remove(t){let c=this.previousValue.has(t);if(!c){let u=this.diff?.added?.has(t);if(!u)return;return this._remove(t,c)}let u=this.diff?.removed?.has(t);u||this._remove(t,c)}};var h,f=u(7110);let nanoid=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((t,c)=>((c&=63)<36?t+=c.toString(36):c<62?t+=(c-26).toString(36).toUpperCase():c>62?t+="-":t+="_",t),"");let RecordType=class RecordType{constructor(t,c){this.typeName=t,this.createDefaultProperties=c.createDefaultProperties,this.migrations=c.migrations,this.validator=c.validator??{validate:t=>t},this.scope=c.scope??"document"}createDefaultProperties;migrations;validator;scope;create(t){let c={...this.createDefaultProperties(),id:this.createId()};for(let[u,h]of Object.entries(t))void 0!==h&&(c[u]=h);return c.typeName=this.typeName,c}clone(t){return{...(0,f.v4)(t),id:this.createId()}}createId(t){return this.typeName+":"+(t??nanoid())}createCustomId(t){return this.typeName+":"+t}parseId(t){if(!this.isId(t))throw Error(`ID "${t}" is not a valid ID for type "${this.typeName}"`);return t.slice(this.typeName.length+1)}isInstance=t=>t?.typeName===this.typeName;isId(t){if(!t)return!1;for(let c=0;c<this.typeName.length;c++)if(t[c]!==this.typeName[c])return!1;return":"===t[this.typeName.length]}withDefaultProperties(t){return new RecordType(this.typeName,{createDefaultProperties:t,migrations:this.migrations,validator:this.validator,scope:this.scope})}validate(t){return this.validator.validate(t)}};function createRecordType(t,c){return new RecordType(t,{createDefaultProperties:()=>({}),migrations:c.migrations??{currentVersion:0,firstVersion:0,migrators:{}},validator:c.validator,scope:c.scope})}function assertIdType(t,c){if(!t||!c.isId(t))throw Error(`string ${JSON.stringify(t)} is not a valid ${c.typeName} id`)}var g=u(9957);let Cache=class Cache{items=new WeakMap;get(t,c){return this.items.has(t)||this.items.set(t,c(t)),this.items.get(t)}};var b=u(9780);function intersectSets(t){if(0===t.length)return new Set;let c=t[0],u=t.slice(1),h=new Set;for(let t of c)u.every(c=>c.has(t))&&h.add(t);return h}function diffSets(t,c){let u={};for(let h of c)t.has(h)||(u.added??=new Set,u.added.add(h));for(let h of t)c.has(h)||(u.removed??=new Set,u.removed.add(h));return u.added||u.removed?u:void 0}function objectMatchesQuery(t,c){for(let[u,h]of Object.entries(t)){let t=c[u];if("eq"in h&&t!==h.eq||"neq"in h&&t===h.neq||"gt"in h&&("number"!=typeof t||t<=h.gt))return!1}return!0}function executeQuery(t,c,u){let h=Object.fromEntries(Object.keys(u).map(t=>[t,new Set]));for(let[f,g]of Object.entries(u))if("eq"in g){let u=t.index(c,f),b=u.value.get(g.eq);if(b)for(let t of b)h[f].add(t)}else if("neq"in g){let u=t.index(c,f);for(let[t,c]of u.value)if(t!==g.neq)for(let t of c)h[f].add(t)}else if("gt"in g){let u=t.index(c,f);for(let[t,c]of u.value)if(t>g.gt)for(let t of c)h[f].add(t)}return intersectSets(Object.values(h))}let StoreQueries=class StoreQueries{constructor(t,c){this.atoms=t,this.history=c}indexCache=new Map;historyCache=new Map;filterHistory(t){if(this.historyCache.has(t))return this.historyCache.get(t);let c=(0,g.Fl)("filterHistory:"+t,(c,u)=>{if((0,g.e1)(c))return this.history.value;let h=this.history.getDiffSince(u);if(h===g.SB)return this.history.value;let b={added:{},removed:{},updated:{}},v=0,x=0,w=0;for(let c of h){for(let u of(0,f.UM)(c.added))if(u.typeName===t){if(b.removed[u.id]){let t=b.removed[u.id];delete b.removed[u.id],x--,t!==u&&(b.updated[u.id]=[t,u],w++)}else b.added[u.id]=u,v++}for(let[u,h]of(0,f.UM)(c.updated))h.typeName===t&&(b.added[h.id]?b.added[h.id]=h:b.updated[h.id]?b.updated[h.id]=[b.updated[h.id][0],h]:(b.updated[h.id]=[u,h],w++));for(let u of(0,f.UM)(c.removed))u.typeName===t&&(b.added[u.id]?(delete b.added[u.id],v--):(b.updated[u.id]?(b.removed[u.id]=b.updated[u.id][0],delete b.updated[u.id],w--):b.removed[u.id]=u,x++))}return v||x||w?(0,g.qo)(this.history.value,b):c},{historyLength:100});return this.historyCache.set(t,c),c}index(t,c){let u=t+":"+c;if(this.indexCache.has(u))return this.indexCache.get(u);let h=this.__uncached_createIndex(t,c);return this.indexCache.set(u,h),h}__uncached_createIndex(t,c){let u=this.filterHistory(t),fromScratch=()=>{u.value;let h=new Map;for(let u of(0,f.UM)(this.atoms.value)){let f=u.value;if(f.typeName===t){let t=f[c];h.has(t)||h.set(t,new Set),h.get(t).add(f.id)}}return h};return(0,g.Fl)("index:"+t+":"+c,(h,b)=>{let v,x;if((0,g.e1)(h))return fromScratch();let w=u.getDiffSince(b);if(w===g.SB)return fromScratch();let _=new Map,add=(t,c)=>{let u=_.get(t);u||(u=new IncrementalSetConstructor(h.get(t)??new Set)),u.add(c),_.set(t,u)},remove=(t,c)=>{let u=_.get(t);u||(u=new IncrementalSetConstructor(h.get(t)??new Set)),u.remove(c),_.set(t,u)};for(let u of w){for(let h of(0,f.UM)(u.added))if(h.typeName===t){let t=h[c];add(t,h.id)}for(let[h,g]of(0,f.UM)(u.updated))if(g.typeName===t){let t=h[c],u=g[c];t!==u&&(remove(t,g.id),add(u,g.id))}for(let h of(0,f.UM)(u.removed))if(h.typeName===t){let t=h[c];remove(t,h.id)}}for(let[t,c]of _){let u=c.get();u&&(v||(v=new Map(h)),x||(x=new Map),0===u.value.size?v.delete(t):v.set(t,u.value),x.set(t,u.diff))}return v&&x?(0,g.qo)(v,x):h},{historyLength:100})}record(t,c=()=>({}),u="record:"+t+(c?":"+c.toString():"")){let h=this.ids(t,c,u);return(0,g.Fl)(u,()=>{for(let t of h.value)return this.atoms.value[t]?.value})}records(t,c=()=>({}),u="records:"+t+(c?":"+c.toString():"")){let h=this.ids(t,c,"ids:"+u);return(0,g.Fl)(u,()=>[...h.value].map(t=>{let c=this.atoms.value[t];if(!c)throw Error("no atom found for record id: "+t);return c.value}))}ids(t,c=()=>({}),u="ids:"+t+(c?":"+c.toString():"")){let h=this.filterHistory(t),fromScratch=()=>{h.value;let u=c();return 0===Object.keys(u).length?new Set((0,f.UM)(this.atoms.value).flatMap(c=>{let u=c.value;return u.typeName===t?u.id:[]})):executeQuery(this,t,u)},fromScratchWithDiff=t=>{let c=fromScratch(),u=diffSets(t,c);return u?(0,g.qo)(c,u):t},v=(0,g.Fl)("ids_query:"+u,c,{isEqual:b});return(0,g.Fl)("query:"+u,(c,u)=>{let b=v.value;if((0,g.e1)(c))return fromScratch();if(u<v.lastChangedEpoch)return fromScratchWithDiff(c);let x=h.getDiffSince(u);if(x===g.SB)return fromScratchWithDiff(c);let w=new IncrementalSetConstructor(c);for(let c of x){for(let u of(0,f.UM)(c.added))u.typeName===t&&objectMatchesQuery(b,u)&&w.add(u.id);for(let[u,h]of(0,f.UM)(c.updated))h.typeName===t&&(objectMatchesQuery(b,h)?w.add(h.id):w.remove(h.id));for(let u of(0,f.UM)(c.removed))u.typeName===t&&w.remove(u.id)}let _=w.get();return _?(0,g.qo)(_.value,_.diff):c},{historyLength:50})}exec(t,c){let u=executeQuery(this,t,c);if(0===u.size)return g.LZ;let h=this.atoms.value;return[...u].map(t=>h[t].value)}};function devFreeze(t){return t}let Store=class Store{id=nanoid();atoms=(0,g.cn)("store_atoms",{});history=(0,g.cn)("history",0,{historyLength:1e3});query=new StoreQueries(this.atoms,this.history);listeners=new Set;historyAccumulator=new HistoryAccumulator;historyReactor;schema;props;scopedTypes;constructor(t){let{initialData:c,schema:u}=t;this.schema=u,this.props=t.props,c&&this.atoms.set((0,f.Ls)((0,f.EP)(c).map(([t,c])=>[t,(0,g.cn)("atom:"+t,this.schema.validateRecord(this,c,"initialize",null))]))),this.historyReactor=(0,g.zH)("Store.historyReactor",()=>{this.history.value,this._flushHistory()},{scheduleEffect:t=>(0,f.xP)(t)}),this.scopedTypes={document:new Set((0,f.UM)(this.schema.types).filter(t=>"document"===t.scope).map(t=>t.typeName)),session:new Set((0,f.UM)(this.schema.types).filter(t=>"session"===t.scope).map(t=>t.typeName)),presence:new Set((0,f.UM)(this.schema.types).filter(t=>"presence"===t.scope).map(t=>t.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){let t=this.historyAccumulator.flush();for(let{changes:c,source:u}of t){let t=null,h=null,f=null;for(let{onHistory:g,filters:b}of this.listeners)if("all"===b.source||b.source===u){if("all"!==b.scope){if("document"===b.scope){if(!(h??=this.filterChangesByScope(c,"document")))continue;g({changes:h,source:u})}else if("session"===b.scope){if(!(t??=this.filterChangesByScope(c,"session")))continue;g({changes:t,source:u})}else{if(!(f??=this.filterChangesByScope(c,"presence")))continue;g({changes:f,source:u})}}else g({changes:c,source:u})}}}}filterChangesByScope(t,c){let u={added:(0,f.H4)(t.added,(t,u)=>this.scopedTypes[c].has(u.typeName)),updated:(0,f.H4)(t.updated,(t,u)=>this.scopedTypes[c].has(u[1].typeName)),removed:(0,f.H4)(t.removed,(t,u)=>this.scopedTypes[c].has(u.typeName))};return 0===Object.keys(u.added).length&&0===Object.keys(u.updated).length&&0===Object.keys(u.removed).length?null:u}updateHistory(t){this.historyAccumulator.add({changes:t,source:this.isMergingRemoteChanges?"remote":"user"}),0===this.listeners.size&&this.historyAccumulator.clear(),this.history.set(this.history.value+1,t)}validate(t){this.allRecords().forEach(c=>this.schema.validateRecord(this,c,t,null))}onBeforeCreate;onAfterCreate;onBeforeChange;onAfterChange;onBeforeDelete;onAfterDelete;_runCallbacks=!0;put=(t,c)=>{(0,g.ay)(()=>{let u;let h={},f={},b=this.atoms.__unsafe__getWithoutCapture(),v=null,x=!1,w=this.onBeforeCreate&&this._runCallbacks?this.onBeforeCreate:null,_=this.onBeforeChange&&this._runCallbacks?this.onBeforeChange:null,k=this.isMergingRemoteChanges?"remote":"user";for(let E=0,$=t.length;E<$;E++){u=t[E];let $=(v??b)[u.id];if($){_&&(u=_($.value,u,k));let t=$.__unsafe__getWithoutCapture();u=this.schema.validateRecord(this,u,c??"updateRecord",t),$.set(u);let f=$.__unsafe__getWithoutCapture();t!==f&&(x=!0,h[u.id]=[t,f])}else w&&(u=w(u,k)),x=!0,f[(u=this.schema.validateRecord(this,u,c??"createRecord",null)).id]=u,v||(v={...b}),v[u.id]=(0,g.cn)("atom:"+u.id,u)}if(v&&this.atoms.set(v),x&&(this.updateHistory({added:f,updated:h,removed:{}}),this._runCallbacks)){let{onAfterCreate:t,onAfterChange:c}=this;t&&Object.values(f).forEach(c=>{t(c,k)}),c&&Object.values(h).forEach(([t,u])=>{c(t,u,k)})}})};remove=t=>{(0,g.ay)(()=>{let c;let u=[],h=this.isMergingRemoteChanges?"remote":"user";if(this.onBeforeDelete&&this._runCallbacks)for(let c of t){let t=this.atoms.__unsafe__getWithoutCapture()[c];t&&!1===this.onBeforeDelete(t.value,h)&&u.push(c)}if(this.atoms.update(h=>{let f;for(let g of t)!u.includes(g)&&g in h&&(f||(f={...h}),c||(c={}),delete f[g],c[g]=h[g].value);return f??h}),c&&(this.updateHistory({added:{},updated:{},removed:c}),this.onAfterDelete&&this._runCallbacks)){let u;for(let f=0,g=t.length;f<g;f++)(u=c[t[f]])&&this.onAfterDelete(u,h)}})};get=t=>this.atoms.value[t]?.value;unsafeGetWithoutCapture=t=>this.atoms.value[t]?.__unsafe__getWithoutCapture();serialize=(t="document")=>{let c={};for(let[u,h]of(0,f.EP)(this.atoms.value)){let f=h.value;("all"===t||this.scopedTypes[t].has(f.typeName))&&(c[u]=f)}return c};getSnapshot(t="document"){return{store:this.serialize(t),schema:this.schema.serialize()}}migrateSnapshot(t){let c=this.schema.migrateStoreSnapshot(t);if("error"===c.type)throw Error(`Failed to migrate snapshot: ${c.reason}`);return{store:c.value,schema:this.schema.serialize()}}loadSnapshot(t){let c=this.schema.migrateStoreSnapshot(t);if("error"===c.type)throw Error(`Failed to migrate snapshot: ${c.reason}`);(0,g.ay)(()=>{this.clear(),this.put(Object.values(c.value)),this.ensureStoreIsUsable()})}allRecords=()=>(0,f.UM)(this.atoms.value).map(t=>t.value);clear=()=>{this.remove((0,f.GH)(this.atoms.value))};update=(t,c)=>{let u=this.atoms.value[t];if(!u){console.error(`Record ${t} not found. This is probably an error`);return}this.put([c(u.__unsafe__getWithoutCapture())])};has=t=>!!this.atoms.value[t];listen=(t,c)=>{this._flushHistory();let u={onHistory:t,filters:{source:c?.source??"all",scope:c?.scope??"all"}};return this.listeners.add(u),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(u),0===this.listeners.size&&this.historyReactor.stop()}};isMergingRemoteChanges=!1;mergeRemoteChanges=t=>{if(this.isMergingRemoteChanges)return t();try{this.isMergingRemoteChanges=!0,(0,g.ay)(t)}finally{this.isMergingRemoteChanges=!1}};extractingChanges(t){let c=[],u=this.historyAccumulator.intercepting(t=>c.push(t.changes));try{return(0,g.ay)(t),squashRecordDiffs(c)}finally{u()}}applyDiff(t,c=!0){let u=this._runCallbacks;try{this._runCallbacks=c,(0,g.ay)(()=>{let c=(0,f.UM)(t.added).concat((0,f.UM)(t.updated).map(([t,c])=>c)),u=(0,f.GH)(t.removed);c.length&&this.put(c),u.length&&this.remove(u)})}finally{this._runCallbacks=u}}createComputedCache=(t,c,u)=>{let h=new Cache;return{get:f=>{let b=this.atoms.value[f];if(b)return h.get(b,()=>{let h=u?(0,g.Fl)(b.name+":equals",()=>b.value,{isEqual:u}):b;return(0,g.Fl)(t+":"+f,()=>c(h.value))}).value}}};createSelectedComputedCache=(t,c,u)=>{let h=new Cache;return{get:f=>{let b=this.atoms.value[f];if(!b)return;let v=(0,g.Fl)(t+":"+f+":selector",()=>c(b.value));return h.get(b,()=>(0,g.Fl)(t+":"+f,()=>u(v.value))).value}}};getRecordType=t=>{let c=this.schema.types[t.typeName];if(!c)throw Error(`Record type ${t.typeName} not found`);return c};_integrityChecker;ensureStoreIsUsable(){this._integrityChecker??=this.schema.createIntegrityChecker(this),this._integrityChecker?.()}_isPossiblyCorrupted=!1;markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}};function squashRecordDiffs(t){let c={added:{},removed:{},updated:{}};for(let u of t){for(let[t,h]of(0,f.EP)(u.added))if(c.removed[t]){let u=c.removed[t];delete c.removed[t],u!==h&&(c.updated[t]=[u,h])}else c.added[t]=h;for(let[t,[h,g]]of(0,f.EP)(u.updated)){if(c.added[t]){c.added[t]=g,delete c.updated[t],delete c.removed[t];continue}if(c.updated[t]){c.updated[t][1]=g,delete c.removed[t];continue}c.updated[t]=u.updated[t],delete c.removed[t]}for(let[t,h]of(0,f.EP)(u.removed))c.added[t]?delete c.added[t]:c.updated[t]?(c.removed[t]=c.updated[t][0],delete c.updated[t]):c.removed[t]=h}return c}function squashHistoryEntries(t){let c;let u=[],h=t[0];for(let f=1,g=t.length;f<g;f++)c=t[f],h.source!==c.source?(u.push(h),h=c):h={source:h.source,changes:squashRecordDiffs([h.changes,c.changes])};return u.push(h),u}function reverseRecordsDiff(t){let c={added:t.removed,removed:t.added,updated:{}};for(let[u,h]of Object.values(t.updated))c.updated[u.id]=[h,u];return c}let HistoryAccumulator=class HistoryAccumulator{_history=[];_interceptors=new Set;intercepting(t){return this._interceptors.add(t),()=>{this._interceptors.delete(t)}}add(t){for(let c of(this._history.push(t),this._interceptors))c(t)}flush(){let t=squashHistoryEntries(this._history);return this._history=[],t}clear(){this._history=[]}hasChanges(){return this._history.length>0}};function isRecord(t){return"object"==typeof t&&null!==t&&"id"in t&&"typeName"in t}function defineMigrations(t){let{currentVersion:c,firstVersion:u,migrators:h={},subTypeKey:f,subTypeMigrations:g}=t;if("number"==typeof c&&"number"==typeof u){if(c===u)throw Error("Current version is equal to initial version.");if(c<u)throw Error("Current version is lower than initial version.")}return{firstVersion:u??0,currentVersion:c??0,migrators:h,subTypeKey:f,subTypeMigrations:g}}var v=((h=v||{}).IncompatibleSubtype="incompatible-subtype",h.UnknownType="unknown-type",h.TargetVersionTooNew="target-version-too-new",h.TargetVersionTooOld="target-version-too-old",h.MigrationError="migration-error",h.UnrecognizedSubtype="unrecognized-subtype",h);function getRecordVersion(t,c){let u=c.recordVersions[t.typeName];if(!u)return{rootVersion:0};if("subTypeKey"in u){let c=t[u.subTypeKey],h=u.subTypeVersions[c];return{rootVersion:u.version,subTypeVersion:h}}return{rootVersion:u.version}}function compareRecordVersions(t,c){if(t.rootVersion>c.rootVersion)return 1;if(t.rootVersion<c.rootVersion)return -1;if(null!=t.subTypeVersion&&null!=c.subTypeVersion){if(t.subTypeVersion>c.subTypeVersion)return 1;if(t.subTypeVersion<c.subTypeVersion)return -1}return 0}function migrateRecord({record:t,migrations:c,fromVersion:u,toVersion:h}){let f=u;if(!isRecord(t))throw Error("[migrateRecord] object is not a record");let{typeName:g,id:b,...v}=t,x=v;for(;f<h;){let t=f+1,u=c.migrators[t];if(!u)return{type:"error",reason:"target-version-too-new"};x=u.up(x),f=t}for(;f>h;){let t=f-1,u=c.migrators[f];if(!u)return{type:"error",reason:"target-version-too-old"};x=u.down(x),f=t}return{type:"success",value:{...x,id:b,typeName:g}}}function migrate({value:t,migrations:c,fromVersion:u,toVersion:h}){let f=u;for(;f<h;){let u=f+1,h=c.migrators[u];if(!h)return{type:"error",reason:"target-version-too-new"};t=h.up(t),f=u}for(;f>h;){let u=f-1,h=c.migrators[f];if(!h)return{type:"error",reason:"target-version-too-old"};t=h.down(t),f=u}return{type:"success",value:t}}let StoreSchema=class StoreSchema{constructor(t,c){this.types=t,this.options=c}static create(t,c){return new StoreSchema(t,c??{})}get currentStoreVersion(){return this.options.snapshotMigrations?.currentVersion??0}validateRecord(t,c,u,h){try{let t=(0,f.eg)(this.types,c.typeName);if(!t)throw Error(`Missing definition for record type ${c.typeName}`);return t.validate(c)}catch(f){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:t,record:c,phase:u,recordBefore:h,error:f});throw f}}migratePersistedRecord(t,c,u="up"){let h=(0,f.eg)(this.types,t.typeName),g=c.recordVersions[t.typeName];if(!g||!h)return{type:"error",reason:v.UnknownType};let b=h.migrations.currentVersion,x=g.version;if(b!==x){let c="up"===u?migrateRecord({record:t,migrations:h.migrations,fromVersion:x,toVersion:b}):migrateRecord({record:t,migrations:h.migrations,fromVersion:b,toVersion:x});if("error"===c.type)return c;t=c.value}if(!h.migrations.subTypeKey)return{type:"success",value:t};let w=h.migrations.subTypeMigrations?.[t[h.migrations.subTypeKey]],_="subTypeVersions"in g?g.subTypeVersions[t[h.migrations.subTypeKey]]:void 0;if(void 0===w)return{type:"error",reason:v.UnrecognizedSubtype};if(void 0===_)return{type:"error",reason:v.IncompatibleSubtype};let k="up"===u?migrateRecord({record:t,migrations:w,fromVersion:_,toVersion:w.currentVersion}):migrateRecord({record:t,migrations:w,fromVersion:w.currentVersion,toVersion:_});return"error"===k.type?k:{type:"success",value:k.value}}migrateStoreSnapshot(t){let{store:c}=t,u=this.options.snapshotMigrations;if(!u)return{type:"success",value:c};let h=u.currentVersion,g=t.schema.storeVersion??0;if(h<g)return{type:"error",reason:v.TargetVersionTooOld};if(h>g){let t=migrate({value:c,migrations:u,fromVersion:g,toVersion:h});if("error"===t.type)return t;c=t.value}let b=[];for(let u of(0,f.UM)(c)){let c=this.migratePersistedRecord(u,t.schema);if("error"===c.type)return c;c.value&&c.value!==u&&b.push(c.value)}if(b.length)for(let t of(c={...c},b))c[t.id]=t;return{type:"success",value:c}}createIntegrityChecker(t){return this.options.createIntegrityChecker?.(t)??void 0}serialize(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.currentVersion??0,recordVersions:Object.fromEntries((0,f.UM)(this.types).map(t=>[t.typeName,t.migrations.subTypeKey&&t.migrations.subTypeMigrations?{version:t.migrations.currentVersion,subTypeKey:t.migrations.subTypeKey,subTypeVersions:t.migrations.subTypeMigrations?Object.fromEntries(Object.entries(t.migrations.subTypeMigrations).map(([t,c])=>[t,c.currentVersion])):void 0}:{version:t.migrations.currentVersion}]))}}serializeEarliestVersion(){return{schemaVersion:1,storeVersion:this.options.snapshotMigrations?.firstVersion??0,recordVersions:Object.fromEntries((0,f.UM)(this.types).map(t=>[t.typeName,t.migrations.subTypeKey&&t.migrations.subTypeMigrations?{version:t.migrations.firstVersion,subTypeKey:t.migrations.subTypeKey,subTypeVersions:t.migrations.subTypeMigrations?Object.fromEntries(Object.entries(t.migrations.subTypeMigrations).map(([t,c])=>[t,c.firstVersion])):void 0}:{version:t.migrations.firstVersion}]))}}};let compareSchemas=(t,c)=>{if(t.schemaVersion>c.schemaVersion)return 1;if(t.schemaVersion<c.schemaVersion)return -1;if(t.storeVersion>c.storeVersion)return 1;if(t.storeVersion<c.storeVersion)return -1;for(let u of Object.keys(t.recordVersions)){let h=t.recordVersions[u],f=c.recordVersions[u];if(h.version>f.version)return 1;if(h.version<f.version)return -1;if("subTypeVersions"in h&&!("subTypeVersions"in f))return 1;if(!("subTypeVersions"in h)&&"subTypeVersions"in f)return -1;if("subTypeVersions"in h&&"subTypeVersions"in f)for(let t of Object.keys(h.subTypeVersions)){let c=h.subTypeVersions[t],u=f.subTypeVersions[t];if(c>u)return 1;if(c<u)return -1}}return 0}},2489:function(t,c,u){"use strict";let h,f,g,b,v;u.r(c),u.d(c,{ANIMATION_MEDIUM_MS:function(){return to.KD},ANIMATION_SHORT_MS:function(){return to.uJ},Arc2d:function(){return Arc2d},ArrayOfValidator:function(){return e2.UR},ArrowShapeArrowheadEndStyle:function(){return e0.ZJ},ArrowShapeArrowheadStartStyle:function(){return e0.TA},ArrowShapeTool:function(){return ArrowShapeTool},ArrowShapeUtil:function(){return ArrowShapeUtil},AssetRecordType:function(){return e0.Yk},AssetUrlsProvider:function(){return AssetUrlsProvider},BaseBoxShapeTool:function(){return BaseBoxShapeTool},BaseBoxShapeUtil:function(){return BaseBoxShapeUtil},BookmarkShapeUtil:function(){return BookmarkShapeUtil},Box2d:function(){return nS.No},BreakPointProvider:function(){return BreakPointProvider},Button:function(){return nU},CAMERA_SLIDE_FRICTION:function(){return to.$G},CameraRecordType:function(){return e0.AN},Canvas:function(){return Canvas},Circle2d:function(){return Circle2d},ContextMenu:function(){return ContextMenu},CubicBezier2d:function(){return CubicBezier2d},CubicSpline2d:function(){return CubicSpline2d},DEFAULT_ACCEPTED_IMG_TYPE:function(){return iM},DEFAULT_ACCEPTED_VID_TYPE:function(){return ij},DEFAULT_ANIMATION_OPTIONS:function(){return to.Xy},DOUBLE_CLICK_DURATION:function(){return to.qV},DRAG_DISTANCE:function(){return to.Sk},DefaultBackground:function(){return DefaultBackground},DefaultBrush:function(){return DefaultBrush},DefaultCollaboratorHint:function(){return DefaultCollaboratorHint},DefaultColorStyle:function(){return e0.R_},DefaultColorThemePalette:function(){return e0.qi},DefaultCursor:function(){return tr},DefaultDashStyle:function(){return e0.ci},DefaultErrorFallback:function(){return DefaultErrorFallback},DefaultFillStyle:function(){return e0.pp},DefaultFontFamilies:function(){return e0.p6},DefaultFontStyle:function(){return e0.Y8},DefaultGrid:function(){return DefaultGrid},DefaultHandle:function(){return DefaultHandle},DefaultHandles:function(){return DefaultHandles},DefaultHorizontalAlignStyle:function(){return e0.Xo},DefaultHoveredShapeIndicator:function(){return DefaultHoveredShapeIndicator},DefaultScribble:function(){return DefaultScribble},DefaultSelectionBackground:function(){return DefaultSelectionBackground},DefaultSelectionForeground:function(){return DefaultSelectionForeground},DefaultSizeStyle:function(){return e0.ST},DefaultSnapLine:function(){return DefaultSnapLine},DefaultSpinner:function(){return DefaultSpinner},DefaultSvgDefs:function(){return DefaultSvgDefs},DefaultVerticalAlignStyle:function(){return e0.HO},Dialog:function(){return L},DictValidator:function(){return e2.oy},DocumentRecordType:function(){return e0._A},DrawShapeTool:function(){return DrawShapeTool},DrawShapeUtil:function(){return DrawShapeUtil},DropdownMenu:function(){return B},EASINGS:function(){return n_.L},EMBED_DEFINITIONS:function(){return e0.Lu},EMPTY_ARRAY:function(){return eJ.LZ},EPSILON:function(){return tt.Ib},EVENT_NAME_MAP:function(){return nw.J},Edge2d:function(){return nP.W},Editor:function(){return tB.M},Ellipse2d:function(){return Ellipse2d},EmbedShapeUtil:function(){return EmbedShapeUtil},EnumStyleProp:function(){return e0.$I},EraserTool:function(){return EraserTool},ErrorBoundary:function(){return ErrorBoundary},ErrorScreen:function(){return ErrorScreen},FileHelpers:function(){return e1.P6},FrameShapeTool:function(){return FrameShapeTool},FrameShapeUtil:function(){return FrameShapeUtil},GRID_STEPS:function(){return to.dW},GeoShapeGeoStyle:function(){return e0.Zu},GeoShapeTool:function(){return GeoShapeTool},GeoShapeUtil:function(){return GeoShapeUtil},Geometry2d:function(){return nk.l},Group2d:function(){return nE.m},GroupShapeUtil:function(){return ng.Q},HASH_PATTERN_ZOOM_NAMES:function(){return to.iF},HIT_TEST_MARGIN:function(){return to.wM},HTMLContainer:function(){return HTMLContainer},HandTool:function(){return HandTool},HighlightShapeTool:function(){return HighlightShapeTool},HighlightShapeUtil:function(){return HighlightShapeUtil},Icon:function(){return nz},ImageShapeUtil:function(){return ImageShapeUtil},IncrementalSetConstructor:function(){return eQ.mW},Input:function(){return oE},InstancePageStateRecordType:function(){return e0.iS},InstancePresenceRecordType:function(){return e0.AM},LANGUAGES:function(){return e0.a2},LaserTool:function(){return LaserTool},LineShapeSplineStyle:function(){return e0.t8},LineShapeTool:function(){return LineShapeTool},LineShapeUtil:function(){return LineShapeUtil},LoadingScreen:function(){return LoadingScreen},MAX_PAGES:function(){return to.Et},MAX_SHAPES_PER_PAGE:function(){return to.kx},MAX_ZOOM:function(){return to.sZ},MIN_ZOOM:function(){return to.Zj},MULTI_CLICK_DURATION:function(){return to.Pz},Matrix2d:function(){return t$.y},MediaHelpers:function(){return e1.xe},MigrationFailureReason:function(){return eQ.qx},NoteShapeTool:function(){return NoteShapeTool},NoteShapeUtil:function(){return NoteShapeUtil},ObjectValidator:function(){return e2.kx},OfflineIndicator:function(){return OfflineIndicator},OptionalErrorBoundary:function(){return OptionalErrorBoundary},PI:function(){return tt.PI},PI2:function(){return tt.yo},PageRecordType:function(){return e0.ez},PngHelpers:function(){return e1.bM},PointerRecordType:function(){return e0.zh},Polygon2d:function(){return n$.w},Polyline2d:function(){return nC.q},PositionedOnCanvas:function(){return nc},ROTATE_CORNER_TO_SELECTION_CORNER:function(){return nS.rf},ReadonlySharedStyleMap:function(){return nT._},RecordType:function(){return eQ.oX},Rectangle2d:function(){return nh.z},Result:function(){return e1.x4},SIN:function(){return tt.dv},SVGContainer:function(){return nu.g},SVG_PADDING:function(){return to.s_},SelectTool:function(){return SelectTool},ShapeIndicator:function(){return te},ShapeUtil:function(){return nf.E},SharedStyleMap:function(){return nT.o},SnapManager:function(){return np.f},Spinner:function(){return Spinner},Stadium2d:function(){return Stadium2d},StateNode:function(){return nx.n},Store:function(){return eQ.yh},StoreSchema:function(){return eQ.sS},StyleProp:function(){return e0.fV},T:function(){return e2.T},TAB_ID:function(){return tq},TAU:function(){return tt.gc},TLDOCUMENT_ID:function(){return e0.G4},TLDRAW_FILE_EXTENSION:function(){return lw},TLINSTANCE_ID:function(){return e0.PQ},TLPOINTER_ID:function(){return e0.LV},TL_CANVAS_UI_COLOR_TYPES:function(){return e0.z},TextShapeTool:function(){return TextShapeTool},TextShapeUtil:function(){return TextShapeUtil},Tldraw:function(){return Tldraw},TldrawEditor:function(){return ns},TldrawUi:function(){return sQ},TldrawUiContextProvider:function(){return TldrawUiContextProvider},USER_COLORS:function(){return nd.A6},UiEventsProvider:function(){return UiEventsProvider},UnionValidator:function(){return e2.zr},Validator:function(){return e2.cX},Vec2d:function(){return tn.G},VideoShapeUtil:function(){return VideoShapeUtil},WeakMapCache:function(){return nI._},ZOOMS:function(){return to.E},ZoomTool:function(){return ZoomTool},angleDelta:function(){return tt.Cc},annotateError:function(){return e1.lw},applyRotationToSnapshotShapes:function(){return nD.Z},approximately:function(){return tt.C2},areAnglesCompatible:function(){return tt._G},arrowShapeMigrations:function(){return e0.Vm},arrowShapeProps:function(){return e0.si},assert:function(){return e1.hu},assertExists:function(){return e1.kP},assertIdType:function(){return eQ.lS},assetIdValidator:function(){return e0._3},assetMigrations:function(){return e0.TD},assetValidator:function(){return e0.$A},atom:function(){return eJ.cn},average:function(){return tt.Y8},bookmarkShapeMigrations:function(){return e0.h9},bookmarkShapeProps:function(){return e0.qU},box2dModelValidator:function(){return e0.tF},buildFromV1Document:function(){return buildFromV1Document},canonicalizeRotation:function(){return tt.f5},canvasUiColorTypeValidator:function(){return e0.MN},clamp:function(){return tt.uZ},clampRadians:function(){return tt.Ci},clockwiseAngleDist:function(){return tt.VK},compact:function(){return e1.oA},compactMenuItems:function(){return compactMenuItems},compareRecordVersions:function(){return eQ.ix},compareSchemas:function(){return eQ.$F},computed:function(){return eJ.Fl},containBoxSize:function(){return containBoxSize},coreShapes:function(){return nr.u},createAssetValidator:function(){return e0.tL},createPresenceStateDerivation:function(){return e0.GP},createRecordType:function(){return eQ.ju},createSessionStateSnapshotSignal:function(){return createSessionStateSnapshotSignal},createShapeId:function(){return e0.F1},createShapeValidator:function(){return e0.JY},createTLSchema:function(){return e0.HH},createTLStore:function(){return createTLStore},createTLUser:function(){return tz.L},dataUrlToFile:function(){return nA.B},debounce:function(){return e1.Ds},debugFlags:function(){return e4},dedupe:function(){return e1.D8},deepCopy:function(){return e1.p$},defaultShapeTools:function(){return iO},defaultShapeUtils:function(){return i3},defaultTools:function(){return i9},defaultUserPreferences:function(){return nd.ks},defineMigrations:function(){return eQ.zn},degreesToRadians:function(){return tt.Ht},devFreeze:function(){return eQ.ZV},drawShapeMigrations:function(){return e0._l},drawShapeProps:function(){return e0.wu},embedShapeMigrations:function(){return e0.BF},embedShapePermissionDefaults:function(){return e0.gB},embedShapeProps:function(){return e0.DW},exhaustiveSwitchError:function(){return e1.iP},extractSessionStateFromLegacySnapshot:function(){return extractSessionStateFromLegacySnapshot},featureFlags:function(){return e5},filterEntries:function(){return e1.H4},findMenuItem:function(){return findMenuItem},frameShapeMigrations:function(){return e0.gR},frameShapeProps:function(){return e0.k7},geoShapeMigrations:function(){return e0.P3},geoShapeProps:function(){return e0.eG},getArcLength:function(){return tt.Pl},getArrowTerminalsInArrowSpace:function(){return ny.Qs},getArrowheadPathForType:function(){return getArrowheadPathForType},getCursor:function(){return getCursor},getCurvedArrowHandlePath:function(){return nb.dz},getDefaultColorTheme:function(){return e0.y6},getDefaultTranslationLocale:function(){return e0.Bz},getEmbedInfo:function(){return getEmbedInfo},getErrorAnnotations:function(){return e1.wi},getFirstFromIterable:function(){return e1.lr},getFreshUserPreferences:function(){return nd.MO},getHashForObject:function(){return e1.pT},getHashForString:function(){return e1.jK},getIncrementedName:function(){return nM.u},getIndexAbove:function(){return nj._L},getIndexBelow:function(){return nj.Xg},getIndexBetween:function(){return nj.eI},getIndices:function(){return nj.H$},getIndicesAbove:function(){return nj.vw},getIndicesBelow:function(){return nj.dk},getIndicesBetween:function(){return nj.Xv},getOwnProperty:function(){return e1.eg},getPointOnCircle:function(){return tt.XD},getPointerInfo:function(){return getPointerInfo},getPolygonVertices:function(){return tt.Oe},getRecordVersion:function(){return eQ.C$},getResizedImageDataUrl:function(){return getResizedImageDataUrl},getRotationSnapshot:function(){return nD.o},getShapePropKeysByStyle:function(){return e0.DR},getSolidCurvedArrowPath:function(){return nb.t9},getSolidStraightArrowPath:function(){return nv.N7},getStarBounds:function(){return tt.LP},getStraightArrowHandlePath:function(){return nv.$w},getSvgPathFromPoints:function(){return getSvgPathFromPoints_getSvgPathFromPoints},getSweep:function(){return tt.hQ},getUserPreferences:function(){return nd.JM},groupShapeMigrations:function(){return e0.c4},groupShapeProps:function(){return e0.A7},hardReset:function(){return hardReset},hardResetEditor:function(){return hardResetEditor},hasOwnProperty:function(){return e1.nr},highlightShapeMigrations:function(){return e0.J1},highlightShapeProps:function(){return e0.VW},idValidator:function(){return e0.yd},imageShapeMigrations:function(){return e0.y5},imageShapeProps:function(){return e0.Fc},intersectLineSegmentPolygon:function(){return nm.qZ},intersectLineSegmentPolyline:function(){return nm.Gc},intersectPolygonPolygon:function(){return nm.tY},isAngleBetween:function(){return tt.FO},isDefined:function(){return e1.$K},isGifAnimated:function(){return isGifAnimated},isNonNull:function(){return e1.GT},isNonNullish:function(){return e1.cF},isPageId:function(){return e0.r5},isSafeFloat:function(){return tt.AV},isShape:function(){return e0.VV},isShapeId:function(){return e0.YT},isValidUrl:function(){return e1.jv},last:function(){return e1.Z$},lerp:function(){return e1.t7},lerpAngles:function(){return tt.M7},lineShapeMigrations:function(){return e0.FH},lineShapeProps:function(){return e0.BG},linesIntersect:function(){return nm.cB},lns:function(){return e1.L8},loadSessionStateSnapshotIntoStore:function(){return loadSessionStateSnapshotIntoStore},longAngleDist:function(){return tt.yE},loopToHtmlElement:function(){return loopToHtmlElement},mapObjectMapValues:function(){return e1.Fm},menuCustom:function(){return menuCustom},menuGroup:function(){return menuGroup},menuItem:function(){return menuItem},menuSubmenu:function(){return menuSubmenu},migrate:function(){return eQ.Te},migrateRecord:function(){return eQ.wJ},minBy:function(){return e1.F},modulate:function(){return e1.vm},noop:function(){return e1.ZT},normalizeWheel:function(){return normalizeWheel},noteShapeMigrations:function(){return e0.C_},noteShapeProps:function(){return e0.m0},objectMapEntries:function(){return e1.EP},objectMapFromEntries:function(){return e1.Ls},objectMapKeys:function(){return e1.GH},objectMapValues:function(){return e1.UM},omitFromStackTrace:function(){return e1.fP},opacityValidator:function(){return e0.jm},openWindow:function(){return openWindow},pageIdValidator:function(){return e0.CF},parentIdValidator:function(){return e0.Mv},parseAndLoadDocument:function(){return parseAndLoadDocument},parseTldrawJsonFile:function(){return parseTldrawJsonFile},partition:function(){return e1.uK},perimeterOfEllipse:function(){return tt.Rp},pointInBounds:function(){return tt.wM},pointInCircle:function(){return tt.mD},pointInEllipse:function(){return tt.WU},pointInPolygon:function(){return tt.Of},pointInPolyline:function(){return tt.V7},pointInRect:function(){return tt.qr},pointNearToLineSegment:function(){return tt.KP},pointNearToPolyline:function(){return tt.Xh},polygonsIntersect:function(){return nm.UQ},precise:function(){return tt.Yk},preventDefault:function(){return preventDefault},promiseWithResolve:function(){return e1.un},radiansToDegrees:function(){return tt.vi},rafThrottle:function(){return e1.TE},rangeIntersection:function(){return tt.mW},react:function(){return eJ.Ym},refreshPage:function(){return refreshPage},releasePointerCapture:function(){return releasePointerCapture},resizeBox:function(){return resizeBox},reverseRecordsDiff:function(){return eQ.kJ},rng:function(){return e1.Vk},rootShapeMigrations:function(){return e0.cL},rotateArray:function(){return e1.R8},rotateSelectionHandle:function(){return nS.dC},runtime:function(){return ti},scribbleValidator:function(){return e0.gw},serializeTldrawJson:function(){return serializeTldrawJson},serializeTldrawJsonBlob:function(){return serializeTldrawJsonBlob},setDefaultEditorAssetUrls:function(){return setDefaultEditorAssetUrls},setDefaultUiAssetUrls:function(){return setDefaultUiAssetUrls},setPointerCapture:function(){return setPointerCapture},setRuntimeOverrides:function(){return setRuntimeOverrides},setUserPreferences:function(){return nd.yu},shapeIdValidator:function(){return e0.u5},shortAngleDist:function(){return tt.Z7},snapAngle:function(){return tt.nD},sortById:function(){return e1.uv},sortByIndex:function(){return nj.hl},squashRecordDiffs:function(){return eQ.bs},stopEventPropagation:function(){return stopEventPropagation},structuredClone:function(){return e1.v4},textShapeMigrations:function(){return e0.pL},textShapeProps:function(){return e0.XB},throttle:function(){return e1.P2},throttledRaf:function(){return e1.xP},toDomPrecision:function(){return tt.$Z},toFixed:function(){return tt.FH},toPrecision:function(){return tt.Zd},toolbarItem:function(){return toolbarItem},track:function(){return eJ.j},transact:function(){return eJ.ay},transaction:function(){return eJ.PS},truncateStringWithEllipsis:function(){return truncateStringWithEllipsis},uniq:function(){return uniq},uniqueId:function(){return tK.E},useActions:function(){return useActions},useActionsMenuSchema:function(){return useActionsMenuSchema},useAssetUrls:function(){return useAssetUrls},useBreakpoint:function(){return useBreakpoint},useCanRedo:function(){return useCanRedo},useCanUndo:function(){return useCanUndo},useComputed:function(){return eJ.vc},useContainer:function(){return useContainer},useContextMenuSchema:function(){return useContextMenuSchema},useCopyAs:function(){return useCopyAs},useDefaultHelpers:function(){return useDefaultHelpers},useDialogs:function(){return useDialogs},useEditor:function(){return e8.j},useExportAs:function(){return useExportAs},useHelpMenuSchema:function(){return useHelpMenuSchema},useIsCropping:function(){return useIsCropping},useIsDarkMode:function(){return useIsDarkMode},useIsEditing:function(){return useIsEditing},useKeyboardShortcuts:function(){return useKeyboardShortcuts},useKeyboardShortcutsSchema:function(){return useKeyboardShortcutsSchema},useLocalStorageState:function(){return useLocalStorageState},useLocalStore:function(){return useLocalStore},useMenuClipboardEvents:function(){return useMenuClipboardEvents},useMenuIsOpen:function(){return useMenuIsOpen},useMenuSchema:function(){return useMenuSchema},useNativeClipboardEvents:function(){return useNativeClipboardEvents},usePeerIds:function(){return usePeerIds},usePresence:function(){return usePresence},useQuickReactor:function(){return eJ.BK},useReactor:function(){return eJ.vC},useReadonly:function(){return useReadonly},useSelectionEvents:function(){return useSelectionEvents},useTLStore:function(){return useTLStore},useToasts:function(){return useToasts},useToolbarSchema:function(){return useToolbarSchema},useTools:function(){return useTools},useTransform:function(){return useTransform},useTranslation:function(){return useTranslation},useUiEvents:function(){return useUiEvents},useValue:function(){return eJ.Hg},vec2dModelValidator:function(){return e0.tn},videoShapeMigrations:function(){return e0.lY},videoShapeProps:function(){return e0.p$},whyAmIRunning:function(){return eJ.iJ}});var x,w,_,k,E,$,T,I,M,j,D,F,L={};u.r(L),u.d(L,{Body:function(){return Body},CloseButton:function(){return CloseButton},Footer:function(){return Footer},Header:function(){return Header},Title:function(){return Title}});var B={};u.r(B),u.d(B,{CheckboxItem:function(){return CheckboxItem},Content:function(){return Content},Group:function(){return Group},Indicator:function(){return Indicator},Item:function(){return Item},RadioItem:function(){return RadioItem},Root:function(){return Root},Sub:function(){return Sub},SubContent:function(){return SubContent},SubTrigger:function(){return SubTrigger},Trigger:function(){return Trigger}});var G=u(7437);function _extends(){return(_extends=Object.assign?Object.assign.bind():function(t){for(var c=1;c<arguments.length;c++){var u=arguments[c];for(var h in u)Object.prototype.hasOwnProperty.call(u,h)&&(t[h]=u[h])}return t}).apply(this,arguments)}var U=u(2265),V=u.t(U,2);function $e42e1063c40fb3ef$export$b9ecd428b558ff10(t,c,{checkForDefaultPrevented:u=!0}={}){return function(h){if(null==t||t(h),!1===u||!h.defaultPrevented)return null==c?void 0:c(h)}}function $6ed0406888f73fc4$var$setRef(t,c){"function"==typeof t?t(c):null!=t&&(t.current=c)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...t){return c=>t.forEach(t=>$6ed0406888f73fc4$var$setRef(t,c))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(...t){return(0,U.useCallback)($6ed0406888f73fc4$export$43e446d32b3d21af(...t),t)}function $c512c27ab02ef895$export$fd42f52fd3ae1109(t,c){let u=(0,U.createContext)(c);function Provider(t){let{children:c,...h}=t,f=(0,U.useMemo)(()=>h,Object.values(h));return(0,U.createElement)(u.Provider,{value:f},c)}function useContext(h){let f=(0,U.useContext)(u);if(f)return f;if(void 0!==c)return c;throw Error(`\`${h}\` must be used within \`${t}\``)}return Provider.displayName=t+"Provider",[Provider,useContext]}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(t,c=[]){let u=[];function $c512c27ab02ef895$export$fd42f52fd3ae1109(c,h){let f=(0,U.createContext)(h),g=u.length;function Provider(c){let{scope:u,children:h,...b}=c,v=(null==u?void 0:u[t][g])||f,x=(0,U.useMemo)(()=>b,Object.values(b));return(0,U.createElement)(v.Provider,{value:x},h)}function useContext(u,b){let v=(null==b?void 0:b[t][g])||f,x=(0,U.useContext)(v);if(x)return x;if(void 0!==h)return h;throw Error(`\`${u}\` must be used within \`${c}\``)}return u=[...u,h],Provider.displayName=c+"Provider",[Provider,useContext]}let createScope=()=>{let c=u.map(t=>(0,U.createContext)(t));return function(u){let h=(null==u?void 0:u[t])||c;return(0,U.useMemo)(()=>({[`__scope${t}`]:{...u,[t]:h}}),[u,h])}};return createScope.scopeName=t,[$c512c27ab02ef895$export$fd42f52fd3ae1109,$c512c27ab02ef895$var$composeContextScopes(createScope,...c)]}function $c512c27ab02ef895$var$composeContextScopes(...t){let c=t[0];if(1===t.length)return c;let createScope1=()=>{let u=t.map(t=>({useScope:t(),scopeName:t.scopeName}));return function(t){let h=u.reduce((c,{useScope:u,scopeName:h})=>{let f=u(t),g=f[`__scope${h}`];return{...c,...g}},{});return(0,U.useMemo)(()=>({[`__scope${c.scopeName}`]:h}),[h])}};return createScope1.scopeName=c.scopeName,createScope1}let K=(null==globalThis?void 0:globalThis.document)?U.useLayoutEffect:()=>{},Z=V["useId".toString()]||(()=>void 0),Y=0;function $1746a345f3d73bb7$export$f680877a34711e37(t){let[c,u]=U.useState(Z());return K(()=>{t||u(t=>null!=t?t:String(Y++))},[t]),t||(c?`radix-${c}`:"")}function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t){let c=(0,U.useRef)(t);return(0,U.useEffect)(()=>{c.current=t}),(0,U.useMemo)(()=>(...t)=>{var u;return null===(u=c.current)||void 0===u?void 0:u.call(c,...t)},[])}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:t,defaultProp:c,onChange:u=()=>{}}){let[h,f]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:c,onChange:u}),g=void 0!==t,b=g?t:h,v=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(u),x=(0,U.useCallback)(c=>{if(g){let u="function"==typeof c?c(t):c;u!==t&&v(u)}else f(c)},[g,t,f,v]);return[b,x]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:t,onChange:c}){let u=(0,U.useState)(t),[h]=u,f=(0,U.useRef)(h),g=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c);return(0,U.useEffect)(()=>{f.current!==h&&(g(h),f.current=h)},[h,f,g]),u}var X=u(4887);let J=(0,U.forwardRef)((t,c)=>{let{children:u,...h}=t,f=U.Children.toArray(u),g=f.find($5e63c961fc1ce211$var$isSlottable);if(g){let t=g.props.children,u=f.map(c=>c!==g?c:U.Children.count(t)>1?U.Children.only(null):(0,U.isValidElement)(t)?t.props.children:null);return(0,U.createElement)(Q,_extends({},h,{ref:c}),(0,U.isValidElement)(t)?(0,U.cloneElement)(t,void 0,u):null)}return(0,U.createElement)(Q,_extends({},h,{ref:c}),u)});J.displayName="Slot";let Q=(0,U.forwardRef)((t,c)=>{let{children:u,...h}=t;return(0,U.isValidElement)(u)?(0,U.cloneElement)(u,{...$5e63c961fc1ce211$var$mergeProps(h,u.props),ref:c?$6ed0406888f73fc4$export$43e446d32b3d21af(c,u.ref):u.ref}):U.Children.count(u)>1?U.Children.only(null):null});Q.displayName="SlotClone";let $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:t})=>(0,U.createElement)(U.Fragment,null,t);function $5e63c961fc1ce211$var$isSlottable(t){return(0,U.isValidElement)(t)&&t.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(t,c){let u={...c};for(let h in c){let f=t[h],g=c[h],b=/^on[A-Z]/.test(h);b?f&&g?u[h]=(...t)=>{g(...t),f(...t)}:f&&(u[h]=f):"style"===h?u[h]={...f,...g}:"className"===h&&(u[h]=[f,g].filter(Boolean).join(" "))}return{...t,...u}}let ee=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((t,c)=>{let u=(0,U.forwardRef)((t,u)=>{let{asChild:h,...f}=t,g=h?J:c;return(0,U.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,U.createElement)(g,_extends({},f,{ref:u}))});return u.displayName=`Primitive.${c}`,{...t,[c]:u}},{});function $8927f6f2acc4f386$export$6d1a0317bde7de7f(t,c){t&&(0,X.flushSync)(()=>t.dispatchEvent(c))}function $addc16e1bbe58fd0$export$3a72a57244d6e765(t,c=null==globalThis?void 0:globalThis.document){let u=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t);(0,U.useEffect)(()=>{let handleKeyDown=t=>{"Escape"===t.key&&u(t)};return c.addEventListener("keydown",handleKeyDown),()=>c.removeEventListener("keydown",handleKeyDown)},[u,c])}let et="dismissableLayer.update",en=(0,U.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),er=(0,U.forwardRef)((t,c)=>{var u;let{disableOutsidePointerEvents:f=!1,onEscapeKeyDown:g,onPointerDownOutside:b,onFocusOutside:v,onInteractOutside:x,onDismiss:w,..._}=t,k=(0,U.useContext)(en),[E,$]=(0,U.useState)(null),T=null!==(u=null==E?void 0:E.ownerDocument)&&void 0!==u?u:null==globalThis?void 0:globalThis.document,[,I]=(0,U.useState)({}),M=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>$(t)),j=Array.from(k.layers),[D]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),F=j.indexOf(D),L=E?j.indexOf(E):-1,B=k.layersWithOutsidePointerEventsDisabled.size>0,G=L>=F,V=$5cb92bef7577960e$var$usePointerDownOutside(t=>{let c=t.target,u=[...k.branches].some(t=>t.contains(c));!G||u||(null==b||b(t),null==x||x(t),t.defaultPrevented||null==w||w())},T),K=$5cb92bef7577960e$var$useFocusOutside(t=>{let c=t.target,u=[...k.branches].some(t=>t.contains(c));u||(null==v||v(t),null==x||x(t),t.defaultPrevented||null==w||w())},T);return $addc16e1bbe58fd0$export$3a72a57244d6e765(t=>{let c=L===k.layers.size-1;c&&(null==g||g(t),!t.defaultPrevented&&w&&(t.preventDefault(),w()))},T),(0,U.useEffect)(()=>{if(E)return f&&(0===k.layersWithOutsidePointerEventsDisabled.size&&(h=T.body.style.pointerEvents,T.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(E)),k.layers.add(E),$5cb92bef7577960e$var$dispatchUpdate(),()=>{f&&1===k.layersWithOutsidePointerEventsDisabled.size&&(T.body.style.pointerEvents=h)}},[E,T,f,k]),(0,U.useEffect)(()=>()=>{E&&(k.layers.delete(E),k.layersWithOutsidePointerEventsDisabled.delete(E),$5cb92bef7577960e$var$dispatchUpdate())},[E,k]),(0,U.useEffect)(()=>{let handleUpdate=()=>I({});return document.addEventListener(et,handleUpdate),()=>document.removeEventListener(et,handleUpdate)},[]),(0,U.createElement)(ee.div,_extends({},_,{ref:M,style:{pointerEvents:B?G?"auto":"none":void 0,...t.style},onFocusCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocusCapture,K.onFocusCapture),onBlurCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onBlurCapture,K.onBlurCapture),onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDownCapture,V.onPointerDownCapture)}))}),ei=(0,U.forwardRef)((t,c)=>{let u=(0,U.useContext)(en),h=(0,U.useRef)(null),f=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,h);return(0,U.useEffect)(()=>{let t=h.current;if(t)return u.branches.add(t),()=>{u.branches.delete(t)}},[u.branches]),(0,U.createElement)(ee.div,_extends({},t,{ref:f}))});function $5cb92bef7577960e$var$usePointerDownOutside(t,c=null==globalThis?void 0:globalThis.document){let u=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t),h=(0,U.useRef)(!1),f=(0,U.useRef)(()=>{});return(0,U.useEffect)(()=>{let handlePointerDown=t=>{if(t.target&&!h.current){let h={originalEvent:t};function handleAndDispatchPointerDownOutsideEvent(){$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.pointerDownOutside",u,h,{discrete:!0})}"touch"===t.pointerType?(c.removeEventListener("click",f.current),f.current=handleAndDispatchPointerDownOutsideEvent,c.addEventListener("click",f.current,{once:!0})):handleAndDispatchPointerDownOutsideEvent()}else c.removeEventListener("click",f.current);h.current=!1},t=window.setTimeout(()=>{c.addEventListener("pointerdown",handlePointerDown)},0);return()=>{window.clearTimeout(t),c.removeEventListener("pointerdown",handlePointerDown),c.removeEventListener("click",f.current)}},[c,u]),{onPointerDownCapture:()=>h.current=!0}}function $5cb92bef7577960e$var$useFocusOutside(t,c=null==globalThis?void 0:globalThis.document){let u=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t),h=(0,U.useRef)(!1);return(0,U.useEffect)(()=>{let handleFocus=t=>{t.target&&!h.current&&$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.focusOutside",u,{originalEvent:t},{discrete:!1})};return c.addEventListener("focusin",handleFocus),()=>c.removeEventListener("focusin",handleFocus)},[c,u]),{onFocusCapture:()=>h.current=!0,onBlurCapture:()=>h.current=!1}}function $5cb92bef7577960e$var$dispatchUpdate(){let t=new CustomEvent(et);document.dispatchEvent(t)}function $5cb92bef7577960e$var$handleAndDispatchCustomEvent(t,c,u,{discrete:h}){let f=u.originalEvent.target,g=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:u});c&&f.addEventListener(t,c,{once:!0}),h?$8927f6f2acc4f386$export$6d1a0317bde7de7f(f,g):f.dispatchEvent(g)}let eo="focusScope.autoFocusOnMount",ea="focusScope.autoFocusOnUnmount",es={bubbles:!1,cancelable:!0},el=(0,U.forwardRef)((t,c)=>{let{loop:u=!1,trapped:h=!1,onMountAutoFocus:f,onUnmountAutoFocus:g,...b}=t,[v,x]=(0,U.useState)(null),w=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(f),_=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g),k=(0,U.useRef)(null),E=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>x(t)),$=(0,U.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,U.useEffect)(()=>{if(h){function handleFocusIn(t){if($.paused||!v)return;let c=t.target;v.contains(c)?k.current=c:$d3863c46a17e8a28$var$focus(k.current,{select:!0})}function handleFocusOut(t){if($.paused||!v)return;let c=t.relatedTarget;null===c||v.contains(c)||$d3863c46a17e8a28$var$focus(k.current,{select:!0})}function handleMutations(t){let c=document.activeElement;if(c===document.body)for(let c of t)c.removedNodes.length>0&&$d3863c46a17e8a28$var$focus(v)}document.addEventListener("focusin",handleFocusIn),document.addEventListener("focusout",handleFocusOut);let t=new MutationObserver(handleMutations);return v&&t.observe(v,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",handleFocusIn),document.removeEventListener("focusout",handleFocusOut),t.disconnect()}}},[h,v,$.paused]),(0,U.useEffect)(()=>{if(v){ec.add($);let t=document.activeElement,c=v.contains(t);if(!c){let c=new CustomEvent(eo,es);v.addEventListener(eo,w),v.dispatchEvent(c),c.defaultPrevented||($d3863c46a17e8a28$var$focusFirst($d3863c46a17e8a28$var$removeLinks($d3863c46a17e8a28$var$getTabbableCandidates(v)),{select:!0}),document.activeElement===t&&$d3863c46a17e8a28$var$focus(v))}return()=>{v.removeEventListener(eo,w),setTimeout(()=>{let c=new CustomEvent(ea,es);v.addEventListener(ea,_),v.dispatchEvent(c),c.defaultPrevented||$d3863c46a17e8a28$var$focus(null!=t?t:document.body,{select:!0}),v.removeEventListener(ea,_),ec.remove($)},0)}}},[v,w,_,$]);let T=(0,U.useCallback)(t=>{if(!u&&!h||$.paused)return;let c="Tab"===t.key&&!t.altKey&&!t.ctrlKey&&!t.metaKey,f=document.activeElement;if(c&&f){let c=t.currentTarget,[h,g]=$d3863c46a17e8a28$var$getTabbableEdges(c),b=h&&g;b?t.shiftKey||f!==g?t.shiftKey&&f===h&&(t.preventDefault(),u&&$d3863c46a17e8a28$var$focus(g,{select:!0})):(t.preventDefault(),u&&$d3863c46a17e8a28$var$focus(h,{select:!0})):f===c&&t.preventDefault()}},[u,h,$.paused]);return(0,U.createElement)(ee.div,_extends({tabIndex:-1},b,{ref:E,onKeyDown:T}))});function $d3863c46a17e8a28$var$focusFirst(t,{select:c=!1}={}){let u=document.activeElement;for(let h of t)if($d3863c46a17e8a28$var$focus(h,{select:c}),document.activeElement!==u)return}function $d3863c46a17e8a28$var$getTabbableEdges(t){let c=$d3863c46a17e8a28$var$getTabbableCandidates(t),u=$d3863c46a17e8a28$var$findVisible(c,t),h=$d3863c46a17e8a28$var$findVisible(c.reverse(),t);return[u,h]}function $d3863c46a17e8a28$var$getTabbableCandidates(t){let c=[],u=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{let c="INPUT"===t.tagName&&"hidden"===t.type;return t.disabled||t.hidden||c?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;u.nextNode();)c.push(u.currentNode);return c}function $d3863c46a17e8a28$var$findVisible(t,c){for(let u of t)if(!$d3863c46a17e8a28$var$isHidden(u,{upTo:c}))return u}function $d3863c46a17e8a28$var$isHidden(t,{upTo:c}){if("hidden"===getComputedStyle(t).visibility)return!0;for(;t&&(void 0===c||t!==c);){if("none"===getComputedStyle(t).display)return!0;t=t.parentElement}return!1}function $d3863c46a17e8a28$var$isSelectableInput(t){return t instanceof HTMLInputElement&&"select"in t}function $d3863c46a17e8a28$var$focus(t,{select:c=!1}={}){if(t&&t.focus){let u=document.activeElement;t.focus({preventScroll:!0}),t!==u&&$d3863c46a17e8a28$var$isSelectableInput(t)&&c&&t.select()}}let ec=$d3863c46a17e8a28$var$createFocusScopesStack();function $d3863c46a17e8a28$var$createFocusScopesStack(){let t=[];return{add(c){let u=t[0];c!==u&&(null==u||u.pause()),(t=$d3863c46a17e8a28$var$arrayRemove(t,c)).unshift(c)},remove(c){var u;null===(u=(t=$d3863c46a17e8a28$var$arrayRemove(t,c))[0])||void 0===u||u.resume()}}}function $d3863c46a17e8a28$var$arrayRemove(t,c){let u=[...t],h=u.indexOf(c);return -1!==h&&u.splice(h,1),u}function $d3863c46a17e8a28$var$removeLinks(t){return t.filter(t=>"A"!==t.tagName)}let eu=(0,U.forwardRef)((t,c)=>{var u;let{container:h=null==globalThis?void 0:null===(u=globalThis.document)||void 0===u?void 0:u.body,...f}=t;return h?X.createPortal((0,U.createElement)(ee.div,_extends({},f,{ref:c})),h):null});function $fe963b355347cc68$export$3e6543de14f8614f(t,c){return(0,U.useReducer)((t,u)=>{let h=c[t][u];return null!=h?h:t},t)}let $921a889cee6df7e8$export$99c2b779aa4e8b8b=t=>{let{present:c,children:u}=t,h=$921a889cee6df7e8$var$usePresence(c),f="function"==typeof u?u({present:h.isPresent}):U.Children.only(u),g=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(h.ref,f.ref),b="function"==typeof u;return b||h.isPresent?(0,U.cloneElement)(f,{ref:g}):null};function $921a889cee6df7e8$var$usePresence(t){let[c,u]=(0,U.useState)(),h=(0,U.useRef)({}),f=(0,U.useRef)(t),g=(0,U.useRef)("none"),b=t?"mounted":"unmounted",[v,x]=$fe963b355347cc68$export$3e6543de14f8614f(b,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,U.useEffect)(()=>{let t=$921a889cee6df7e8$var$getAnimationName(h.current);g.current="mounted"===v?t:"none"},[v]),K(()=>{let c=h.current,u=f.current,b=u!==t;if(b){let h=g.current,b=$921a889cee6df7e8$var$getAnimationName(c);t?x("MOUNT"):"none"===b||(null==c?void 0:c.display)==="none"?x("UNMOUNT"):u&&h!==b?x("ANIMATION_OUT"):x("UNMOUNT"),f.current=t}},[t,x]),K(()=>{if(c){let handleAnimationEnd=t=>{let u=$921a889cee6df7e8$var$getAnimationName(h.current),f=u.includes(t.animationName);t.target===c&&f&&(0,X.flushSync)(()=>x("ANIMATION_END"))},handleAnimationStart=t=>{t.target===c&&(g.current=$921a889cee6df7e8$var$getAnimationName(h.current))};return c.addEventListener("animationstart",handleAnimationStart),c.addEventListener("animationcancel",handleAnimationEnd),c.addEventListener("animationend",handleAnimationEnd),()=>{c.removeEventListener("animationstart",handleAnimationStart),c.removeEventListener("animationcancel",handleAnimationEnd),c.removeEventListener("animationend",handleAnimationEnd)}}x("ANIMATION_END")},[c,x]),{isPresent:["mounted","unmountSuspended"].includes(v),ref:(0,U.useCallback)(t=>{t&&(h.current=getComputedStyle(t)),u(t)},[])}}function $921a889cee6df7e8$var$getAnimationName(t){return(null==t?void 0:t.animationName)||"none"}$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";let ed=0;function $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(){(0,U.useEffect)(()=>{var t,c;let u=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(t=u[0])&&void 0!==t?t:$3db38b7d1fb3fe6a$var$createFocusGuard()),document.body.insertAdjacentElement("beforeend",null!==(c=u[1])&&void 0!==c?c:$3db38b7d1fb3fe6a$var$createFocusGuard()),ed++,()=>{1===ed&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),ed--}},[])}function $3db38b7d1fb3fe6a$var$createFocusGuard(){let t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var __assign=function(){return(__assign=Object.assign||function(t){for(var c,u=1,h=arguments.length;u<h;u++)for(var f in c=arguments[u])Object.prototype.hasOwnProperty.call(c,f)&&(t[f]=c[f]);return t}).apply(this,arguments)};function __rest(t,c){var u={};for(var h in t)Object.prototype.hasOwnProperty.call(t,h)&&0>c.indexOf(h)&&(u[h]=t[h]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var f=0,h=Object.getOwnPropertySymbols(t);f<h.length;f++)0>c.indexOf(h[f])&&Object.prototype.propertyIsEnumerable.call(t,h[f])&&(u[h[f]]=t[h[f]]);return u}function __spreadArray(t,c,u){if(u||2==arguments.length)for(var h,f=0,g=c.length;f<g;f++)!h&&f in c||(h||(h=Array.prototype.slice.call(c,0,f)),h[f]=c[f]);return t.concat(h||Array.prototype.slice.call(c))}"function"==typeof SuppressedError&&SuppressedError;var ep="right-scroll-bar-position",eh="width-before-scroll-bar";function assignRef(t,c){return"function"==typeof t?t(c):t&&(t.current=c),t}function useCallbackRef(t,c){var u=(0,U.useState)(function(){return{value:t,callback:c,facade:{get current(){return u.value},set current(value){var h=u.value;h!==value&&(u.value=value,u.callback(value,h))}}}})[0];return u.callback=c,u.facade}function useMergeRefs(t,c){return useCallbackRef(c||null,function(c){return t.forEach(function(t){return assignRef(t,c)})})}function ItoI(t){return t}var ef=(void 0===x&&(x={}),(w=function innerCreateMedium(t,c){void 0===c&&(c=ItoI);var u=[],h=!1;return{read:function(){if(h)throw Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return u.length?u[u.length-1]:t},useMedium:function(t){var f=c(t,h);return u.push(f),function(){u=u.filter(function(t){return t!==f})}},assignSyncMedium:function(t){for(h=!0;u.length;){var c=u;u=[],c.forEach(t)}u={push:function(c){return t(c)},filter:function(){return u}}},assignMedium:function(t){h=!0;var c=[];if(u.length){var f=u;u=[],f.forEach(t),c=u}var executeQueue=function(){var u=c;c=[],u.forEach(t)},cycle=function(){return Promise.resolve().then(executeQueue)};cycle(),u={push:function(t){c.push(t),cycle()},filter:function(t){return c=c.filter(t),u}}}}}(null)).options=__assign({async:!0,ssr:!1},x),w),nothing=function(){},eg=U.forwardRef(function(t,c){var u=U.useRef(null),h=U.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),f=h[0],g=h[1],b=t.forwardProps,v=t.children,x=t.className,w=t.removeScrollBar,_=t.enabled,k=t.shards,E=t.sideCar,$=t.noIsolation,T=t.inert,I=t.allowPinchZoom,M=t.as,j=void 0===M?"div":M,D=__rest(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),F=useMergeRefs([u,c]),L=__assign(__assign({},D),f);return U.createElement(U.Fragment,null,_&&U.createElement(E,{sideCar:ef,removeScrollBar:w,shards:k,noIsolation:$,inert:T,setCallbacks:g,allowPinchZoom:!!I,lockRef:u}),b?U.cloneElement(U.Children.only(v),__assign(__assign({},L),{ref:F})):U.createElement(j,__assign({},L,{className:x,ref:F}),v))});eg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1},eg.classNames={fullWidth:eh,zeroRight:ep};var SideCar=function(t){var c=t.sideCar,u=__rest(t,["sideCar"]);if(!c)throw Error("Sidecar: please provide `sideCar` property to import the right car");var h=c.read();if(!h)throw Error("Sidecar medium not found");return U.createElement(h,__assign({},u))};function exportSidecar(t,c){return t.useMedium(c),SideCar}function makeStyleTag(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var c=F||u.nc;return c&&t.setAttribute("nonce",c),t}function injectStyles(t,c){t.styleSheet?t.styleSheet.cssText=c:t.appendChild(document.createTextNode(c))}function insertStyleTag(t){(document.head||document.getElementsByTagName("head")[0]).appendChild(t)}SideCar.isSideCarExport=!0;var stylesheetSingleton=function(){var t=0,c=null;return{add:function(u){0==t&&(c=makeStyleTag())&&(injectStyles(c,u),insertStyleTag(c)),t++},remove:function(){--t||!c||(c.parentNode&&c.parentNode.removeChild(c),c=null)}}},styleHookSingleton=function(){var t=stylesheetSingleton();return function(c,u){U.useEffect(function(){return t.add(c),function(){t.remove()}},[c&&u])}},styleSingleton=function(){var t=styleHookSingleton();return function(c){return t(c.styles,c.dynamic),null}},em={left:0,top:0,right:0,gap:0},parse=function(t){return parseInt(t||"",10)||0},getOffset=function(t){var c=window.getComputedStyle(document.body),u=c["padding"===t?"paddingLeft":"marginLeft"],h=c["padding"===t?"paddingTop":"marginTop"],f=c["padding"===t?"paddingRight":"marginRight"];return[parse(u),parse(h),parse(f)]},getGapWidth=function(t){if(void 0===t&&(t="margin"),"undefined"==typeof window)return em;var c=getOffset(t),u=document.documentElement.clientWidth,h=window.innerWidth;return{left:c[0],top:c[1],right:c[2],gap:Math.max(0,h-u+c[2]-c[0])}},eb=styleSingleton(),getStyles=function(t,c,u,h){var f=t.left,g=t.top,b=t.right,v=t.gap;return void 0===u&&(u="margin"),"\n  .".concat("with-scroll-bars-hidden"," {\n   overflow: hidden ").concat(h,";\n   padding-right: ").concat(v,"px ").concat(h,";\n  }\n  body {\n    overflow: hidden ").concat(h,";\n    overscroll-behavior: contain;\n    ").concat([c&&"position: relative ".concat(h,";"),"margin"===u&&"\n    padding-left: ".concat(f,"px;\n    padding-top: ").concat(g,"px;\n    padding-right: ").concat(b,"px;\n    margin-left:0;\n    margin-top:0;\n    margin-right: ").concat(v,"px ").concat(h,";\n    "),"padding"===u&&"padding-right: ".concat(v,"px ").concat(h,";")].filter(Boolean).join(""),"\n  }\n  \n  .").concat(ep," {\n    right: ").concat(v,"px ").concat(h,";\n  }\n  \n  .").concat(eh," {\n    margin-right: ").concat(v,"px ").concat(h,";\n  }\n  \n  .").concat(ep," .").concat(ep," {\n    right: 0 ").concat(h,";\n  }\n  \n  .").concat(eh," .").concat(eh," {\n    margin-right: 0 ").concat(h,";\n  }\n  \n  body {\n    ").concat("--removed-body-scroll-bar-size",": ").concat(v,"px;\n  }\n")},RemoveScrollBar=function(t){var c=t.noRelative,u=t.noImportant,h=t.gapMode,f=void 0===h?"margin":h,g=U.useMemo(function(){return getGapWidth(f)},[f]);return U.createElement(eb,{styles:getStyles(g,!c,f,u?"":"!important")})},ey=!1;if("undefined"!=typeof window)try{var ev=Object.defineProperty({},"passive",{get:function(){return ey=!0,!0}});window.addEventListener("test",ev,ev),window.removeEventListener("test",ev,ev)}catch(t){ey=!1}var ex=!!ey&&{passive:!1},elementCanBeScrolled=function(t,c){var u=window.getComputedStyle(t);return"hidden"!==u[c]&&!(u.overflowY===u.overflowX&&"TEXTAREA"!==t.tagName&&"visible"===u[c])},locationCouldBeScrolled=function(t,c){var u=c;do{if("undefined"!=typeof ShadowRoot&&u instanceof ShadowRoot&&(u=u.host),elementCouldBeScrolled(t,u)){var h=getScrollVariables(t,u);if(h[1]>h[2])return!0}u=u.parentNode}while(u&&u!==document.body);return!1},elementCouldBeScrolled=function(t,c){return"v"===t?elementCanBeScrolled(c,"overflowY"):elementCanBeScrolled(c,"overflowX")},getScrollVariables=function(t,c){return"v"===t?[c.scrollTop,c.scrollHeight,c.clientHeight]:[c.scrollLeft,c.scrollWidth,c.clientWidth]},handleScroll=function(t,c,u,h,f){var g,b=(g=window.getComputedStyle(c).direction,"h"===t&&"rtl"===g?-1:1),v=b*h,x=u.target,w=c.contains(x),_=!1,k=v>0,E=0,$=0;do{var T=getScrollVariables(t,x),I=T[0],M=T[1]-T[2]-b*I;(I||M)&&elementCouldBeScrolled(t,x)&&(E+=M,$+=I),x=x.parentNode}while(!w&&x!==document.body||w&&(c.contains(x)||c===x));return k&&(f&&0===E||!f&&v>E)?_=!0:!k&&(f&&0===$||!f&&-v>$)&&(_=!0),_},getTouchXY=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(t){return[t.deltaX,t.deltaY]},extractRef=function(t){return t&&"current"in t?t.current:t},ew=0,eS=[],e_=exportSidecar(ef,function(t){var c=U.useRef([]),u=U.useRef([0,0]),h=U.useRef(),f=U.useState(ew++)[0],g=U.useState(function(){return styleSingleton()})[0],b=U.useRef(t);U.useEffect(function(){b.current=t},[t]),U.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(f));var c=__spreadArray([t.lockRef.current],(t.shards||[]).map(extractRef),!0).filter(Boolean);return c.forEach(function(t){return t.classList.add("allow-interactivity-".concat(f))}),function(){document.body.classList.remove("block-interactivity-".concat(f)),c.forEach(function(t){return t.classList.remove("allow-interactivity-".concat(f))})}}},[t.inert,t.lockRef.current,t.shards]);var v=U.useCallback(function(t,c){if("touches"in t&&2===t.touches.length)return!b.current.allowPinchZoom;var f,g=getTouchXY(t),v=u.current,x="deltaX"in t?t.deltaX:v[0]-g[0],w="deltaY"in t?t.deltaY:v[1]-g[1],_=t.target,k=Math.abs(x)>Math.abs(w)?"h":"v";if("touches"in t&&"h"===k&&"range"===_.type)return!1;var E=locationCouldBeScrolled(k,_);if(!E)return!0;if(E?f=k:(f="v"===k?"h":"v",E=locationCouldBeScrolled(k,_)),!E)return!1;if(!h.current&&"changedTouches"in t&&(x||w)&&(h.current=f),!f)return!0;var $=h.current||f;return handleScroll($,c,t,"h"===$?x:w,!0)},[]),x=U.useCallback(function(t){if(eS.length&&eS[eS.length-1]===g){var u="deltaY"in t?getDeltaXY(t):getTouchXY(t),h=c.current.filter(function(c){var h;return c.name===t.type&&c.target===t.target&&(h=c.delta)[0]===u[0]&&h[1]===u[1]})[0];if(h&&h.should){t.cancelable&&t.preventDefault();return}if(!h){var f=(b.current.shards||[]).map(extractRef).filter(Boolean).filter(function(c){return c.contains(t.target)});(f.length>0?v(t,f[0]):!b.current.noIsolation)&&t.cancelable&&t.preventDefault()}}},[]),w=U.useCallback(function(t,u,h,f){var g={name:t,delta:u,target:h,should:f};c.current.push(g),setTimeout(function(){c.current=c.current.filter(function(t){return t!==g})},1)},[]),_=U.useCallback(function(t){u.current=getTouchXY(t),h.current=void 0},[]),k=U.useCallback(function(c){w(c.type,getDeltaXY(c),c.target,v(c,t.lockRef.current))},[]),E=U.useCallback(function(c){w(c.type,getTouchXY(c),c.target,v(c,t.lockRef.current))},[]);U.useEffect(function(){return eS.push(g),t.setCallbacks({onScrollCapture:k,onWheelCapture:k,onTouchMoveCapture:E}),document.addEventListener("wheel",x,ex),document.addEventListener("touchmove",x,ex),document.addEventListener("touchstart",_,ex),function(){eS=eS.filter(function(t){return t!==g}),document.removeEventListener("wheel",x,ex),document.removeEventListener("touchmove",x,ex),document.removeEventListener("touchstart",_,ex)}},[]);var $=t.removeScrollBar,T=t.inert;return U.createElement(U.Fragment,null,T?U.createElement(g,{styles:"\n  .block-interactivity-".concat(f," {pointer-events: none;}\n  .allow-interactivity-").concat(f," {pointer-events: all;}\n")}):null,$?U.createElement(RemoveScrollBar,{gapMode:"margin"}):null)}),ek=U.forwardRef(function(t,c){return U.createElement(eg,__assign({},t,{ref:c,sideCar:e_}))});ek.classNames=eg.classNames;var eC=new WeakMap,eP=new WeakMap,eE={},e$=0,unwrapHost=function(t){return t&&(t.host||unwrapHost(t.parentNode))},applyAttributeToOthers=function(t,c,u,h){var f=(Array.isArray(t)?t:[t]).map(function(t){if(c.contains(t))return t;var u=unwrapHost(t);return u&&c.contains(u)?u:(console.error("aria-hidden",t,"in not contained inside",c,". Doing nothing"),null)}).filter(function(t){return!!t});eE[u]||(eE[u]=new WeakMap);var g=eE[u],b=[],v=new Set,x=new Set(f),keep=function(t){!t||v.has(t)||(v.add(t),keep(t.parentNode))};f.forEach(keep);var deep=function(t){!t||x.has(t)||Array.prototype.forEach.call(t.children,function(t){if(v.has(t))deep(t);else{var c=t.getAttribute(h),f=null!==c&&"false"!==c,x=(eC.get(t)||0)+1,w=(g.get(t)||0)+1;eC.set(t,x),g.set(t,w),b.push(t),1===x&&f&&eP.set(t,!0),1===w&&t.setAttribute(u,"true"),f||t.setAttribute(h,"true")}})};return deep(c),v.clear(),e$++,function(){b.forEach(function(t){var c=eC.get(t)-1,f=g.get(t)-1;eC.set(t,c),g.set(t,f),c||(eP.has(t)||t.removeAttribute(h),eP.delete(t)),f||t.removeAttribute(u)}),--e$||(eC=new WeakMap,eC=new WeakMap,eP=new WeakMap,eE={})}},hideOthers=function(t,c,u){void 0===u&&(u="data-aria-hidden");var h=Array.from(Array.isArray(t)?t:[t]),f=c||("undefined"==typeof document?null:(Array.isArray(t)?t[0]:t).ownerDocument.body);return f?(h.push.apply(h,Array.from(f.querySelectorAll("[aria-live]"))),applyAttributeToOthers(h,f,u,"aria-hidden")):function(){return null}};let eT="Dialog",[eI,eA]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(eT),[eM,ej]=eI(eT),eD="DialogPortal",[eO,eF]=eI(eD,{forceMount:void 0}),eR="DialogOverlay",eL=(0,U.forwardRef)((t,c)=>{let u=eF(eR,t.__scopeDialog),{forceMount:h=u.forceMount,...f}=t,g=ej(eR,t.__scopeDialog);return g.modal?(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:h||g.open},(0,U.createElement)(eN,_extends({},f,{ref:c}))):null}),eN=(0,U.forwardRef)((t,c)=>{let{__scopeDialog:u,...h}=t,f=ej(eR,u);return(0,U.createElement)(ek,{as:J,allowPinchZoom:!0,shards:[f.contentRef]},(0,U.createElement)(ee.div,_extends({"data-state":$5d3850c4d0b4e6c7$var$getState(f.open)},h,{ref:c,style:{pointerEvents:"auto",...h.style}})))}),ez="DialogContent",eB=(0,U.forwardRef)((t,c)=>{let u=eF(ez,t.__scopeDialog),{forceMount:h=u.forceMount,...f}=t,g=ej(ez,t.__scopeDialog);return(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:h||g.open},g.modal?(0,U.createElement)(eG,_extends({},f,{ref:c})):(0,U.createElement)(eH,_extends({},f,{ref:c})))}),eG=(0,U.forwardRef)((t,c)=>{let u=ej(ez,t.__scopeDialog),h=(0,U.useRef)(null),f=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,u.contentRef,h);return(0,U.useEffect)(()=>{let t=h.current;if(t)return hideOthers(t)},[]),(0,U.createElement)(eU,_extends({},t,{ref:f,trapFocus:u.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onCloseAutoFocus,t=>{var c;t.preventDefault(),null===(c=u.triggerRef.current)||void 0===c||c.focus()}),onPointerDownOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDownOutside,t=>{let c=t.detail.originalEvent,u=0===c.button&&!0===c.ctrlKey,h=2===c.button||u;h&&t.preventDefault()}),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocusOutside,t=>t.preventDefault())}))}),eH=(0,U.forwardRef)((t,c)=>{let u=ej(ez,t.__scopeDialog),h=(0,U.useRef)(!1),f=(0,U.useRef)(!1);return(0,U.createElement)(eU,_extends({},t,{ref:c,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var g,b;null===(g=t.onCloseAutoFocus)||void 0===g||g.call(t,c),c.defaultPrevented||(h.current||null===(b=u.triggerRef.current)||void 0===b||b.focus(),c.preventDefault()),h.current=!1,f.current=!1},onInteractOutside:c=>{var g,b;null===(g=t.onInteractOutside)||void 0===g||g.call(t,c),c.defaultPrevented||(h.current=!0,"pointerdown"!==c.detail.originalEvent.type||(f.current=!0));let v=c.target,x=null===(b=u.triggerRef.current)||void 0===b?void 0:b.contains(v);x&&c.preventDefault(),"focusin"===c.detail.originalEvent.type&&f.current&&c.preventDefault()}}))}),eU=(0,U.forwardRef)((t,c)=>{let{__scopeDialog:u,trapFocus:h,onOpenAutoFocus:f,onCloseAutoFocus:g,...b}=t,v=ej(ez,u),x=(0,U.useRef)(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,x);return $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),(0,U.createElement)(U.Fragment,null,(0,U.createElement)(el,{asChild:!0,loop:!0,trapped:h,onMountAutoFocus:f,onUnmountAutoFocus:g},(0,U.createElement)(er,_extends({role:"dialog",id:v.contentId,"aria-describedby":v.descriptionId,"aria-labelledby":v.titleId,"data-state":$5d3850c4d0b4e6c7$var$getState(v.open)},b,{ref:w,onDismiss:()=>v.onOpenChange(!1)}))),!1)}),eV="DialogTitle",eW=(0,U.forwardRef)((t,c)=>{let{__scopeDialog:u,...h}=t,f=ej(eV,u);return(0,U.createElement)(ee.h2,_extends({id:f.titleId},h,{ref:c}))}),eK=(0,U.forwardRef)((t,c)=>{let{__scopeDialog:u,...h}=t,f=ej("DialogClose",u);return(0,U.createElement)(ee.button,_extends({type:"button"},h,{ref:c,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onClick,()=>f.onOpenChange(!1))}))});function $5d3850c4d0b4e6c7$var$getState(t){return t?"open":"closed"}let[eZ,eY]=$c512c27ab02ef895$export$fd42f52fd3ae1109("DialogTitleWarning",{contentName:ez,titleName:eV,docsSlug:"dialog"}),$5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9=t=>{let{__scopeDialog:c,children:u,open:h,defaultOpen:f,onOpenChange:g,modal:b=!0}=t,v=(0,U.useRef)(null),x=(0,U.useRef)(null),[w=!1,_]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:h,defaultProp:f,onChange:g});return(0,U.createElement)(eM,{scope:c,triggerRef:v,contentRef:x,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),titleId:$1746a345f3d73bb7$export$f680877a34711e37(),descriptionId:$1746a345f3d73bb7$export$f680877a34711e37(),open:w,onOpenChange:_,onOpenToggle:(0,U.useCallback)(()=>_(t=>!t),[_]),modal:b},u)},$5d3850c4d0b4e6c7$export$602eac185826482c=t=>{let{__scopeDialog:c,forceMount:u,children:h,container:f}=t,g=ej(eD,c);return(0,U.createElement)(eO,{scope:c,forceMount:u},U.Children.map(h,t=>(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:u||g.open},(0,U.createElement)(eu,{asChild:!0,container:f},t))))};var eX=u(4440),eJ=u(9957),eQ=u(932),e0=u(6579),e1=u(7110),e2=u(5958),e3=u(2601);let e5={},e4={preventDefaultLogging:createDebugValue("preventDefaultLogging",{defaults:{all:!1}}),pointerCaptureLogging:createDebugValue("pointerCaptureLogging",{defaults:{all:!1}}),pointerCaptureTracking:createDebugValue("pointerCaptureTracking",{defaults:{all:!1}}),pointerCaptureTrackingObject:createDebugValue("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),elementRemovalLogging:createDebugValue("elementRemovalLogging",{defaults:{all:!1}}),debugSvg:createDebugValue("debugSvg",{defaults:{all:!1}}),throwToBlob:createDebugValue("throwToBlob",{defaults:{all:!1}}),logMessages:createDebugValue("uiLog",{defaults:{all:[]}}),resetConnectionEveryPing:createDebugValue("resetConnectionEveryPing",{defaults:{all:!1}}),debugCursors:createDebugValue("debugCursors",{defaults:{all:!1}}),forceSrgb:createDebugValue("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:createDebugValue("debugGeometry",{defaults:{all:!1}}),hideShapes:createDebugValue("hideShapes",{defaults:{all:!1}})};if("undefined"!=typeof window&&(window.tldrawLog=t=>{e4.logMessages.set(e4.logMessages.value.concat(t))}),"undefined"!=typeof Element){let t=Element.prototype.removeChild;(0,eJ.Ym)("element removal logging",()=>{e4.elementRemovalLogging.value?Element.prototype.removeChild=function(c){return console.warn("[tldraw] removing child:",c),t.call(this,c)}:Element.prototype.removeChild=t})}function createDebugValue(t,{defaults:c,shouldStoreForSession:u=!0}){return createDebugValueBase({name:t,defaults:c,shouldStoreForSession:u})}function createDebugValueBase(t){let c=getDefaultValue(t),u=t.shouldStoreForSession?getStoredInitialValue(t.name):null,h=(0,eJ.cn)(`debug:${t.name}`,u??c);return"undefined"!=typeof window&&(t.shouldStoreForSession&&(0,eJ.Ym)(`debug:${t.name}`,()=>{let u=h.value;try{u===c?window.sessionStorage.removeItem(`tldraw_debug:${t.name}`):window.sessionStorage.setItem(`tldraw_debug:${t.name}`,JSON.stringify(u))}catch{}}),Object.defineProperty(window,`tldraw${t.name.replace(/^[a-z]/,t=>t.toUpperCase())}`,{get:()=>h.value,set(t){h.set(t)},configurable:!0})),Object.assign(h,t)}function getStoredInitialValue(t){try{return JSON.parse(window?.sessionStorage.getItem(`tldraw_debug:${t}`)??"null")}catch(t){return null}}function readEnv(t){try{return t()}catch{return null}}function getDefaultValue(t){let c=readEnv(()=>e3.env.TLDRAW_ENV)??readEnv(()=>e3.env.VERCEL_PUBLIC_TLDRAW_ENV)??readEnv(()=>e3.env.NEXT_PUBLIC_TLDRAW_ENV)??"production";switch(c){case"production":return t.defaults.production??t.defaults.all;case"preview":case"staging":return t.defaults.staging??t.defaults.all;default:return t.defaults.development??t.defaults.all}}function loopToHtmlElement(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return loopToHtmlElement(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}function preventDefault(t){t.preventDefault(),e4.preventDefaultLogging.value&&console.warn("preventDefault called on event:",t)}function setPointerCapture(t,c){if(t.setPointerCapture(c.pointerId),e4.pointerCaptureTracking.value){let c=e4.pointerCaptureTrackingObject.value;c.set(t,(c.get(t)??0)+1)}e4.pointerCaptureLogging.value&&console.warn("setPointerCapture called on element:",t,c)}function releasePointerCapture(t,c){if(t.hasPointerCapture(c.pointerId)){if(t.releasePointerCapture(c.pointerId),e4.pointerCaptureTracking.value){let c=e4.pointerCaptureTrackingObject.value;1===c.get(t)?c.delete(t):c.has(t)?c.set(t,c.get(t)-1):console.warn("Release without capture")}e4.pointerCaptureLogging.value&&console.warn("releasePointerCapture called on element:",t,c)}}let stopEventPropagation=t=>t.stopPropagation();function getPointerInfo(t){return t.isKilled=!0,{point:{x:t.clientX,y:t.clientY,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:t.pointerId,button:t.button,isPen:"pen"===t.pointerType}}var e8=u(3373);function useCanvasEvents(){let t=(0,e8.j)(),c=(0,U.useMemo)(function(){let c,u;return{onPointerDown:function(c){if(!c.isKilled){if(2===c.button){t.dispatch({type:"pointer",target:"canvas",name:"right_click",...getPointerInfo(c)});return}(0===c.button||1===c.button||5===c.button)&&(setPointerCapture(c.currentTarget,c),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...getPointerInfo(c)}),t.openMenus.length>0&&(document.body.click(),t.getContainer().focus()))}},onPointerMove:function(h){h.isKilled||h.clientX===c&&h.clientY===u||(c=h.clientX,u=h.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...getPointerInfo(h)}))},onPointerUp:function(h){h.isKilled||0!==h.button&&1!==h.button&&2!==h.button&&5!==h.button||(c=h.clientX,u=h.clientY,releasePointerCapture(h.currentTarget,h),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...getPointerInfo(h)}))},onPointerEnter:function(c){if(c.isKilled||t.instanceState.isPenMode&&"pen"!==c.pointerType)return;let u="mouse"===c.pointerType||"pen"===c.pointerType;t.updateInstanceState({isHoveringCanvas:!!u||null})},onPointerLeave:function(c){if(c.isKilled||t.instanceState.isPenMode&&"pen"!==c.pointerType)return;let u="mouse"===c.pointerType||"pen"===c.pointerType;t.updateInstanceState({isHoveringCanvas:!u&&null})},onDragOver:function(t){preventDefault(t)},onDrop:async function(c){if(preventDefault(c),!c.dataTransfer?.files?.length)return;let u=Array.from(c.dataTransfer.files);await t.putExternalContent({type:"files",files:u,point:t.screenToPage({x:c.clientX,y:c.clientY}),ignoreParent:!1})},onTouchStart:function(t){t.isKilled=!0,document.body.click(),preventDefault(t)},onTouchEnd:function(t){t.isKilled=!0,"A"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&preventDefault(t)},onClick:function(t){stopEventPropagation(t)}}},[t]);return c}function useCoarsePointer(){let t=(0,e8.j)();(0,U.useEffect)(()=>{if(t.environment.isFirefox&&!t.environment.isAndroid&&!t.environment.isIos){t.updateInstanceState({isCoarsePointer:!1});return}if(window.matchMedia){let c=window.matchMedia("(pointer: coarse)"),handler=()=>{t.updateInstanceState({isCoarsePointer:!!c.matches})};if(handler(),c)return c.addEventListener("change",handler),()=>c.removeEventListener("change",handler)}},[t])}let e6=(0,U.createContext)(null);function ContainerProvider({container:t,children:c}){return(0,G.jsx)(e6.Provider,{value:t,children:c})}function useContainer(){return(0,e1.kP)((0,U.useContext)(e6),"useContainer used outside of <Tldraw />")}function useDocumentEvents(){let t=(0,e8.j)(),c=useContainer(),u=(0,eJ.Hg)("isFocused",()=>t.instanceState.isFocused,[t]);(0,U.useEffect)(()=>{let c=null,updatePixelRatio=()=>{null!=c&&c();let u=`(resolution: ${window.devicePixelRatio}dppx)`,h=matchMedia(u);h.addEventListener("change",updatePixelRatio),c=()=>{h.removeEventListener("change",updatePixelRatio)},t.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return updatePixelRatio(),()=>{c?.()}},[t]),(0,U.useEffect)(()=>{if(!u)return;let handleKeyDown=u=>{if(u.altKey&&(t.isIn("zoom")||!t.root.path.value.endsWith(".idle"))&&!isFocusingInput()&&preventDefault(u),u.isKilled)return;switch(u.isKilled=!0,u.key){case"=":case"-":case"0":if(u.metaKey||u.ctrlKey){preventDefault(u);return}break;case"Tab":default:if(isFocusingInput()||t.isMenuOpen)return;break;case",":if(!isFocusingInput()&&(preventDefault(u),!t.inputs.keys.has("Comma"))){let{x:c,y:h,z:f}=t.inputs.currentScreenPoint;t.inputs.keys.add("Comma");let g={type:"pointer",name:"pointer_down",point:{x:c,y:h,z:f},shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey,pointerId:0,button:0,isPen:t.instanceState.isPenMode,target:"canvas"};t.dispatch(g);return}break;case"Escape":if((t.editingShape||t.selectedShapeIds.length>0)&&u.preventDefault(),t.openMenus.length>0)return;t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),c.focus());return}let h={type:"keyboard",name:u.repeat?"key_repeat":"key_down",key:u.key,code:u.code,shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey};t.dispatch(h)},handleKeyUp=c=>{if(c.isKilled||(c.isKilled=!0,isFocusingInput()||t.isMenuOpen))return;if(","===c.key&&(document.activeElement?.ELEMENT_NODE&&preventDefault(c),t.inputs.keys.has(c.code))){let{x:u,y:h,z:f}=t.inputs.currentScreenPoint;t.inputs.keys.delete(c.code);let g={type:"pointer",name:"pointer_up",point:{x:u,y:h,z:f},shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey,pointerId:0,button:0,isPen:t.instanceState.isPenMode,target:"canvas"};t.dispatch(g);return}let u={type:"keyboard",name:"key_up",key:c.key,code:c.code,shiftKey:c.shiftKey,altKey:c.altKey,ctrlKey:c.metaKey||c.ctrlKey};t.dispatch(u)};function handleTouchStart(u){if(c.contains(u.target)){let c=u.touches[0].pageX,h=u.touches[0].radiusX||0;(c-h<10||c+h>t.viewportScreenBounds.width-10)&&(u.target?.tagName==="BUTTON"&&u.target?.click(),preventDefault(u))}}let handleWheel=t=>{c.contains(t.target)&&(t.ctrlKey||t.metaKey)&&preventDefault(t)};return c.addEventListener("touchstart",handleTouchStart,{passive:!1}),c.addEventListener("wheel",handleWheel,{passive:!1}),document.addEventListener("gesturestart",preventDefault),document.addEventListener("gesturechange",preventDefault),document.addEventListener("gestureend",preventDefault),c.addEventListener("keydown",handleKeyDown),c.addEventListener("keyup",handleKeyUp),()=>{c.removeEventListener("touchstart",handleTouchStart),c.removeEventListener("wheel",handleWheel),document.removeEventListener("gesturestart",preventDefault),document.removeEventListener("gesturechange",preventDefault),document.removeEventListener("gestureend",preventDefault),c.removeEventListener("keydown",handleKeyDown),c.removeEventListener("keyup",handleKeyUp)}},[t,c,u])}let e7=["input","select","button","textarea"];function isFocusingInput(){let{activeElement:t}=document;return!!(t&&(t.getAttribute("contenteditable")||e7.indexOf(t.tagName.toLowerCase())>-1))}let e9={error:null};let ErrorBoundary=class ErrorBoundary extends U.Component{static getDerivedStateFromError(t){return{error:t}}state=e9;componentDidCatch(t){this.props.onError?.(t)}render(){let{error:t}=this.state;if(null!==t){let{fallback:c}=this.props;return(0,G.jsx)(c,{error:t})}return this.props.children}};function OptionalErrorBoundary({children:t,fallback:c,...u}){return null===c?(0,G.jsx)(G.Fragment,{children:t}):(0,G.jsx)(ErrorBoundary,{fallback:c,...u,children:t})}let ShapeWithPropsEquality=class ShapeWithPropsEquality{constructor(t){this.shape=t}equals(t){return this.shape?.isLocked===t?.shape?.isLocked&&this.shape?.props===t?.shape?.props&&this.shape?.meta===t?.shape?.meta}};let EvenInnererIndicator=({shape:t,util:c})=>(0,eJ.uC)("Indicator:"+t.type,()=>c.indicator(t)),InnerIndicator=({editor:t,id:c})=>{let u=(0,eJ.Hg)("shape",()=>new ShapeWithPropsEquality(t.store.get(c)),[t,c]),{ShapeIndicatorErrorFallback:h}=useEditorComponents();return!u.shape||u.shape.isLocked?null:(0,G.jsx)(OptionalErrorBoundary,{fallback:h,onError:c=>t.annotateError(c,{origin:"react.shapeIndicator",willCrashApp:!1}),children:(0,G.jsx)(EvenInnererIndicator,{shape:u.shape,util:t.getShapeUtil(u.shape)},u.shape.id)})},te=U.memo(({id:t,className:c,color:u,opacity:h})=>{let f=(0,e8.j)(),g=(0,eJ.Hg)("transform",()=>{let c=f.getShapePageTransform(t);return c?c.toCssString():""},[f,t]);return(0,G.jsx)("svg",{className:eX("tl-overlays__item",c),children:(0,G.jsx)("g",{className:"tl-shape-indicator",transform:g,stroke:u??"var(--color-selected)",opacity:h,children:(0,G.jsx)(InnerIndicator,{editor:f,id:t})})})});function DefaultBackground(){return(0,G.jsx)("div",{className:"tl-background"})}function useTransform(t,c,u,h,f,g){(0,U.useLayoutEffect)(()=>{let b=t.current;if(!b||void 0===c)return;let v=`translate(${c}px, ${u}px)`;void 0!==h&&(v+=` scale(${h})`),void 0!==f&&(v+=` rotate(${f}rad)`),g&&(v+=` translate(${g.x}px, ${g.y}px)`),b.style.transform=v})}var tt=u(6166);let DefaultBrush=({brush:t,color:c,opacity:u})=>{let h=(0,U.useRef)(null);useTransform(h,t.x,t.y);let f=(0,tt.$Z)(Math.max(1,t.w)),g=(0,tt.$Z)(Math.max(1,t.h));return(0,G.jsx)("svg",{className:"tl-overlays__item",ref:h,children:c?(0,G.jsxs)("g",{className:"tl-brush",opacity:u,children:[(0,G.jsx)("rect",{width:f,height:g,fill:c,opacity:.75}),(0,G.jsx)("rect",{width:f,height:g,fill:"none",stroke:c,opacity:.1})]}):(0,G.jsx)("rect",{className:"tl-brush tl-brush__default",width:f,height:g})})};var tn=u(6799);let DefaultCollaboratorHint=({className:t,zoom:c,point:u,color:h,viewport:f,opacity:g=1})=>{let b=(0,U.useRef)(null);return useTransform(b,(0,tt.uZ)(u.x,f.minX+5/c,f.maxX-5/c),(0,tt.uZ)(u.y,f.minY+5/c,f.maxY-5/c),1/c,tn.G.Angle(f.center,u)),(0,G.jsxs)("svg",{ref:b,className:eX("tl-overlays__item",t),children:[(0,G.jsx)("use",{href:"#cursor_hint",color:h,strokeWidth:3,stroke:"var(--color-background)"}),(0,G.jsx)("use",{href:"#cursor_hint",color:h,opacity:g})]})},tr=(0,U.memo)(({className:t,zoom:c,point:u,color:h,name:f,chatMessage:g})=>{let b=(0,U.useRef)(null);return(useTransform(b,u?.x,u?.y,1/c),u)?(0,G.jsxs)("div",{ref:b,className:eX("tl-overlays__item",t),children:[(0,G.jsx)("svg",{className:"tl-cursor",children:(0,G.jsx)("use",{href:"#cursor",color:h})}),g?(0,G.jsxs)(G.Fragment,{children:[f&&(0,G.jsx)("div",{className:"tl-nametag-title",style:{color:h},children:f}),(0,G.jsx)("div",{className:"tl-nametag-chat",style:{backgroundColor:h},children:g})]}):f&&(0,G.jsx)("div",{className:"tl-nametag",style:{backgroundColor:h},children:f})]}):null}),ti={openWindow:(t,c)=>window.open(t,c,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>await window.__tldraw__hardReset?.()};function setRuntimeOverrides(t){Object.assign(ti,t)}function hardResetEditor(){ti.hardReset()}function refreshPage(){ti.refreshPage()}function noop(){}let DefaultErrorFallback=({error:t,editor:c})=>{let u=(0,U.useRef)(null),[h,f]=(0,U.useState)(!1),[g,b]=(0,U.useState)(!1),[v,x]=(0,U.useState)(!1),w=t instanceof Error?t.message:String(t),_=t instanceof Error?t.stack:null,k=(0,eJ.Hg)("isDarkMode",()=>{try{if(c)return c.user.isDarkMode}catch{}return null},[c]),[E,$]=(0,U.useState)(null);(0,U.useLayoutEffect)(()=>{null!==k&&$(k);let t=u.current?.parentElement,c=!1;for(;t;){if(t.classList.contains("tl-theme__dark")||t.classList.contains("tl-theme__light")){c=!0;break}t=t.parentElement}if(c){$(null);return}$(window.matchMedia("(prefers-color-scheme: dark)").matches)},[k]),(0,U.useEffect)(()=>{if(g){let t=setTimeout(()=>{b(!1)},2e3);return()=>clearTimeout(t)}},[g]);let resetLocalState=async()=>{hardResetEditor()},T=new URL("https://github.com/tldraw/tldraw/issues/new");return T.searchParams.set("title",w),T.searchParams.set("labels","bug"),T.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${_??w}
\`\`\`

My browser: ${navigator.userAgent}`),(0,G.jsxs)("div",{ref:u,className:eX("tl-container tl-error-boundary",null===E?"":E?"tl-theme__dark":"tl-theme__light"),children:[(0,G.jsx)("div",{className:"tl-error-boundary__overlay"}),c&&(0,G.jsx)(ErrorBoundary,{onError:noop,fallback:()=>null,children:(0,G.jsx)(e8.r.Provider,{value:c,children:(0,G.jsx)("div",{className:"tl-overlay tl-error-boundary__canvas",children:(0,G.jsx)(Canvas,{})})})}),(0,G.jsx)("div",{className:eX("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":h&&!v}),children:v?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("h2",{children:"Are you sure?"}),(0,G.jsx)("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),(0,G.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,G.jsx)("button",{onClick:()=>x(!1),children:"Cancel"}),(0,G.jsx)("button",{className:"tl-error-boundary__reset",onClick:resetLocalState,children:"Reset data"})]})]}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("h2",{children:"Something's gone wrong."}),(0,G.jsxs)("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",(0,G.jsx)("a",{href:T.toString(),children:"create a GitHub issue"})," or"," ",(0,G.jsx)("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),h&&(0,G.jsxs)("div",{className:"tl-error-boundary__content__error",children:[(0,G.jsx)("pre",{children:(0,G.jsx)("code",{children:_??w})}),(0,G.jsx)("button",{onClick:()=>{let t=document.createElement("textarea");t.value=_??w,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove(),b(!0)},children:g?"Copied!":"Copy"})]}),(0,G.jsxs)("div",{className:"tl-error-boundary__content__actions",children:[(0,G.jsx)("button",{onClick:()=>f(!h),children:h?"Hide details":"Show details"}),(0,G.jsxs)("div",{className:"tl-error-boundary__content__actions__group",children:[(0,G.jsx)("button",{className:"tl-error-boundary__reset",onClick:()=>x(!0),children:"Reset data"}),(0,G.jsx)("button",{className:"tl-error-boundary__refresh",onClick:()=>{refreshPage()},children:"Refresh Page"})]})]})]})})]})};var to=u(7655);let DefaultGrid=({x:t,y:c,z:u,size:h})=>(0,G.jsxs)("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[(0,G.jsx)("defs",{children:to.dW.map(({min:f,mid:g,step:b},v)=>{let x=b*h*u,w=.5+t*u,_=.5+c*u,k=u<g?(0,e1.vm)(u,[f,g],[0,1]):1;return(0,G.jsx)("pattern",{id:`grid-${b}`,width:x,height:x,patternUnits:"userSpaceOnUse",children:(0,G.jsx)("circle",{className:"tl-grid-dot",cx:w>0?w%x:x+w%x,cy:_>0?_%x:x+_%x,r:1,opacity:k})},`grid-pattern-${v}`)})}),to.dW.map(({step:t},c)=>(0,G.jsx)("rect",{width:"100%",height:"100%",fill:`url(#grid-${t})`},`grid-rect-${c}`))]}),DefaultHandle=({handle:t,isCoarse:c,className:u,zoom:h})=>{let f=("create"===t.type&&c?3:4)/h;return(0,G.jsxs)("g",{className:eX("tl-handle",{"tl-handle__virtual":"virtual"===t.type,"tl-handle__create":"create"===t.type},u),children:[(0,G.jsx)("circle",{className:"tl-handle__bg",r:(c?20:12)/h}),(0,G.jsx)("circle",{className:"tl-handle__fg",r:f})]})},DefaultHandles=({children:t})=>(0,G.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:t}),DefaultHoveredShapeIndicator=({shapeId:t})=>(0,G.jsx)(te,{className:"tl-user-indicator__hovered",id:t});function getSvgPathFromPoints_getSvgPathFromPoints(t,c=!0){let u=t.length;if(u<2)return"";let h=t[0],f=t[1];if(2===u)return`M${(0,tt.Yk)(h)}L${(0,tt.Yk)(f)}`;let g="";for(let c=2,b=u-1;c<b;c++)h=t[c],f=t[c+1],g+=(0,tt.Y8)(h,f);return c?`M${(0,tt.Y8)(t[0],t[1])}Q${(0,tt.Yk)(t[1])}${(0,tt.Y8)(t[1],t[2])}T${g}${(0,tt.Y8)(t[u-1],t[0])}${(0,tt.Y8)(t[0],t[1])}Z`:`M${(0,tt.Yk)(t[0])}Q${(0,tt.Yk)(t[1])}${(0,tt.Y8)(t[1],t[2])}${t.length>3?"T":""}${g}L${(0,tt.Yk)(t[u-1])}`}let DefaultScribble=({scribble:t,zoom:c,color:u,opacity:h,className:f})=>t.points.length?(0,G.jsx)("svg",{className:f?eX("tl-overlays__item",f):f,children:(0,G.jsx)("path",{className:"tl-scribble",d:getSvgPathFromPoints_getSvgPathFromPoints(t.points,!1),stroke:u??`var(--color-${t.color})`,fill:"none",strokeWidth:8/c,opacity:h??t.opacity})}):null,DefaultSelectionBackground=({bounds:t,rotation:c})=>{let u=U.useRef(null);return useTransform(u,t.x,t.y,1,c),U.useLayoutEffect(()=>{let c=u.current;c&&(c.style.width=(0,tt.$Z)(Math.max(1,t.width))+"px",c.style.height=(0,tt.$Z)(Math.max(1,t.height))+"px")},[t.width,t.height]),(0,G.jsx)("div",{ref:u,className:"tl-selection__bg",draggable:!1})},DefaultSelectionForeground=({bounds:t,rotation:c})=>{let u=(0,e8.j)(),h=(0,U.useRef)(null),f=(0,eJ.Hg)("only selected shape",()=>u.onlySelectedShape,[u]),g=f?u.getShapeUtil(f).expandSelectionOutlinePx(f):0;return useTransform(h,t?.x,t?.y,1,c,{x:-g,y:-g}),t=t.clone().expandBy(g).zeroFix(),(0,G.jsx)("svg",{ref:h,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:(0,G.jsx)("rect",{className:eX("tl-selection__fg__outline"),width:(0,tt.$Z)(t.width),height:(0,tt.$Z)(t.height)})})},DefaultShapeErrorFallback=()=>(0,G.jsx)("div",{className:"tl-shape-error-boundary"}),DefaultShapeIndicatorErrorFallback=()=>(0,G.jsx)("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"});function PointsSnapLine({points:t,zoom:c}){let u,h,f,g;let b=2.5/c,v=t.reduce((t,c)=>Math.min(t,c.x),1/0),x=t.reduce((t,c)=>Math.max(t,c.x),-1/0),w=t.reduce((t,c)=>Math.min(t,c.y),1/0),_=t.reduce((t,c)=>Math.max(t,c.y),-1/0),k=t.some(t=>t.x===v&&t.y===w);return k?(u=v,h=w,f=x,g=_):(u=v,h=_,f=x,g=w),(0,G.jsxs)("g",{className:"tl-snap-line",children:[(0,G.jsx)("line",{x1:u,y1:h,x2:f,y2:g}),t.map((t,c)=>(0,G.jsx)("g",{transform:`translate(${t.x},${t.y})`,children:(0,G.jsx)("path",{className:"tl-snap-point",d:`M ${-b},${-b} L ${b},${b} M ${-b},${b} L ${b},${-b}`})},c))]})}function GapsSnapLine({gaps:t,direction:c,zoom:u}){let h=3.5/u,f=[-1/0,1/0],g=null,b="horizontal"===c;for(let c of t)(g=(0,tt.mW)(f[0],f[1],b?c.startEdge[0].y:c.startEdge[0].x,b?c.startEdge[1].y:c.startEdge[1].x))&&(f=g,(g=(0,tt.mW)(f[0],f[1],b?c.endEdge[0].y:c.endEdge[0].x,b?c.endEdge[1].y:c.endEdge[1].x))&&(f=g));if(null===f)return null;let v=(f[0]+f[1])/2;return(0,G.jsx)("g",{className:"tl-snap-line",children:t.map(({startEdge:t,endEdge:c},u)=>(0,G.jsx)(U.Fragment,{children:b?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("line",{x1:t[0].x,y1:v-2*h,x2:t[1].x,y2:v+2*h}),(0,G.jsx)("line",{x1:c[0].x,y1:v-2*h,x2:c[1].x,y2:v+2*h}),(0,G.jsx)("line",{x1:t[0].x,y1:v,x2:c[0].x,y2:v}),(0,G.jsx)("line",{x1:(t[0].x+c[0].x)/2,y1:v-h,x2:(t[0].x+c[0].x)/2,y2:v+h})]}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("line",{x1:v-2*h,y1:t[0].y,x2:v+2*h,y2:t[1].y}),(0,G.jsx)("line",{x1:v-2*h,y1:c[0].y,x2:v+2*h,y2:c[1].y}),(0,G.jsx)("line",{x1:v,y1:t[0].y,x2:v,y2:c[0].y}),(0,G.jsx)("line",{x1:v-h,y1:(t[0].y+c[0].y)/2,x2:v+h,y2:(t[0].y+c[0].y)/2})]})},u))})}let DefaultSnapLine=({className:t,line:c,zoom:u})=>(0,G.jsx)("svg",{className:eX("tl-overlays__item",t),children:"points"===c.type?(0,G.jsx)(PointsSnapLine,{...c,zoom:u}):"gaps"===c.type?(0,G.jsx)(GapsSnapLine,{...c,zoom:u}):null}),DefaultSpinner=()=>(0,G.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",children:(0,G.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,G.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"var(--color-text-1)"}),(0,G.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"var(--color-text-1)",children:(0,G.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})}),DefaultSvgDefs=()=>null,ta=(0,U.createContext)({});function EditorComponentsProvider({overrides:t,children:c}){return(0,G.jsx)(ta.Provider,{value:(0,U.useMemo)(()=>({Background:DefaultBackground,SvgDefs:DefaultSvgDefs,Brush:DefaultBrush,ZoomBrush:DefaultBrush,CollaboratorBrush:DefaultBrush,Cursor:tr,CollaboratorCursor:tr,CollaboratorHint:DefaultCollaboratorHint,CollaboratorShapeIndicator:te,Grid:DefaultGrid,Scribble:DefaultScribble,SnapLine:DefaultSnapLine,Handles:DefaultHandles,Handle:DefaultHandle,CollaboratorScribble:DefaultScribble,ErrorFallback:DefaultErrorFallback,ShapeErrorFallback:DefaultShapeErrorFallback,ShapeIndicatorErrorFallback:DefaultShapeIndicatorErrorFallback,Spinner:DefaultSpinner,SelectionBackground:DefaultSelectionBackground,SelectionForeground:DefaultSelectionForeground,HoveredShapeIndicator:DefaultHoveredShapeIndicator,...t}),[t]),children:c})}function useEditorComponents(){return(0,U.useContext)(ta)}let ts=["textarea","input"];function useFixSafariDoubleTapZoomPencilEvents(t){let c=(0,e8.j)();(0,U.useEffect)(()=>{let u=t.current;if(!u)return;let handleEvent=t=>{if(t instanceof PointerEvent&&"pen"===t.pointerType){t.isKilled=!0;let{target:u}=t;ts.includes(u.tagName?.toLocaleLowerCase())||c.isIn("select.editing_shape")||preventDefault(t)}};return u.addEventListener("touchstart",handleEvent),u.addEventListener("touchend",handleEvent),()=>{u.removeEventListener("touchstart",handleEvent),u.addEventListener("touchend",handleEvent)}},[c,t])}function clamp(t,c,u){return Math.max(c,Math.min(t,u))}let tl={toVector:(t,c)=>(void 0===t&&(t=c),Array.isArray(t)?t:[t,t]),add:(t,c)=>[t[0]+c[0],t[1]+c[1]],sub:(t,c)=>[t[0]-c[0],t[1]-c[1]],addTo(t,c){t[0]+=c[0],t[1]+=c[1]},subTo(t,c){t[0]-=c[0],t[1]-=c[1]}};function rubberband(t,c,u){return 0===c||Math.abs(c)===1/0?Math.pow(t,5*u):t*c*u/(c+u*t)}function rubberbandIfOutOfBounds(t,c,u,h=.15){return 0===h?clamp(t,c,u):t<c?-rubberband(c-t,u-c,h)+c:t>u?+rubberband(t-u,u-c,h)+u:t}function computeRubberband(t,[c,u],[h,f]){let[[g,b],[v,x]]=t;return[rubberbandIfOutOfBounds(c,g,b,h),rubberbandIfOutOfBounds(u,v,x,f)]}function _toPrimitive(t,c){if("object"!=typeof t||null===t)return t;var u=t[Symbol.toPrimitive];if(void 0!==u){var h=u.call(t,c||"default");if("object"!=typeof h)return h;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===c?String:Number)(t)}function _toPropertyKey(t){var c=_toPrimitive(t,"string");return"symbol"==typeof c?c:String(c)}function _defineProperty(t,c,u){return(c=_toPropertyKey(c))in t?Object.defineProperty(t,c,{value:u,enumerable:!0,configurable:!0,writable:!0}):t[c]=u,t}function ownKeys(t,c){var u=Object.keys(t);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(t);c&&(h=h.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),u.push.apply(u,h)}return u}function _objectSpread2(t){for(var c=1;c<arguments.length;c++){var u=null!=arguments[c]?arguments[c]:{};c%2?ownKeys(Object(u),!0).forEach(function(c){_defineProperty(t,c,u[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(u)):ownKeys(Object(u)).forEach(function(c){Object.defineProperty(t,c,Object.getOwnPropertyDescriptor(u,c))})}return t}let tc={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function capitalize(t){return t?t[0].toUpperCase()+t.slice(1):""}let tu=["enter","leave"];function hasCapture(t=!1,c){return t&&!tu.includes(c)}function toHandlerProp(t,c="",u=!1){let h=tc[t],f=h&&h[c]||c;return"on"+capitalize(t)+capitalize(f)+(hasCapture(u,f)?"Capture":"")}let td=["gotpointercapture","lostpointercapture"];function parseProp(t){let c=t.substring(2).toLowerCase(),u=!!~c.indexOf("passive");u&&(c=c.replace("passive",""));let h=td.includes(c)?"capturecapture":"capture",f=!!~c.indexOf(h);return f&&(c=c.replace("capture","")),{device:c,capture:f,passive:u}}function toDomEventType(t,c=""){let u=tc[t],h=u&&u[c]||c;return t+h}function isTouch(t){return"touches"in t}function getPointerType(t){return isTouch(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function getCurrentTargetTouchList(t){return Array.from(t.touches).filter(c=>{var u,h;return c.target===t.currentTarget||(null===(u=t.currentTarget)||void 0===u||null===(h=u.contains)||void 0===h?void 0:h.call(u,c.target))})}function distanceAngle(t,c){try{let u=c.clientX-t.clientX,h=c.clientY-t.clientY,f=(c.clientX+t.clientX)/2,g=(c.clientY+t.clientY)/2;return{angle:-(180*Math.atan2(u,h))/Math.PI,distance:Math.hypot(u,h),origin:[f,g]}}catch(t){}return null}function touchIds(t){return getCurrentTargetTouchList(t).map(t=>t.identifier)}function touchDistanceAngle(t,c){let[u,h]=Array.from(t.touches).filter(t=>c.includes(t.identifier));return distanceAngle(u,h)}function wheelValues(t){let{deltaX:c,deltaY:u,deltaMode:h}=t;return 1===h?(c*=40,u*=40):2===h&&(c*=800,u*=800),[c,u]}function getEventDetails(t){let c={};if("buttons"in t&&(c.buttons=t.buttons),"shiftKey"in t){let{shiftKey:u,altKey:h,metaKey:f,ctrlKey:g}=t;Object.assign(c,{shiftKey:u,altKey:h,metaKey:f,ctrlKey:g})}return c}function call(t,...c){return"function"==typeof t?t(...c):t}function actions_fe213e88_esm_noop(){}function chain(...t){return 0===t.length?actions_fe213e88_esm_noop:1===t.length?t[0]:function(){let c;for(let u of t)c=u.apply(this,arguments)||c;return c}}function assignDefault(t,c){return Object.assign({},c,t||{})}let Engine=class Engine{constructor(t,c,u){this.ctrl=t,this.args=c,this.key=u,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(t){this.ctrl.state[this.key]=t}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:t,shared:c,ingKey:u,args:h}=this;c[u]=t._active=t.active=t._blocked=t._force=!1,t._step=[!1,!1],t.intentional=!1,t._movement=[0,0],t._distance=[0,0],t._direction=[0,0],t._delta=[0,0],t._bounds=[[-1/0,1/0],[-1/0,1/0]],t.args=h,t.axis=void 0,t.memo=void 0,t.elapsedTime=t.timeDelta=0,t.direction=[0,0],t.distance=[0,0],t.overflow=[0,0],t._movementBound=[!1,!1],t.velocity=[0,0],t.movement=[0,0],t.delta=[0,0],t.timeStamp=0}start(t){let c=this.state,u=this.config;c._active||(this.reset(),this.computeInitial(),c._active=!0,c.target=t.target,c.currentTarget=t.currentTarget,c.lastOffset=u.from?call(u.from,c):c.offset,c.offset=c.lastOffset,c.startTime=c.timeStamp=t.timeStamp)}computeValues(t){let c=this.state;c._values=t,c.values=this.config.transform(t)}computeInitial(){let t=this.state;t._initial=t._values,t.initial=t.values}compute(t){let{state:c,config:u,shared:h}=this;c.args=this.args;let f=0;if(t&&(c.event=t,u.preventDefault&&t.cancelable&&c.event.preventDefault(),c.type=t.type,h.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,h.locked=!!document.pointerLockElement,Object.assign(h,getEventDetails(t)),h.down=h.pressed=h.buttons%2==1||h.touches>0,f=t.timeStamp-c.timeStamp,c.timeStamp=t.timeStamp,c.elapsedTime=c.timeStamp-c.startTime),c._active){let t=c._delta.map(Math.abs);tl.addTo(c._distance,t)}this.axisIntent&&this.axisIntent(t);let[g,b]=c._movement,[v,x]=u.threshold,{_step:w,values:_}=c;if(u.hasCustomTransform?(!1===w[0]&&(w[0]=Math.abs(g)>=v&&_[0]),!1===w[1]&&(w[1]=Math.abs(b)>=x&&_[1])):(!1===w[0]&&(w[0]=Math.abs(g)>=v&&Math.sign(g)*v),!1===w[1]&&(w[1]=Math.abs(b)>=x&&Math.sign(b)*x)),c.intentional=!1!==w[0]||!1!==w[1],!c.intentional)return;let k=[0,0];if(u.hasCustomTransform){let[t,c]=_;k[0]=!1!==w[0]?t-w[0]:0,k[1]=!1!==w[1]?c-w[1]:0}else k[0]=!1!==w[0]?g-w[0]:0,k[1]=!1!==w[1]?b-w[1]:0;this.restrictToAxis&&!c._blocked&&this.restrictToAxis(k);let E=c.offset,$=c._active&&!c._blocked||c.active;$&&(c.first=c._active&&!c.active,c.last=!c._active&&c.active,c.active=h[this.ingKey]=c._active,t&&(c.first&&("bounds"in u&&(c._bounds=call(u.bounds,c)),this.setup&&this.setup()),c.movement=k,this.computeOffset()));let[T,I]=c.offset,[[M,j],[D,F]]=c._bounds;c.overflow=[T<M?-1:T>j?1:0,I<D?-1:I>F?1:0],c._movementBound[0]=!!c.overflow[0]&&(!1===c._movementBound[0]?c._movement[0]:c._movementBound[0]),c._movementBound[1]=!!c.overflow[1]&&(!1===c._movementBound[1]?c._movement[1]:c._movementBound[1]);let L=c._active&&u.rubberband||[0,0];if(c.offset=computeRubberband(c._bounds,c.offset,L),c.delta=tl.sub(c.offset,E),this.computeMovement(),$&&(!c.last||f>32)){c.delta=tl.sub(c.offset,E);let t=c.delta.map(Math.abs);tl.addTo(c.distance,t),c.direction=c.delta.map(Math.sign),c._direction=c._delta.map(Math.sign),!c.first&&f>0&&(c.velocity=[t[0]/f,t[1]/f],c.timeDelta=f)}}emit(){let t=this.state,c=this.shared,u=this.config;if(t._active||this.clean(),(t._blocked||!t.intentional)&&!t._force&&!u.triggerAllEvents)return;let h=this.handler(_objectSpread2(_objectSpread2(_objectSpread2({},c),t),{},{[this.aliasKey]:t.values}));void 0!==h&&(t.memo=h)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}};function selectAxis([t,c],u){let h=Math.abs(t),f=Math.abs(c);return h>f&&h>u?"x":f>h&&f>u?"y":void 0}let CoordinatesEngine=class CoordinatesEngine extends Engine{constructor(...t){super(...t),_defineProperty(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=tl.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=tl.sub(this.state.offset,this.state.lastOffset)}axisIntent(t){let c=this.state,u=this.config;if(!c.axis&&t){let h="object"==typeof u.axisThreshold?u.axisThreshold[getPointerType(t)]:u.axisThreshold;c.axis=selectAxis(c._movement,h)}c._blocked=(u.lockDirection||!!u.axis)&&!c.axis||!!u.axis&&u.axis!==c.axis}restrictToAxis(t){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":t[1]=0;break;case"y":t[0]=0}}};let identity=t=>t,tp={enabled:(t=!0)=>t,eventOptions:(t,c,u)=>_objectSpread2(_objectSpread2({},u.shared.eventOptions),t),preventDefault:(t=!1)=>t,triggerAllEvents:(t=!1)=>t,rubberband(t=0){switch(t){case!0:return[.15,.15];case!1:return[0,0];default:return tl.toVector(t)}},from:t=>"function"==typeof t?t:null!=t?tl.toVector(t):void 0,transform(t,c,u){let h=t||u.shared.transform;return this.hasCustomTransform=!!h,h||identity},threshold:t=>tl.toVector(t,0)},th=0,tf=_objectSpread2(_objectSpread2({},tp),{},{axis(t,c,{axis:u}){if(this.lockDirection="lock"===u,!this.lockDirection)return u},axisThreshold:(t=th)=>t,bounds(t={}){if("function"==typeof t)return c=>tf.bounds(t(c));if("current"in t)return()=>t.current;if("function"==typeof HTMLElement&&t instanceof HTMLElement)return t;let{left:c=-1/0,right:u=1/0,top:h=-1/0,bottom:f=1/0}=t;return[[c,u],[h,f]]}}),tg="undefined"!=typeof window&&window.document&&window.document.createElement;function supportsTouchEvents(){return tg&&"ontouchstart"in window}function isTouchScreen(){return supportsTouchEvents()||tg&&window.navigator.maxTouchPoints>1}function supportsPointerEvents(){return tg&&"onpointerdown"in window}function supportsPointerLock(){return tg&&"exitPointerLock"in window.document}function supportsGestureEvents(){try{return"constructor"in GestureEvent}catch(t){return!1}}let tm={isBrowser:tg,gesture:supportsGestureEvents(),touch:supportsTouchEvents(),touchscreen:isTouchScreen(),pointer:supportsPointerEvents(),pointerLock:supportsPointerLock()},tb=10,ty={mouse:0,touch:0,pen:8};function clampStateInternalMovementToBounds(t){let[c,u]=t.overflow,[h,f]=t._delta,[g,b]=t._direction;(c<0&&h>0&&g<0||c>0&&h<0&&g>0)&&(t._movement[0]=t._movementBound[0]),(u<0&&f>0&&b<0||u>0&&f<0&&b>0)&&(t._movement[1]=t._movementBound[1])}_objectSpread2(_objectSpread2({},tf),{},{device(t,c,{pointer:{touch:u=!1,lock:h=!1,mouse:f=!1}={}}){return(this.pointerLock=h&&tm.pointerLock,tm.touch&&u)?"touch":this.pointerLock?"mouse":tm.pointer&&!f?"pointer":tm.touch?"touch":"mouse"},preventScrollAxis(t,c,{preventScroll:u}){if(this.preventScrollDelay="number"==typeof u?u:u||void 0===u&&t?250:void 0,tm.touchscreen&&!1!==u)return t||(void 0!==u?"y":void 0)},pointerCapture(t,c,{pointer:{capture:u=!0,buttons:h=1,keys:f=!0}={}}){return this.pointerButtons=h,this.keys=f,!this.pointerLock&&"pointer"===this.device&&u},threshold(t,c,{filterTaps:u=!1,tapsThreshold:h=3,axis:f}){let g=tl.toVector(t,u?h:f?1:0);return this.filterTaps=u,this.tapsThreshold=h,g},swipe({velocity:t=.5,distance:c=50,duration:u=250}={}){return{velocity:this.transform(tl.toVector(t)),distance:this.transform(tl.toVector(c)),duration:u}},delay(t=0){switch(t){case!0:return 180;case!1:return 0;default:return t}},axisThreshold:t=>t?_objectSpread2(_objectSpread2({},ty),t):ty,keyboardDisplacement:(t=tb)=>t});let PinchEngine=class PinchEngine extends Engine{constructor(...t){super(...t),_defineProperty(this,"ingKey","pinching"),_defineProperty(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();let t=this.state;t._touchIds=[],t.canceled=!1,t.cancel=this.cancel.bind(this),t.turns=0}computeOffset(){let{type:t,movement:c,lastOffset:u}=this.state;"wheel"===t?this.state.offset=tl.add(c,u):this.state.offset=[(1+c[0])*u[0],c[1]+u[1]]}computeMovement(){let{offset:t,lastOffset:c}=this.state;this.state.movement=[t[0]/c[0],t[1]-c[1]]}axisIntent(){let t=this.state,[c,u]=t._movement;if(!t.axis){let h=30*Math.abs(c)-Math.abs(u);h<0?t.axis="angle":h>0&&(t.axis="scale")}}restrictToAxis(t){this.config.lockDirection&&("scale"===this.state.axis?t[1]=0:"angle"===this.state.axis&&(t[0]=0))}cancel(){let t=this.state;t.canceled||setTimeout(()=>{t.canceled=!0,t._active=!1,this.compute(),this.emit()},0)}touchStart(t){this.ctrl.setEventIds(t);let c=this.state,u=this.ctrl.touchIds;if(c._active&&c._touchIds.every(t=>u.has(t))||u.size<2)return;this.start(t),c._touchIds=Array.from(u).slice(0,2);let h=touchDistanceAngle(t,c._touchIds);h&&this.pinchStart(t,h)}pointerStart(t){if(null!=t.buttons&&t.buttons%2!=1)return;this.ctrl.setEventIds(t),t.target.setPointerCapture(t.pointerId);let c=this.state,u=c._pointerEvents,h=this.ctrl.pointerIds;if(c._active&&Array.from(u.keys()).every(t=>h.has(t))||(u.size<2&&u.set(t.pointerId,t),c._pointerEvents.size<2))return;this.start(t);let f=distanceAngle(...Array.from(u.values()));f&&this.pinchStart(t,f)}pinchStart(t,c){let u=this.state;u.origin=c.origin,this.computeValues([c.distance,c.angle]),this.computeInitial(),this.compute(t),this.emit()}touchMove(t){if(!this.state._active)return;let c=touchDistanceAngle(t,this.state._touchIds);c&&this.pinchMove(t,c)}pointerMove(t){let c=this.state._pointerEvents;if(c.has(t.pointerId)&&c.set(t.pointerId,t),!this.state._active)return;let u=distanceAngle(...Array.from(c.values()));u&&this.pinchMove(t,u)}pinchMove(t,c){let u=this.state,h=u._values[1],f=c.angle-h,g=0;Math.abs(f)>270&&(g+=Math.sign(f)),this.computeValues([c.distance,c.angle-360*g]),u.origin=c.origin,u.turns=g,u._movement=[u._values[0]/u._initial[0]-1,u._values[1]-u._initial[1]],this.compute(t),this.emit()}touchEnd(t){this.ctrl.setEventIds(t),this.state._active&&this.state._touchIds.some(t=>!this.ctrl.touchIds.has(t))&&(this.state._active=!1,this.compute(t),this.emit())}pointerEnd(t){let c=this.state;this.ctrl.setEventIds(t);try{t.target.releasePointerCapture(t.pointerId)}catch(t){}c._pointerEvents.has(t.pointerId)&&c._pointerEvents.delete(t.pointerId),c._active&&c._pointerEvents.size<2&&(c._active=!1,this.compute(t),this.emit())}gestureStart(t){t.cancelable&&t.preventDefault();let c=this.state;c._active||(this.start(t),this.computeValues([t.scale,t.rotation]),c.origin=[t.clientX,t.clientY],this.compute(t),this.emit())}gestureMove(t){if(t.cancelable&&t.preventDefault(),!this.state._active)return;let c=this.state;this.computeValues([t.scale,t.rotation]),c.origin=[t.clientX,t.clientY];let u=c._movement;c._movement=[t.scale-1,t.rotation],c._delta=tl.sub(c._movement,u),this.compute(t),this.emit()}gestureEnd(t){this.state._active&&(this.state._active=!1,this.compute(t),this.emit())}wheel(t){let c=this.config.modifierKey;(!c||(Array.isArray(c)?c.find(c=>t[c]):t[c]))&&(this.state._active?this.wheelChange(t):this.wheelStart(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(t){this.start(t),this.wheelChange(t)}wheelChange(t){let c="uv"in t;!c&&t.cancelable&&t.preventDefault();let u=this.state;u._delta=[-wheelValues(t)[1]/100*u.offset[0],0],tl.addTo(u._movement,u._delta),clampStateInternalMovementToBounds(u),this.state.origin=[t.clientX,t.clientY],this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){let c=this.config.device;c&&(t(c,"start",this[c+"Start"].bind(this)),t(c,"change",this[c+"Move"].bind(this)),t(c,"end",this[c+"End"].bind(this)),t(c,"cancel",this[c+"End"].bind(this)),t("lostPointerCapture","",this[c+"End"].bind(this))),this.config.pinchOnWheel&&t("wheel","",this.wheel.bind(this),{passive:!1})}};let tv=_objectSpread2(_objectSpread2({},tp),{},{device(t,c,{shared:u,pointer:{touch:h=!1}={}}){if(u.target&&!tm.touch&&tm.gesture)return"gesture";if(tm.touch&&h)return"touch";if(tm.touchscreen){if(tm.pointer)return"pointer";if(tm.touch)return"touch"}},bounds(t,c,{scaleBounds:u={},angleBounds:h={}}){let _scaleBounds=t=>{let c=assignDefault(call(u,t),{min:-1/0,max:1/0});return[c.min,c.max]},_angleBounds=t=>{let c=assignDefault(call(h,t),{min:-1/0,max:1/0});return[c.min,c.max]};return"function"!=typeof u&&"function"!=typeof h?[_scaleBounds(),_angleBounds()]:t=>[_scaleBounds(t),_angleBounds(t)]},threshold(t,c,u){this.lockDirection="lock"===u.axis;let h=tl.toVector(t,this.lockDirection?[.1,3]:0);return h},modifierKey:t=>void 0===t?"ctrlKey":t,pinchOnWheel:(t=!0)=>t});_objectSpread2(_objectSpread2({},tf),{},{mouseOnly:(t=!0)=>t});let WheelEngine=class WheelEngine extends CoordinatesEngine{constructor(...t){super(...t),_defineProperty(this,"ingKey","wheeling")}wheel(t){this.state._active||this.start(t),this.wheelChange(t),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(t){let c=this.state;c._delta=wheelValues(t),tl.addTo(c._movement,c._delta),clampStateInternalMovementToBounds(c),this.compute(t),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(t){t("wheel","",this.wheel.bind(this))}};_objectSpread2(_objectSpread2({},tf),{},{mouseOnly:(t=!0)=>t});let tx=new Map,tw=new Map;function registerAction(t){tx.set(t.key,t.engine),tw.set(t.key,t.resolver)}function _objectWithoutPropertiesLoose(t,c){if(null==t)return{};var u,h,f={},g=Object.keys(t);for(h=0;h<g.length;h++)u=g[h],c.indexOf(u)>=0||(f[u]=t[u]);return f}function _objectWithoutProperties(t,c){if(null==t)return{};var u,h,f=_objectWithoutPropertiesLoose(t,c);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(t);for(h=0;h<g.length;h++)u=g[h],!(c.indexOf(u)>=0)&&Object.prototype.propertyIsEnumerable.call(t,u)&&(f[u]=t[u])}return f}let tS={target(t){if(t)return()=>"current"in t?t.current:t},enabled:(t=!0)=>t,window:(t=tm.isBrowser?window:void 0)=>t,eventOptions:({passive:t=!0,capture:c=!1}={})=>({passive:t,capture:c}),transform:t=>t},t_=["target","eventOptions","window","enabled","transform"];function resolveWith(t={},c){let u={};for(let[h,f]of Object.entries(c))switch(typeof f){case"function":u[h]=f.call(u,t[h],h,t);break;case"object":u[h]=resolveWith(t[h],f);break;case"boolean":f&&(u[h]=t[h])}return u}function use_gesture_core_esm_parse(t,c,u={}){let{target:h,eventOptions:f,window:g,enabled:b,transform:v}=t,x=_objectWithoutProperties(t,t_);if(u.shared=resolveWith({target:h,eventOptions:f,window:g,enabled:b,transform:v},tS),c){let t=tw.get(c);u[c]=resolveWith(_objectSpread2({shared:u.shared},x),t)}else for(let t in x){let c=tw.get(t);c&&(u[t]=resolveWith(_objectSpread2({shared:u.shared},x[t]),c))}return u}let EventStore=class EventStore{constructor(t,c){_defineProperty(this,"_listeners",new Set),this._ctrl=t,this._gestureKey=c}add(t,c,u,h,f){let g=this._listeners,b=toDomEventType(c,u),v=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},x=_objectSpread2(_objectSpread2({},v),f);t.addEventListener(b,h,x);let remove=()=>{t.removeEventListener(b,h,x),g.delete(remove)};return g.add(remove),remove}clean(){this._listeners.forEach(t=>t()),this._listeners.clear()}};let TimeoutStore=class TimeoutStore{constructor(){_defineProperty(this,"_timeouts",new Map)}add(t,c,u=140,...h){this.remove(t),this._timeouts.set(t,window.setTimeout(c,u,...h))}remove(t){let c=this._timeouts.get(t);c&&window.clearTimeout(c)}clean(){this._timeouts.forEach(t=>void window.clearTimeout(t)),this._timeouts.clear()}};let Controller=class Controller{constructor(t){_defineProperty(this,"gestures",new Set),_defineProperty(this,"_targetEventStore",new EventStore(this)),_defineProperty(this,"gestureEventStores",{}),_defineProperty(this,"gestureTimeoutStores",{}),_defineProperty(this,"handlers",{}),_defineProperty(this,"config",{}),_defineProperty(this,"pointerIds",new Set),_defineProperty(this,"touchIds",new Set),_defineProperty(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),resolveGestures(this,t)}setEventIds(t){return isTouch(t)?(this.touchIds=new Set(touchIds(t)),this.touchIds):"pointerId"in t?("pointerup"===t.type||"pointercancel"===t.type?this.pointerIds.delete(t.pointerId):"pointerdown"===t.type&&this.pointerIds.add(t.pointerId),this.pointerIds):void 0}applyHandlers(t,c){this.handlers=t,this.nativeHandlers=c}applyConfig(t,c){this.config=use_gesture_core_esm_parse(t,c,this.config)}clean(){for(let t of(this._targetEventStore.clean(),this.gestures))this.gestureEventStores[t].clean(),this.gestureTimeoutStores[t].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...t){let c;let u=this.config.shared,h={};if(!u.target||(c=u.target())){if(u.enabled){for(let u of this.gestures){let f=this.config[u],g=bindToProps(h,f.eventOptions,!!c);if(f.enabled){let c=tx.get(u);new c(this,t,u).bind(g)}}let f=bindToProps(h,u.eventOptions,!!c);for(let c in this.nativeHandlers)f(c,"",u=>this.nativeHandlers[c](_objectSpread2(_objectSpread2({},this.state.shared),{},{event:u,args:t})),void 0,!0)}for(let t in h)h[t]=chain(...h[t]);if(!c)return h;for(let t in h){let{device:u,capture:f,passive:g}=parseProp(t);this._targetEventStore.add(c,u,"",h[t],{capture:f,passive:g})}}}};function setupGesture(t,c){t.gestures.add(c),t.gestureEventStores[c]=new EventStore(t,c),t.gestureTimeoutStores[c]=new TimeoutStore}function resolveGestures(t,c){c.drag&&setupGesture(t,"drag"),c.wheel&&setupGesture(t,"wheel"),c.scroll&&setupGesture(t,"scroll"),c.move&&setupGesture(t,"move"),c.pinch&&setupGesture(t,"pinch"),c.hover&&setupGesture(t,"hover")}let bindToProps=(t,c,u)=>(h,f,g,b={},v=!1)=>{var x,w;let _=null!==(x=b.capture)&&void 0!==x?x:c.capture,k=null!==(w=b.passive)&&void 0!==w?w:c.passive,E=v?h:toHandlerProp(h,f,_);u&&k&&(E+="Passive"),t[E]=t[E]||[],t[E].push(g)},tk=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function sortHandlers(t){let c={},u={},h=new Set;for(let f in t)tk.test(f)?(h.add(RegExp.lastMatch),u[f]=t[f]):c[f]=t[f];return[u,c,h]}function registerGesture(t,c,u,h,f,g){if(!t.has(u)||!tx.has(h))return;let b=u+"Start",v=u+"End";f[h]=t=>{let h;return t.first&&b in c&&c[b](t),u in c&&(h=c[u](t)),t.last&&v in c&&c[v](t),h},g[h]=g[h]||{}}function parseMergedHandlers(t,c){let[u,h,f]=sortHandlers(t),g={};return registerGesture(f,u,"onDrag","drag",g,c),registerGesture(f,u,"onWheel","wheel",g,c),registerGesture(f,u,"onScroll","scroll",g,c),registerGesture(f,u,"onPinch","pinch",g,c),registerGesture(f,u,"onMove","move",g,c),registerGesture(f,u,"onHover","hover",g,c),{handlers:g,config:c,nativeHandlers:h}}function useRecognizers(t,c={},u,h){let f=U.useMemo(()=>new Controller(t),[]);if(f.applyHandlers(t,h),f.applyConfig(c,u),U.useEffect(f.effect.bind(f)),U.useEffect(()=>f.clean.bind(f),[]),void 0===c.target)return f.bind.bind(f)}function createUseGesture(t){return t.forEach(registerAction),function(t,c){let{handlers:u,nativeHandlers:h,config:f}=parseMergedHandlers(t,c||{});return useRecognizers(u,f,void 0,h)}}u(2729);let tC=/Mac|iPod|iPhone|iPad/.test("undefined"==typeof window?"node":window.navigator.platform);function normalizeWheel(t){let{deltaY:c,deltaX:u}=t,h=0;if(t.ctrlKey||t.altKey||t.metaKey){let u=Math.sign(t.deltaY),f=Math.abs(t.deltaY),g=c;f>10&&(g=10*u),h=g/100}else t.shiftKey&&!tC&&(u=c,c=0);return{x:-u,y:-c,z:-h}}let tP=createUseGesture([{key:"wheel",engine:WheelEngine,resolver:tf},{key:"pinch",engine:PinchEngine,resolver:tv}]),isWheelEndEvent=t=>void 0===v?(v=t,!1):t-v>120&&t-v<160?(v=t,!0):(v=t,!1);function useGestureEvents(t){let c=(0,e8.j)(),u=U.useMemo(()=>{let u="not sure",h=1,f=1,g=1,b=0,v=new tn.G,x=new tn.G,updatePinchState=t=>{if(t&&(u="zooming"),"zooming"===u)return;let c=Math.abs(b-h),f=tn.G.Dist(v,x);switch(u){case"not sure":c>24?u="zooming":f>16&&(u="panning");break;case"panning":c>64&&(u="zooming")}};return{onWheel:({event:t})=>{if(!c.instanceState.isFocused||(u="not sure",isWheelEndEvent(Date.now())))return;if(c.editingShapeId){let t=c.getShape(c.editingShapeId);if(t){let u=c.getShapeUtil(t);if(u.canScroll(t)){let t=c.getShapePageBounds(c.editingShapeId);if(t?.containsPoint(c.inputs.currentPagePoint))return}}}preventDefault(t);let h=normalizeWheel(t);if(0===h.x&&0===h.y)return;let f={type:"wheel",name:"wheel",delta:h,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey};c.dispatch(f)},onPinchStart:g=>{let b=t.current;u="not sure";let{event:w,origin:_,da:k}=g;!(w instanceof WheelEvent)&&(w.target===b||b?.contains(w.target))&&(x.x=_[0],x.y=_[1],v.x=_[0],v.y=_[1],h=k[0],f=c.zoomLevel,c.dispatch({type:"pinch",name:"pinch_start",point:{x:_[0],y:_[1],z:c.zoomLevel},delta:{x:0,y:0},shiftKey:w.shiftKey,altKey:w.altKey,ctrlKey:w.metaKey||w.ctrlKey}))},onPinchEnd:h=>{let f=t.current,{event:g,origin:b,offset:v}=h;if(g instanceof WheelEvent||!(g.target===f||f?.contains(g.target)))return;let x=v[0];u="not sure",requestAnimationFrame(()=>{c.dispatch({type:"pinch",name:"pinch_end",point:{x:b[0],y:b[1],z:x},delta:{x:b[0],y:b[1]},shiftKey:g.shiftKey,altKey:g.altKey,ctrlKey:g.metaKey||g.ctrlKey})})},onPinch:h=>{let v=t.current,{event:w,origin:_,offset:k,da:E}=h;if(w instanceof WheelEvent||!(w.target===v||v?.contains(w.target)))return;let $="gesturechange"===h.type||"gestureend"===h.type;b=E[0];let T=_[0]-x.x,I=_[1]-x.y;switch(x.x=_[0],x.y=_[1],updatePinchState($),u){case"zooming":g=k[0],c.dispatch({type:"pinch",name:"pinch",point:{x:_[0],y:_[1],z:g},delta:{x:T,y:I},shiftKey:w.shiftKey,altKey:w.altKey,ctrlKey:w.metaKey||w.ctrlKey});break;case"panning":c.dispatch({type:"pinch",name:"pinch",point:{x:_[0],y:_[1],z:f},delta:{x:T,y:I},shiftKey:w.shiftKey,altKey:w.altKey,ctrlKey:w.metaKey||w.ctrlKey})}}}},[c,t]);tP(u,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[c.zoomLevel,0],scaleBounds:()=>({from:c.zoomLevel,max:8,min:.05})}})}function getHandle(t,c,u){let h=t.getShape(c),f=t.getShapeHandles(h);return{shape:h,handle:f.find(t=>t.id===u)}}function useHandleEvents(t,c){let u=(0,e8.j)();return U.useMemo(()=>{let h,f;return{onPointerDown:h=>{if(h.isKilled)return;let f=loopToHtmlElement(h.currentTarget);setPointerCapture(f,h);let{shape:g,handle:b}=getHandle(u,t,c);b&&u.dispatch({type:"pointer",target:"handle",handle:b,shape:g,name:"pointer_down",...getPointerInfo(h)})},onPointerMove:g=>{if(g.isKilled||g.clientX===h&&g.clientY===f)return;h=g.clientX,f=g.clientY;let{shape:b,handle:v}=getHandle(u,t,c);v&&u.dispatch({type:"pointer",target:"handle",handle:v,shape:b,name:"pointer_move",...getPointerInfo(g)})},onPointerUp:h=>{if(h.isKilled)return;let f=loopToHtmlElement(h.currentTarget);releasePointerCapture(f,h);let{shape:g,handle:b}=getHandle(u,t,c);b&&u.dispatch({type:"pointer",target:"handle",handle:b,shape:g,name:"pointer_up",...getPointerInfo(h)})}}},[u,t,c])}var tE=u(6978);function useScreenBounds(){let t=(0,e8.j)();(0,U.useLayoutEffect)(()=>{let c=tE(()=>{t.updateViewportScreenBounds()},200,{trailing:!0});t.updateViewportScreenBounds();let u=setInterval(c,1e3);return window.addEventListener("resize",c),window.addEventListener("scroll",c),()=>{clearInterval(u),window.removeEventListener("resize",c),window.removeEventListener("scroll",c)}},[t])}var t$=u(498);function useTick(t=!0){let[c,u]=(0,U.useState)(0),h=(0,e8.j)();(0,U.useEffect)(()=>{if(!t)return;let update=()=>u(t=>t+1);return h.on("tick",update),()=>{h.off("tick",update)}},[h,t])}let tT=(0,eJ.j)(function({showStroke:t=!0,showVertices:c=!0,showClosestPointOnOutline:u=!0}){let h=(0,e8.j)();useTick(u);let{zoomLevel:f,renderingShapes:g,inputs:{currentPagePoint:b}}=h;return(0,G.jsx)("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:g.map(g=>{let v=h.getShape(g.id);if("group"===v.type)return null;let x=h.getShapeGeometry(v),w=h.getShapePageTransform(v),_=h.getPointInShapeSpace(v,b),k=x.nearestPoint(_),E=x.distanceToPoint(_,!0),$=Math.abs(E)*f,{vertices:T}=x;return(0,G.jsxs)("g",{transform:w.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[t&&(0,G.jsx)("path",{stroke:"red",strokeWidth:"2",fill:"none",opacity:"1",d:x.toSimpleSvgPath()}),c&&T.map((t,c)=>(0,G.jsx)("circle",{cx:t.x,cy:t.y,r:"2",fill:`hsl(${(0,e1.vm)(c,[0,T.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:"1"},`v${c}`)),u&&$<150&&(0,G.jsx)("line",{x1:k.x,y1:k.y,x2:_.x,y2:_.y,opacity:1-$/150,stroke:E<0?"goldenrod":"dodgerblue",strokeWidth:"2"})]},g.id+"_outline")})})});var tI=u(528);function uniq(t){return tI(t)}function usePeerIds(){let t=(0,e8.j)(),c=(0,U.useMemo)(()=>t.store.query.records("instance_presence",()=>({userId:{neq:t.user.id}})),[t]),u=(0,eJ.vc)("userIds",()=>tI(c.value.map(t=>t.userId)).sort(),{isEqual:(t,c)=>t.join(",")===c.join?.(",")},[c]);return(0,eJ.Hg)(u)}function usePresence(t){let c=(0,e8.j)(),u=(0,U.useMemo)(()=>c.store.query.records("instance_presence",()=>({userId:{eq:t}})),[c,t]),h=(0,eJ.Hg)(`latestPresence:${t}`,()=>u.value.slice().sort((t,c)=>c.lastActivityTimestamp-t.lastActivityTimestamp)[0],[]);return h??null}let tA=(0,eJ.j)(function(){let t=usePeerIds();return(0,G.jsx)(G.Fragment,{children:t.map(t=>(0,G.jsx)(tM,{collaboratorId:t},t))})}),tM=(0,eJ.j)(function({collaboratorId:t}){let c=(0,e8.j)(),u=usePresence(t),h=useCollaboratorState(u);if(!(u&&u.currentPageId===c.currentPageId))return null;switch(h){case"inactive":{let{followingUserId:t,highlightedUserIds:h}=c.instanceState;if(!(t===u.userId||h.includes(u.userId)))return null;break}case"idle":{let{highlightedUserIds:t}=c.instanceState;if(u.followingUserId===c.user.id&&!(u.chatMessage||t.includes(u.userId)))return null}}return(0,G.jsx)(tj,{latestPresence:u})}),tj=(0,eJ.j)(function({latestPresence:t}){let c=(0,e8.j)(),{CollaboratorBrush:u,CollaboratorScribble:h,CollaboratorCursor:f,CollaboratorHint:g,CollaboratorShapeIndicator:b}=useEditorComponents(),{viewportPageBounds:v,zoomLevel:x}=c,{userId:w,chatMessage:_,brush:k,scribble:E,selectedShapeIds:$,userName:T,cursor:I,color:M}=t,j=!(I.x<v.minX-12/x||I.y<v.minY-16/x||I.x>v.maxX-12/x||I.y>v.maxY-16/x);return(0,G.jsxs)(G.Fragment,{children:[k&&u?(0,G.jsx)(u,{className:"tl-collaborator__brush",brush:k,color:M,opacity:.1},w+"_brush"):null,j&&f?(0,G.jsx)(f,{className:"tl-collaborator__cursor",point:I,color:M,zoom:x,name:"New User"!==T?T:null,chatMessage:_},w+"_cursor"):g?(0,G.jsx)(g,{className:"tl-collaborator__cursor-hint",point:I,color:M,zoom:x,viewport:v},w+"_cursor_hint"):null,E&&h?(0,G.jsx)(h,{className:"tl-collaborator__scribble",scribble:E,color:M,zoom:x,opacity:"laser"===E.color?.5:.1},w+"_scribble"):null,b&&$.map(t=>(0,G.jsx)(b,{className:"tl-collaborator__shape-indicator",id:t,color:M,opacity:.5},w+"_"+t))]})});function getStateFromElapsedTime(t){return t>to.RZ?"inactive":t>to.O8?"idle":"active"}function useCollaboratorState(t){let c=(0,U.useRef)(t?.lastActivityTimestamp??-1),[u,h]=(0,U.useState)(()=>getStateFromElapsedTime(Date.now()-c.current));return(0,U.useEffect)(()=>{let t=setInterval(()=>{h(getStateFromElapsedTime(Date.now()-c.current))},to.MN);return()=>clearInterval(t)},[]),t&&(c.current=t.lastActivityTimestamp),u}function gcd(t,c){return 0===c?t:gcd(c,t%c)}function nearestMultiple(t){let c=t.toString().split(".")[1];if(!c)return 1;let u=Math.pow(10,c.length),h=parseInt(c,10);return u/gcd(h,u)}function useDPRMultiple(){let t=(0,e8.j)(),c=useContainer();U.useEffect(()=>(0,eJ.Ym)("useDPRMultiple",()=>{let u=t.instanceState.devicePixelRatio;c.style.setProperty("--tl-dpr-multiple",nearestMultiple(u).toString())}),[t,c])}let tD=(0,eJ.j)(function({id:t,shape:c,util:u,index:h,backgroundIndex:f,opacity:g,isCulled:b}){let v=(0,e8.j)(),{ShapeErrorFallback:x}=useEditorComponents(),w=U.useRef(null),_=U.useRef(null),k=U.useCallback((t,c)=>{w.current?.style.setProperty(t,c),_.current?.style.setProperty(t,c)},[]);(0,eJ.BK)("set shape container transform position",()=>{let c=v.getShape(t);if(!c)return;let u=v.getShapePageTransform(t),h=t$.y.toCssString(u);k("transform",h)},[v,k]),(0,eJ.BK)("set shape container clip path",()=>{let c=v.getShape(t);if(!c)return null;let u=v.getShapeClipPath(t);k("clip-path",u??"none")},[v,k]),(0,eJ.BK)("set shape height and width",()=>{let c=v.getShape(t);if(!c)return null;let u=v.getShapeGeometry(c).bounds,h=Math.floor(100*v.instanceState.devicePixelRatio)/100,f=nearestMultiple(h),g=u.w%f,b=0===g?u.w:u.w+(f-g),x=u.h%f,w=0===x?u.h:u.h+(f-x);k("width",Math.max(b,f)+"px"),k("height",Math.max(w,f)+"px")},[v]),U.useLayoutEffect(()=>{k("opacity",g+""),w.current?.style.setProperty("z-index",h+""),_.current?.style.setProperty("z-index",f+"")},[g,h,f,k]);let E=U.useCallback(t=>{v.annotateError(t,{origin:"react.shape",willCrashApp:!1})},[v]);return c?(0,G.jsxs)(G.Fragment,{children:[u.backgroundComponent&&(0,G.jsx)("div",{ref:_,className:"tl-shape tl-shape-background","data-shape-type":c.type,draggable:!1,children:!b&&(0,G.jsx)(OptionalErrorBoundary,{fallback:x,onError:E,children:(0,G.jsx)(tF,{shape:c,util:u})})}),(0,G.jsx)("div",{ref:w,className:"tl-shape","data-shape-type":c.type,draggable:!1,children:b?(0,G.jsx)(tR,{shape:c}):(0,G.jsx)(OptionalErrorBoundary,{fallback:x,onError:E,children:(0,G.jsx)(tO,{shape:c,util:u})})})]}):null}),tO=U.memo(function({shape:t,util:c}){return(0,eJ.uC)("InnerShape:"+t.type,()=>c.component(t))},(t,c)=>t.shape.props===c.shape.props&&t.shape.meta===c.shape.meta),tF=U.memo(function({shape:t,util:c}){return(0,eJ.uC)("InnerShape:"+t.type,()=>c.backgroundComponent?.(t))},(t,c)=>t.shape.props===c.shape.props&&t.shape.meta===c.shape.meta),tR=U.memo(function({shape:t}){let c=(0,e8.j)(),u=c.getShapeGeometry(t).bounds;return(0,G.jsx)("div",{className:"tl-shape__culled",style:{transform:`translate(${(0,tt.$Z)(u.minX)}px, ${(0,tt.$Z)(u.minY)}px)`,width:Math.max(1,(0,tt.$Z)(u.width)),height:Math.max(1,(0,tt.$Z)(u.height))}})},()=>!0);function Canvas({className:t}){let c=(0,e8.j)(),{Background:u,SvgDefs:h}=useEditorComponents(),f=U.useRef(null),g=U.useRef(null),b=U.useRef(null);useScreenBounds(),useDocumentEvents(),useCoarsePointer(),useGestureEvents(f),useFixSafariDoubleTapZoomPencilEvents(f),(0,eJ.BK)("position layers",()=>{let t=g.current;if(!t)return;let u=b.current;if(!u)return;let{x:h,y:f,z:v}=c.camera,x=v>=1?(0,e1.vm)(v,[1,8],[.125,.5],!0):(0,e1.vm)(v,[.1,1],[-2,.125],!0),w=`scale(${(0,tt.$Z)(v)}) translate(${(0,tt.$Z)(h+x)}px,${(0,tt.$Z)(f+x)}px)`;t.style.setProperty("transform",w),u.style.setProperty("transform",w)},[c]);let v=useCanvasEvents(),x=(0,eJ.Hg)("shapeSvgDefs",()=>{let t=new Map;for(let u of(0,e1.UM)(c.shapeUtils)){if(!u)return;let c=u.getCanvasSvgDefs();for(let{key:u,component:h}of c)t.has(u)||t.set(u,(0,G.jsx)(h,{},u))}return[...t.values()]},[c]),w=(0,eJ.Hg)("debug_shapes",()=>e4.hideShapes.value,[e4]),_=(0,eJ.Hg)("debug_svg",()=>e4.debugSvg.value,[e4]),k=(0,eJ.Hg)("debug_geometry",()=>e4.debugGeometry.value,[e4]);return(0,G.jsxs)("div",{ref:f,draggable:!1,className:eX("tl-canvas",t),"data-testid":"canvas",...v,children:[u&&(0,G.jsx)(u,{}),(0,G.jsx)(GridWrapper,{}),(0,G.jsx)(UiLogger,{}),(0,G.jsx)("svg",{className:"tl-svg-context",children:(0,G.jsxs)("defs",{children:[x,Cursor&&(0,G.jsx)(Cursor,{}),(0,G.jsx)(CollaboratorHint,{}),(0,G.jsx)(ArrowheadDot,{}),(0,G.jsx)(ArrowheadCross,{}),h&&(0,G.jsx)(h,{})]})}),(0,G.jsxs)("div",{ref:g,className:"tl-html-layer tl-shapes",draggable:!1,children:[(0,G.jsx)(SelectionBackgroundWrapper,{}),w?null:_?(0,G.jsx)(ShapesWithSVGs,{}):(0,G.jsx)(ShapesToDisplay,{})]}),(0,G.jsx)("div",{className:"tl-fixed-layer tl-overlays",children:(0,G.jsxs)("div",{ref:b,className:"tl-html-layer",children:[k?(0,G.jsx)(tT,{}):null,(0,G.jsx)(HandlesWrapper,{}),(0,G.jsx)(BrushWrapper,{}),(0,G.jsx)(ScribbleWrapper,{}),(0,G.jsx)(ZoomBrushWrapper,{}),(0,G.jsx)(SelectedIdIndicators,{}),(0,G.jsx)(HoveredShapeIndicator,{}),(0,G.jsx)(tL,{}),(0,G.jsx)(SnapLinesWrapper,{}),(0,G.jsx)(SelectionForegroundWrapper,{}),(0,G.jsx)(tA,{})]})})]})}function GridWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("gridSize",()=>t.documentSettings.gridSize,[t]),{x:u,y:h,z:f}=(0,eJ.Hg)("camera",()=>t.camera,[t]),g=(0,eJ.Hg)("isGridMode",()=>t.instanceState.isGridMode,[t]),{Grid:b}=useEditorComponents();return b&&g?(0,G.jsx)(b,{x:u,y:h,z:f,size:c}):null}function ScribbleWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("scribble",()=>t.instanceState.scribble,[t]),u=(0,eJ.Hg)("zoomLevel",()=>t.zoomLevel,[t]),{Scribble:h}=useEditorComponents();return h&&c?(0,G.jsx)(h,{className:"tl-user-scribble",scribble:c,zoom:u}):null}function BrushWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("brush",()=>t.instanceState.brush,[t]),{Brush:u}=useEditorComponents();return u&&c?(0,G.jsx)(u,{className:"tl-user-brush",brush:c}):null}function ZoomBrushWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("zoomBrush",()=>t.instanceState.zoomBrush,[t]),{ZoomBrush:u}=useEditorComponents();return u&&c?(0,G.jsx)(u,{className:"tl-user-brush",brush:c}):null}function SnapLinesWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("snapLines",()=>t.snaps.lines,[t]),u=(0,eJ.Hg)("zoomLevel",()=>t.zoomLevel,[t]),{SnapLine:h}=useEditorComponents();return h&&c.length>0?(0,G.jsx)(G.Fragment,{children:c.map(t=>(0,G.jsx)(h,{className:"tl-user-snapline",line:t,zoom:u},t.id))}):null}function HandlesWrapper(){let t=(0,e8.j)(),{Handles:c}=useEditorComponents(),u=(0,eJ.Hg)("zoomLevel",()=>t.zoomLevel,[t]),h=(0,eJ.Hg)("coarse pointer",()=>t.instanceState.isCoarsePointer,[t]),f=(0,eJ.Hg)("onlySelectedShape",()=>t.onlySelectedShape,[t]),g=(0,eJ.Hg)("isChangingStyle",()=>t.instanceState.isChangingStyle,[t]),b=(0,eJ.Hg)("isChangingStyle",()=>t.instanceState.isReadonly,[t]),v=(0,eJ.Hg)("handles",()=>t.onlySelectedShape?t.getShapeHandles(t.onlySelectedShape):void 0,[t]),x=(0,eJ.Hg)("transform",()=>t.onlySelectedShape?t.getShapePageTransform(t.onlySelectedShape):void 0,[t]);if(!c||!f||g||b||!v||!x)return null;let w=[];for(let t=0,c=v[t];t<v.length;c=v[++t]){if("vertex"!==c.type){let c=v[t-1],h=v[t+1];if(c&&h&&Math.hypot(c.y-h.y,c.x-h.x)<48/u)continue}w.push(c)}return w.sort(t=>"vertex"===t.type?1:-1),(0,G.jsx)(c,{children:(0,G.jsx)("g",{transform:t$.y.toCssString(x),children:w.map(t=>(0,G.jsx)(HandleWrapper,{shapeId:f.id,handle:t,zoom:u,isCoarse:h},t.id))})})}function HandleWrapper({shapeId:t,handle:c,zoom:u,isCoarse:h}){let f=useHandleEvents(t,c.id),{Handle:g}=useEditorComponents();return g?(0,G.jsx)("g",{"aria-label":"handle",transform:`translate(${c.x}, ${c.y})`,...f,children:(0,G.jsx)(g,{shapeId:t,handle:c,zoom:u,isCoarse:h})}):null}function ShapesWithSVGs(){let t=(0,e8.j)(),c=(0,eJ.Hg)("rendering shapes",()=>t.renderingShapes,[t]);return(0,G.jsx)(G.Fragment,{children:c.map(t=>(0,G.jsxs)(U.Fragment,{children:[(0,G.jsx)(tD,{...t}),(0,G.jsx)(tN,{id:t.id})]},t.id+"_fragment"))})}function ShapesToDisplay(){let t=(0,e8.j)(),c=(0,eJ.Hg)("rendering shapes",()=>t.renderingShapes,[t]);return(0,G.jsx)(G.Fragment,{children:c.map(t=>(0,G.jsx)(tD,{...t},t.id+"_shape"))})}function SelectedIdIndicators(){let t=(0,e8.j)(),c=(0,eJ.Hg)("selectedShapeIds",()=>t.currentPageState.selectedShapeIds,[t]),u=(0,eJ.Hg)("should display selected ids",()=>t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!t.instanceState.isChangingStyle,[t]);return u?(0,G.jsx)(G.Fragment,{children:c.map(t=>(0,G.jsx)(te,{className:"tl-user-indicator__selected",id:t},t+"_indicator"))}):null}let HoveredShapeIndicator=function(){let t=(0,e8.j)(),{HoveredShapeIndicator:c}=useEditorComponents(),u=(0,eJ.Hg)("coarse pointer",()=>t.instanceState.isCoarsePointer,[t]),h=(0,eJ.Hg)("hovering canvas",()=>t.instanceState.isHoveringCanvas,[t]),f=(0,eJ.Hg)("hovered id",()=>t.currentPageState.hoveredShapeId,[t]);return!u&&h&&f&&c?(0,G.jsx)(c,{shapeId:f}):null},tL=(0,eJ.j)(function(){let t=(0,e8.j)(),c=(0,e1.D8)(t.hintingShapeIds);return c.length?(0,G.jsx)(G.Fragment,{children:c.map(t=>(0,G.jsx)(te,{className:"tl-user-indicator__hint",id:t},t+"_hinting"))}):null});function Cursor(){return(0,G.jsxs)("g",{id:"cursor",children:[(0,G.jsxs)("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[(0,G.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,G.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,G.jsxs)("g",{fill:"white",transform:"translate(-12,-12)",children:[(0,G.jsx)("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),(0,G.jsx)("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),(0,G.jsxs)("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[(0,G.jsx)("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),(0,G.jsx)("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function CollaboratorHint(){return(0,G.jsx)("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function ArrowheadDot(){return(0,G.jsx)("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:(0,G.jsx)("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function ArrowheadCross(){return(0,G.jsxs)("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[(0,G.jsx)("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),(0,G.jsx)("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}let tN=(0,eJ.j)(function({id:t}){let c=(0,e8.j)(),u=c.getShape(t),[h,f]=U.useState(""),g=u?.parentId===c.currentPageId;return(U.useEffect(()=>{if(!g)return;let u=null,h=(0,eJ.Ym)("shape to svg",async()=>{let h=Math.random();u=h;let g=c.getShapePageBounds(t),b=await c.getSvg([t],{padding:0});b&&g&&u===h&&(b.style.setProperty("overflow","visible"),b.setAttribute("preserveAspectRatio","xMidYMin slice"),b.style.setProperty("transform",`translate(${g.x}px, ${g.y+g.h+12}px)`),b.style.setProperty("border","1px solid black"),f(b?.outerHTML))});return()=>{u=null,h()}},[c,t,g]),g)?(0,G.jsx)("div",{style:{paddingTop:12,position:"absolute"},children:(0,G.jsx)("div",{style:{display:"flex"},dangerouslySetInnerHTML:{__html:h}})}):null});function UiLogger(){let t=(0,eJ.Hg)("debugging ui log",()=>e4.logMessages.value,[e4]);return t.length?(0,G.jsx)("div",{className:"debug__ui-logger",children:t.map((t,c)=>{let u="string"==typeof t?t:JSON.stringify(t);return(0,G.jsx)("div",{className:"debug__ui-logger__line",children:u},c)})}):null}function SelectionForegroundWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("selection rotation",()=>t.selectionRotation,[t]),u=(0,eJ.Hg)("selection bounds",()=>t.selectionRotatedPageBounds,[t]),{SelectionForeground:h}=useEditorComponents();return u&&h?(0,G.jsx)(h,{bounds:u,rotation:c}):null}function SelectionBackgroundWrapper(){let t=(0,e8.j)(),c=(0,eJ.Hg)("selection rotation",()=>t.selectionRotation,[t]),u=(0,eJ.Hg)("selection bounds",()=>t.selectionRotatedPageBounds,[t]),{SelectionBackground:h}=useEditorComponents();return u&&h?(0,G.jsx)(h,{bounds:u,rotation:c}):null}var tz=u(7217),tB=u(418);function useIsDarkMode(){let t=(0,e8.j)();return(0,eJ.Hg)("isDarkMode",()=>t.user.isDarkMode,[t])}let tG="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",tH="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",tU='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function getCursorCss(t,c,u,h,f,g=16,b=16){let v=(-u-c)*(tt.PI/180),x=Math.sin(v),w=Math.cos(v);return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${f};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${1*w-1*x}' dy='${1*x+1*w}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${c+u} 16 16)${h?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+t.replaceAll('"',"'")+`</g></svg>") ${g} ${b}, pointer`}let tV={none:()=>"none",default:(t,c,u)=>getCursorCss('<path d="m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z" fill="white"/><path d="m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z" fill="white"/><path d="m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z" fill="black"/><path d="m13 10.814v11.188l2.969-2.866.428-.139h4.768z" fill="black"/>',t,0,c,u,12,8),pointer:(t,c,u)=>getCursorCss('<path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.3315 21.3799c-.284-.359-.629-1.093-1.243-1.984-.348-.504-1.211-1.453-1.468-1.935-.223-.426-.199-.617-.146-.97.094-.628.738-1.117 1.425-1.051.519.049.959.392 1.355.716.239.195.533.574.71.788.163.196.203.277.377.509.23.307.302.459.214.121-.071-.496-.187-1.343-.355-2.092-.128-.568-.159-.657-.281-1.093-.129-.464-.195-.789-.316-1.281-.084-.348-.235-1.059-.276-1.459-.057-.547-.087-1.439.264-1.849.275-.321.906-.418 1.297-.22.512.259.803 1.003.936 1.3.239.534.387 1.151.516 1.961.164 1.031.466 2.462.476 2.763.024-.369-.068-1.146-.004-1.5.058-.321.328-.694.666-.795.286-.085.621-.116.916-.055.313.064.643.288.766.499.362.624.369 1.899.384 1.831.086-.376.071-1.229.284-1.584.14-.234.497-.445.687-.479.294-.052.655-.068.964-.008.249.049.586.345.677.487.218.344.342 1.317.379 1.658.015.141.074-.392.293-.736.406-.639 1.843-.763 1.898.639.025.654.02.624.02 1.064 0 .517-.012.828-.04 1.202-.031.4-.117 1.304-.242 1.742-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.191 1.813-.118.562-.079.566-.102.965-.023.398.121.922.121.922s-.802.104-1.234.035c-.391-.063-.875-.841-1-1.079-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.031-3.139.02 0 0 .185-1.011-.227-1.358-.305-.259-.83-.784-1.144-1.06z" stroke-linejoin="round"/><path d="m21.5664 21.7344v-3.459"/><path d="m19.5508 21.7461-.016-3.473"/><path d="m17.5547 18.3047.021 3.426"/></g>',t,0,c,u,14,10),cross:(t,c,u)=>getCursorCss('<path d="m25 16h-6.01v-6h-2.98v6h-6.01v3h6.01v6h2.98v-6h6.01z" fill="white"/><path d="m23.9902 17.0103h-6v-6.01h-.98v6.01h-6v.98h6v6.01h.98v-6.01h6z" fill="%23231f1f"/>',t,0,c,u),move:(t,c,u)=>getCursorCss('<path d="m19 14h1v1h-1zm1 6h-1v-1h1zm-5-5h-1v-1h1zm0 5h-1v-1h1zm2-10.987-7.985 7.988 5.222 5.221 2.763 2.763 7.984-7.985z" fill="white"/><g fill="black"><path d="m23.5664 16.9971-2.557-2.809v1.829h-4.009-4.001v-1.829l-2.571 2.809 2.572 2.808-.001-1.808h4.001 4.009l-.001 1.808z"/><path d="m17.9873 17h.013v-4.001l1.807.001-2.807-2.571-2.809 2.57h1.809v4.001h.008v4.002l-1.828-.001 2.807 2.577 2.805-2.576h-1.805z"/></g>',t,0,c,u),grab:(t,c,u)=>getCursorCss('<path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" fill="white"/><g stroke="black" stroke-linecap="round" stroke-width=".75"><path d="m13.5557 17.5742c-.098-.375-.196-.847-.406-1.552-.167-.557-.342-.859-.47-1.233-.155-.455-.303-.721-.496-1.181-.139-.329-.364-1.048-.457-1.44-.119-.509.033-.924.244-1.206.253-.339.962-.49 1.357-.351.371.13.744.512.916.788.288.46.357.632.717 1.542.393.992.564 1.918.611 2.231l.085.452c-.001-.04-.043-1.122-.044-1.162-.035-1.029-.06-1.823-.038-2.939.002-.126.064-.587.084-.715.078-.5.305-.8.673-.979.412-.201.926-.215 1.401-.017.423.173.626.55.687 1.022.014.109.094.987.093 1.107-.013 1.025.006 1.641.015 2.174.004.231.003 1.625.017 1.469.061-.656.094-3.189.344-3.942.144-.433.405-.746.794-.929.431-.203 1.113-.07 1.404.243.285.305.446.692.482 1.153.032.405-.019.897-.02 1.245 0 .867-.021 1.324-.037 2.121-.001.038-.015.298.023.182.094-.28.188-.542.266-.745.049-.125.241-.614.359-.859.114-.234.211-.369.415-.688.2-.313.415-.448.668-.561.54-.235 1.109.112 1.301.591.086.215.009.713-.028 1.105-.061.647-.254 1.306-.352 1.648-.128.447-.274 1.235-.34 1.601-.072.394-.234 1.382-.359 1.82-.086.301-.371.978-.652 1.384 0 0-1.074 1.25-1.192 1.812-.117.563-.078.567-.101.965-.024.399.121.923.121.923s-.802.104-1.234.034c-.391-.062-.875-.841-1-1.078-.172-.328-.539-.265-.682-.023-.225.383-.709 1.07-1.051 1.113-.668.084-2.054.03-3.139.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.284-.36-.629-1.093-1.243-1.985-.348-.504-1.027-1.085-1.284-1.579-.223-.425-.331-.954-.19-1.325.225-.594.675-.897 1.362-.832.519.05.848.206 1.238.537.225.19.573.534.75.748.163.195.203.276.377.509.23.307.302.459.214.121" stroke-linejoin="round"/><path d="m20.5664 21.7344v-3.459"/><path d="m18.5508 21.7461-.016-3.473"/><path d="m16.5547 18.3047.021 3.426"/></g>',t,0,c,u),grabbing:(t,c,u)=>getCursorCss("<path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042' fill='white'/><g stroke='black' stroke-width='.75'><path d='m13.5732 12.0361c.48-.178 1.427-.069 1.677.473.213.462.396 1.241.406 1.075.024-.369-.024-1.167.137-1.584.117-.304.347-.59.686-.691.285-.086.62-.116.916-.055.313.064.642.287.765.499.362.623.368 1.899.385 1.831.064-.272.07-1.229.283-1.584.141-.235.497-.445.687-.479.294-.052.656-.068.964-.008.249.049.586.344.677.487.219.344.342 1.316.379 1.658.016.141.074-.393.293-.736.406-.639 1.844-.763 1.898.639.026.654.02.624.02 1.064 0 .516-.012.828-.04 1.202-.03.399-.116 1.304-.241 1.742-.086.301-.371.978-.653 1.384 0 0-1.074 1.25-1.191 1.812-.117.563-.078.567-.102.965-.023.399.121.923.121.923s-.801.104-1.234.034c-.391-.062-.875-.84-1-1.078-.172-.328-.539-.265-.682-.023-.224.383-.709 1.07-1.05 1.113-.669.084-2.055.03-3.14.02 0 0 .185-1.011-.227-1.358-.305-.26-.83-.784-1.144-1.06l-.832-.921c-.283-.36-1.002-.929-1.243-1.985-.213-.936-.192-1.395.037-1.77.232-.381.67-.589.854-.625.208-.042.692-.039.875.062.223.123.313.159.488.391.23.307.312.456.213.121-.076-.262-.322-.595-.434-.97-.109-.361-.401-.943-.38-1.526.008-.221.103-.771.832-1.042z' stroke-linejoin='round'/><path d='m20.5664 19.7344v-3.459' stroke-linecap='round'/><path d='m18.5508 19.7461-.016-3.473' stroke-linecap='round'/><path d='m16.5547 16.3047.021 3.426' stroke-linecap='round'/></g>",t,0,c,u),text:(t,c,u)=>getCursorCss('<path fill="white" d="M7.94 0a5.25 5.25 0 0 0-3.47 1.17A5.27 5.27 0 0 0 1 0H0v3h1c1.41 0 1.85.7 2 1v3.94H2v3h1v3c-.13.3-.57 1-2 1H0v3h1a5.27 5.27 0 0 0 3.47-1.17c.98.8 2.21 1.21 3.47 1.17h1v-3h-1c-1.41 0-1.85-.7-2-1v-3H7v-3H6V4c.13-.3.57-1 2-1h1V0H7.94z"/><path fill="black" d="M7.94 2V1a4 4 0 0 0-3.47 1.64A4 4 0 0 0 1 1v1c1.3-.17 2.56.6 3 1.84v5.1H3v1h1v4.16c-.45 1.24-1.7 2-3 1.84v1a4.05 4.05 0 0 0 3.47-1.63 4.05 4.05 0 0 0 3.47 1.63v-1A2.82 2.82 0 0 1 5 14.1V9.93h1v-1H5V3.85A2.81 2.81 0 0 1 7.94 2z"/>',t,0,c,u,4,10),"ew-resize":(t,c,u)=>getCursorCss(tH,t,0,c,u),"ns-resize":(t,c,u)=>getCursorCss(tH,t,90,c,u),"nesw-resize":(t,c,u)=>getCursorCss(tG,t,0,c,u),"nwse-resize":(t,c,u)=>getCursorCss(tG,t,90,c,u),"nwse-rotate":(t,c,u)=>getCursorCss(tU,t,0,c,u),"nesw-rotate":(t,c,u)=>getCursorCss(tU,t,90,c,u),"senw-rotate":(t,c,u)=>getCursorCss(tU,t,180,c,u),"swne-rotate":(t,c,u)=>getCursorCss(tU,t,270,c,u),"zoom-in":(t,c,u)=>getCursorCss('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 14h-2v-2h-2v2h-2v1.98h2v2.02h2v-2.02h2z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',t,0,c,u),"zoom-out":(t,c,u)=>getCursorCss('<path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5" fill="white"/><path d="m20.5 15c0 3.038-2.462 5.5-5.5 5.5s-5.5-2.462-5.5-5.5 2.462-5.5 5.5-5.5 5.5 2.462 5.5 5.5z" stroke="black"/><g fill="black"><path d="m18 16h-5.98v-1.98h5.98z"/><path d="m23.5859 25 1.414-1.414-5.449-5.449-1.414 1.414z"/></g>',t,0,c,u)};function getCursor(t,c=0,u="black"){return tV[t]((0,tt.vi)(c),!1,u)}let tW=["default","pointer","cross","move","grab","grabbing","text"];function useCursor(){let t=(0,e8.j)(),c=useContainer(),u=useIsDarkMode();(0,eJ.BK)("useCursor",()=>{let{type:h,rotation:f}=t.instanceState.cursor;if(tW.includes(h)){c.style.setProperty("--tl-cursor",`var(--tl-cursor-${h})`);return}c.style.setProperty("--tl-cursor",getCursor(h,f,u?"white":"black"))},[t,c,u])}function useDarkMode(){let t=(0,e8.j)(),c=useContainer(),u=useIsDarkMode(),h=(0,eJ.Hg)(e4.forceSrgb);U.useEffect(()=>{u?(c.setAttribute("data-color-mode","dark"),c.classList.remove("tl-theme__light"),c.classList.add("tl-theme__dark")):(c.setAttribute("data-color-mode","light"),c.classList.remove("tl-theme__dark"),c.classList.add("tl-theme__light")),h?c.classList.add("tl-theme__force-sRGB"):c.classList.remove("tl-theme__force-sRGB")},[t,c,h,u])}function useEvent(t){let c=(0,U.useRef)();return(0,U.useLayoutEffect)(()=>{c.current=t}),(0,U.useDebugValue)(t),(0,U.useCallback)((...t)=>{let u=c.current;return(0,e1.hu)(u,"fn does not exist"),u(...t)},[])}function useFocusEvents(t){let c=(0,e8.j)(),u=useContainer();(0,U.useLayoutEffect)(()=>{t?(c.instanceState.isFocused||c.updateInstanceState({isFocused:!0}),c.getContainer().focus()):c.instanceState.isFocused&&c.updateInstanceState({isFocused:!1})},[c,u,t])}function useForceUpdate(){let[t,c]=(0,U.useState)(0);(0,U.useEffect)(()=>c(t=>t+1),[])}var tK=u(1034);let tZ="TLDRAW_TAB_ID_v2",tY=globalThis.window;function iOS(){return!!tY&&(["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(tY.navigator.platform)||tY.navigator.userAgent.includes("Mac")&&"ontouchend"in document)}let tq=tY?.[tZ]??tY?.sessionStorage[tZ]??"TLDRAW_INSTANCE_STATE_V1_"+(0,tK.E)();tY&&(tY[tZ]=tq,iOS()?tY.sessionStorage[tZ]=tq:delete tY.sessionStorage[tZ]),tY?.addEventListener("beforeunload",()=>{tY.sessionStorage[tZ]=tq});let tX=e2.T.object({version:e2.T.number,currentPageId:e0.CF,isFocusMode:e2.T.boolean,exportBackground:e2.T.boolean,isDebugMode:e2.T.boolean,isToolLocked:e2.T.boolean,isGridMode:e2.T.boolean,pageStates:e2.T.arrayOf(e2.T.object({pageId:e0.CF,camera:e2.T.object({x:e2.T.number,y:e2.T.number,z:e2.T.number}),selectedShapeIds:e2.T.arrayOf(e0.u5),focusedGroupId:e0.u5.nullable()}))}),tJ=(0,eQ.zn)({currentVersion:0});function migrateAndValidateSessionStateSnapshot(t){if(!t||"object"!=typeof t)return console.warn("Invalid instance state"),null;if(!("version"in t)||"number"!=typeof t.version)return console.warn("No version in instance state"),null;let c=(0,eQ.Te)({value:t,fromVersion:t.version,toVersion:0,migrations:tJ});if("error"===c.type)return console.warn(c.reason),null;let u={...c.value,version:0};try{tX.validate(u)}catch(t){return console.warn(t),null}return u}function createSessionStateSnapshotSignal(t){let c=t.query.ids("page");return(0,eJ.Fl)("sessionStateSnapshot",()=>{let u=t.get(e0.PQ);if(!u)return null;let h=[...c.value];return{version:0,currentPageId:u.currentPageId,exportBackground:u.exportBackground,isFocusMode:u.isFocusMode,isDebugMode:u.isDebugMode,isToolLocked:u.isToolLocked,isGridMode:u.isGridMode,pageStates:h.map(c=>{let u=t.get(e0.iS.createId(c)),h=t.get(e0.AN.createId(c));return{pageId:c,camera:{x:h?.x??0,y:h?.y??0,z:h?.z??1},selectedShapeIds:u?.selectedShapeIds??[],focusedGroupId:u?.focusedGroupId??null}})}})}function loadSessionStateSnapshotIntoStore(t,c){let u=migrateAndValidateSessionStateSnapshot(c);if(!u)return;let h=t.allRecords().filter(t=>"instance_page_state"===t.typeName||"camera"===t.typeName),f={added:{},updated:{},removed:{...(0,e1.Ls)(h.map(t=>[t.id,t]))}};t.has(e0.PQ)&&(f.removed[e0.PQ]=t.get(e0.PQ));let g={removed:{},updated:{},added:{[e0.PQ]:t.schema.types.instance.create({id:e0.PQ,currentPageId:u.currentPageId,isDebugMode:u.isDebugMode,isFocusMode:u.isFocusMode,isToolLocked:u.isToolLocked,isGridMode:u.isGridMode,exportBackground:u.exportBackground})}};for(let t of u.pageStates){let c=e0.AN.createId(t.pageId),u=e0.iS.createId(t.pageId);g.added[c]=e0.AN.create({id:e0.AN.createId(t.pageId),x:t.camera.x,y:t.camera.y,z:t.camera.z}),g.added[u]=e0.iS.create({id:e0.iS.createId(t.pageId),pageId:t.pageId,selectedShapeIds:t.selectedShapeIds,focusedGroupId:t.focusedGroupId})}(0,eJ.ay)(()=>{t.applyDiff((0,eQ.bs)([f,g])),t.ensureStoreIsUsable()})}function extractSessionStateFromLegacySnapshot(t){let c=[];for(let u of Object.values(t))u.typeName?.match(/^(instance.*|pointer|camera)$/)&&c.push(u);let u=c.filter(t=>"instance"===t.typeName&&t.id!==e0.PQ)[0];if(!u)return null;let h={version:0,currentPageId:u.currentPageId,exportBackground:!!u.exportBackground,isFocusMode:!!u.isFocusMode,isDebugMode:!!u.isDebugMode,isToolLocked:!!u.isToolLocked,isGridMode:!1,pageStates:c.filter(t=>"instance_page_state"===t.typeName&&t.instanceId===u.id).map(c=>{let u=t[c.cameraId]??{x:0,y:0,z:1};return{pageId:c.pageId,camera:{x:u.x,y:u.y,z:u.z},selectedShapeIds:c.selectedShapeIds,focusedGroupId:c.focusedGroupId}})};try{return tX.validate(h),h}catch(t){return null}}function showCantWriteToIndexDbAlert(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
\u2022 If your hard disk is full, try clearing up some space and then reload the page.`)}function showCantReadFromIndexDbAlert(){window.alert(`Oops! We could not access your browser's storage\u2014and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
\u2022 If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}let instanceOfAny=(t,c)=>c.some(c=>t instanceof c);function getIdbProxyableTypes(){return f||(f=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return g||(g=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let tQ=new WeakMap,t0=new WeakMap,t1=new WeakMap,t2=new WeakMap,t3=new WeakMap;function promisifyRequest(t){let c=new Promise((c,u)=>{let unlisten=()=>{t.removeEventListener("success",success),t.removeEventListener("error",error)},success=()=>{c(wrap(t.result)),unlisten()},error=()=>{u(t.error),unlisten()};t.addEventListener("success",success),t.addEventListener("error",error)});return c.then(c=>{c instanceof IDBCursor&&tQ.set(c,t)}).catch(()=>{}),t3.set(c,t),c}function cacheDonePromiseForTransaction(t){if(t0.has(t))return;let c=new Promise((c,u)=>{let unlisten=()=>{t.removeEventListener("complete",complete),t.removeEventListener("error",error),t.removeEventListener("abort",error)},complete=()=>{c(),unlisten()},error=()=>{u(t.error||new DOMException("AbortError","AbortError")),unlisten()};t.addEventListener("complete",complete),t.addEventListener("error",error),t.addEventListener("abort",error)});t0.set(t,c)}let t5={get(t,c,u){if(t instanceof IDBTransaction){if("done"===c)return t0.get(t);if("objectStoreNames"===c)return t.objectStoreNames||t1.get(t);if("store"===c)return u.objectStoreNames[1]?void 0:u.objectStore(u.objectStoreNames[0])}return wrap(t[c])},set:(t,c,u)=>(t[c]=u,!0),has:(t,c)=>t instanceof IDBTransaction&&("done"===c||"store"===c)||c in t};function replaceTraps(t){t5=t(t5)}function wrapFunction(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?getCursorAdvanceMethods().includes(t)?function(...c){return t.apply(unwrap(this),c),wrap(tQ.get(this))}:function(...c){return wrap(t.apply(unwrap(this),c))}:function(c,...u){let h=t.call(unwrap(this),c,...u);return t1.set(h,c.sort?c.sort():[c]),wrap(h)}}function transformCachableValue(t){return"function"==typeof t?wrapFunction(t):(t instanceof IDBTransaction&&cacheDonePromiseForTransaction(t),instanceOfAny(t,getIdbProxyableTypes()))?new Proxy(t,t5):t}function wrap(t){if(t instanceof IDBRequest)return promisifyRequest(t);if(t2.has(t))return t2.get(t);let c=transformCachableValue(t);return c!==t&&(t2.set(t,c),t3.set(c,t)),c}let unwrap=t=>t3.get(t);function openDB(t,c,{blocked:u,upgrade:h,blocking:f,terminated:g}={}){let b=indexedDB.open(t,c),v=wrap(b);return h&&b.addEventListener("upgradeneeded",t=>{h(wrap(b.result),t.oldVersion,t.newVersion,wrap(b.transaction),t)}),u&&b.addEventListener("blocked",t=>u(t.oldVersion,t.newVersion,t)),v.then(t=>{g&&t.addEventListener("close",()=>g()),f&&t.addEventListener("versionchange",t=>f(t.oldVersion,t.newVersion,t))}).catch(()=>{}),v}function deleteDB(t,{blocked:c}={}){let u=indexedDB.deleteDatabase(t);return c&&u.addEventListener("blocked",t=>c(t.oldVersion,t)),wrap(u).then(()=>void 0)}let t4=["get","getKey","getAll","getAllKeys","count"],t8=["put","add","delete","clear"],t6=new Map;function getMethod(t,c){if(!(t instanceof IDBDatabase&&!(c in t)&&"string"==typeof c))return;if(t6.get(c))return t6.get(c);let u=c.replace(/FromIndex$/,""),h=c!==u,f=t8.includes(u);if(!(u in(h?IDBIndex:IDBObjectStore).prototype)||!(f||t4.includes(u)))return;let method=async function(t,...c){let g=this.transaction(t,f?"readwrite":"readonly"),b=g.store;return h&&(b=b.index(c.shift())),(await Promise.all([b[u](...c),f&&g.done]))[0]};return t6.set(c,method),method}replaceTraps(t=>({...t,get:(c,u,h)=>getMethod(c,u)||t.get(c,u,h),has:(c,u)=>!!getMethod(c,u)||t.has(c,u)}));let t7="TLDRAW_DOCUMENT_v2",t9="TLDRAW_DB_NAME_INDEX_v2",ne={Records:"records",Schema:"schema",SessionState:"session_state"};async function withDb(t,c){addDbName(t);let u=await openDB(t,3,{upgrade(t){t.objectStoreNames.contains(ne.Records)||t.createObjectStore(ne.Records),t.objectStoreNames.contains(ne.Schema)||t.createObjectStore(ne.Schema),t.objectStoreNames.contains(ne.SessionState)||t.createObjectStore(ne.SessionState)}});try{return await c(u)}finally{u.close()}}async function loadDataFromStore({persistenceKey:t,sessionId:c,didCancel:u}){let h=t7+t;if(getAllIndexDbNames().includes(h))return await pruneSessionState({persistenceKey:t,didCancel:u}),await withDb(h,async t=>{if(u?.())return;let h=t.transaction([ne.Records,ne.Schema,ne.SessionState],"readonly"),f=h.objectStore(ne.Records),g=h.objectStore(ne.Schema),b=h.objectStore(ne.SessionState),v=c?(await b.get(c))?.snapshot:null;if(!v){let t=await b.getAll();v=t.sort((t,c)=>t.updatedAt-c.updatedAt).pop()?.snapshot}let x={records:await f.getAll(),schema:await g.get(ne.Schema),sessionStateSnapshot:v};if(u?.()){h.abort();return}return await h.done,x})}async function storeChangesInIndexedDb({persistenceKey:t,schema:c,changes:u,sessionId:h,sessionStateSnapshot:f,didCancel:g}){let b=t7+t;await withDb(b,async t=>{let b=t.transaction([ne.Records,ne.Schema,ne.SessionState],"readwrite"),v=b.objectStore(ne.Records),x=b.objectStore(ne.Schema),w=b.objectStore(ne.SessionState);for(let[t,c]of Object.entries(u.added))await v.put(c,t);for(let[t,c]of Object.values(u.updated))await v.put(c,c.id);for(let t of Object.keys(u.removed))await v.delete(t);if(x.put(c.serialize(),ne.Schema),f&&h?w.put({snapshot:f,updatedAt:Date.now(),id:h},h):(f||h)&&console.error("sessionStateSnapshot and instanceId must be provided together"),g?.())return b.abort();await b.done})}async function storeSnapshotInIndexedDb({persistenceKey:t,schema:c,snapshot:u,sessionId:h,sessionStateSnapshot:f,didCancel:g}){let b=t7+t;await withDb(b,async t=>{let b=t.transaction([ne.Records,ne.Schema,ne.SessionState],"readwrite"),v=b.objectStore(ne.Records),x=b.objectStore(ne.Schema),w=b.objectStore(ne.SessionState);for(let[t,c]of(await v.clear(),Object.entries(u)))await v.put(c,t);if(x.put(c.serialize(),ne.Schema),f&&h?w.put({snapshot:f,updatedAt:Date.now(),id:h},h):(f||h)&&console.error("sessionStateSnapshot and instanceId must be provided together"),g?.())return b.abort();await b.done})}async function pruneSessionState({persistenceKey:t,didCancel:c}){await withDb(t7+t,async t=>{let u=t.transaction([ne.SessionState],"readwrite"),h=u.objectStore(ne.SessionState),f=(await h.getAll()).sort((t,c)=>t.updatedAt-c.updatedAt);if(f.length<10){await u.done;return}let g=f.slice(0,f.length-10);for(let{id:t}of g)await h.delete(t);if(c?.())return u.abort();await u.done})}function getAllIndexDbNames(){let t=JSON.parse(window?.localStorage.getItem(t9)||"[]")??[];return Array.isArray(t)?t:[]}function addDbName(t){let c=new Set(getAllIndexDbNames());c.add(t),window?.localStorage.setItem(t9,JSON.stringify([...c]))}let nt=Symbol("UPDATE_INSTANCE_STATE"),msg=t=>t;let BroadcastChannelMock=class BroadcastChannelMock{onmessage;constructor(t){}postMessage(t){}close(){}};let nn="undefined"==typeof BroadcastChannel?BroadcastChannelMock:BroadcastChannel;let TLLocalSyncClient=class TLLocalSyncClient{constructor(t,{persistenceKey:c,sessionId:u=tq,onLoad:h,onLoadError:f},g=new nn(`tldraw-tab-sync-${c}`)){this.store=t,this.channel=g,"undefined"!=typeof window&&(window.tlsync=this),this.persistenceKey=c,this.sessionId=u,this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=createSessionStateSnapshotSignal(this.store),this.disposables.add(t.listen(({changes:t})=>{this.diffQueue.push(t),this.channel.postMessage(msg({type:"diff",storeId:this.store.id,changes:t,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(t.listen(()=>{this.diffQueue.push(nt),this.schedulePersist()},{scope:"session"})),this.connect(h,f),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(t=>"document"===t.scope).map(t=>t.typeName))}disposables=new Set;diffQueue=[];didDispose=!1;shouldDoFullDBWrite=!0;isReloading=!1;persistenceKey;sessionId;serializedSchema;isDebugging=!1;documentTypes;$sessionStateSnapshot;initTime=Date.now();debug(...t){this.isDebugging&&console.debug(...t)}async connect(t,c){let u;this.debug("connecting");try{u=await loadDataFromStore({persistenceKey:this.persistenceKey,sessionId:this.sessionId,didCancel:()=>this.didDispose})}catch(t){c(t),showCantReadFromIndexDbAlert(),"undefined"!=typeof window&&window.location.reload();return}if(this.debug("loaded data from store",u,"didDispose",this.didDispose),!this.didDispose)try{if(u){let t=Object.fromEntries(u.records.map(t=>[t.id,t])),h=u.sessionStateSnapshot??extractSessionStateFromLegacySnapshot(t),f=this.store.schema.migrateStoreSnapshot({store:t,schema:u.schema??this.store.schema.serializeEarliestVersion()});if("error"===f.type){console.error("failed to migrate store",f),c(Error(`Failed to migrate store: ${f.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(f.value).filter(t=>this.documentTypes.has(t.typeName)),"initialize")}),h&&loadSessionStateSnapshotIntoStore(this.store,h)}this.channel.onmessage=({data:t})=>{this.debug("got message",t);let u=(0,eQ.$F)(this.serializedSchema,t.schema??this.store.schema.serializeEarliestVersion());if(-1===u){let t=Date.now()-this.initTime;if(t<5e3){c(Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,window?.location?.reload?.();return}if(1===u){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}"diff"===t.type&&(this.debug("applying diff"),(0,eJ.ay)(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(t.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),t(this)}catch(t){if(this.debug("error loading data from store",t),this.didDispose)return;c(t);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(t=>t())}isPersisting=!1;didLastWriteError=!1;scheduledPersistTimeout=null;schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),this.scheduledPersistTimeout||(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?1e4:350))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),this.isPersisting||this.isReloading||this.store.isPossiblyCorrupted()||!this.shouldDoFullDBWrite&&!(this.diffQueue.length>0)||this.doPersist()}async doPersist(){(0,e1.hu)(!this.isPersisting,"persist already in progress"),this.isPersisting=!0,this.debug("doPersist start");let t=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await storeSnapshotInIndexedDb({persistenceKey:this.persistenceKey,schema:this.store.schema,snapshot:this.store.serialize(),didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value});else{let c=(0,eQ.bs)(t.filter(t=>t!==nt));await storeChangesInIndexedDb({persistenceKey:this.persistenceKey,changes:c,schema:this.store.schema,didCancel:()=>this.didDispose,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.value})}this.didLastWriteError=!1}catch(t){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",t),showCantWriteToIndexDbAlert(),"undefined"!=typeof window&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}};var nr=u(9968);function createTLStore({initialData:t,defaultName:c="",...u}){let h="schema"in u&&u.schema?u.schema:(0,e0.HH)({shapes:currentPageShapesToShapeMap((0,nr.m)("shapeUtils"in u&&u.shapeUtils?u.shapeUtils:[]))});return new eQ.yh({schema:h,initialData:t,props:{defaultName:c}})}function currentPageShapesToShapeMap(t){return Object.fromEntries(t.map(t=>[t.type,{props:t.props,migrations:t.migrations}]))}function useTLStore(t){let[c,u]=(0,U.useState)(()=>{let c=createTLStore(t);return t.snapshot&&c.loadSnapshot(t.snapshot),c}),h=(0,U.useRef)(t);if((0,U.useEffect)(()=>void(h.current=t)),Object.keys(h.current).some(c=>h.current[c]!==t[c])){let c=createTLStore(t);return t.snapshot&&c.loadSnapshot(t.snapshot),u(c),c}return c}function useLocalStore({persistenceKey:t,sessionId:c,...u}){let[h,f]=(0,U.useState)(null),g=useTLStore(u);return(0,U.useEffect)(()=>{let u=(0,tK.E)();if(!t){f({id:u,storeWithStatus:{status:"not-synced",store:g}});return}f({id:u,storeWithStatus:{status:"loading"}});let setStoreWithStatus=t=>{f(c=>c?.id===u?{id:u,storeWithStatus:t}:c)},h=new TLLocalSyncClient(g,{sessionId:c,persistenceKey:t,onLoad(){setStoreWithStatus({store:g,status:"synced-local"})},onLoadError(t){setStoreWithStatus({status:"error",error:t})}});return()=>{f(t=>t?.id===u?null:t),h.close()}},[t,g,c]),h?.storeWithStatus??{status:"loading"}}let ni=!1;if("undefined"!=typeof window){let t=window.navigator.userAgent,c=!!t.match(/iPad/i)||!!t.match(/iPhone/i),u=!!t.match(/WebKit/i);ni=c&&u&&!t.match(/CriOS/i)}function useSafariFocusOutFix(){let t=(0,e8.j)();U.useEffect(()=>{if(ni)return document.addEventListener("focusout",handleFocusOut),()=>document.removeEventListener("focusout",handleFocusOut);function handleFocusOut(c){(c.target instanceof HTMLInputElement&&"text"===c.target.type||c.target instanceof HTMLTextAreaElement)&&t.complete()}},[t])}function useZoomCss(){let t=(0,e8.j)(),c=useContainer();U.useEffect(()=>{let setScale=t=>c.style.setProperty("--tl-zoom",t.toString()),u=(0,e1.Ds)(setScale,100),h=new eJ.R0("useZoomCss",()=>{let c=t.currentPageShapeIds.size;c<300?setScale(t.zoomLevel):u(t.zoomLevel)});return h.attach(),h.execute(),()=>{h.detach()}},[t,c])}let no=[],na=[],ns=(0,U.memo)(function({store:t,components:c,className:u,user:h,...f}){let[g,b]=U.useState(null),v=(0,U.useMemo)(()=>h??(0,tz.L)(),[h]),x=c?.ErrorFallback===void 0?DefaultErrorFallback:c?.ErrorFallback,w={...f,shapeUtils:f.shapeUtils??no,tools:f.tools??na};return(0,G.jsx)("div",{ref:b,draggable:!1,className:eX("tl-container tl-theme__light",u),onPointerDown:stopEventPropagation,tabIndex:-1,children:(0,G.jsx)(OptionalErrorBoundary,{fallback:x,onError:t=>(0,e1.lw)(t,{tags:{origin:"react.tldraw-before-app"}}),children:g&&(0,G.jsx)(ContainerProvider,{container:g,children:(0,G.jsx)(EditorComponentsProvider,{overrides:c,children:t?t instanceof eQ.yh?(0,G.jsx)(TldrawEditorWithReadyStore,{...w,store:t,user:v}):(0,G.jsx)(nl,{...w,store:t,user:v}):(0,G.jsx)(TldrawEditorWithOwnStore,{...w,store:t,user:v})})})})})});function TldrawEditorWithOwnStore(t){let{defaultName:c,snapshot:u,initialData:h,shapeUtils:f,persistenceKey:g,sessionId:b,user:v}=t,x=useLocalStore({shapeUtils:f,initialData:h,persistenceKey:g,sessionId:b,defaultName:c,snapshot:u});return(0,G.jsx)(nl,{...t,store:x,user:v})}let nl=(0,U.memo)(function({store:t,user:c,...u}){let h=useContainer();switch((0,U.useLayoutEffect)(()=>{c.userPreferences.value.isDarkMode&&(h.classList.remove("tl-theme__light"),h.classList.add("tl-theme__dark"))},[h,c.userPreferences.value.isDarkMode]),t.status){case"error":throw t.error;case"loading":return(0,G.jsx)(LoadingScreen,{children:"Connecting..."})}return(0,G.jsx)(TldrawEditorWithReadyStore,{...u,store:t.store,user:c})});function TldrawEditorWithReadyStore({onMount:t,children:c,store:u,tools:h,shapeUtils:f,user:g,initialState:b,autoFocus:v=!0,inferDarkMode:x}){let{ErrorFallback:w}=useEditorComponents(),_=useContainer(),[k,E]=(0,U.useState)(null);(0,U.useLayoutEffect)(()=>{let t=new tB.M({store:u,shapeUtils:f,tools:h,getContainer:()=>_,user:g,initialState:b,inferDarkMode:x});return window.app=t,window.editor=t,E(t),()=>{t.dispose()}},[_,f,h,u,g,b,x]);let $=(0,U.useSyncExternalStore)((0,U.useCallback)(t=>k?(k.on("crash",t),()=>k.off("crash",t)):()=>{},[k]),()=>k?.crashingError??null);return k?(0,G.jsx)(OptionalErrorBoundary,{fallback:w,onError:t=>k.annotateError(t,{origin:"react.tldraw",willCrashApp:!0}),children:$?(0,G.jsx)(Crash,{crashingError:$}):(0,G.jsx)(e8.r.Provider,{value:k,children:(0,G.jsx)(Layout,{autoFocus:v,onMount:t,children:c})})}):null}function Layout({children:t,onMount:c,autoFocus:u}){useZoomCss(),useCursor(),useDarkMode(),useSafariFocusOutFix(),useForceUpdate(),useFocusEvents(u),useOnMount(c),useDPRMultiple();let h=(0,e8.j)();return h.updateViewportScreenBounds(),t??(0,G.jsx)(Canvas,{})}function Crash({crashingError:t}){throw t}function LoadingScreen({children:t}){let{Spinner:c}=useEditorComponents();return(0,G.jsxs)("div",{className:"tl-loading",children:[c?(0,G.jsx)(c,{}):null,t]})}function ErrorScreen({children:t}){return(0,G.jsx)("div",{className:"tl-loading",children:t})}function useOnMount(t){let c=(0,e8.j)(),u=useEvent(c=>{let u=t?.(c);return c.emit("mount"),window.tldrawReady=!0,u});U.useLayoutEffect(()=>{if(c)return u?.(c)},[c,u])}function HTMLContainer({children:t,className:c="",...u}){return(0,G.jsx)("div",{...u,className:`tl-html-container ${c}`,children:t})}let nc=(0,eJ.j)(function({x:t=0,y:c=0,rotation:u=0,...h}){let f=(0,e8.j)(),g=(0,U.useRef)(null);return(0,U.useLayoutEffect)(()=>{let{x:h,y:b,z:v}=f.camera,x=g.current;x&&void 0!==h&&(x.style.transform=`translate(${h}px, ${b}px) scale(${v}) rotate(${u}rad) translate(${t}px, ${c}px)`)},[f.camera,t,c,u]),(0,G.jsx)("div",{ref:g,...h,className:eX("tl-positioned",h.className)})});var nu=u(7295),nd=u(5894),np=u(2278),nh=u(9234),nf=u(5859);function resizeBox(t,c,u={}){let{newPoint:h,handle:f,scaleX:g,scaleY:b}=c,{minWidth:v=1,maxWidth:x=1/0,minHeight:w=1,maxHeight:_=1/0}=u,k=t.props.w*g,E=t.props.h*b,$=new tn.G(0,0);if(k>0){if(k<v){switch(f){case"top_left":case"left":case"bottom_left":$.x=k-v;break;case"top":case"bottom":$.x=(k-v)/2;break;default:$.x=0}k=v}}else if($.x=k,(k=-k)<v){switch(f){case"top_left":case"left":case"bottom_left":$.x=-k;break;default:$.x=-v}k=v}if(E>0){if(E<w){switch(f){case"top_left":case"top":case"top_right":$.y=E-w;break;case"right":case"left":$.y=(E-w)/2;break;default:$.y=0}E=w}}else if($.y=E,(E=-E)<w){switch(f){case"top_left":case"top":case"top_right":$.y=-E;break;default:$.y=-w}E=w}let{x:T,y:I}=$.rot(t.rotation).add(h);return{x:T,y:I,props:{w:Math.min(x,k),h:Math.min(_,E)}}}let BaseBoxShapeUtil=class BaseBoxShapeUtil extends nf.E{getGeometry(t){return new nh.z({width:t.props.w,height:t.props.h,isFilled:!0})}onResize=(t,c)=>resizeBox(t,c)};var ng=u(2772),nm=u(224);function getArrowPoints(t,c,u){let h;let f="end"===c?t.end.point:t.start.point,g="end"===c?t.start.point:t.end.point,b=t.isStraight?tn.G.Dist(g,f):Math.abs(t.bodyArc.length),v=Math.max(Math.min(b/5,3*u),u);if(t.isStraight)h=tn.G.Nudge(f,g,v);else{let u=(0,nm.bO)(f,v,t.handleArc.center,t.handleArc.radius);h="end"===c?t.handleArc.sweepFlag?u[0]:u[1]:t.handleArc.sweepFlag?u[1]:u[0]}return{point:f,int:h}}function getArrowhead({point:t,int:c}){let u=tn.G.RotWith(c,t,tt.PI/6),h=tn.G.RotWith(c,t,-tt.PI/6);return`M ${u.x} ${u.y} L ${t.x} ${t.y} L ${h.x} ${h.y}`}function getTriangleHead({point:t,int:c}){let u=tn.G.RotWith(c,t,tt.PI/6),h=tn.G.RotWith(c,t,-tt.PI/6);return`M ${u.x} ${u.y} L ${t.x} ${t.y} L ${h.x} ${h.y} Z`}function getInvertedTriangleHead({point:t,int:c}){let u=tn.G.Sub(c,t).div(2),h=tn.G.Add(t,tn.G.Rot(u,tt.gc)),f=tn.G.Sub(t,tn.G.Rot(u,tt.gc));return`M ${h.x} ${h.y} L ${c.x} ${c.y} L ${f.x} ${f.y} Z`}function getDotHead({point:t,int:c}){let u=tn.G.Lrp(t,c,.45),h=tn.G.Dist(u,t);return`M ${u.x-h},${u.y}
  a ${h},${h} 0 1,0 ${2*h},0
  a ${h},${h} 0 1,0 -${2*h},0 `}function getDiamondHead({point:t,int:c}){let u=tn.G.Lrp(t,c,.75),h=tn.G.RotWith(u,t,tt.PI/4),f=tn.G.RotWith(u,t,-tt.PI/4),g=tn.G.Lrp(h,f,.5);return g.add(tn.G.Sub(g,t)),`M ${g.x} ${g.y} L ${h.x} ${h.y} ${t.x} ${t.y} L ${f.x} ${f.y} Z`}function getSquareHead({int:t,point:c}){let u=tn.G.Lrp(c,t,.85),h=tn.G.Sub(u,c).div(2),f=tn.G.Add(c,tn.G.Rot(h,tt.gc)),g=tn.G.Sub(c,tn.G.Rot(h,tt.gc)),b=tn.G.Add(u,tn.G.Rot(h,tt.gc)),v=tn.G.Sub(u,tn.G.Rot(h,tt.gc));return`M ${f.x} ${f.y} L ${b.x} ${b.y} L ${v.x} ${v.y} L ${g.x} ${g.y} Z`}function getBarHead({int:t,point:c}){let u=tn.G.Sub(t,c).div(2),h=tn.G.Add(c,tn.G.Rot(u,tt.gc)),f=tn.G.Sub(c,tn.G.Rot(u,tt.gc));return`M ${h.x} ${h.y} L ${f.x} ${f.y}`}function getArrowheadPathForType(t,c,u){let h="end"===c?t.end.arrowhead:t.start.arrowhead;if("none"===h)return;let f=getArrowPoints(t,c,u);if(f){switch(h){case"bar":return getBarHead(f);case"square":return getSquareHead(f);case"diamond":return getDiamondHead(f);case"dot":return getDotHead(f);case"inverted":return getInvertedTriangleHead(f);case"arrow":return getArrowhead(f);case"triangle":return getTriangleHead(f)}return""}}var nb=u(4214),ny=u(7761),nv=u(3308),nx=u(2797);let Idle=class Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("pointing",t)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}};let Pointing=class Pointing extends nx.n{static id="pointing";markId="";wasFocusedOnEnter=!1;onEnter=()=>{let{isMenuOpen:t}=this.editor;this.wasFocusedOnEnter=!t};onPointerMove=t=>{if(this.editor.inputs.isDragging){let{originPagePoint:c}=this.editor.inputs,u=this.parent.shapeType,h=(0,e0.F1)();this.markId=`creating:${h}`,this.editor.mark(this.markId),this.editor.createShapes([{id:h,type:u,x:c.x,y:c.y,props:{w:1,h:1}}]).select(h),this.editor.setCurrentTool("select.resizing",{...t,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{originPagePoint:t}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);let c=this.parent.shapeType,u=(0,e0.F1)();this.editor.mark(this.markId),this.editor.createShapes([{id:u,type:c,x:t.x,y:t.y}]);let h=this.editor.getShape(u),{w:f,h:g}=this.editor.getShapeUtil(h).getDefaultProps(),b=new tn.G(f/2,g/2),v=this.editor.getShapeParentTransform(h);v&&b.rot(-v.rotation()),this.editor.updateShapes([{id:u,type:c,x:h.x-b.x,y:h.y-b.y}]),this.editor.setSelectedShapes([u]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle",{})}};let BaseBoxShapeTool=class BaseBoxShapeTool extends nx.n{static id="box";static initial="idle";static children=()=>[Idle,Pointing]};var nw=u(521);function useIsCropping(t){let c=(0,e8.j)();return(0,eJ.Hg)("isCropping",()=>c.croppingShapeId===t,[c,t])}function useIsEditing(t){let c=(0,e8.j)();return(0,eJ.Hg)("isEditing",()=>c.editingShapeId===t,[c,t])}function useSelectionEvents(t){let c=(0,e8.j)(),u=(0,U.useMemo)(function(){let u,h;return{onPointerDown:u=>{if(u.isKilled)return;if(2===u.button){c.dispatch({type:"pointer",target:"selection",handle:t,name:"right_click",...getPointerInfo(u)});return}if(0!==u.button)return;let h=loopToHtmlElement(u.currentTarget);function releaseCapture(){h.removeEventListener("pointerup",releaseCapture),releasePointerCapture(h,u)}setPointerCapture(h,u),h.addEventListener("pointerup",releaseCapture),c.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...getPointerInfo(u)}),stopEventPropagation(u)},onPointerMove:function(f){f.isKilled||0!==f.button||f.clientX===u&&f.clientY===h||(u=f.clientX,h=f.clientY,c.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...getPointerInfo(f)}))},onPointerUp:u=>{u.isKilled||0!==u.button||c.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...getPointerInfo(u)})}}},[c,t]);return u}var nS=u(9303),n_=u(1986),nk=u(4519);function getVerticesCountForLength(t,c=20){return Math.max(8,Math.ceil(t/c))}let Arc2d=class Arc2d extends nk.l{_center;radius;start;end;measure;length;angleStart;angleEnd;constructor(t){super({...t,isFilled:!1,isClosed:!1});let{center:c,radius:u,sweepFlag:h,largeArcFlag:f,start:g,end:b}=t;if(g.equals(b))throw Error("Arc must have different start and end points.");this.angleStart=tn.G.Angle(c,g),this.angleEnd=tn.G.Angle(c,b),this.measure=getArcMeasure(this.angleStart,this.angleEnd,h,f),this.length=this.measure*u,this.start=g,this.end=b,this._center=c,this.radius=u}nearestPoint(t){let c;let{_center:u,measure:h,radius:f,angleEnd:g,angleStart:b,start:v,end:x}=this,w=getPointInArcT(h,b,g,u.angle(t));if(w<=0)return v;if(w>=1)return x;let _=u.clone().add(t.clone().sub(u).uni().mul(f)),k=1/0;for(let u of[v,x,_])t.dist(u)<k&&(c=u,k=t.dist(u));if(!c)throw Error("nearest point not found");return c}hitTestLineSegment(t,c,u){let{_center:h,radius:f,measure:g,angleStart:b,angleEnd:v}=this,x=(0,nm.ZM)(t,c,h,f);return null!==x&&x.some(t=>{let c=getPointInArcT(g,b,v,h.angle(t));return c>=0&&c<=1})}getVertices(){let{_center:t,measure:c,length:u,radius:h,angleStart:f}=this,g=[];for(let b=0,v=getVerticesCountForLength(Math.abs(u));b<v+1;b++){let u=b/v*c,x=f+u;g.push(t.clone().add(new tn.G(Math.cos(x),Math.sin(x)).mul(h)))}return g}};function getPointInArcT(t,c,u,h){let f;if(!(Math.abs(t)>tt.PI))return(f=(0,tt.Z7)(c,h))/t;{f=(0,tt.Z7)(c,h);let g=(0,tt.Z7)(h,u);return Math.abs(f)<Math.abs(g)?f/t:(t-g)/t}}function getArcMeasure(t,c,u,h){let f=2*((c-t)%tt.yo)%tt.yo-(c-t)%tt.yo;return h?(tt.yo-Math.abs(f))*(u?1:-1):f}let Circle2d=class Circle2d extends nk.l{constructor(t){super({isClosed:!0,...t}),this.config=t;let{x:c=0,y:u=0,radius:h}=t;this.x=c,this.y=u,this._center=new tn.G(h+c,h+u),this.radius=h}_center;radius;x;y;getBounds(){return new nS.No(this.x,this.y,2*this.radius,2*this.radius)}getVertices(){let{_center:t,radius:c}=this,u=tt.yo*c,h=[];for(let f=0,g=getVerticesCountForLength(u);f<g;f++){let u=f/g*tt.yo;h.push(t.clone().add(tn.G.FromAngle(u).mul(c)))}return h}nearestPoint(t){let{_center:c,radius:u}=this;return c.equals(t)?tn.G.AddXY(c,u,0):c.clone().add(t.clone().sub(c).uni().mul(u))}hitTestLineSegment(t,c,u){let{_center:h,radius:f}=this;return null!==(0,nm.ZM)(t,c,h,f)}};var nC=u(6368);let CubicBezier2d=class CubicBezier2d extends nC.q{a;b;c;d;constructor(t){let{start:c,cp1:u,cp2:h,end:f}=t;super({...t,points:[c,f]}),this.a=c,this.b=u,this.c=h,this.d=f}getVertices(){let t=[],{a:c,b:u,c:h,d:f}=this;for(let g=0;g<=10;g++){let b=g/10;t.push(new tn.G((1-b)*(1-b)*(1-b)*c.x+3*((1-b)*(1-b))*b*u.x+3*(1-b)*(b*b)*h.x+b*b*b*f.x,(1-b)*(1-b)*(1-b)*c.y+3*((1-b)*(1-b))*b*u.y+3*(1-b)*(b*b)*h.y+b*b*b*f.y))}return t}midPoint(){return getAtT(this,.5)}nearestPoint(t){let c;let u=1/0;for(let h of this.segments){let f=h.nearestPoint(t),g=f.dist(t);g<u&&(c=f,u=g)}if(!c)throw Error("nearest point not found");return c}};function getAtT(t,c){let{a:u,b:h,c:f,d:g}=t;return new tn.G((1-c)*(1-c)*(1-c)*u.x+3*((1-c)*(1-c))*c*h.x+3*(1-c)*(c*c)*f.x+c*c*c*g.x,(1-c)*(1-c)*(1-c)*u.y+3*((1-c)*(1-c))*c*h.y+3*(1-c)*(c*c)*f.y+c*c*c*g.y)}let CubicSpline2d=class CubicSpline2d extends nk.l{points;constructor(t){super({...t,isClosed:!1,isFilled:!1});let{points:c}=t;this.points=c}_segments;get segments(){if(!this._segments){this._segments=[];let{points:t}=this,c=t.length,u=c-2;for(let h=0;h<c-1;h++){let c=0===h?t[0]:t[h-1],f=t[h],g=t[h+1],b=h===u?g:t[h+2],v=0===h?c:new tn.G(f.x+(g.x-c.x)/6*1.25,f.y+(g.y-c.y)/6*1.25),x=h===u?g:new tn.G(g.x-(b.x-f.x)/6*1.25,g.y-(b.y-f.y)/6*1.25);this._segments.push(new CubicBezier2d({start:f,cp1:v,cp2:x,end:g}))}}return this._segments}_length;get length(){return this._length||(this._length=this.segments.reduce((t,c)=>t+c.length,0)),this._length}getVertices(){let t=this.segments.reduce((t,c)=>t.concat(c.vertices),[]);return t.push(this.points[this.points.length-1]),t}nearestPoint(t){let c;let u=1/0;for(let h of this.segments){let f=h.nearestPoint(t),g=f.dist(t);g<u&&(c=f,u=g)}if(!c)throw Error("nearest point not found");return c}hitTestLineSegment(t,c,u){return this.segments.some(h=>h.hitTestLineSegment(t,c,u))}};var nP=u(4137);let Ellipse2d=class Ellipse2d extends nk.l{constructor(t){super({...t,isClosed:!0}),this.config=t;let{width:c,height:u}=t;this.w=c,this.h=u}w;h;_edges;get edges(){if(!this._edges){let{vertices:t}=this;this._edges=[];for(let c=0,u=t.length;c<u;c++){let h=t[c],f=t[(c+1)%u];this._edges.push(new nP.W({start:h,end:f}))}}return this._edges}getVertices(){let t=Math.max(1,this.w),c=Math.max(1,this.h),u=t/2,h=c/2,f=Math.pow(u-h,2)/Math.pow(u+h,2),g=tt.PI*(u+h)*(1+3*f/(10+Math.sqrt(4-3*f))),b=getVerticesCountForLength(g),v=tt.yo/b,x=Math.cos(v),w=Math.sin(v),_=0,k=1,E=0,$=1,T=Array(b);for(let t=0;t<b;t++)T[t]=new tn.G(u+u*k,h+h*_),E=w*k+x*_,$=x*k-w*_,_=E,k=$;return T}nearestPoint(t){let c;let u=1/0;for(let h of this.edges){let f=h.nearestPoint(t),g=f.dist(t);g<u&&(c=f,u=g)}if(!c)throw Error("nearest point not found");return c}hitTestLineSegment(t,c,u){return this.edges.some(h=>h.hitTestLineSegment(t,c,u))}getBounds(){return new nS.No(0,0,this.w,this.h)}};var nE=u(7684),n$=u(2042);let Stadium2d=class Stadium2d extends Ellipse2d{constructor(t){super({...t}),this.config=t}getVertices(){let t=Math.max(1,this.w),c=Math.max(1,this.h),u=t/2,h=c/2,f=Array(18);if(c>t)for(let t=0;t<9;t++){let h=-tt.PI+tt.PI*t/8,g=tt.PI*t/8;f[t]=new tn.G(u+u*Math.cos(h),u+u*Math.sin(h)),f[t+9]=new tn.G(u+u*Math.cos(g),c-u+u*Math.sin(g))}else for(let u=0;u<9;u++){let g=-tt.gc+tt.PI*u/8,b=tt.gc+-(tt.PI*u)/8;f[u]=new tn.G(t-h+h*Math.cos(g),c-h+h*Math.sin(g)),f[u+9]=new tn.G(h-h*Math.cos(b),c-h+h*Math.sin(b))}return f}};var nT=u(7539),nI=u(1230),nA=u(5279),nM=u(1605),nj=u(4078),nD=u(7556);async function hardReset({shouldReload:t=!0}={}){sessionStorage.clear(),await Promise.all(getAllIndexDbNames().map(t=>deleteDB(t))),localStorage.clear(),t&&window.location.reload()}function openWindow(t,c="_blank"){ti.openWindow(t,c)}"undefined"!=typeof window&&(window.__tldraw__hardReset=hardReset),u(9645),u(4770),u(6930),u(2880),u(9304);let nO=(0,U.createContext)(null);function AssetUrlsProvider({assetUrls:t,children:c}){return(0,G.jsx)(nO.Provider,{value:t,children:c})}function useAssetUrls(){let t=(0,U.useContext)(nO);if(!t)throw Error("useAssetUrls must be used within an AssetUrlsProvider");return t}let nF={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.print":"Print","action.redo":"Redo","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.view":"View","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy share link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy read-only link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to view (but not edit) this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrowheads","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},nR={locale:"en",label:"English",messages:nF};async function fetchTranslation(t,c){let u=await fetch(c.translations.en);if(!u.ok)return console.warn("No main translations found."),nR;if("en"===t)return nR;let h=e0.a2.find(c=>c.locale===t);if(!h)return console.warn(`No translation found for locale ${t}`),nR;let f=await fetch(c.translations[h.locale]),g=await f.json();if(!g)return console.warn(`No messages found for locale ${t}`),nR;let b=[];for(let t in nR.messages)g[t]||b.push(t);return b.length,{locale:t,label:h.label,messages:{...nR.messages,...g}}}let nL=U.createContext({}),useCurrentTranslation=()=>U.useContext(nL),nN=(0,eJ.j)(function({overrides:t,children:c}){let u=(0,e8.j)(),h=u.user.locale,f=useAssetUrls(),[g,b]=U.useState(()=>t&&t.en?{locale:"en",label:"English",messages:{...nF,...t.en}}:{locale:"en",label:"English",messages:nF});return U.useEffect(()=>{let c=!1;return async function(){let u=await fetchTranslation(h,f);u&&!c&&(t&&t[h]?b({...u,messages:{...u.messages,...t[h]}}):b(u))}(),()=>{c=!0}},[f,h,t]),(0,G.jsx)(nL.Provider,{value:g,children:c})});function useTranslation(){let t=useCurrentTranslation();return U.useCallback(function(c){return t.messages[c]??c},[t])}function Spinner(t){return(0,G.jsx)("svg",{width:16,height:16,viewBox:"0 0 16 16",...t,children:(0,G.jsxs)("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[(0,G.jsx)("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),(0,G.jsx)("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:(0,G.jsx)("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}let nz=(0,U.memo)(function({small:t,invertIcon:c,icon:u,color:h,className:f,...g}){let b=useAssetUrls(),v=b.icons[u],x=(0,U.useRef)(null);return(0,U.useLayoutEffect)(()=>{x?.current&&(x.current.style.webkitMask=`url(${v}) center 100% / 100% no-repeat`)},[x,v]),(0,G.jsx)("div",{...g,ref:x,className:eX("tlui-icon",{"tlui-icon__small":t},f),style:{color:h,mask:`url(${v}) center 100% / 100% no-repeat`,transform:c?"scale(-1, 1)":void 0}})}),nB="undefined"!=typeof window&&window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,nG=nB?"⌘":"Ctrl",nH=nB?"⌥":"Alt";function kbd(t){return t.split(",")[0].split("").map(t=>{let c=t.replace(/\$/g,nG).replace(/\?/g,nH).replace(/!/g,"⇧");return c[0].toUpperCase()+c.slice(1)})}function kbdStr(t){return"— "+t.split(",")[0].split("").map(t=>{let c=t.replace(/\$/g,nG).replace(/\?/g,nH).replace(/!/g,"⇧");return c[0].toUpperCase()+c.slice(1)}).join(" ")}function Kbd({children:t}){return(0,G.jsx)("kbd",{className:"tlui-kbd",children:kbd(t).map((t,c)=>(0,G.jsx)("span",{children:t},c))})}let nU=U.forwardRef(function({label:t,icon:c,invertIcon:u,iconLeft:h,smallIcon:f,kbd:g,isChecked:b=!1,type:v="normal",children:x,spinner:w,..._},k){let E=useTranslation(),$=t?E(t):"";return(0,G.jsxs)("button",{ref:k,draggable:!1,type:"button",..._,title:_.title??$,className:eX("tlui-button",`tlui-button__${v}`,_.className),children:[h&&(0,G.jsx)(nz,{icon:h,className:"tlui-icon-left",small:!0}),x,t&&(0,G.jsxs)("span",{draggable:!1,children:[$,b&&(0,G.jsx)(nz,{icon:"check"})]}),g&&(0,G.jsx)(Kbd,{children:g}),c&&!w&&(0,G.jsx)(nz,{icon:c,small:!!t||f,invertIcon:u}),w&&(0,G.jsx)(Spinner,{})]})});function Header({className:t,children:c}){return(0,G.jsx)("div",{className:eX("tlui-dialog__header",t),children:c})}function Title({className:t,children:c}){return(0,G.jsx)(eW,{dir:"ltr",className:eX("tlui-dialog__header__title",t),children:c})}function CloseButton(){return(0,G.jsx)("div",{className:"tlui-dialog__header__close",children:(0,G.jsx)(eK,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:(0,G.jsx)(nU,{"aria-label":"Close",onTouchEnd:t=>t.target.click(),children:(0,G.jsx)(nz,{small:!0,icon:"cross-2"})})})})}function Body({className:t,children:c,style:u}){return(0,G.jsx)("div",{className:eX("tlui-dialog__body",t),style:u,children:c})}function Footer({className:t,children:c}){return(0,G.jsx)("div",{className:eX("tlui-dialog__footer",t),children:c})}function $e02a7d9cb1dc128c$export$c74125a8e3af6bb2(t){let c=t+"CollectionProvider",[u,h]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(c),[f,g]=u(c,{collectionRef:{current:null},itemMap:new Map}),b=t+"CollectionSlot",v=U.forwardRef((t,c)=>{let{scope:u,children:h}=t,f=g(b,u),v=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,f.collectionRef);return U.createElement(J,{ref:v},h)}),x=t+"CollectionItemSlot",w="data-radix-collection-item",_=U.forwardRef((t,c)=>{let{scope:u,children:h,...f}=t,b=U.useRef(null),v=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,b),_=g(x,u);return U.useEffect(()=>(_.itemMap.set(b,{ref:b,...f}),()=>void _.itemMap.delete(b))),U.createElement(J,{[w]:"",ref:v},h)});return[{Provider:t=>{let{scope:c,children:u}=t,h=U.useRef(null),g=U.useRef(new Map).current;return U.createElement(f,{scope:c,itemMap:g,collectionRef:h},u)},Slot:v,ItemSlot:_},function(c){let u=g(t+"CollectionConsumer",c),h=U.useCallback(()=>{let t=u.collectionRef.current;if(!t)return[];let c=Array.from(t.querySelectorAll(`[${w}]`)),h=Array.from(u.itemMap.values()),f=h.sort((t,u)=>c.indexOf(t.ref.current)-c.indexOf(u.ref.current));return f},[u.collectionRef,u.itemMap]);return h},h]}let nV=(0,U.createContext)(void 0);function $f631663db3294ace$export$b39126d51d94e6f3(t){let c=(0,U.useContext)(nV);return t||c||"ltr"}let nW=["top","right","bottom","left"],nK=Math.min,nZ=Math.max,nY=Math.round,nq=Math.floor,createCoords=t=>({x:t,y:t}),nX={left:"right",right:"left",bottom:"top",top:"bottom"},nJ={start:"end",end:"start"};function evaluate(t,c){return"function"==typeof t?t(c):t}function getSide(t){return t.split("-")[0]}function getAlignment(t){return t.split("-")[1]}function getOppositeAxis(t){return"x"===t?"y":"x"}function getAxisLength(t){return"y"===t?"height":"width"}function getSideAxis(t){return["top","bottom"].includes(getSide(t))?"y":"x"}function getAlignmentSides(t,c,u){void 0===u&&(u=!1);let h=getAlignment(t),f=getOppositeAxis(getSideAxis(t)),g=getAxisLength(f),b="x"===f?h===(u?"end":"start")?"right":"left":"start"===h?"bottom":"top";return c.reference[g]>c.floating[g]&&(b=getOppositePlacement(b)),[b,getOppositePlacement(b)]}function getExpandedPlacements(t){let c=getOppositePlacement(t);return[getOppositeAlignmentPlacement(t),c,getOppositeAlignmentPlacement(c)]}function getOppositeAlignmentPlacement(t){return t.replace(/start|end/g,t=>nJ[t])}function getSideList(t,c,u){let h=["left","right"],f=["right","left"];switch(t){case"top":case"bottom":if(u)return c?f:h;return c?h:f;case"left":case"right":return c?["top","bottom"]:["bottom","top"];default:return[]}}function getOppositeAxisPlacements(t,c,u,h){let f=getAlignment(t),g=getSideList(getSide(t),"start"===u,h);return f&&(g=g.map(t=>t+"-"+f),c&&(g=g.concat(g.map(getOppositeAlignmentPlacement)))),g}function getOppositePlacement(t){return t.replace(/left|right|bottom|top/g,t=>nX[t])}function expandPaddingObject(t){return{top:0,right:0,bottom:0,left:0,...t}}function getPaddingObject(t){return"number"!=typeof t?expandPaddingObject(t):{top:t,right:t,bottom:t,left:t}}function rectToClientRect(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function computeCoordsFromPlacement(t,c,u){let h,{reference:f,floating:g}=t,b=getSideAxis(c),v=getOppositeAxis(getSideAxis(c)),x=getAxisLength(v),w=getSide(c),_="y"===b,k=f.x+f.width/2-g.width/2,E=f.y+f.height/2-g.height/2,$=f[x]/2-g[x]/2;switch(w){case"top":h={x:k,y:f.y-g.height};break;case"bottom":h={x:k,y:f.y+f.height};break;case"right":h={x:f.x+f.width,y:E};break;case"left":h={x:f.x-g.width,y:E};break;default:h={x:f.x,y:f.y}}switch(getAlignment(c)){case"start":h[v]-=$*(u&&_?-1:1);break;case"end":h[v]+=$*(u&&_?-1:1)}return h}let computePosition=async(t,c,u)=>{let{placement:h="bottom",strategy:f="absolute",middleware:g=[],platform:b}=u,v=g.filter(Boolean),x=await (null==b.isRTL?void 0:b.isRTL(c)),w=await b.getElementRects({reference:t,floating:c,strategy:f}),{x:_,y:k}=computeCoordsFromPlacement(w,h,x),E=h,$={},T=0;for(let u=0;u<v.length;u++){let{name:g,fn:I}=v[u],{x:M,y:j,data:D,reset:F}=await I({x:_,y:k,initialPlacement:h,placement:E,strategy:f,middlewareData:$,rects:w,platform:b,elements:{reference:t,floating:c}});if(_=null!=M?M:_,k=null!=j?j:k,$={...$,[g]:{...$[g],...D}},F&&T<=50){T++,"object"==typeof F&&(F.placement&&(E=F.placement),F.rects&&(w=!0===F.rects?await b.getElementRects({reference:t,floating:c,strategy:f}):F.rects),{x:_,y:k}=computeCoordsFromPlacement(w,E,x)),u=-1;continue}}return{x:_,y:k,placement:E,strategy:f,middlewareData:$}};async function detectOverflow(t,c){var u;void 0===c&&(c={});let{x:h,y:f,platform:g,rects:b,elements:v,strategy:x}=t,{boundary:w="clippingAncestors",rootBoundary:_="viewport",elementContext:k="floating",altBoundary:E=!1,padding:$=0}=evaluate(c,t),T=getPaddingObject($),I=v[E?"floating"===k?"reference":"floating":k],M=rectToClientRect(await g.getClippingRect({element:null==(u=await (null==g.isElement?void 0:g.isElement(I)))||u?I:I.contextElement||await (null==g.getDocumentElement?void 0:g.getDocumentElement(v.floating)),boundary:w,rootBoundary:_,strategy:x})),j="floating"===k?{...b.floating,x:h,y:f}:b.reference,D=await (null==g.getOffsetParent?void 0:g.getOffsetParent(v.floating)),F=await (null==g.isElement?void 0:g.isElement(D))&&await (null==g.getScale?void 0:g.getScale(D))||{x:1,y:1},L=rectToClientRect(g.convertOffsetParentRelativeRectToViewportRelativeRect?await g.convertOffsetParentRelativeRectToViewportRelativeRect({rect:j,offsetParent:D,strategy:x}):j);return{top:(M.top-L.top+T.top)/F.y,bottom:(L.bottom-M.bottom+T.bottom)/F.y,left:(M.left-L.left+T.left)/F.x,right:(L.right-M.right+T.right)/F.x}}let arrow=t=>({name:"arrow",options:t,async fn(c){let{x:u,y:h,placement:f,rects:g,platform:b,elements:v,middlewareData:x}=c,{element:w,padding:_=0}=evaluate(t,c)||{};if(null==w)return{};let k=getPaddingObject(_),E={x:u,y:h},$=getOppositeAxis(getSideAxis(f)),T=getAxisLength($),I=await b.getDimensions(w),M="y"===$,j=M?"clientHeight":"clientWidth",D=g.reference[T]+g.reference[$]-E[$]-g.floating[T],F=E[$]-g.reference[$],L=await (null==b.getOffsetParent?void 0:b.getOffsetParent(w)),B=L?L[j]:0;B&&await (null==b.isElement?void 0:b.isElement(L))||(B=v.floating[j]||g.floating[T]);let G=B/2-I[T]/2-1,U=nK(k[M?"top":"left"],G),V=nK(k[M?"bottom":"right"],G),K=B-I[T]-V,Z=B/2-I[T]/2+(D/2-F/2),Y=nZ(U,nK(Z,K)),X=!x.arrow&&null!=getAlignment(f)&&Z!=Y&&g.reference[T]/2-(Z<U?U:V)-I[T]/2<0,J=X?Z<U?Z-U:Z-K:0;return{[$]:E[$]+J,data:{[$]:Y,centerOffset:Z-Y-J,...X&&{alignmentOffset:J}},reset:X}}});function getSideOffsets(t,c){return{top:t.top-c.height,right:t.right-c.width,bottom:t.bottom-c.height,left:t.left-c.width}}function isAnySideFullyClipped(t){return nW.some(c=>t[c]>=0)}async function convertValueToCoords(t,c){let{placement:u,platform:h,elements:f}=t,g=await (null==h.isRTL?void 0:h.isRTL(f.floating)),b=getSide(u),v=getAlignment(u),x="y"===getSideAxis(u),w=["left","top"].includes(b)?-1:1,_=g&&x?-1:1,k=evaluate(c,t),{mainAxis:E,crossAxis:$,alignmentAxis:T}="number"==typeof k?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...k};return v&&"number"==typeof T&&($="end"===v?-1*T:T),x?{x:$*_,y:E*w}:{x:E*w,y:$*_}}function getNodeName(t){return isNode(t)?(t.nodeName||"").toLowerCase():"#document"}function getWindow(t){var c;return(null==t?void 0:null==(c=t.ownerDocument)?void 0:c.defaultView)||window}function getDocumentElement(t){var c;return null==(c=(isNode(t)?t.ownerDocument:t.document)||window.document)?void 0:c.documentElement}function isNode(t){return t instanceof Node||t instanceof getWindow(t).Node}function isElement(t){return t instanceof Element||t instanceof getWindow(t).Element}function isHTMLElement(t){return t instanceof HTMLElement||t instanceof getWindow(t).HTMLElement}function isShadowRoot(t){return"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof getWindow(t).ShadowRoot)}function isOverflowElement(t){let{overflow:c,overflowX:u,overflowY:h,display:f}=floating_ui_utils_dom_getComputedStyle(t);return/auto|scroll|overlay|hidden|clip/.test(c+h+u)&&!["inline","contents"].includes(f)}function isTableElement(t){return["table","td","th"].includes(getNodeName(t))}function isContainingBlock(t){let c=isWebKit(),u=floating_ui_utils_dom_getComputedStyle(t);return"none"!==u.transform||"none"!==u.perspective||!!u.containerType&&"normal"!==u.containerType||!c&&!!u.backdropFilter&&"none"!==u.backdropFilter||!c&&!!u.filter&&"none"!==u.filter||["transform","perspective","filter"].some(t=>(u.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(u.contain||"").includes(t))}function getContainingBlock(t){let c=getParentNode(t);for(;isHTMLElement(c)&&!isLastTraversableNode(c);){if(isContainingBlock(c))return c;c=getParentNode(c)}return null}function isWebKit(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(t){return["html","body","#document"].includes(getNodeName(t))}function floating_ui_utils_dom_getComputedStyle(t){return getWindow(t).getComputedStyle(t)}function getNodeScroll(t){return isElement(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function getParentNode(t){if("html"===getNodeName(t))return t;let c=t.assignedSlot||t.parentNode||isShadowRoot(t)&&t.host||getDocumentElement(t);return isShadowRoot(c)?c.host:c}function getNearestOverflowAncestor(t){let c=getParentNode(t);return isLastTraversableNode(c)?t.ownerDocument?t.ownerDocument.body:t.body:isHTMLElement(c)&&isOverflowElement(c)?c:getNearestOverflowAncestor(c)}function getOverflowAncestors(t,c,u){var h;void 0===c&&(c=[]),void 0===u&&(u=!0);let f=getNearestOverflowAncestor(t),g=f===(null==(h=t.ownerDocument)?void 0:h.body),b=getWindow(f);return g?c.concat(b,b.visualViewport||[],isOverflowElement(f)?f:[],b.frameElement&&u?getOverflowAncestors(b.frameElement):[]):c.concat(f,getOverflowAncestors(f,[],u))}function getCssDimensions(t){let c=floating_ui_utils_dom_getComputedStyle(t),u=parseFloat(c.width)||0,h=parseFloat(c.height)||0,f=isHTMLElement(t),g=f?t.offsetWidth:u,b=f?t.offsetHeight:h,v=nY(u)!==g||nY(h)!==b;return v&&(u=g,h=b),{width:u,height:h,$:v}}function unwrapElement(t){return isElement(t)?t:t.contextElement}function getScale(t){let c=unwrapElement(t);if(!isHTMLElement(c))return createCoords(1);let u=c.getBoundingClientRect(),{width:h,height:f,$:g}=getCssDimensions(c),b=(g?nY(u.width):u.width)/h,v=(g?nY(u.height):u.height)/f;return b&&Number.isFinite(b)||(b=1),v&&Number.isFinite(v)||(v=1),{x:b,y:v}}let nQ=createCoords(0);function getVisualOffsets(t){let c=getWindow(t);return isWebKit()&&c.visualViewport?{x:c.visualViewport.offsetLeft,y:c.visualViewport.offsetTop}:nQ}function shouldAddVisualOffsets(t,c,u){return void 0===c&&(c=!1),!!u&&(!c||u===getWindow(t))&&c}function getBoundingClientRect(t,c,u,h){void 0===c&&(c=!1),void 0===u&&(u=!1);let f=t.getBoundingClientRect(),g=unwrapElement(t),b=createCoords(1);c&&(h?isElement(h)&&(b=getScale(h)):b=getScale(t));let v=shouldAddVisualOffsets(g,u,h)?getVisualOffsets(g):createCoords(0),x=(f.left+v.x)/b.x,w=(f.top+v.y)/b.y,_=f.width/b.x,k=f.height/b.y;if(g){let t=getWindow(g),c=h&&isElement(h)?getWindow(h):h,u=t.frameElement;for(;u&&h&&c!==t;){let t=getScale(u),c=u.getBoundingClientRect(),h=floating_ui_utils_dom_getComputedStyle(u),f=c.left+(u.clientLeft+parseFloat(h.paddingLeft))*t.x,g=c.top+(u.clientTop+parseFloat(h.paddingTop))*t.y;x*=t.x,w*=t.y,_*=t.x,k*=t.y,x+=f,w+=g,u=getWindow(u).frameElement}}return rectToClientRect({width:_,height:k,x,y:w})}function convertOffsetParentRelativeRectToViewportRelativeRect(t){let{rect:c,offsetParent:u,strategy:h}=t,f=isHTMLElement(u),g=getDocumentElement(u);if(u===g)return c;let b={scrollLeft:0,scrollTop:0},v=createCoords(1),x=createCoords(0);if((f||!f&&"fixed"!==h)&&(("body"!==getNodeName(u)||isOverflowElement(g))&&(b=getNodeScroll(u)),isHTMLElement(u))){let t=getBoundingClientRect(u);v=getScale(u),x.x=t.x+u.clientLeft,x.y=t.y+u.clientTop}return{width:c.width*v.x,height:c.height*v.y,x:c.x*v.x-b.scrollLeft*v.x+x.x,y:c.y*v.y-b.scrollTop*v.y+x.y}}function getClientRects(t){return Array.from(t.getClientRects())}function getWindowScrollBarX(t){return getBoundingClientRect(getDocumentElement(t)).left+getNodeScroll(t).scrollLeft}function getDocumentRect(t){let c=getDocumentElement(t),u=getNodeScroll(t),h=t.ownerDocument.body,f=nZ(c.scrollWidth,c.clientWidth,h.scrollWidth,h.clientWidth),g=nZ(c.scrollHeight,c.clientHeight,h.scrollHeight,h.clientHeight),b=-u.scrollLeft+getWindowScrollBarX(t),v=-u.scrollTop;return"rtl"===floating_ui_utils_dom_getComputedStyle(h).direction&&(b+=nZ(c.clientWidth,h.clientWidth)-f),{width:f,height:g,x:b,y:v}}function getViewportRect(t,c){let u=getWindow(t),h=getDocumentElement(t),f=u.visualViewport,g=h.clientWidth,b=h.clientHeight,v=0,x=0;if(f){g=f.width,b=f.height;let t=isWebKit();(!t||t&&"fixed"===c)&&(v=f.offsetLeft,x=f.offsetTop)}return{width:g,height:b,x:v,y:x}}function getInnerBoundingClientRect(t,c){let u=getBoundingClientRect(t,!0,"fixed"===c),h=u.top+t.clientTop,f=u.left+t.clientLeft,g=isHTMLElement(t)?getScale(t):createCoords(1),b=t.clientWidth*g.x,v=t.clientHeight*g.y,x=f*g.x,w=h*g.y;return{width:b,height:v,x,y:w}}function getClientRectFromClippingAncestor(t,c,u){let h;if("viewport"===c)h=getViewportRect(t,u);else if("document"===c)h=getDocumentRect(getDocumentElement(t));else if(isElement(c))h=getInnerBoundingClientRect(c,u);else{let u=getVisualOffsets(t);h={...c,x:c.x-u.x,y:c.y-u.y}}return rectToClientRect(h)}function hasFixedPositionAncestor(t,c){let u=getParentNode(t);return!(u===c||!isElement(u)||isLastTraversableNode(u))&&("fixed"===floating_ui_utils_dom_getComputedStyle(u).position||hasFixedPositionAncestor(u,c))}function getClippingElementAncestors(t,c){let u=c.get(t);if(u)return u;let h=getOverflowAncestors(t,[],!1).filter(t=>isElement(t)&&"body"!==getNodeName(t)),f=null,g="fixed"===floating_ui_utils_dom_getComputedStyle(t).position,b=g?getParentNode(t):t;for(;isElement(b)&&!isLastTraversableNode(b);){let c=floating_ui_utils_dom_getComputedStyle(b),u=isContainingBlock(b);u||"fixed"!==c.position||(f=null);let v=g?!u&&!f:!u&&"static"===c.position&&!!f&&["absolute","fixed"].includes(f.position)||isOverflowElement(b)&&!u&&hasFixedPositionAncestor(t,b);v?h=h.filter(t=>t!==b):f=c,b=getParentNode(b)}return c.set(t,h),h}function getClippingRect(t){let{element:c,boundary:u,rootBoundary:h,strategy:f}=t,g="clippingAncestors"===u?getClippingElementAncestors(c,this._c):[].concat(u),b=[...g,h],v=b[0],x=b.reduce((t,u)=>{let h=getClientRectFromClippingAncestor(c,u,f);return t.top=nZ(h.top,t.top),t.right=nK(h.right,t.right),t.bottom=nK(h.bottom,t.bottom),t.left=nZ(h.left,t.left),t},getClientRectFromClippingAncestor(c,v,f));return{width:x.right-x.left,height:x.bottom-x.top,x:x.left,y:x.top}}function getDimensions(t){return getCssDimensions(t)}function getRectRelativeToOffsetParent(t,c,u){let h=isHTMLElement(c),f=getDocumentElement(c),g="fixed"===u,b=getBoundingClientRect(t,!0,g,c),v={scrollLeft:0,scrollTop:0},x=createCoords(0);if(h||!h&&!g){if(("body"!==getNodeName(c)||isOverflowElement(f))&&(v=getNodeScroll(c)),h){let t=getBoundingClientRect(c,!0,g,c);x.x=t.x+c.clientLeft,x.y=t.y+c.clientTop}else f&&(x.x=getWindowScrollBarX(f))}return{x:b.left+v.scrollLeft-x.x,y:b.top+v.scrollTop-x.y,width:b.width,height:b.height}}function getTrueOffsetParent(t,c){return isHTMLElement(t)&&"fixed"!==floating_ui_utils_dom_getComputedStyle(t).position?c?c(t):t.offsetParent:null}function getOffsetParent(t,c){let u=getWindow(t);if(!isHTMLElement(t))return u;let h=getTrueOffsetParent(t,c);for(;h&&isTableElement(h)&&"static"===floating_ui_utils_dom_getComputedStyle(h).position;)h=getTrueOffsetParent(h,c);return h&&("html"===getNodeName(h)||"body"===getNodeName(h)&&"static"===floating_ui_utils_dom_getComputedStyle(h).position&&!isContainingBlock(h))?u:h||getContainingBlock(t)||u}let getElementRects=async function(t){let{reference:c,floating:u,strategy:h}=t,f=this.getOffsetParent||getOffsetParent,g=this.getDimensions;return{reference:getRectRelativeToOffsetParent(c,await f(u),h),floating:{x:0,y:0,...await g(u)}}};function isRTL(t){return"rtl"===floating_ui_utils_dom_getComputedStyle(t).direction}let n0={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement:getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement:isElement,isRTL};function observeMove(t,c){let u,h=null,f=getDocumentElement(t);function cleanup(){clearTimeout(u),h&&h.disconnect(),h=null}function refresh(g,b){void 0===g&&(g=!1),void 0===b&&(b=1),cleanup();let{left:v,top:x,width:w,height:_}=t.getBoundingClientRect();if(g||c(),!w||!_)return;let k=nq(x),E=nq(f.clientWidth-(v+w)),$=nq(f.clientHeight-(x+_)),T=nq(v),I={rootMargin:-k+"px "+-E+"px "+-$+"px "+-T+"px",threshold:nZ(0,nK(1,b))||1},M=!0;function handleObserve(t){let c=t[0].intersectionRatio;if(c!==b){if(!M)return refresh();c?refresh(!1,c):u=setTimeout(()=>{refresh(!1,1e-7)},100)}M=!1}try{h=new IntersectionObserver(handleObserve,{...I,root:f.ownerDocument})}catch(t){h=new IntersectionObserver(handleObserve,I)}h.observe(t)}return refresh(!0),cleanup}function autoUpdate(t,c,u,h){let f;void 0===h&&(h={});let{ancestorScroll:g=!0,ancestorResize:b=!0,elementResize:v="function"==typeof ResizeObserver,layoutShift:x="function"==typeof IntersectionObserver,animationFrame:w=!1}=h,_=unwrapElement(t),k=g||b?[..._?getOverflowAncestors(_):[],...getOverflowAncestors(c)]:[];k.forEach(t=>{g&&t.addEventListener("scroll",u,{passive:!0}),b&&t.addEventListener("resize",u)});let E=_&&x?observeMove(_,u):null,$=-1,T=null;v&&(T=new ResizeObserver(t=>{let[h]=t;h&&h.target===_&&T&&(T.unobserve(c),cancelAnimationFrame($),$=requestAnimationFrame(()=>{T&&T.observe(c)})),u()}),_&&!w&&T.observe(_),T.observe(c));let I=w?getBoundingClientRect(t):null;function frameLoop(){let c=getBoundingClientRect(t);I&&(c.x!==I.x||c.y!==I.y||c.width!==I.width||c.height!==I.height)&&u(),I=c,f=requestAnimationFrame(frameLoop)}return w&&frameLoop(),u(),()=>{k.forEach(t=>{g&&t.removeEventListener("scroll",u),b&&t.removeEventListener("resize",u)}),E&&E(),T&&T.disconnect(),T=null,w&&cancelAnimationFrame(f)}}let floating_ui_dom_computePosition=(t,c,u)=>{let h=new Map,f={platform:n0,...u},g={...f.platform,_c:h};return computePosition(t,c,{...f,platform:g})},floating_ui_react_dom_arrow=t=>{function isRef(t){return({}).hasOwnProperty.call(t,"current")}return{name:"arrow",options:t,fn(c){let{element:u,padding:h}="function"==typeof t?t(c):t;if(u&&isRef(u)){if(null!=u.current)return arrow({element:u.current,padding:h}).fn(c)}else if(u)return arrow({element:u,padding:h}).fn(c);return{}}}};var n1="undefined"!=typeof document?U.useLayoutEffect:U.useEffect;function deepEqual(t,c){let u,h,f;if(t===c)return!0;if(typeof t!=typeof c)return!1;if("function"==typeof t&&t.toString()===c.toString())return!0;if(t&&c&&"object"==typeof t){if(Array.isArray(t)){if((u=t.length)!=c.length)return!1;for(h=u;0!=h--;)if(!deepEqual(t[h],c[h]))return!1;return!0}if((u=(f=Object.keys(t)).length)!==Object.keys(c).length)return!1;for(h=u;0!=h--;)if(!({}).hasOwnProperty.call(c,f[h]))return!1;for(h=u;0!=h--;){let u=f[h];if(("_owner"!==u||!t.$$typeof)&&!deepEqual(t[u],c[u]))return!1}return!0}return t!=t&&c!=c}function getDPR(t){if("undefined"==typeof window)return 1;let c=t.ownerDocument.defaultView||window;return c.devicePixelRatio||1}function roundByDPR(t,c){let u=getDPR(t);return Math.round(c*u)/u}function useLatestRef(t){let c=U.useRef(t);return n1(()=>{c.current=t}),c}function useFloating(t){void 0===t&&(t={});let{placement:c="bottom",strategy:u="absolute",middleware:h=[],platform:f,elements:{reference:g,floating:b}={},transform:v=!0,whileElementsMounted:x,open:w}=t,[_,k]=U.useState({x:0,y:0,strategy:u,placement:c,middlewareData:{},isPositioned:!1}),[E,$]=U.useState(h);deepEqual(E,h)||$(h);let[T,I]=U.useState(null),[M,j]=U.useState(null),D=U.useCallback(t=>{t!=G.current&&(G.current=t,I(t))},[I]),F=U.useCallback(t=>{t!==V.current&&(V.current=t,j(t))},[j]),L=g||T,B=b||M,G=U.useRef(null),V=U.useRef(null),K=U.useRef(_),Z=useLatestRef(x),Y=useLatestRef(f),J=U.useCallback(()=>{if(!G.current||!V.current)return;let t={placement:c,strategy:u,middleware:E};Y.current&&(t.platform=Y.current),floating_ui_dom_computePosition(G.current,V.current,t).then(t=>{let c={...t,isPositioned:!0};Q.current&&!deepEqual(K.current,c)&&(K.current=c,X.flushSync(()=>{k(c)}))})},[E,c,u,Y]);n1(()=>{!1===w&&K.current.isPositioned&&(K.current.isPositioned=!1,k(t=>({...t,isPositioned:!1})))},[w]);let Q=U.useRef(!1);n1(()=>(Q.current=!0,()=>{Q.current=!1}),[]),n1(()=>{if(L&&(G.current=L),B&&(V.current=B),L&&B){if(Z.current)return Z.current(L,B,J);J()}},[L,B,J,Z]);let ee=U.useMemo(()=>({reference:G,floating:V,setReference:D,setFloating:F}),[D,F]),et=U.useMemo(()=>({reference:L,floating:B}),[L,B]),en=U.useMemo(()=>{let t={position:u,left:0,top:0};if(!et.floating)return t;let c=roundByDPR(et.floating,_.x),h=roundByDPR(et.floating,_.y);return v?{...t,transform:"translate("+c+"px, "+h+"px)",...getDPR(et.floating)>=1.5&&{willChange:"transform"}}:{position:u,left:c,top:h}},[u,v,et.floating,_.x,_.y]);return U.useMemo(()=>({..._,update:J,refs:ee,elements:et,floatingStyles:en}),[_,J,ee,et,en])}let n2=(0,U.forwardRef)((t,c)=>{let{children:u,width:h=10,height:f=5,...g}=t;return(0,U.createElement)(ee.svg,_extends({},g,{ref:c,width:h,height:f,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),t.asChild?u:(0,U.createElement)("polygon",{points:"0,0 30,0 15,10"}))});function $db6c3485150b8e66$export$1ab7ae714698c4b8(t){let[c,u]=(0,U.useState)(void 0);return K(()=>{if(t){u({width:t.offsetWidth,height:t.offsetHeight});let c=new ResizeObserver(c=>{let h,f;if(!Array.isArray(c)||!c.length)return;let g=c[0];if("borderBoxSize"in g){let t=g.borderBoxSize,c=Array.isArray(t)?t[0]:t;h=c.inlineSize,f=c.blockSize}else h=t.offsetWidth,f=t.offsetHeight;u({width:h,height:f})});return c.observe(t,{box:"border-box"}),()=>c.unobserve(t)}u(void 0)},[t]),c}let n3="Popper",[n5,n4]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(n3),[n8,n6]=n5(n3),n7=(0,U.forwardRef)((t,c)=>{let{__scopePopper:u,virtualRef:h,...f}=t,g=n6("PopperAnchor",u),b=(0,U.useRef)(null),v=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,b);return(0,U.useEffect)(()=>{g.onAnchorChange((null==h?void 0:h.current)||b.current)}),h?null:(0,U.createElement)(ee.div,_extends({},f,{ref:v}))}),n9="PopperContent",[re,rt]=n5(n9),rn=(0,U.forwardRef)((t,c)=>{var u,h,f,g,b,v,x,w,_,k,E,$,T,I;let{__scopePopper:M,side:j="bottom",sideOffset:D=0,align:F="center",alignOffset:L=0,arrowPadding:B=0,avoidCollisions:G=!0,collisionBoundary:V=[],collisionPadding:Z=0,sticky:Y="partial",hideWhenDetached:X=!1,updatePositionStrategy:J="optimized",onPlaced:Q,...et}=t,en=n6(n9,M),[er,ei]=(0,U.useState)(null),eo=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>ei(t)),[ea,es]=(0,U.useState)(null),el=$db6c3485150b8e66$export$1ab7ae714698c4b8(ea),ec=null!==(u=null==el?void 0:el.width)&&void 0!==u?u:0,eu=null!==(h=null==el?void 0:el.height)&&void 0!==h?h:0,ed="number"==typeof Z?Z:{top:0,right:0,bottom:0,left:0,...Z},ep=Array.isArray(V)?V:[V],eh=ep.length>0,ef={padding:ed,boundary:ep.filter($cf1ac5d9fe0e8206$var$isNotNull),altBoundary:eh},{refs:eg,floatingStyles:em,placement:eb,isPositioned:ey,middlewareData:ev}=useFloating({strategy:"fixed",placement:j+("center"!==F?"-"+F:""),whileElementsMounted:(...t)=>{let c=autoUpdate(...t,{animationFrame:"always"===J});return c},elements:{reference:en.anchor},middleware:[{name:"offset",options:_={mainAxis:D+eu,alignmentAxis:L},async fn(t){let{x:c,y:u}=t,h=await convertValueToCoords(t,_);return{x:c+h.x,y:u+h.y,data:h}}},G&&{name:"shift",options:E={mainAxis:!0,crossAxis:!1,limiter:"partial"===Y?(void 0===k&&(k={}),{options:k,fn(t){let{x:c,y:u,placement:h,rects:f,middlewareData:g}=t,{offset:b=0,mainAxis:v=!0,crossAxis:x=!0}=evaluate(k,t),w={x:c,y:u},_=getSideAxis(h),E=getOppositeAxis(_),$=w[E],T=w[_],I=evaluate(b,t),M="number"==typeof I?{mainAxis:I,crossAxis:0}:{mainAxis:0,crossAxis:0,...I};if(v){let t="y"===E?"height":"width",c=f.reference[E]-f.floating[t]+M.mainAxis,u=f.reference[E]+f.reference[t]-M.mainAxis;$<c?$=c:$>u&&($=u)}if(x){var j,D;let t="y"===E?"width":"height",c=["top","left"].includes(getSide(h)),u=f.reference[_]-f.floating[t]+(c&&(null==(j=g.offset)?void 0:j[_])||0)+(c?0:M.crossAxis),b=f.reference[_]+f.reference[t]+(c?0:(null==(D=g.offset)?void 0:D[_])||0)-(c?M.crossAxis:0);T<u?T=u:T>b&&(T=b)}return{[E]:$,[_]:T}}}):void 0,...ef},async fn(t){let{x:c,y:u,placement:h}=t,{mainAxis:f=!0,crossAxis:g=!1,limiter:b={fn:t=>{let{x:c,y:u}=t;return{x:c,y:u}}},...v}=evaluate(E,t),x={x:c,y:u},w=await detectOverflow(t,v),_=getSideAxis(getSide(h)),k=getOppositeAxis(_),$=x[k],T=x[_];if(f){let t=$+w["y"===k?"top":"left"],c=$-w["y"===k?"bottom":"right"];$=nZ(t,nK($,c))}if(g){let t="y"===_?"top":"left",c="y"===_?"bottom":"right",u=T+w[t],h=T-w[c];T=nZ(u,nK(T,h))}let I=b.fn({...t,[k]:$,[_]:T});return{...I,data:{x:I.x-c,y:I.y-u}}}},G&&{name:"flip",options:$={...ef},async fn(t){var c,u,h,f,g;let{placement:b,middlewareData:v,rects:x,initialPlacement:w,platform:_,elements:k}=t,{mainAxis:E=!0,crossAxis:T=!0,fallbackPlacements:I,fallbackStrategy:M="bestFit",fallbackAxisSideDirection:j="none",flipAlignment:D=!0,...F}=evaluate($,t);if(null!=(c=v.arrow)&&c.alignmentOffset)return{};let L=getSide(b),B=getSide(w)===w,G=await (null==_.isRTL?void 0:_.isRTL(k.floating)),U=I||(B||!D?[getOppositePlacement(w)]:getExpandedPlacements(w));I||"none"===j||U.push(...getOppositeAxisPlacements(w,D,j,G));let V=[w,...U],K=await detectOverflow(t,F),Z=[],Y=(null==(u=v.flip)?void 0:u.overflows)||[];if(E&&Z.push(K[L]),T){let t=getAlignmentSides(b,x,G);Z.push(K[t[0]],K[t[1]])}if(Y=[...Y,{placement:b,overflows:Z}],!Z.every(t=>t<=0)){let t=((null==(h=v.flip)?void 0:h.index)||0)+1,c=V[t];if(c)return{data:{index:t,overflows:Y},reset:{placement:c}};let u=null==(f=Y.filter(t=>t.overflows[0]<=0).sort((t,c)=>t.overflows[1]-c.overflows[1])[0])?void 0:f.placement;if(!u)switch(M){case"bestFit":{let t=null==(g=Y.map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,c)=>t+c,0)]).sort((t,c)=>t[1]-c[1])[0])?void 0:g[0];t&&(u=t);break}case"initialPlacement":u=w}if(b!==u)return{reset:{placement:u}}}return{}}},{name:"size",options:T={...ef,apply:({elements:t,rects:c,availableWidth:u,availableHeight:h})=>{let{width:f,height:g}=c.reference,b=t.floating.style;b.setProperty("--radix-popper-available-width",`${u}px`),b.setProperty("--radix-popper-available-height",`${h}px`),b.setProperty("--radix-popper-anchor-width",`${f}px`),b.setProperty("--radix-popper-anchor-height",`${g}px`)}},async fn(t){let c,u;let{placement:h,rects:f,platform:g,elements:b}=t,{apply:v=()=>{},...x}=evaluate(T,t),w=await detectOverflow(t,x),_=getSide(h),k=getAlignment(h),E="y"===getSideAxis(h),{width:$,height:I}=f.floating;"top"===_||"bottom"===_?(c=_,u=k===(await (null==g.isRTL?void 0:g.isRTL(b.floating))?"start":"end")?"left":"right"):(u=_,c="end"===k?"top":"bottom");let M=I-w[c],j=$-w[u],D=!t.middlewareData.shift,F=M,L=j;if(E){let t=$-w.left-w.right;L=k||D?nK(j,t):t}else{let t=I-w.top-w.bottom;F=k||D?nK(M,t):t}if(D&&!k){let t=nZ(w.left,0),c=nZ(w.right,0),u=nZ(w.top,0),h=nZ(w.bottom,0);E?L=$-2*(0!==t||0!==c?t+c:nZ(w.left,w.right)):F=I-2*(0!==u||0!==h?u+h:nZ(w.top,w.bottom))}await v({...t,availableWidth:L,availableHeight:F});let B=await g.getDimensions(b.floating);return $!==B.width||I!==B.height?{reset:{rects:!0}}:{}}},ea&&floating_ui_react_dom_arrow({element:ea,padding:B}),$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:ec,arrowHeight:eu}),X&&{name:"hide",options:I={strategy:"referenceHidden",...ef},async fn(t){let{rects:c}=t,{strategy:u="referenceHidden",...h}=evaluate(I,t);switch(u){case"referenceHidden":{let u=await detectOverflow(t,{...h,elementContext:"reference"}),f=getSideOffsets(u,c.reference);return{data:{referenceHiddenOffsets:f,referenceHidden:isAnySideFullyClipped(f)}}}case"escaped":{let u=await detectOverflow(t,{...h,altBoundary:!0}),f=getSideOffsets(u,c.floating);return{data:{escapedOffsets:f,escaped:isAnySideFullyClipped(f)}}}default:return{}}}}]}),[ex,ew]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(eb),eS=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Q);K(()=>{ey&&(null==eS||eS())},[ey,eS]);let e_=null===(f=ev.arrow)||void 0===f?void 0:f.x,ek=null===(g=ev.arrow)||void 0===g?void 0:g.y,eC=(null===(b=ev.arrow)||void 0===b?void 0:b.centerOffset)!==0,[eP,eE]=(0,U.useState)();return K(()=>{er&&eE(window.getComputedStyle(er).zIndex)},[er]),(0,U.createElement)("div",{ref:eg.setFloating,"data-radix-popper-content-wrapper":"",style:{...em,transform:ey?em.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:eP,"--radix-popper-transform-origin":[null===(v=ev.transformOrigin)||void 0===v?void 0:v.x,null===(x=ev.transformOrigin)||void 0===x?void 0:x.y].join(" ")},dir:t.dir},(0,U.createElement)(re,{scope:M,placedSide:ex,onArrowChange:es,arrowX:e_,arrowY:ek,shouldHideArrow:eC},(0,U.createElement)(ee.div,_extends({"data-side":ex,"data-align":ew},et,{ref:eo,style:{...et.style,animation:ey?void 0:"none",opacity:null!==(w=ev.hide)&&void 0!==w&&w.referenceHidden?0:void 0}}))))}),rr={top:"bottom",right:"left",bottom:"top",left:"right"},ri=(0,U.forwardRef)(function(t,c){let{__scopePopper:u,...h}=t,f=rt("PopperArrow",u),g=rr[f.placedSide];return(0,U.createElement)("span",{ref:f.onArrowChange,style:{position:"absolute",left:f.arrowX,top:f.arrowY,[g]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[f.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[f.placedSide],visibility:f.shouldHideArrow?"hidden":void 0}},(0,U.createElement)(n2,_extends({},h,{ref:c,style:{...h.style,display:"block"}})))});function $cf1ac5d9fe0e8206$var$isNotNull(t){return null!==t}let $cf1ac5d9fe0e8206$var$transformOrigin=t=>({name:"transformOrigin",options:t,fn(c){var u,h,f,g,b;let{placement:v,rects:x,middlewareData:w}=c,_=(null===(u=w.arrow)||void 0===u?void 0:u.centerOffset)!==0,k=_?0:t.arrowWidth,E=_?0:t.arrowHeight,[$,T]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(v),I={start:"0%",center:"50%",end:"100%"}[T],M=(null!==(h=null===(f=w.arrow)||void 0===f?void 0:f.x)&&void 0!==h?h:0)+k/2,j=(null!==(g=null===(b=w.arrow)||void 0===b?void 0:b.y)&&void 0!==g?g:0)+E/2,D="",F="";return"bottom"===$?(D=_?I:`${M}px`,F=`${-E}px`):"top"===$?(D=_?I:`${M}px`,F=`${x.floating.height+E}px`):"right"===$?(D=`${-E}px`,F=_?I:`${j}px`):"left"===$&&(D=`${x.floating.width+E}px`,F=_?I:`${j}px`),{data:{x:D,y:F}}}});function $cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(t){let[c,u="center"]=t.split("-");return[c,u]}let $cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=t=>{let{__scopePopper:c,children:u}=t,[h,f]=(0,U.useState)(null);return(0,U.createElement)(n8,{scope:c,anchor:h,onAnchorChange:f},u)},ro="rovingFocusGroup.onEntryFocus",ra={bubbles:!1,cancelable:!0},rs="RovingFocusGroup",[rl,rc,ru]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2(rs),[rd,rp]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(rs,[ru]),[rh,rf]=rd(rs),rg=(0,U.forwardRef)((t,c)=>(0,U.createElement)(rl.Provider,{scope:t.__scopeRovingFocusGroup},(0,U.createElement)(rl.Slot,{scope:t.__scopeRovingFocusGroup},(0,U.createElement)(rm,_extends({},t,{ref:c}))))),rm=(0,U.forwardRef)((t,c)=>{let{__scopeRovingFocusGroup:u,orientation:h,loop:f=!1,dir:g,currentTabStopId:b,defaultCurrentTabStopId:v,onCurrentTabStopIdChange:x,onEntryFocus:w,..._}=t,k=(0,U.useRef)(null),E=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,k),$=$f631663db3294ace$export$b39126d51d94e6f3(g),[T=null,I]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:b,defaultProp:v,onChange:x}),[M,j]=(0,U.useState)(!1),D=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(w),F=rc(u),L=(0,U.useRef)(!1),[B,G]=(0,U.useState)(0);return(0,U.useEffect)(()=>{let t=k.current;if(t)return t.addEventListener(ro,D),()=>t.removeEventListener(ro,D)},[D]),(0,U.createElement)(rh,{scope:u,orientation:h,dir:$,loop:f,currentTabStopId:T,onItemFocus:(0,U.useCallback)(t=>I(t),[I]),onItemShiftTab:(0,U.useCallback)(()=>j(!0),[]),onFocusableItemAdd:(0,U.useCallback)(()=>G(t=>t+1),[]),onFocusableItemRemove:(0,U.useCallback)(()=>G(t=>t-1),[])},(0,U.createElement)(ee.div,_extends({tabIndex:M||0===B?-1:0,"data-orientation":h},_,{ref:E,style:{outline:"none",...t.style},onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onMouseDown,()=>{L.current=!0}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocus,t=>{let c=!L.current;if(t.target===t.currentTarget&&c&&!M){let c=new CustomEvent(ro,ra);if(t.currentTarget.dispatchEvent(c),!c.defaultPrevented){let t=F().filter(t=>t.focusable),c=t.find(t=>t.active),u=t.find(t=>t.id===T),h=[c,u,...t].filter(Boolean),f=h.map(t=>t.ref.current);$d7bdfb9eb0fdf311$var$focusFirst(f)}}L.current=!1}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onBlur,()=>j(!1))})))}),rb=(0,U.forwardRef)((t,c)=>{let{__scopeRovingFocusGroup:u,focusable:h=!0,active:f=!1,tabStopId:g,...b}=t,v=$1746a345f3d73bb7$export$f680877a34711e37(),x=g||v,w=rf("RovingFocusGroupItem",u),_=w.currentTabStopId===x,k=rc(u),{onFocusableItemAdd:E,onFocusableItemRemove:$}=w;return(0,U.useEffect)(()=>{if(h)return E(),()=>$()},[h,E,$]),(0,U.createElement)(rl.ItemSlot,{scope:u,id:x,focusable:h,active:f},(0,U.createElement)(ee.span,_extends({tabIndex:_?0:-1,"data-orientation":w.orientation},b,{ref:c,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onMouseDown,t=>{h?w.onItemFocus(x):t.preventDefault()}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocus,()=>w.onItemFocus(x)),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,t=>{if("Tab"===t.key&&t.shiftKey){w.onItemShiftTab();return}if(t.target!==t.currentTarget)return;let c=$d7bdfb9eb0fdf311$var$getFocusIntent(t,w.orientation,w.dir);if(void 0!==c){t.preventDefault();let u=k().filter(t=>t.focusable),h=u.map(t=>t.ref.current);if("last"===c)h.reverse();else if("prev"===c||"next"===c){"prev"===c&&h.reverse();let u=h.indexOf(t.currentTarget);h=w.loop?$d7bdfb9eb0fdf311$var$wrapArray(h,u+1):h.slice(u+1)}setTimeout(()=>$d7bdfb9eb0fdf311$var$focusFirst(h))}})})))}),ry={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $d7bdfb9eb0fdf311$var$getDirectionAwareKey(t,c){return"rtl"!==c?t:"ArrowLeft"===t?"ArrowRight":"ArrowRight"===t?"ArrowLeft":t}function $d7bdfb9eb0fdf311$var$getFocusIntent(t,c,u){let h=$d7bdfb9eb0fdf311$var$getDirectionAwareKey(t.key,u);if(!("vertical"===c&&["ArrowLeft","ArrowRight"].includes(h))&&!("horizontal"===c&&["ArrowUp","ArrowDown"].includes(h)))return ry[h]}function $d7bdfb9eb0fdf311$var$focusFirst(t){let c=document.activeElement;for(let u of t)if(u===c||(u.focus(),document.activeElement!==c))return}function $d7bdfb9eb0fdf311$var$wrapArray(t,c){return t.map((u,h)=>t[(c+h)%t.length])}let rv=["Enter"," "],rx=["ArrowUp","PageDown","End"],rw=["ArrowDown","PageUp","Home",...rx],rS={ltr:[...rv,"ArrowRight"],rtl:[...rv,"ArrowLeft"]},r_={ltr:["ArrowLeft"],rtl:["ArrowRight"]},rk="Menu",[rC,rP,rE]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2(rk),[r$,rT]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(rk,[rE,n4,rp]),rI=n4(),rA=rp(),[rM,rj]=r$(rk),[rD,rO]=r$(rk),rF=(0,U.forwardRef)((t,c)=>{let{__scopeMenu:u,...h}=t,f=rI(u);return(0,U.createElement)(n7,_extends({},f,h,{ref:c}))}),rR="MenuPortal",[rL,rN]=r$(rR,{forceMount:void 0}),rz="MenuContent",[rB,rG]=r$(rz),rH=(0,U.forwardRef)((t,c)=>{let u=rN(rz,t.__scopeMenu),{forceMount:h=u.forceMount,...f}=t,g=rj(rz,t.__scopeMenu),b=rO(rz,t.__scopeMenu);return(0,U.createElement)(rC.Provider,{scope:t.__scopeMenu},(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:h||g.open},(0,U.createElement)(rC.Slot,{scope:t.__scopeMenu},b.modal?(0,U.createElement)(rU,_extends({},f,{ref:c})):(0,U.createElement)(rV,_extends({},f,{ref:c})))))}),rU=(0,U.forwardRef)((t,c)=>{let u=rj(rz,t.__scopeMenu),h=(0,U.useRef)(null),f=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,h);return(0,U.useEffect)(()=>{let t=h.current;if(t)return hideOthers(t)},[]),(0,U.createElement)(rW,_extends({},t,{ref:f,trapFocus:u.open,disableOutsidePointerEvents:u.open,disableOutsideScroll:!0,onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocusOutside,t=>t.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>u.onOpenChange(!1)}))}),rV=(0,U.forwardRef)((t,c)=>{let u=rj(rz,t.__scopeMenu);return(0,U.createElement)(rW,_extends({},t,{ref:c,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>u.onOpenChange(!1)}))}),rW=(0,U.forwardRef)((t,c)=>{let{__scopeMenu:u,loop:h=!1,trapFocus:f,onOpenAutoFocus:g,onCloseAutoFocus:b,disableOutsidePointerEvents:v,onEntryFocus:x,onEscapeKeyDown:w,onPointerDownOutside:_,onFocusOutside:k,onInteractOutside:E,onDismiss:$,disableOutsideScroll:T,...I}=t,M=rj(rz,u),j=rO(rz,u),D=rI(u),F=rA(u),L=rP(u),[B,G]=(0,U.useState)(null),V=(0,U.useRef)(null),K=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,V,M.onContentChange),Z=(0,U.useRef)(0),Y=(0,U.useRef)(""),X=(0,U.useRef)(0),Q=(0,U.useRef)(null),ee=(0,U.useRef)("right"),et=(0,U.useRef)(0),en=T?ek:U.Fragment,ei=T?{as:J,allowPinchZoom:!0}:void 0,handleTypeaheadSearch=t=>{var c,u;let h=Y.current+t,f=L().filter(t=>!t.disabled),g=document.activeElement,b=null===(c=f.find(t=>t.ref.current===g))||void 0===c?void 0:c.textValue,v=f.map(t=>t.textValue),x=$6cc32821e9371a1c$var$getNextMatch(v,h,b),w=null===(u=f.find(t=>t.textValue===x))||void 0===u?void 0:u.ref.current;!function updateSearch(t){Y.current=t,window.clearTimeout(Z.current),""!==t&&(Z.current=window.setTimeout(()=>updateSearch(""),1e3))}(h),w&&setTimeout(()=>w.focus())};(0,U.useEffect)(()=>()=>window.clearTimeout(Z.current),[]),$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c();let eo=(0,U.useCallback)(t=>{var c,u;let h=ee.current===(null===(c=Q.current)||void 0===c?void 0:c.side);return h&&$6cc32821e9371a1c$var$isPointerInGraceArea(t,null===(u=Q.current)||void 0===u?void 0:u.area)},[]);return(0,U.createElement)(rB,{scope:u,searchRef:Y,onItemEnter:(0,U.useCallback)(t=>{eo(t)&&t.preventDefault()},[eo]),onItemLeave:(0,U.useCallback)(t=>{var c;eo(t)||(null===(c=V.current)||void 0===c||c.focus(),G(null))},[eo]),onTriggerLeave:(0,U.useCallback)(t=>{eo(t)&&t.preventDefault()},[eo]),pointerGraceTimerRef:X,onPointerGraceIntentChange:(0,U.useCallback)(t=>{Q.current=t},[])},(0,U.createElement)(en,ei,(0,U.createElement)(el,{asChild:!0,trapped:f,onMountAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(g,t=>{var c;t.preventDefault(),null===(c=V.current)||void 0===c||c.focus()}),onUnmountAutoFocus:b},(0,U.createElement)(er,{asChild:!0,disableOutsidePointerEvents:v,onEscapeKeyDown:w,onPointerDownOutside:_,onFocusOutside:k,onInteractOutside:E,onDismiss:$},(0,U.createElement)(rg,_extends({asChild:!0},F,{dir:j.dir,orientation:"vertical",loop:h,currentTabStopId:B,onCurrentTabStopIdChange:G,onEntryFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(x,t=>{j.isUsingKeyboardRef.current||t.preventDefault()})}),(0,U.createElement)(rn,_extends({role:"menu","aria-orientation":"vertical","data-state":$6cc32821e9371a1c$var$getOpenState(M.open),"data-radix-menu-content":"",dir:j.dir},D,I,{ref:K,style:{outline:"none",...I.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(I.onKeyDown,t=>{let c=t.target,u=c.closest("[data-radix-menu-content]")===t.currentTarget,h=t.ctrlKey||t.altKey||t.metaKey,f=1===t.key.length;u&&("Tab"===t.key&&t.preventDefault(),!h&&f&&handleTypeaheadSearch(t.key));let g=V.current;if(t.target!==g||!rw.includes(t.key))return;t.preventDefault();let b=L().filter(t=>!t.disabled),v=b.map(t=>t.ref.current);rx.includes(t.key)&&v.reverse(),$6cc32821e9371a1c$var$focusFirst(v)}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onBlur,t=>{t.currentTarget.contains(t.target)||(window.clearTimeout(Z.current),Y.current="")}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerMove,$6cc32821e9371a1c$var$whenMouse(t=>{let c=t.target,u=et.current!==t.clientX;if(t.currentTarget.contains(c)&&u){let c=t.clientX>et.current?"right":"left";ee.current=c,et.current=t.clientX}}))})))))))}),rK=(0,U.forwardRef)((t,c)=>{let{__scopeMenu:u,...h}=t;return(0,U.createElement)(ee.div,_extends({role:"group"},h,{ref:c}))}),rZ=((t,c)=>{let{__scopeMenu:u,...h}=t;return(0,U.createElement)(ee.div,_extends({},h,{ref:c}))},"MenuItem"),rY="menu.itemSelect",rq=(0,U.forwardRef)((t,c)=>{let{disabled:u=!1,onSelect:h,...f}=t,g=(0,U.useRef)(null),b=rO(rZ,t.__scopeMenu),v=rG(rZ,t.__scopeMenu),x=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,g),w=(0,U.useRef)(!1);return(0,U.createElement)(rX,_extends({},f,{ref:x,disabled:u,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onClick,()=>{let t=g.current;if(!u&&t){let c=new CustomEvent(rY,{bubbles:!0,cancelable:!0});t.addEventListener(rY,t=>null==h?void 0:h(t),{once:!0}),$8927f6f2acc4f386$export$6d1a0317bde7de7f(t,c),c.defaultPrevented?w.current=!1:b.onClose()}}),onPointerDown:c=>{var u;null===(u=t.onPointerDown)||void 0===u||u.call(t,c),w.current=!0},onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerUp,t=>{var c;w.current||null===(c=t.currentTarget)||void 0===c||c.click()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,t=>{let c=""!==v.searchRef.current;!u&&(!c||" "!==t.key)&&rv.includes(t.key)&&(t.currentTarget.click(),t.preventDefault())})}))}),rX=(0,U.forwardRef)((t,c)=>{let{__scopeMenu:u,disabled:h=!1,textValue:f,...g}=t,b=rG(rZ,u),v=rA(u),x=(0,U.useRef)(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,x),[_,k]=(0,U.useState)(!1),[E,$]=(0,U.useState)("");return(0,U.useEffect)(()=>{let t=x.current;if(t){var c;$((null!==(c=t.textContent)&&void 0!==c?c:"").trim())}},[g.children]),(0,U.createElement)(rC.ItemSlot,{scope:u,disabled:h,textValue:null!=f?f:E},(0,U.createElement)(rb,_extends({asChild:!0},v,{focusable:!h}),(0,U.createElement)(ee.div,_extends({role:"menuitem","data-highlighted":_?"":void 0,"aria-disabled":h||void 0,"data-disabled":h?"":void 0},g,{ref:w,onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerMove,$6cc32821e9371a1c$var$whenMouse(t=>{if(h)b.onItemLeave(t);else if(b.onItemEnter(t),!t.defaultPrevented){let c=t.currentTarget;c.focus()}})),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerLeave,$6cc32821e9371a1c$var$whenMouse(t=>b.onItemLeave(t))),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocus,()=>k(!0)),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onBlur,()=>k(!1))}))))}),rJ=(0,U.forwardRef)((t,c)=>{let{checked:u=!1,onCheckedChange:h,...f}=t;return(0,U.createElement)(r2,{scope:t.__scopeMenu,checked:u},(0,U.createElement)(rq,_extends({role:"menuitemcheckbox","aria-checked":$6cc32821e9371a1c$var$isIndeterminate(u)?"mixed":u},f,{ref:c,"data-state":$6cc32821e9371a1c$var$getCheckedState(u),onSelect:$e42e1063c40fb3ef$export$b9ecd428b558ff10(f.onSelect,()=>null==h?void 0:h(!!$6cc32821e9371a1c$var$isIndeterminate(u)||!u),{checkForDefaultPrevented:!1})})))}),[rQ,r0]=r$("MenuRadioGroup",{value:void 0,onValueChange:()=>{}}),r1=((t,c)=>{let{value:u,onValueChange:h,...f}=t,g=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(h);return(0,U.createElement)(rQ,{scope:t.__scopeMenu,value:u,onValueChange:g},(0,U.createElement)(rK,_extends({},f,{ref:c})))},"MenuItemIndicator"),[r2,r3]=r$(r1,{checked:!1}),r5=(0,U.forwardRef)((t,c)=>{let{__scopeMenu:u,forceMount:h,...f}=t,g=r3(r1,u);return(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:h||$6cc32821e9371a1c$var$isIndeterminate(g.checked)||!0===g.checked},(0,U.createElement)(ee.span,_extends({},f,{ref:c,"data-state":$6cc32821e9371a1c$var$getCheckedState(g.checked)})))}),r4=((t,c)=>{let{__scopeMenu:u,...h}=t;return(0,U.createElement)(ee.div,_extends({role:"separator","aria-orientation":"horizontal"},h,{ref:c}))},"MenuSub"),[r8,r6]=r$(r4),r7="MenuSubTrigger",r9=(0,U.forwardRef)((t,c)=>{let u=rj(r7,t.__scopeMenu),h=rO(r7,t.__scopeMenu),f=r6(r7,t.__scopeMenu),g=rG(r7,t.__scopeMenu),b=(0,U.useRef)(null),{pointerGraceTimerRef:v,onPointerGraceIntentChange:x}=g,w={__scopeMenu:t.__scopeMenu},_=(0,U.useCallback)(()=>{b.current&&window.clearTimeout(b.current),b.current=null},[]);return(0,U.useEffect)(()=>_,[_]),(0,U.useEffect)(()=>{let t=v.current;return()=>{window.clearTimeout(t),x(null)}},[v,x]),(0,U.createElement)(rF,_extends({asChild:!0},w),(0,U.createElement)(rX,_extends({id:f.triggerId,"aria-haspopup":"menu","aria-expanded":u.open,"aria-controls":f.contentId,"data-state":$6cc32821e9371a1c$var$getOpenState(u.open)},t,{ref:$6ed0406888f73fc4$export$43e446d32b3d21af(c,f.onTriggerChange),onClick:c=>{var h;null===(h=t.onClick)||void 0===h||h.call(t,c),t.disabled||c.defaultPrevented||(c.currentTarget.focus(),u.open||u.onOpenChange(!0))},onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerMove,$6cc32821e9371a1c$var$whenMouse(c=>{g.onItemEnter(c),c.defaultPrevented||t.disabled||u.open||b.current||(g.onPointerGraceIntentChange(null),b.current=window.setTimeout(()=>{u.onOpenChange(!0),_()},100))})),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerLeave,$6cc32821e9371a1c$var$whenMouse(t=>{var c,h;_();let f=null===(c=u.content)||void 0===c?void 0:c.getBoundingClientRect();if(f){let c=null===(h=u.content)||void 0===h?void 0:h.dataset.side,b="right"===c,x=f[b?"left":"right"],w=f[b?"right":"left"];g.onPointerGraceIntentChange({area:[{x:t.clientX+(b?-5:5),y:t.clientY},{x:x,y:f.top},{x:w,y:f.top},{x:w,y:f.bottom},{x:x,y:f.bottom}],side:c}),window.clearTimeout(v.current),v.current=window.setTimeout(()=>g.onPointerGraceIntentChange(null),300)}else{if(g.onTriggerLeave(t),t.defaultPrevented)return;g.onPointerGraceIntentChange(null)}})),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,c=>{let f=""!==g.searchRef.current;if(!t.disabled&&(!f||" "!==c.key)&&rS[h.dir].includes(c.key)){var b;u.onOpenChange(!0),null===(b=u.content)||void 0===b||b.focus(),c.preventDefault()}})})))}),ie=(0,U.forwardRef)((t,c)=>{let u=rN(rz,t.__scopeMenu),{forceMount:h=u.forceMount,...f}=t,g=rj(rz,t.__scopeMenu),b=rO(rz,t.__scopeMenu),v=r6("MenuSubContent",t.__scopeMenu),x=(0,U.useRef)(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,x);return(0,U.createElement)(rC.Provider,{scope:t.__scopeMenu},(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:h||g.open},(0,U.createElement)(rC.Slot,{scope:t.__scopeMenu},(0,U.createElement)(rW,_extends({id:v.contentId,"aria-labelledby":v.triggerId},f,{ref:w,align:"start",side:"rtl"===b.dir?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:t=>{var c;b.isUsingKeyboardRef.current&&(null===(c=x.current)||void 0===c||c.focus()),t.preventDefault()},onCloseAutoFocus:t=>t.preventDefault(),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocusOutside,t=>{t.target!==v.trigger&&g.onOpenChange(!1)}),onEscapeKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onEscapeKeyDown,t=>{b.onClose(),t.preventDefault()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,t=>{let c=t.currentTarget.contains(t.target),u=r_[b.dir].includes(t.key);if(c&&u){var h;g.onOpenChange(!1),null===(h=v.trigger)||void 0===h||h.focus(),t.preventDefault()}})})))))});function $6cc32821e9371a1c$var$getOpenState(t){return t?"open":"closed"}function $6cc32821e9371a1c$var$isIndeterminate(t){return"indeterminate"===t}function $6cc32821e9371a1c$var$getCheckedState(t){return $6cc32821e9371a1c$var$isIndeterminate(t)?"indeterminate":t?"checked":"unchecked"}function $6cc32821e9371a1c$var$focusFirst(t){let c=document.activeElement;for(let u of t)if(u===c||(u.focus(),document.activeElement!==c))return}function $6cc32821e9371a1c$var$wrapArray(t,c){return t.map((u,h)=>t[(c+h)%t.length])}function $6cc32821e9371a1c$var$getNextMatch(t,c,u){let h=c.length>1&&Array.from(c).every(t=>t===c[0]),f=h?c[0]:c,g=u?t.indexOf(u):-1,b=$6cc32821e9371a1c$var$wrapArray(t,Math.max(g,0)),v=1===f.length;v&&(b=b.filter(t=>t!==u));let x=b.find(t=>t.toLowerCase().startsWith(f.toLowerCase()));return x!==u?x:void 0}function $6cc32821e9371a1c$var$isPointInPolygon(t,c){let{x:u,y:h}=t,f=!1;for(let t=0,g=c.length-1;t<c.length;g=t++){let b=c[t].x,v=c[t].y,x=c[g].x,w=c[g].y,_=v>h!=w>h&&u<(x-b)*(h-v)/(w-v)+b;_&&(f=!f)}return f}function $6cc32821e9371a1c$var$isPointerInGraceArea(t,c){if(!c)return!1;let u={x:t.clientX,y:t.clientY};return $6cc32821e9371a1c$var$isPointInPolygon(u,c)}function $6cc32821e9371a1c$var$whenMouse(t){return c=>"mouse"===c.pointerType?t(c):void 0}let $6cc32821e9371a1c$export$be92b6f5f03c0fe9=t=>{let{__scopeMenu:c,open:u=!1,children:h,dir:f,onOpenChange:g,modal:b=!0}=t,v=rI(c),[x,w]=(0,U.useState)(null),_=(0,U.useRef)(!1),k=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g),E=$f631663db3294ace$export$b39126d51d94e6f3(f);return(0,U.useEffect)(()=>{let handleKeyDown=()=>{_.current=!0,document.addEventListener("pointerdown",handlePointer,{capture:!0,once:!0}),document.addEventListener("pointermove",handlePointer,{capture:!0,once:!0})},handlePointer=()=>_.current=!1;return document.addEventListener("keydown",handleKeyDown,{capture:!0}),()=>{document.removeEventListener("keydown",handleKeyDown,{capture:!0}),document.removeEventListener("pointerdown",handlePointer,{capture:!0}),document.removeEventListener("pointermove",handlePointer,{capture:!0})}},[]),(0,U.createElement)($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,v,(0,U.createElement)(rM,{scope:c,open:u,onOpenChange:k,content:x,onContentChange:w},(0,U.createElement)(rD,{scope:c,onClose:(0,U.useCallback)(()=>k(!1),[k]),isUsingKeyboardRef:_,dir:E,modal:b},h)))},$6cc32821e9371a1c$export$602eac185826482c=t=>{let{__scopeMenu:c,forceMount:u,children:h,container:f}=t,g=rj(rR,c);return(0,U.createElement)(rL,{scope:c,forceMount:u},(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:u||g.open},(0,U.createElement)(eu,{asChild:!0,container:f},h)))},$6cc32821e9371a1c$export$d7a01e11500dfb6f=t=>{let{__scopeMenu:c,children:u,open:h=!1,onOpenChange:f}=t,g=rj(r4,c),b=rI(c),[v,x]=(0,U.useState)(null),[w,_]=(0,U.useState)(null),k=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(f);return(0,U.useEffect)(()=>(!1===g.open&&k(!1),()=>k(!1)),[g.open,k]),(0,U.createElement)($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,b,(0,U.createElement)(rM,{scope:c,open:h,onOpenChange:k,content:w,onContentChange:_},(0,U.createElement)(r8,{scope:c,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),triggerId:$1746a345f3d73bb7$export$f680877a34711e37(),trigger:v,onTriggerChange:x},u)))},it="DropdownMenu",[ir,ii]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(it,[rT]),io=rT(),[ia,is]=ir(it),il=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,disabled:h=!1,...f}=t,g=is("DropdownMenuTrigger",u),b=io(u);return(0,U.createElement)(rF,_extends({asChild:!0},b),(0,U.createElement)(ee.button,_extends({type:"button",id:g.triggerId,"aria-haspopup":"menu","aria-expanded":g.open,"aria-controls":g.open?g.contentId:void 0,"data-state":g.open?"open":"closed","data-disabled":h?"":void 0,disabled:h},f,{ref:$6ed0406888f73fc4$export$43e446d32b3d21af(c,g.triggerRef),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDown,t=>{h||0!==t.button||!1!==t.ctrlKey||(g.onOpenToggle(),g.open||t.preventDefault())}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,t=>{!h&&(["Enter"," "].includes(t.key)&&g.onOpenToggle(),"ArrowDown"===t.key&&g.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(t.key)&&t.preventDefault())})})))}),ic=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=is("DropdownMenuContent",u),g=io(u),b=(0,U.useRef)(!1);return(0,U.createElement)(rH,_extends({id:f.contentId,"aria-labelledby":f.triggerId},g,h,{ref:c,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onCloseAutoFocus,t=>{var c;b.current||null===(c=f.triggerRef.current)||void 0===c||c.focus(),b.current=!1,t.preventDefault()}),onInteractOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onInteractOutside,t=>{let c=t.detail.originalEvent,u=0===c.button&&!0===c.ctrlKey,h=2===c.button||u;(!f.modal||h)&&(b.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),iu=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=io(u);return(0,U.createElement)(rK,_extends({},f,h,{ref:c}))}),id=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=io(u);return(0,U.createElement)(rq,_extends({},f,h,{ref:c}))}),ip=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=io(u);return(0,U.createElement)(rJ,_extends({},f,h,{ref:c}))}),ih=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=io(u);return(0,U.createElement)(r5,_extends({},f,h,{ref:c}))}),ig=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=io(u);return(0,U.createElement)(r9,_extends({},f,h,{ref:c}))}),im=(0,U.forwardRef)((t,c)=>{let{__scopeDropdownMenu:u,...h}=t,f=io(u);return(0,U.createElement)(ie,_extends({},f,h,{ref:c,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),$d08ef79370b62062$export$be92b6f5f03c0fe9=t=>{let{__scopeDropdownMenu:c,children:u,dir:h,open:f,defaultOpen:g,onOpenChange:b,modal:v=!0}=t,x=io(c),w=(0,U.useRef)(null),[_=!1,k]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:f,defaultProp:g,onChange:b});return(0,U.createElement)(ia,{scope:c,triggerId:$1746a345f3d73bb7$export$f680877a34711e37(),triggerRef:w,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),open:_,onOpenChange:k,onOpenToggle:(0,U.useCallback)(()=>k(t=>!t),[k]),modal:v},(0,U.createElement)($6cc32821e9371a1c$export$be92b6f5f03c0fe9,_extends({},x,{open:_,onOpenChange:k,dir:h,modal:v}),u))},$d08ef79370b62062$export$602eac185826482c=t=>{let{__scopeDropdownMenu:c,...u}=t,h=io(c);return(0,U.createElement)($6cc32821e9371a1c$export$602eac185826482c,_extends({},h,u))},$d08ef79370b62062$export$d7a01e11500dfb6f=t=>{let{__scopeDropdownMenu:c,children:u,open:h,onOpenChange:f,defaultOpen:g}=t,b=io(c),[v=!1,x]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:h,defaultProp:g,onChange:f});return(0,U.createElement)($6cc32821e9371a1c$export$d7a01e11500dfb6f,_extends({},b,{open:v,onOpenChange:x}),u)},defaultEventHandler=()=>void 0,ib=U.createContext({});function UiEventsProvider({onEvent:t,children:c}){return(0,G.jsx)(ib.Provider,{value:t??defaultEventHandler,children:c})}function useUiEvents(){let t=U.useContext(ib);return t??defaultEventHandler}function useMenuIsOpen(t,c){let u=(0,e8.j)(),h=(0,U.useRef)(!1),f=useUiEvents(),g=(0,U.useCallback)(f=>{h.current=f,u.batch(()=>{f?(u.complete(),u.addOpenMenu(t)):u.updateInstanceState({openMenus:u.openMenus.filter(c=>!c.startsWith(t))}),c?.(f)})},[u,t,c]);(0,U.useEffect)(()=>(h.current&&(f("open-menu",{source:"unknown",id:t}),u.addOpenMenu(t)),()=>{h.current&&(u.deleteOpenMenu(t),u.openMenus.forEach(c=>{c.startsWith(t)&&(f("close-menu",{source:"unknown",id:t}),u.deleteOpenMenu(c))}),h.current=!1)}),[u,t,f]);let b=(0,eJ.Hg)("is menu open",()=>u.openMenus.includes(t),[u,t]);return[b,g]}function Root({id:t,children:c,modal:u=!1}){let[h,f]=useMenuIsOpen(t);return(0,G.jsx)($d08ef79370b62062$export$be92b6f5f03c0fe9,{open:h,dir:"ltr",modal:u,onOpenChange:f,children:c})}function Trigger({children:t,"data-testid":c}){return(0,G.jsx)(il,{dir:"ltr","data-testid":c,asChild:!0,onTouchEnd:t=>preventDefault(t),children:t})}function Content({side:t="bottom",align:c="start",sideOffset:u=8,alignOffset:h=8,children:f}){let g=useContainer();return(0,G.jsx)($d08ef79370b62062$export$602eac185826482c,{dir:"ltr",container:g,children:(0,G.jsx)(ic,{className:"tlui-menu",align:c,sideOffset:u,side:t,alignOffset:h,collisionPadding:4,children:f})})}function Sub({id:t,children:c}){let[u,h]=useMenuIsOpen(t);return(0,G.jsx)($d08ef79370b62062$export$d7a01e11500dfb6f,{open:u,onOpenChange:h,children:c})}function SubTrigger({label:t,"data-testid":c,"data-direction":u}){return(0,G.jsx)(ig,{dir:"ltr","data-direction":u,"data-testid":c,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button tlui-menu__submenu__trigger",label:t,icon:"chevron-right"})})}function SubContent({alignOffset:t=0,sideOffset:c=5,children:u}){let h=useContainer();return(0,G.jsx)($d08ef79370b62062$export$602eac185826482c,{container:h,dir:"ltr",children:(0,G.jsx)(im,{className:"tlui-menu tlui-menu__submenu__content",alignOffset:t,sideOffset:c,collisionPadding:4,children:u})})}function Group({children:t,size:c="medium"}){return(0,G.jsx)(iu,{dir:"ltr",className:"tlui-menu__group","data-size":c,children:t})}function Indicator(){return(0,G.jsx)(ih,{dir:"ltr",asChild:!0,children:(0,G.jsx)(nz,{icon:"check"})})}function Item({noClose:t,...c}){return(0,G.jsx)(id,{dir:"ltr",asChild:!0,onClick:t||void 0!==c.isChecked?preventDefault:void 0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",...c})})}function CheckboxItem({children:t,onSelect:c,...u}){return(0,G.jsxs)(ip,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:t=>{c?.(t),preventDefault(t)},...u,children:[(0,G.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${u.checked?1:.5})`,opacity:u.checked?1:.5},children:(0,G.jsx)(nz,{small:!0,icon:u.checked?"check":"checkbox-empty"})}),t]})}function RadioItem({children:t,onSelect:c,...u}){return(0,G.jsxs)(ip,{dir:"ltr",className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",onSelect:t=>{c?.(t),preventDefault(t)},...u,children:[(0,G.jsx)(ih,{dir:"ltr",className:"tlui-menu__checkbox-item__check",children:(0,G.jsx)(nz,{icon:"check"})}),t]})}let TldrawHandles=({children:t})=>{let c=(0,e8.j)(),u=(0,eJ.Hg)("shouldDisplayHandles",()=>c.isInAny("select.idle","select.pointing_handle"),[c]);return u?(0,G.jsx)("svg",{className:"tl-user-handles tl-overlays__item",children:t}):null},TldrawHoveredShapeIndicator=({shapeId:t})=>{let c=(0,e8.j)(),u=(0,eJ.Hg)("show hovered",()=>c.isIn("select.editing_shape")?c.hoveredShapeId!==c.editingShapeId:c.isInAny("select.idle"),[c]);return u?(0,G.jsx)(te,{className:"tl-user-indicator__hovered",id:t}):null},{PI:iy}=Math,iv=iy+1e-4;function getStrokeOutlinePoints_getStrokeOutlinePoints(t,c={}){let u;let{size:h=16,smoothing:f=.5,start:g={},end:b={},last:v=!1}=c,{cap:x=!0}=g,{cap:w=!0}=b;if(0===t.length||h<=0)return[];let _=t[0],k=t[t.length-1],E=k.runningLength,$=!1===g.taper?0:!0===g.taper?Math.max(h,E):g.taper,T=!1===b.taper?0:!0===b.taper?Math.max(h,E):b.taper,I=Math.pow(h*f,2),M=[],j=[],D=t[0].vector,F=t[0].point,L=F,B=F,G=L,U=!1;for(let c=0;c<t.length;c++){u=t[c];let{point:h,vector:f}=t[c],g=u.vector.dpr(D),b=(c<t.length-1?t[c+1]:t[c]).vector,v=c<t.length-1?b.dpr(u.vector):1,x=g<0&&!U,w=null!==v&&v<.2;if(x||w){if(v>-.62&&E-u.runningLength>u.radius){let t=D.clone().mul(u.radius),c=D.clone().cpr(b);c<0?(B=tn.G.Add(h,t),G=tn.G.Sub(h,t)):(B=tn.G.Sub(h,t),G=tn.G.Add(h,t)),M.push(B),j.push(G)}else{let t=D.clone().mul(u.radius).per(),c=tn.G.Sub(u.input,t);for(let t=1/13,h=0;h<1;h+=t)B=tn.G.RotWith(c,u.input,iv*h),M.push(B),G=tn.G.RotWith(c,u.input,iv+-(iv*h)),j.push(G)}F=B,L=G,w&&(U=!0);continue}if(U=!1,u===_||u===k){let t=tn.G.Per(f).mul(u.radius);M.push(tn.G.Sub(h,t)),j.push(tn.G.Add(h,t));continue}let $=tn.G.Lrp(b,f,v).per().mul(u.radius);B=tn.G.Sub(h,$),(c<=1||tn.G.Dist2(F,B)>I)&&(M.push(B),F=B),G=tn.G.Add(h,$),(c<=1||tn.G.Dist2(L,G)>I)&&(j.push(G),L=G),D=f}let V=_.point,K=t.length>1?t[t.length-1].point:tn.G.AddXY(_.point,1,1);if(1===t.length&&(!($||T)||v)){let t=tn.G.Add(V,tn.G.Sub(V,K).uni().per().mul(-_.radius)),c=[];for(let u=1/13,h=u;h<=1;h+=u)c.push(tn.G.RotWith(t,V,2*iv*h));return c}let Z=[];if($||T&&1===t.length);else if(x)for(let t=1/8,c=t;c<=1;c+=t){let t=tn.G.RotWith(j[0],V,iv*c);Z.push(t)}else{let t=tn.G.Sub(M[0],j[0]),c=tn.G.Mul(t,.5),u=tn.G.Mul(t,.51);Z.push(tn.G.Sub(V,c),tn.G.Sub(V,u),tn.G.Add(V,u),tn.G.Add(V,c))}let Y=[],X=k.vector.clone().per().neg();if(T||$&&1===t.length)Y.push(K);else if(w){let t=tn.G.Add(K,tn.G.Mul(X,k.radius));for(let c=1/29,u=c;u<1;u+=c)Y.push(tn.G.RotWith(t,K,3*iv*u))}else Y.push(tn.G.Add(K,tn.G.Mul(X,k.radius)),tn.G.Add(K,tn.G.Mul(X,.99*k.radius)),tn.G.Sub(K,tn.G.Mul(X,.99*k.radius)),tn.G.Sub(K,tn.G.Mul(X,k.radius)));return M.concat(Y,j.reverse(),Z)}function getStrokePoints(t,c={}){let u,h;let{streamline:f=.5,size:g=16,simulatePressure:b=!1}=c;if(0===t.length)return[];let v=.15+(1-f)*.85,x=t.map(tn.G.From),w=0;if(!b){let t=x[0];for(;t&&!(t.z>=.025);)x.shift(),t=x[0]}if(!b){let t=x[x.length-1];for(;t&&!(t.z>=.01);)x.pop(),t=x[x.length-1]}if(0===x.length)return[{point:tn.G.From(t[0]),input:tn.G.From(t[0]),pressure:b?.5:.15,vector:new tn.G(1,1),distance:0,runningLength:0,radius:1}];let _=x[1];for(;_&&!(tn.G.Dist(_,x[0])>g/3);)x[0].z=Math.max(x[0].z,_.z),x.splice(1,1),_=x[1];let k=x.pop();for(_=x[x.length-1];_&&!(tn.G.Dist(_,k)>g/3);)x.pop(),_=x[x.length-1],w++;x.push(k);let E=c.last||!c.simulatePressure||x.length>1&&tn.G.Dist(x[x.length-1],x[x.length-2])<g||w>0;if(2===x.length&&c.simulatePressure){let t=x[1];x=x.slice(0,-1);for(let c=1;c<5;c++){let u=tn.G.Lrp(x[0],t,c/4);u.z=(x[0].z+(t.z-x[0].z))*c/4,x.push(u)}}let $=[{point:x[0],input:x[0],pressure:b?.5:x[0].z,vector:new tn.G(1,1),distance:0,runningLength:0,radius:1}],T=0,I=$[0];E&&f>0&&x.push(x[x.length-1].clone());for(let t=1,f=x.length;t<f;t++)if(u=!v||c.last&&t===f-1?x[t].clone():x[t].clone().lrp(I.point,1-v),!I.point.equals(u)){if(T+=h=tn.G.Dist(u,I.point),t<4&&T<g)continue;I={input:x[t],point:u,pressure:b?.5:x[t].z,vector:tn.G.Sub(I.point,u).uni(),distance:h,runningLength:T,radius:1},$.push(I)}if($[1]?.vector&&($[0].vector=$[1].vector.clone()),T<1){let t=Math.max(.5,...$.map(t=>t.pressure));$.forEach(c=>c.pressure=t)}return $}let{min:ix}=Math;function setStrokePointRadii(t,c){let u,h;let{size:f=16,thinning:g=.5,simulatePressure:b=!0,easing:v=t=>t,start:x={},end:w={}}=c,{easing:_=n_.L.easeOutQuad}=x,{easing:k=n_.L.easeOutCubic}=w,E=t[t.length-1].runningLength,$=t[0].pressure;if(!b&&E<f){let c=t.reduce((t,c)=>Math.max(t,c.pressure),.5);return t.forEach(t=>{t.pressure=c,t.radius=f*v(.5-g*(.5-t.pressure))}),t}{let c;for(let u=0,g=t.length;u<g&&!((h=t[u]).runningLength>5*f);u++){let t=ix(1,h.distance/f);if(b){let u=ix(1,1-t);c=ix(1,$+(u-$)*(.275*t))}else c=ix(1,$+(h.pressure-$)*.5);$+=(c-$)*.5}for(let c=0;c<t.length;c++){if(h=t[c],g){let{pressure:t}=h,c=ix(1,h.distance/f);if(b){let u=ix(1,1-c);t=ix(1,$+(u-$)*(.275*c))}else t=ix(1,$+(t-$)*(.275*c));h.radius=f*v(.5-g*(.5-t)),$=t}else h.radius=f/2;void 0===u&&(u=h.radius)}}let T=!1===x.taper?0:!0===x.taper?Math.max(f,E):x.taper,I=!1===w.taper?0:!0===w.taper?Math.max(f,E):w.taper;if(T||I)for(let c=0;c<t.length;c++){h=t[c];let{runningLength:u}=h,f=u<T?_(u/T):1,g=E-u<I?k((E-u)/I):1;h.radius=Math.max(.01,h.radius*Math.min(f,g))}return t}function getStroke(t,c={}){return getStrokeOutlinePoints_getStrokeOutlinePoints(setStrokePointRadii(getStrokePoints(t,c),c),c)}let TldrawScribble=({scribble:t,zoom:c,color:u,opacity:h,className:f})=>{let g;if(!t.points.length)return null;let b=getStroke(t.points,{size:t.size/c,start:{taper:!0,easing:n_.L.linear},last:"stopping"===t.state,simulatePressure:!1,streamline:.32});if(b.length<4){let u=t.size/c/2,{x:h,y:f}=t.points[t.points.length-1];g=`M ${h-u},${f} a ${u},${u} 0 1,0 ${2*u},0 a ${u},${u} 0 1,0 ${-(2*u)},0`}else g=getSvgPathFromPoints_getSvgPathFromPoints(b);return(0,G.jsx)("svg",{className:f?eX("tl-overlays__item",f):f,children:(0,G.jsx)("path",{className:"tl-scribble",d:g,fill:u??`var(--color-${t.color})`,opacity:h??t.opacity})})},TldrawSelectionBackground=({bounds:t,rotation:c})=>{let u=(0,e8.j)(),h=(0,eJ.Hg)("should display",()=>u.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[u]);return h?(0,G.jsx)(DefaultSelectionBackground,{bounds:t,rotation:c}):null};function useReadonly(){let t=(0,e8.j)();return(0,eJ.Hg)("isReadonlyMode",()=>t.instanceState.isReadonly,[t])}function CropHandles({size:t,width:c,height:u,hideAlternateHandles:h}){let f=(0,tt.$Z)(t/3),g=f/2;return(0,G.jsxs)("svg",{className:"tl-overlays__item",children:[(0,G.jsx)("polyline",{className:"tl-corner-crop-handle",points:`
						${(0,tt.$Z)(0-g)},${(0,tt.$Z)(t)} 
						${(0,tt.$Z)(0-g)},${(0,tt.$Z)(0-g)} 
						${(0,tt.$Z)(t)},${(0,tt.$Z)(0-g)}`,strokeWidth:f,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),(0,G.jsx)("line",{className:eX("tl-corner-crop-edge-handle",{"tl-hidden":h}),x1:(0,tt.$Z)(c/2-t),y1:(0,tt.$Z)(0-g),x2:(0,tt.$Z)(c/2+t),y2:(0,tt.$Z)(0-g),strokeWidth:f,"data-testid":"selection.crop.top","aria-label":"top handle"}),(0,G.jsx)("polyline",{className:eX("tl-corner-crop-handle",{"tl-hidden":h}),points:`
						${(0,tt.$Z)(c-t)},${(0,tt.$Z)(0-g)} 
						${(0,tt.$Z)(c+g)},${(0,tt.$Z)(0-g)} 
						${(0,tt.$Z)(c+g)},${(0,tt.$Z)(t)}`,strokeWidth:f,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),(0,G.jsx)("line",{className:eX("tl-corner-crop-edge-handle",{"tl-hidden":h}),x1:(0,tt.$Z)(c+g),y1:(0,tt.$Z)(u/2-t),x2:(0,tt.$Z)(c+g),y2:(0,tt.$Z)(u/2+t),strokeWidth:f,"data-testid":"selection.crop.right","aria-label":"right handle"}),(0,G.jsx)("polyline",{className:"tl-corner-crop-handle",points:`
						${(0,tt.$Z)(c+g)},${(0,tt.$Z)(u-t)} 
						${(0,tt.$Z)(c+g)},${(0,tt.$Z)(u+g)}
						${(0,tt.$Z)(c-t)},${(0,tt.$Z)(u+g)}`,strokeWidth:f,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),(0,G.jsx)("line",{className:eX("tl-corner-crop-edge-handle",{"tl-hidden":h}),x1:(0,tt.$Z)(c/2-t),y1:(0,tt.$Z)(u+g),x2:(0,tt.$Z)(c/2+t),y2:(0,tt.$Z)(u+g),strokeWidth:f,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),(0,G.jsx)("polyline",{className:eX("tl-corner-crop-handle",{"tl-hidden":h}),points:`
						${(0,tt.$Z)(0+t)},${(0,tt.$Z)(u+g)} 
						${(0,tt.$Z)(0-g)},${(0,tt.$Z)(u+g)}
						${(0,tt.$Z)(0-g)},${(0,tt.$Z)(u-t)}`,strokeWidth:f,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),(0,G.jsx)("line",{className:eX("tl-corner-crop-edge-handle",{"tl-hidden":h}),x1:(0,tt.$Z)(0-g),y1:(0,tt.$Z)(u/2-t),x2:(0,tt.$Z)(0-g),y2:(0,tt.$Z)(u/2+t),strokeWidth:f,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}let iw="undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1,iS=(0,eJ.j)(function({bounds:t,rotation:c}){let u=(0,e8.j)(),h=(0,U.useRef)(null),f=useReadonly(),g=useSelectionEvents("top"),b=useSelectionEvents("right"),v=useSelectionEvents("bottom"),x=useSelectionEvents("left"),w=useSelectionEvents("top_left"),_=useSelectionEvents("top_right"),k=useSelectionEvents("bottom_right"),E=useSelectionEvents("bottom_left"),$=!u.isMenuOpen&&"default"===u.instanceState.cursor.type,T=u.instanceState.isCoarsePointer,I=u.selectedShapes,M=u.onlySelectedShape,j=M&&u.isShapeOrAncestorLocked(M),D=M?u.getShapeUtil(M).expandSelectionOutlinePx(M):0;if(useTransform(h,t?.x,t?.y,1,u.selectionRotation,{x:-D,y:-D}),!t)return null;t=t.clone().expandBy(D).zeroFix();let F=u.zoomLevel,L=u.instanceState.isChangingStyle,B=t.width,V=t.height,K=8/F,Z=B<2*K,Y=V<2*K,X=B<4*K,J=V<4*K,Q=B<5*K,ee=V<5*K,et=T?1.75:1,en=6/F*et,er=(X?en/2:en)*(.75*et),ei=(J?en/2:en)*(.75*et),eo=(!M||!u.getShapeUtil(M).hideSelectionBoundsFg(M))&&!L,ea=eo&&u.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.pointing_resize_handle","select.pointing_crop_handle")||eo&&u.isIn("select.resizing")&&M&&u.isShapeOfType(M,"text");M&&ea&&iw&&u.isShapeOfType(M,"embed")&&(ea=!1);let es=u.isInAny("select.pointing_crop_handle","select.crop.idle","select.crop.pointing_crop")&&!L&&!f,el=u.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!L&&!f,ec=!T&&!(Z||Y)&&(el||es)&&(!M||!u.getShapeUtil(M).hideRotateHandle(M))&&!j,eu=T&&(!X||!J)&&(el||es)&&(!M||!u.getShapeUtil(M).hideRotateHandle(M))&&!j,ed=el&&(!M||u.getShapeUtil(M).canResize(M)&&!u.getShapeUtil(M).hideResizeHandles(M))&&!es&&!j,ep=Z||Y,eh=Z&&Y,ef=Q||ee,eg=ed||es,em=!ec,eb=!el||!eg,ey=!el||!eg||ep,ev=!el||!eg||ep,ex=!el||!eg||eh&&!es,ew=T;ew&&I.every(t=>u.getShapeUtil(t).isAspectRatioLocked(t))&&(ew=!1);let eS=!0;es?eS=ef:ed&&(eS=ep||eh||ew);let e_=Math.min(24/F,V-3*ei),ek=el&&T&&M&&u.isShapeOfType(M,"text")&&e_*F>=4;return(0,G.jsxs)("svg",{ref:h,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:[ea&&(0,G.jsx)("rect",{className:eX("tl-selection__fg__outline"),width:(0,tt.$Z)(B),height:(0,tt.$Z)(V)}),(0,G.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:en,corner:"top_left_rotate",cursor:$?getCursor("nwse-rotate",c):void 0,isHidden:em}),(0,G.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.top-right",cx:B+3*en,cy:0,targetSize:en,corner:"top_right_rotate",cursor:$?getCursor("nesw-rotate",c):void 0,isHidden:em}),(0,G.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:V+3*en,targetSize:en,corner:"bottom_left_rotate",cursor:$?getCursor("swne-rotate",c):void 0,isHidden:em}),(0,G.jsx)(RotateCornerHandle,{"data-testid":"selection.rotate.bottom-right",cx:B+3*en,cy:V+3*en,targetSize:en,corner:"bottom_right_rotate",cursor:$?getCursor("senw-rotate",c):void 0,isHidden:em}),(0,G.jsx)(MobileRotateHandle,{"data-testid":"selection.rotate.mobile",cx:X?-(1.5*en):B/2,cy:X?V/2:-(1.5*en),size:K,isHidden:!el||!eu}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":eS}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:(0,tt.$Z)(0-(J?2*ei:ei)),width:(0,tt.$Z)(B),height:(0,tt.$Z)(Math.max(1,2*ei)),style:$?{cursor:getCursor("ns-resize",c)}:void 0,...g}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":eS}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:(0,tt.$Z)(B-(X?0:er)),y:0,height:(0,tt.$Z)(V),width:(0,tt.$Z)(Math.max(1,2*er)),style:$?{cursor:getCursor("ew-resize",c)}:void 0,...b}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":eS}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:(0,tt.$Z)(V-(J?0:ei)),width:(0,tt.$Z)(B),height:(0,tt.$Z)(Math.max(1,2*ei)),style:$?{cursor:getCursor("ns-resize",c)}:void 0,...v}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":eS}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:(0,tt.$Z)(0-(X?2*er:er)),y:0,height:(0,tt.$Z)(V),width:(0,tt.$Z)(Math.max(1,2*er)),style:$?{cursor:getCursor("ew-resize",c)}:void 0,...x}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":eb}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:(0,tt.$Z)(0-(X?2*er:1.5*er)),y:(0,tt.$Z)(0-(J?2*ei:1.5*ei)),width:(0,tt.$Z)(3*er),height:(0,tt.$Z)(3*ei),style:$?{cursor:getCursor("nwse-resize",c)}:void 0,...w}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":ey}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:(0,tt.$Z)(B-(X?0:1.5*er)),y:(0,tt.$Z)(0-(J?2*ei:1.5*ei)),width:(0,tt.$Z)(3*er),height:(0,tt.$Z)(3*ei),style:$?{cursor:getCursor("nesw-resize",c)}:void 0,..._}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":ex}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:(0,tt.$Z)(B-(X?er:1.5*er)),y:(0,tt.$Z)(V-(J?ei:1.5*ei)),width:(0,tt.$Z)(3*er),height:(0,tt.$Z)(3*ei),style:$?{cursor:getCursor("nwse-resize",c)}:void 0,...k}),(0,G.jsx)("rect",{className:eX("tl-transparent",{"tl-hidden":ev}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:(0,tt.$Z)(0-(X?3*er:1.5*er)),y:(0,tt.$Z)(V-(J?0:1.5*ei)),width:(0,tt.$Z)(3*er),height:(0,tt.$Z)(3*ei),style:$?{cursor:getCursor("nesw-resize",c)}:void 0,...E}),ed&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("rect",{"data-testid":"selection.resize.top-left",className:eX("tl-corner-handle",{"tl-hidden":eb}),"aria-label":"top_left handle",x:(0,tt.$Z)(0-K/2),y:(0,tt.$Z)(0-K/2),width:(0,tt.$Z)(K),height:(0,tt.$Z)(K)}),(0,G.jsx)("rect",{"data-testid":"selection.resize.top-right",className:eX("tl-corner-handle",{"tl-hidden":ey}),"aria-label":"top_right handle",x:(0,tt.$Z)(B-K/2),y:(0,tt.$Z)(0-K/2),width:(0,tt.$Z)(K),height:(0,tt.$Z)(K)}),(0,G.jsx)("rect",{"data-testid":"selection.resize.bottom-right",className:eX("tl-corner-handle",{"tl-hidden":ex}),"aria-label":"bottom_right handle",x:(0,tt.$Z)(B-K/2),y:(0,tt.$Z)(V-K/2),width:(0,tt.$Z)(K),height:(0,tt.$Z)(K)}),(0,G.jsx)("rect",{"data-testid":"selection.resize.bottom-left",className:eX("tl-corner-handle",{"tl-hidden":ev}),"aria-label":"bottom_left handle",x:(0,tt.$Z)(0-K/2),y:(0,tt.$Z)(V-K/2),width:(0,tt.$Z)(K),height:(0,tt.$Z)(K)})]}),ek&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:(0,tt.$Z)(0-K/4),y:(0,tt.$Z)(V/2-e_/2),rx:K/4,width:(0,tt.$Z)(K/2),height:(0,tt.$Z)(e_)}),(0,G.jsx)("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:K/4,x:(0,tt.$Z)(B-K/4),y:(0,tt.$Z)(V/2-e_/2),width:(0,tt.$Z)(K/2),height:(0,tt.$Z)(e_)})]}),es&&(0,G.jsx)(CropHandles,{size:K,width:B,height:V,hideAlternateHandles:ef})]})}),RotateCornerHandle=function({cx:t,cy:c,targetSize:u,corner:h,cursor:f,isHidden:g,"data-testid":b}){let v=useSelectionEvents(h);return(0,G.jsx)("rect",{className:eX("tl-transparent","tl-rotate-corner",{"tl-hidden":g}),"data-testid":b,"aria-label":`${h} target`,pointerEvents:"all",x:(0,tt.$Z)(t-3*u),y:(0,tt.$Z)(c-3*u),width:(0,tt.$Z)(Math.max(1,3*u)),height:(0,tt.$Z)(Math.max(1,3*u)),cursor:f,...v})},i_=Math.sqrt(Math.PI),MobileRotateHandle=function({cx:t,cy:c,size:u,isHidden:h,"data-testid":f}){let g=useSelectionEvents("mobile_rotate"),b=(0,e8.j)(),v=(0,eJ.Hg)("zoom level",()=>b.zoomLevel,[b]);return(0,G.jsxs)("g",{children:[(0,G.jsx)("circle",{"data-testid":f,pointerEvents:"all",className:eX("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":h}),cx:t,cy:c,r:Math.max(14*(1/v),20/Math.max(1,v)),...g}),(0,G.jsx)("circle",{className:eX("tl-mobile-rotate__fg",{"tl-hidden":h}),cx:t,cy:c,r:u/i_})]})},ik={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},iC={s:2,m:3.5,l:5,xl:10},iP={s:18,m:24,l:36,xl:44},iE={s:18,m:22,l:26,xl:32},i$={s:18,m:20,l:24,xl:28},iT={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"};var iI=u(5965);let iA=null;function getBrowserCanvasMaxSize(){return iA||(iA=calculateBrowserCanvasMaxSize()),iA}async function calculateBrowserCanvasMaxSize(){let t=await iI.default.maxWidth({usePromise:!0}),c=await iI.default.maxHeight({usePromise:!0}),u=await iI.default.maxArea({usePromise:!0});return{maxWidth:t.width,maxHeight:c.height,maxArea:u.width*u.height}}function getDataBlocksLength(t,c){let u=0;for(;t[c+u];)u+=t[c+u]+1;return u+1}function isGIF(t){let c=new TextDecoder("ascii"),u=c.decode(t.slice(0,3));return"GIF"===u}function isAnimated(t){let c,u;let h=new Uint8Array(t),f=0,g=0;if(!isGIF(t))return!1;for(c=128&h[10],u=7&h[10],f+=13+(c?3*Math.pow(2,u+1):0);g<2&&f<h.length;)switch(h[f]){case 44:g+=1,c=128&h[f+9],u=7&h[f+9],f+=10+(c?3*Math.pow(2,u+1):0),f+=getDataBlocksLength(h,f+1)+1;break;case 33:f+=2,f+=getDataBlocksLength(h,f);break;default:f=h.length}return g>1}function containBoxSize(t,c){let u=t.w/c.w,h=t.h/c.h;return u<=1&&h<=1?t:u>h?{w:t.w/u,h:t.h/u}:{w:t.w/h,h:t.h/h}}async function getResizedImageDataUrl(t,c,u){return await new Promise(h=>{let f=new Image;f.onload=async()=>{let t=document.createElement("canvas"),g=t.getContext("2d");if(!g)return;let b=await getBrowserCanvasMaxSize(),v=2*c,x=2*u,w=f.width/f.height;if(v>b.maxWidth&&(x=(v=b.maxWidth)/w),x>b.maxHeight&&(v=(x=b.maxHeight)*w),v*x>b.maxArea){let t=Math.sqrt(b.maxArea/(v*x));v*=t,x*=t}t.width=v,t.height=x,g.drawImage(f,0,0,t.width,t.height);let _=t.toDataURL();h(_)},f.crossOrigin="anonymous",f.src=t})}let iM=["image/jpeg","image/png","image/gif","image/svg+xml"],ij=["video/mp4","video/quicktime"];async function isGifAnimated(t){return await new Promise((c,u)=>{let h=new FileReader;h.onerror=()=>u(h.error),h.onload=()=>{c(!!h.result&&isAnimated(h.result))},h.readAsArrayBuffer(t)})}function escapeStringRegexp(t){if("string"!=typeof t)throw TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function matchEmbedUrl(t){let c=new URL(t).host.replace("www.","");for(let u of e0.Lu)if(checkHostnames(u.hostnames,c)){let c=u.fromEmbedUrl(t);if(c)return{definition:u,url:c,embedUrl:t}}}let globlikeRegExp=t=>t.split("*").map(t=>escapeStringRegexp(t)).join(".+"),checkHostnames=(t,c)=>!!t.find(t=>{let u=new RegExp(globlikeRegExp(t));return c.match(u)});function matchUrl(t){let c=new URL(t).host.replace("www.","");for(let u of e0.Lu)if(checkHostnames(u.hostnames,c)){let c=u.toEmbedUrl(t);if(c)return{definition:u,embedUrl:c,url:t}}}function getEmbedInfoUnsafely(t){let c=matchUrl(t)??matchEmbedUrl(t);return c}function getEmbedInfo(t){try{return getEmbedInfoUnsafely(t)}catch(t){console.error(t)}}let TextHelpers=class TextHelpers{static insertTextFirefox(t,c){t.setRangeText(c,t.selectionStart||0,t.selectionEnd||0,"end"),t.dispatchEvent(new InputEvent("input",{data:c,inputType:"insertText",isComposing:!1}))}static insert(t,c){let u=t.ownerDocument,h=u.activeElement;h!==t&&t.focus(),u.execCommand("insertText",!1,c)||TextHelpers.insertTextFirefox(t,c),h===u.body?t.blur():h instanceof HTMLElement&&h!==t&&h.focus()}static set(t,c){t.select(),TextHelpers.insert(t,c)}static getSelection(t){let{selectionStart:c,selectionEnd:u}=t;return t.value.slice(c||void 0,u||void 0)}static wrapSelection(t,c,u){let{selectionStart:h,selectionEnd:f}=t,g=TextHelpers.getSelection(t);TextHelpers.insert(t,c+g+(u??c)),t.selectionStart=(h||0)+c.length,t.selectionEnd=(f||0)+c.length}static replace(t,c,u){let h=0;t.value.replace(c,(...c)=>{let f=h+c[c.length-2],g=c[0].length;t.selectionStart=f,t.selectionEnd=f+g;let b="string"==typeof u?u:u(...c);return TextHelpers.insert(t,b),t.selectionStart=f,h+=b.length-g,b})}static findLineEnd(t,c){let u=t.lastIndexOf("\n",c-1)+1;return"	"!==t.charAt(u)?c:u+1}static indent(t){let{selectionStart:c,selectionEnd:u,value:h}=t,f=h.slice(c,u),g=/\n/g.exec(f)?.length;if(g&&g>0){let f=h.lastIndexOf("\n",c-1)+1,g=t.value.slice(f,u-1),b=g.replace(/^|\n/g,"$&  "),v=b.length-g.length;t.setSelectionRange(f,u-1),TextHelpers.insert(t,b),t.setSelectionRange(c+1,u+v)}else TextHelpers.insert(t,"  ")}static unindent(t){let{selectionStart:c,selectionEnd:u,value:h}=t,f=h.lastIndexOf("\n",c-1)+1,g=TextHelpers.findLineEnd(h,u),b=t.value.slice(f,g),v=b.replace(/(^|\n)(\t| {1,2})/g,"$1"),x=b.length-v.length;t.setSelectionRange(f,g),TextHelpers.insert(t,v);let w=/\t| {1,2}/.exec(h.slice(f,c)),_=w?w[0].length:0,k=c-_;t.setSelectionRange(c-_,Math.max(k,u-x))}static indentCE(t){let c=window.getSelection(),u=t.innerText,h=getCaretIndex(t)??0,f=getCaretIndex(t)??0,g=u.slice(h,f),b=/\n/g.exec(g)?.length;if(b&&b>0){let g=u.lastIndexOf("\n",h-1)+1,b=u.slice(g,f-1),v=b.replace(/^|\n/g,"$&  "),x=v.length-b.length;c&&c.setBaseAndExtent(t,h+1,t,f+x)}else{let c=window.getSelection();t.innerText=u.slice(0,h)+"  "+u.slice(h),c?.setBaseAndExtent(t,h+1,t,h+2)}}static unindentCE(t){let c=window.getSelection(),u=t.innerText,h=getCaretIndex(t)??0,f=getCaretIndex(t)??0,g=u.lastIndexOf("\n",h-1)+1,b=TextHelpers.findLineEnd(u,f),v=u.slice(g,b),x=v.replace(/(^|\n)(\t| {1,2})/g,"$1"),w=v.length-x.length;if(c){c.setBaseAndExtent(t,g,t,b);let v=/\t| {1,2}/.exec(u.slice(g,h)),x=v?v[0].length:0,_=h-x;c.setBaseAndExtent(t,h-x,t,Math.max(_,f-w))}}static fixNewLines=/\r?\n|\r/g;static normalizeText(t){return t.replace(TextHelpers.fixNewLines,"\n")}static normalizeTextForDom(t){return t.replace(TextHelpers.fixNewLines,"\n").split("\n").map(t=>t||" ").join("\n")}};function getCaretIndex(t){if(void 0===window.getSelection)return;let c=window.getSelection();if(!c)return;let u=0;if(0!==c.rangeCount){let h=c.getRangeAt(0),f=h.cloneRange();f.selectNodeContents(t),f.setEnd(h.endContainer,h.endOffset),u=f.toString().length}return u}let iD=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function isRightToLeftLanguage(t){return iD.test(t)}function replaceTabsWithSpaces(t){return t.replace(/\t/g,"  ")}function stripCommonMinimumIndentation(t){let c=t.split("\n");for(;0===c[0].trim().length;)c.shift();let u=1/0;for(let t of c)if(t.trim().length>0){let c=t.length-t.trimStart().length;u=Math.min(u,c)}return c.map(t=>t.slice(u)).join("\n")}function stripTrailingWhitespace(t){return t.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function cleanupText(t){return stripTrailingWhitespace(stripCommonMinimumIndentation(replaceTabsWithSpaces(t)))}let truncateStringWithEllipsis=(t,c)=>t.length<=c?t:t.substring(0,c-3)+"...";function registerDefaultExternalContentHandlers(t,{maxImageDimension:c,maxAssetSize:u,acceptedImageMimeTypes:h,acceptedVideoMimeTypes:f}){t.registerExternalAssetHandler("file",async({file:t})=>await new Promise((g,b)=>{h.includes(t.type)||f.includes(t.type)||(console.warn(`File type not allowed: ${t.type}`),b()),t.size>u&&(console.warn(`File size too big: ${(t.size/1024).toFixed()}kb > ${(u/1024).toFixed()}kb`),b());let v=new FileReader;v.onerror=()=>b(v.error),v.onload=async()=>{let u,f,b=v.result;"video/quicktime"===t.type&&b.includes("video/quicktime")&&(b=b.replace("video/quicktime","video/mp4"));let x=h.includes(t.type);if(x?(u=await e1.xe.getImageSizeFromSrc(b),f="image/gif"===t.type&&await isGifAnimated(t)):(f=!0,u=await e1.xe.getVideoSizeFromSrc(b)),isFinite(c)){let h=containBoxSize(u,{w:c,h:c});u!==h&&("image/jpeg"===t.type||"image/png"===t.type)&&(b=await getResizedImageDataUrl(b,u.w,u.h)),u=h}let w=e0.Yk.createId((0,e1.jK)(b)),_=e0.Yk.create({id:w,type:x?"image":"video",typeName:"asset",props:{name:t.name,src:b,w:u.w,h:u.h,mimeType:t.type,isAnimated:f}});g(_)},v.readAsDataURL(t)})),t.registerExternalAssetHandler("url",async({url:t})=>{let c;try{let u=await fetch(t,{method:"GET",mode:"no-cors"}),h=await u.text(),f=new DOMParser().parseFromString(h,"text/html");c={image:f.head.querySelector('meta[property="og:image"]')?.getAttribute("content")??"",title:f.head.querySelector('meta[property="og:title"]')?.getAttribute("content")??truncateStringWithEllipsis(t,32),description:f.head.querySelector('meta[property="og:description"]')?.getAttribute("content")??""}}catch(u){console.error(u),c={image:"",title:truncateStringWithEllipsis(t,32),description:""}}return{id:e0.Yk.createId((0,e1.jK)(t)),typeName:"asset",type:"bookmark",props:{src:t,description:c.description,image:c.image,title:c.title},meta:{}}}),t.registerExternalContentHandler("svg-text",async({point:c,text:u})=>{let h=c??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),f=new DOMParser().parseFromString(u,"image/svg+xml").querySelector("svg");if(!f)throw Error("No <svg/> element present");let g=parseFloat(f.getAttribute("width")||"0"),b=parseFloat(f.getAttribute("height")||"0");if(!(g&&b)){document.body.appendChild(f);let t=f.getBoundingClientRect();document.body.removeChild(f),g=t.width,b=t.height}let v=await t.getAssetForExternalContent({type:"file",file:new File([u],"asset.svg",{type:"image/svg+xml"})});if(!v)throw Error("Could not create an asset");createShapesForAssets(t,[v],h)}),t.registerExternalContentHandler("embed",({point:c,url:u,embed:h})=>{let f=c??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),{width:g,height:b}=h,v=(0,e0.F1)(),x={id:v,type:"embed",x:f.x-(g||450)/2,y:f.y-(b||450)/2,props:{w:g,h:b,url:u}};t.createShapes([x]).select(v)}),t.registerExternalContentHandler("files",async({point:c,files:g})=>{let b=c??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),v=new tn.G(b.x,b.y),x=[];await Promise.all(g.map(async(c,g)=>{if(c.size>u)return console.warn(`File size too big: ${(c.size/1024).toFixed()}kb > ${(u/1024).toFixed()}kb`),null;if(!c.type)throw Error("No mime type");if(!h.concat(f).includes(c.type))return console.warn(`${c.name} not loaded - Extension not allowed.`),null;try{let u=await t.getAssetForExternalContent({type:"file",file:c});if(!u)throw Error("Could not create an asset");x[g]=u}catch(t){return console.error(t),null}})),createShapesForAssets(t,(0,e1.oA)(x),v)}),t.registerExternalContentHandler("text",async({point:c,text:u})=>{let h,f,g;let b=c??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),v=t.getShapeUtil("text").getDefaultProps(),x=cleanupText(u),w="middle",_=x.split("\n").length>1,k=isRightToLeftLanguage(x);_&&(w=_?k?"end":"start":"middle");let E=t.textMeasure.measureText(x,{...ik,fontFamily:iT[v.font],fontSize:iP[v.size],maxWidth:null}),$=Math.min(_?.9*t.viewportPageBounds.width:920,Math.max(200,.9*t.viewportPageBounds.width));if(E.w>$){let c=t.textMeasure.measureText(x,{...ik,fontFamily:iT[v.font],fontSize:iP[v.size],maxWidth:$});h=c.w,f=c.h,g=!1,w=k?"end":"start"}else h=E.w,f=E.h,g=!0;b.y-f/2<t.viewportPageBounds.minY+40&&(b.y=t.viewportPageBounds.minY+40+f/2),t.createShapes([{id:(0,e0.F1)(),type:"text",x:b.x-h/2,y:b.y-f/2,props:{text:x,align:w,autoSize:g,w:h}}])}),t.registerExternalContentHandler("url",async({point:c,url:u})=>{let h=getEmbedInfo(u);if(h)return t.putExternalContent({type:"embed",url:h.url,point:c,embed:h.definition});let f=c??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.viewportPageCenter),g=e0.Yk.createId((0,e1.jK)(u)),b=t.getAsset(g),v=!1;if(!b){v=!0;let c=await t.getAssetForExternalContent({type:"url",url:u});if(!c)throw Error("Could not create an asset");b=c}t.batch(()=>{v&&t.createAssets([b]),createShapesForAssets(t,[b],f)})})}async function createShapesForAssets(t,c,u){if(!c.length)return;let h=tn.G.From(u),f=[];for(let t of c)switch(t.type){case"bookmark":f.push({id:(0,e0.F1)(),type:"bookmark",x:h.x-150,y:h.y-160,opacity:1,props:{assetId:t.id,url:t.props.src}}),h.x+=300;break;case"image":f.push({id:(0,e0.F1)(),type:"image",x:h.x-t.props.w/2,y:h.y-t.props.h/2,opacity:1,props:{assetId:t.id,w:t.props.w,h:t.props.h}}),h.x+=t.props.w;break;case"video":f.push({id:(0,e0.F1)(),type:"video",x:h.x-t.props.w/2,y:h.y-t.props.h/2,opacity:1,props:{assetId:t.id,w:t.props.w,h:t.props.h}}),h.x+=t.props.w}t.batch(()=>{let h=c.filter(c=>!t.getAsset(c.id));h.length&&t.createAssets(h),t.createShapes(f).select(...f.map(t=>t.id));let{viewportPageBounds:g}=t,{selectionPageBounds:b}=t;if(b){let c=b.center.sub(u);t.updateShapes(t.selectedShapes.map(u=>{let h=t.getShapeParentTransform(u).decompose().rotation,f=tn.G.Rot(c,-h);return{id:u.id,type:u.type,x:u.x-f.x,y:u.y-f.y}}))}(b=t.selectionPageBounds)&&!g.contains(b)&&t.zoomToSelection()})}let Idle_Idle=class Idle_Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("pointing",t)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")};onKeyUp=t=>{if("Enter"===t.key){if(this.editor.instanceState.isReadonly)return null;let{onlySelectedShape:c}=this.editor;c&&this.editor.getShapeUtil(c).canEdit(c)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(c.id),this.editor.root.current.value.transition("editing_shape",{...t,target:"shape",shape:c}))}}};let Pointing_Pointing=class Pointing_Pointing extends nx.n{static id="pointing";shape;markId="";onEnter=()=>{this.didTimeout=!1;let t=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:t=>!t.isLocked&&this.editor.getShapeUtil(t).canBind(t),margin:0,hitInside:!0,renderingOnly:!0});t?this.editor.setHintingShapes([t.id]):this.createArrowShape(),this.startPreciseTimeout()};onExit=()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()};onPointerMove=()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:this.editor.getShapeHandles(this.shape).find(t=>"end"===t.id),isCreating:!0,onInteractionEnd:"arrow"})}};onPointerUp=()=>{this.cancel()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle",{})}createArrowShape(){let{originPagePoint:t}=this.editor.inputs,c=(0,e0.F1)();this.markId=`creating:${c}`,this.editor.mark(this.markId),this.editor.createShapes([{id:c,type:"arrow",x:t.x,y:t.y}]);let u=this.editor.getShape(c);if(!u)throw Error("expected shape");let h=this.editor.getShapeHandles(u);if(!h)throw Error("expected handles for arrow");let f=this.editor.getShapeUtil("arrow"),g=h.find(t=>"start"===t.id),b=f.onHandleChange?.(u,{handle:{...g,x:0,y:0},isPrecise:!0});if(b){let t=b.props?.start;t?.type==="binding"&&this.editor.setHintingShapes([t.boundShapeId]),this.editor.updateShapes([b],{squashing:!0})}this.shape=this.editor.getShape(c),this.editor.select(c)}updateArrowShapeEndHandle(){let t=this.shape;if(!t)throw Error("expected shape");let c=this.editor.getShapeHandles(t);if(!c)throw Error("expected handles for arrow");let u={...t,props:{...t.props,end:{...t.props.end,x:0,y:0}}};{let h=this.editor.getShapeUtil("arrow"),f=this.editor.getPointInShapeSpace(t,this.editor.inputs.currentPagePoint),g=c.find(t=>"end"===t.id),b=h.onHandleChange?.(u,{handle:{...g,x:f.x,y:f.y},isPrecise:!1});if(b){let t=b.props?.end;t?.type==="binding"&&this.editor.setHintingShapes([t.boundShapeId]),this.editor.updateShapes([b],{squashing:!0})}}{let t=this.editor.getShapeUtil("arrow"),h=c.find(t=>"start"===t.id),f=t.onHandleChange?.(u,{handle:{...h,x:0,y:0},isPrecise:this.didTimeout});f&&this.editor.updateShapes([f],{squashing:!0})}this.shape=this.editor.getShape(t.id)}preciseTimeout=-1;didTimeout=!1;startPreciseTimeout(){this.preciseTimeout=window.setTimeout(()=>{this.isActive&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}};let ArrowShapeTool=class ArrowShapeTool extends nx.n{static id="arrow";static initial="idle";static children=()=>[Idle_Idle,Pointing_Pointing];shapeType="arrow"};let Drawing=class Drawing extends nx.n{static id="drawing";info={};initialShape;shapeType="highlight"===this.parent.id?"highlight":"draw";util=this.editor.getShapeUtil(this.shapeType);isPen=!1;segmentMode="free";didJustShiftClickToExtendPreviousShapeLine=!1;pagePointWhereCurrentSegmentChanged={};pagePointWhereNextSegmentChanged=null;lastRecordedPoint={};mergeNextPoint=!1;currentLineLength=0;canDraw=!1;markId=null;onEnter=t=>{this.markId=null,this.info=t,this.canDraw=!this.editor.isMenuOpen,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()};onPointerMove=()=>{let{editor:{inputs:t}}=this;if(this.isPen!==t.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&t.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(t.isPen?tn.G.Dist(t.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.zoomLevel?(this.lastRecordedPoint=t.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateShapes())};onKeyDown=t=>{if("Shift"===t.key)switch(this.segmentMode){case"free":this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_free":this.segmentMode="starting_straight"}this.updateShapes()};onKeyUp=t=>{if("Shift"===t.key)switch(this.editor.snaps.clear(),this.segmentMode){case"straight":this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break;case"starting_straight":this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free"}this.updateShapes()};onExit=()=>{this.editor.snaps.clear(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()};canClose(){return"highlight"!==this.shapeType}getIsClosed(t,c){if(!this.canClose())return!1;let u=iC[c],h=t[0].points[0],f=t[t.length-1],g=f.points[f.points.length-1];return h!==g&&this.currentLineLength>4*u&&tn.G.Dist(h,g)<2*u}startShape(){let{inputs:{originPagePoint:t,isPen:c}}=this.editor;this.markId="draw start "+(0,tK.E)(),this.editor.mark(this.markId),this.isPen=c;let u=this.isPen?1.25*this.info.point.z:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=t.clone(),this.initialShape){let c=this.editor.getShape(this.initialShape.id);if(c&&"straight"===this.segmentMode){this.didJustShiftClickToExtendPreviousShapeLine=!0;let u=(0,e1.Z$)(c.props.segments);if(!u)throw Error("Expected a previous segment!");let h=(0,e1.Z$)(u.points);if(!h)throw Error("Expected a previous point!");let{x:f,y:g}=this.editor.getPointInShapeSpace(c,t).toFixed(),b=this.isPen?1.25*this.info.point.z:.5,v={type:this.segmentMode,points:[{x:h.x,y:h.y,z:+b.toFixed(2)},{x:f,y:g,z:+b.toFixed(2)}]},x=t$.y.applyToPoint(this.editor.getShapePageTransform(c.id),h);this.pagePointWhereCurrentSegmentChanged=x,this.pagePointWhereNextSegmentChanged=null;let w=[...c.props.segments,v];this.currentLineLength=this.getLineLength(w);let _={id:c.id,type:this.shapeType,props:{segments:w}};this.canClose()&&(_.props.isClosed=this.getIsClosed(w,c.props.size)),this.editor.updateShapes([_]);return}}this.pagePointWhereCurrentSegmentChanged=t.clone();let h=(0,e0.F1)();this.editor.createShapes([{id:h,type:this.shapeType,x:t.x,y:t.y,props:{isPen:this.isPen,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+u.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(h)}updateShapes(){let{inputs:t}=this.editor,{initialShape:c}=this;if(!c)return;let{id:u,props:{size:h}}=c,f=this.editor.getShape(u);if(!f)return;let{segments:g}=f.props,{x:b,y:v,z:x}=this.editor.getPointInShapeSpace(f,t.currentPagePoint).toFixed(),w={x:b,y:v,z:this.isPen?+(1.25*x).toFixed(2):.5};switch(this.segmentMode){case"starting_straight":{let{pagePointWhereNextSegmentChanged:c}=this;if(null===c)throw Error("We should have a point where the segment changed");let b=tn.G.Dist(c,t.currentPagePoint)>to.Sk;if(b){let t;this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";let c=(0,e1.Z$)(g);if(!c)throw Error("Expected a previous segment!");let b=(0,e1.Z$)(c.points);if(!b)throw Error("Expected a previous last point!");let v=this.editor.getPointInShapeSpace(f,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if("straight"===c.type){this.currentLineLength+=tn.G.Dist(b,v),t={type:"straight",points:[{...b},v]};let c=this.editor.getShapePageTransform(f);this.pagePointWhereCurrentSegmentChanged=t$.y.applyToPoint(c,b)}else t={type:"straight",points:[v,w]};let x={id:u,type:this.shapeType,props:{segments:[...g,t]}};this.canClose()&&(x.props.isClosed=this.getIsClosed(g,h)),this.editor.updateShapes([x],{squashing:!0})}break}case"starting_free":{let{pagePointWhereNextSegmentChanged:c}=this;if(null===c)throw Error("We should have a point where the segment changed");let f=tn.G.Dist(c,t.currentPagePoint)>to.Sk;if(f){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";let t=g.slice(),c=t[t.length-1],f=(0,e1.Z$)(c.points);if(!f)throw Error("No previous point!");let b={type:"free",points:[...tn.G.PointsBetween(f,w,6).map(t=>t.toFixed().toJson())]},v=[...t,b];this.currentLineLength=this.getLineLength(v);let x={id:u,type:this.shapeType,props:{segments:v}};this.canClose()&&(x.props.isClosed=this.getIsClosed(v,h)),this.editor.updateShapes([x],{squashing:!0})}break}case"straight":{let t,c;let b=g.slice(),v=b[b.length-1],{pagePointWhereCurrentSegmentChanged:x}=this,{currentPagePoint:w,ctrlKey:_}=this.editor.inputs;if(!x)throw Error("We should have a point where the segment changed");let k=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(k=!_,this.didJustShiftClickToExtendPreviousShapeLine=!1):k=!_;let E=this.editor.getPointInShapeSpace(f,w).toFixed().toJson(),$=!1,T=this.editor.user.isSnapMode?!_:_;if(T&&b.length>2){let t;let u=8/this.editor.zoomLevel;for(let h=0,f=g.length-2;h<f;h++){let f=g[h];if(!f)break;if("free"===f.type)continue;let b=f.points[0],v=(0,e1.Z$)(f.points);if(!(b&&v))continue;let x=tn.G.NearestPointOnLineSegment(b,v,E),w=tn.G.Dist(x,E);if(w<u){t=x.toFixed().toJson(),u=w,c=f;break}}t&&($=!0,E=t)}if($&&c){let t=this.editor.getShapePageTransform(f),u=c.points[0],h=(0,e1.Z$)(c.points);if(!h)throw Error("Expected a last point!");let g=t$.y.applyToPoint(t,u),b=t$.y.applyToPoint(t,h),v=t$.y.applyToPoint(t,E);this.editor.snaps.setLines([{id:(0,tK.E)(),type:"points",points:[g,v,b]}])}else{if(this.editor.snaps.clear(),k){let c=tn.G.Angle(x,w),u=(0,tt.nD)(c,24),h=u-c;t=tn.G.RotWith(w,x,h)}else t=w;E=this.editor.getPointInShapeSpace(f,t).toFixed().toJson()}this.currentLineLength+=tn.G.Dist(v.points[0],E),b[b.length-1]={...v,type:"straight",points:[v.points[0],E]};let I={id:u,type:this.shapeType,props:{segments:b}};this.canClose()&&(I.props.isClosed=this.getIsClosed(g,h)),this.editor.updateShapes([I],{squashing:!0});break}case"free":{let t=g.slice(),c=t[t.length-1],f=[...c.points];if(f.length&&this.mergeNextPoint){let{z:t}=f[f.length-1];f[f.length-1]={x:w.x,y:w.y,z:t?Math.max(t,w.z):w.z}}else this.currentLineLength+=tn.G.Dist(f[f.length-1],w),f.push(w);t[t.length-1]={...c,points:f},this.currentLineLength=this.getLineLength(t);let b={id:u,type:this.shapeType,props:{segments:t}};if(this.canClose()&&(b.props.isClosed=this.getIsClosed(t,h)),this.editor.updateShapes([b],{squashing:!0}),f.length>500){this.editor.updateShapes([{id:u,type:this.shapeType,props:{isComplete:!0}}]);let{currentPagePoint:t}=this.editor.inputs,c=(0,e0.F1)();this.editor.createShapes([{id:c,type:this.shapeType,x:(0,tt.FH)(t.x),y:(0,tt.FH)(t.y),props:{isPen:this.isPen,segments:[{type:"free",points:[{x:0,y:0,z:this.isPen?+(1.25*x).toFixed():.5}]}]}}]),this.initialShape=structuredClone(this.editor.getShape(c)),this.mergeNextPoint=!1,this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.currentLineLength=0}}}}getLineLength(t){let c=0;for(let u of t)for(let t=0;t<u.points.length-1;t++){let h=u.points[t],f=u.points[t+1];c+=tn.G.Sub(f,h).len2()}return Math.sqrt(c)}onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())};complete(){if(!this.canDraw){this.cancel();return}let{initialShape:t}=this;t&&(this.editor.updateShapes([{id:t.id,type:t.type,props:{isComplete:!0}}]),this.parent.transition("idle",{}))}cancel(){this.parent.transition("idle",this.info)}};let toolStates_Idle_Idle=class toolStates_Idle_Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("drawing",t)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}};let DrawShapeTool=class DrawShapeTool extends nx.n{static id="draw";static initial="idle";static children=()=>[toolStates_Idle_Idle,Drawing];shapeType="draw";onExit=()=>{let t=this.children.drawing;t.initialShape=void 0}};let FrameShapeTool=class FrameShapeTool extends BaseBoxShapeTool{static id="frame";static initial="idle";shapeType="frame"};let geo_toolStates_Idle_Idle=class geo_toolStates_Idle_Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("pointing",t)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onKeyUp=t=>{if("Enter"===t.key){if(this.editor.instanceState.isReadonly)return null;let{onlySelectedShape:c}=this.editor;c&&this.editor.getShapeUtil(c).canEdit(c)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(c.id),this.editor.root.current.value.transition("editing_shape",{...t,target:"shape",shape:c}))}};onCancel=()=>{this.editor.setCurrentTool("select")}};let toolStates_Pointing_Pointing=class toolStates_Pointing_Pointing extends nx.n{static id="pointing";markId="";onPointerUp=()=>{this.complete()};onPointerMove=t=>{if(this.editor.inputs.isDragging){let{originPagePoint:c}=this.editor.inputs,u=(0,e0.F1)();this.markId=`creating:${u}`,this.editor.mark(this.markId),this.editor.createShapes([{id:u,type:"geo",x:c.x,y:c.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(e0.Zu)}}]).select(u).setCurrentTool("select.resizing",{...t,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{originPagePoint:t}=this.editor.inputs,c=(0,e0.F1)();this.markId=`creating:${c}`,this.editor.mark(this.markId),this.editor.createShapes([{id:c,type:"geo",x:t.x,y:t.y,props:{geo:this.editor.getStyleForNextShape(e0.Zu),w:1,h:1}}]);let u=this.editor.getShape(c);if(!u)return;let h="star"===u.props.geo?(0,tt.LP)(5,200,200):"cloud"===u.props.geo?new nS.No(0,0,300,180):new nS.No(0,0,200,200),f=h.center,g=this.editor.getShapeParentTransform(u);g&&f.rot(-g.rotation()),this.editor.select(c),this.editor.updateShapes([{id:u.id,type:"geo",x:u.x-f.x,y:u.y-f.y,props:{geo:this.editor.getStyleForNextShape(e0.Zu),w:h.width,h:h.height}}]),this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle",{})}};let GeoShapeTool=class GeoShapeTool extends nx.n{static id="geo";static initial="idle";static children=()=>[geo_toolStates_Idle_Idle,toolStates_Pointing_Pointing];shapeType="geo"};let HighlightShapeTool=class HighlightShapeTool extends nx.n{static id="highlight";static initial="idle";static children=()=>[toolStates_Idle_Idle,Drawing];shapeType="highlight";onExit=()=>{let t=this.children.drawing;t.initialShape=void 0}};let line_toolStates_Idle_Idle=class line_toolStates_Idle_Idle extends nx.n{static id="idle";shapeId="";onEnter=t=>{this.shapeId=t.shapeId,this.editor.setCursor({type:"cross",rotation:0})};onPointerDown=()=>{this.parent.transition("pointing",{shapeId:this.shapeId})};onCancel=()=>{this.editor.setCurrentTool("select")}};let line_toolStates_Pointing_Pointing=class line_toolStates_Pointing_Pointing extends nx.n{static id="pointing";shape={};markId;onEnter=t=>{let{inputs:c}=this.editor,{currentPagePoint:u}=c;this.markId=void 0;let h=t.shapeId&&this.editor.getShape(t.shapeId);if(h&&c.shiftKey){let t,c;this.markId=`creating:${h.id}`,this.editor.mark(this.markId),this.shape=h;let f=this.editor.getShapeHandles(this.shape);if(!f)return;let g=f.filter(t=>"vertex"===t.type).sort(nj.hl),b=g[g.length-1],v=g[g.length-2],x=t$.y.applyToPoint(this.editor.getShapeParentTransform(this.shape),new tn.G(this.shape.x,this.shape.y)),w=tn.G.Sub(u,x);2>tn.G.Dist(b,v)||2>tn.G.Dist(w,b)?(t=b.index,b.id,c={...b,x:w.x+.1,y:w.y+.1}):c={id:"handle:"+(t=(0,nj._L)(b.index)),type:"vertex",index:t,x:w.x+.1,y:w.y+.1,canBind:!1};let _=(0,e1.v4)(this.shape.props.handles);_[c.id]=c,this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{handles:_}}])}else{let t=(0,e0.F1)();this.markId=`creating:${t}`,this.editor.mark(this.markId),this.editor.createShapes([{id:t,type:"line",x:u.x,y:u.y}]),this.editor.select(t),this.shape=this.editor.getShape(t)}};onPointerMove=()=>{if(this.shape&&this.editor.inputs.isDragging){let t=this.editor.getShapeHandles(this.shape);if(!t)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");let c=(0,e1.Z$)(t);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...c,x:c.x-.1,y:c.y-.1},onInteractionEnd:"line"})}};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle",{}),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clear()};complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clear()}};let LineShapeTool=class LineShapeTool extends nx.n{static id="line";static initial="idle";static children=()=>[line_toolStates_Idle_Idle,line_toolStates_Pointing_Pointing];shapeType="line"};let note_toolStates_Idle_Idle=class note_toolStates_Idle_Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("pointing",t)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")}};let note_toolStates_Pointing_Pointing=class note_toolStates_Pointing_Pointing extends nx.n{static id="pointing";dragged=!1;info={};wasFocusedOnEnter=!1;markId="";shape={};onEnter=()=>{this.wasFocusedOnEnter=!this.editor.isMenuOpen,this.wasFocusedOnEnter&&(this.shape=this.createShape())};onPointerMove=t=>{this.editor.inputs.isDragging&&(this.wasFocusedOnEnter||(this.shape=this.createShape()),this.editor.setCurrentTool("select.translating",{...t,target:"shape",shape:this.shape,isCreating:!0,editAfterComplete:!0,onInteractionEnd:"note"}))};onPointerUp=()=>{this.complete()};onInterrupt=()=>{this.cancel()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};complete(){this.wasFocusedOnEnter&&(this.editor.instanceState.isToolLocked?this.parent.transition("idle",{}):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}createShape(){let{inputs:{originPagePoint:t}}=this.editor,c=(0,e0.F1)();this.markId=`creating:${c}`,this.editor.mark(this.markId),this.editor.createShapes([{id:c,type:"note",x:t.x,y:t.y}]).select(c);let u=this.editor.getShape(c),h=this.editor.getShapeGeometry(u).bounds;return this.editor.updateShapes([{id:c,type:"note",x:u.x-h.width/2,y:u.y-h.height/2}]),this.editor.getShape(c)}};let NoteShapeTool=class NoteShapeTool extends nx.n{static id="note";static initial="idle";static children=()=>[note_toolStates_Idle_Idle,note_toolStates_Pointing_Pointing];shapeType="note"};function updateHoveredId(t){let c;let u=t.getShapeAtPoint(t.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:to.wM/t.zoomLevel,renderingOnly:!0});if(!u)return t.setHoveredShape(null);let h=t.getOutermostSelectableShape(u);return c=h===u?u:h.id===t.focusedGroupId||t.selectedShapeIds.includes(h.id)?u:h,t.setHoveredShape(c.id)}let text_toolStates_Idle_Idle=class text_toolStates_Idle_Idle extends nx.n{static id="idle";onPointerMove=t=>{switch(t.target){case"shape":case"canvas":updateHoveredId(this.editor)}};onPointerDown=t=>{this.parent.transition("pointing",t)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onKeyDown=t=>{if("Enter"===t.key){if(this.editor.instanceState.isReadonly)return null;let{onlySelectedShape:c}=this.editor;c&&this.editor.getShapeUtil(c).canEdit(c)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(c.id),this.editor.root.current.value.transition("editing_shape",{...t,target:"shape",shape:c}))}};onCancel=()=>{this.editor.setCurrentTool("select")}};let text_toolStates_Pointing_Pointing=class text_toolStates_Pointing_Pointing extends nx.n{static id="pointing";shape;markId="";onExit=()=>{this.editor.setHintingShapes([])};onPointerMove=t=>{if(this.editor.inputs.isDragging){let{inputs:{originPagePoint:c}}=this.editor,u=(0,e0.F1)();this.markId=`creating:${u}`,this.editor.mark(this.markId),this.editor.createShapes([{id:u,type:"text",x:c.x,y:c.y,props:{text:"",autoSize:!1,w:20}}]),this.editor.select(u),this.shape=this.editor.getShape(u),this.shape&&this.editor.setCurrentTool("select.resizing",{...t,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:1,y:1},editAfterComplete:!0,onInteractionEnd:"text"})}};onPointerUp=()=>{this.complete()};onComplete=()=>{this.cancel()};onCancel=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.editor.mark("creating text shape");let t=(0,e0.F1)(),{x:c,y:u}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:t,type:"text",x:c,y:u,props:{text:"",autoSize:!0}}]).select(t),this.editor.setEditingShape(t),this.editor.setCurrentTool("select"),this.editor.root.current.value?.transition("editing_shape",{})}cancel(){this.parent.transition("idle",{}),this.editor.bailToMark(this.markId)}};let TextShapeTool=class TextShapeTool extends nx.n{static id="text";static initial="idle";static children=()=>[text_toolStates_Idle_Idle,text_toolStates_Pointing_Pointing];shapeType="text"};let iO=[TextShapeTool,DrawShapeTool,GeoShapeTool,NoteShapeTool,LineShapeTool,FrameShapeTool,ArrowShapeTool,HighlightShapeTool];function useDefaultColorTheme(){return(0,e0.y6)({isDarkMode:useIsDarkMode()})}let iF=U.memo(function({theme:t,d:c,color:u,fill:h}){switch(h){case"none":return null;case"solid":return(0,G.jsx)("path",{fill:t[u].semi,d:c});case"semi":return(0,G.jsx)("path",{fill:t.solid,d:c});case"pattern":return(0,G.jsx)(PatternFill,{theme:t,color:u,fill:h,d:c})}}),PatternFill=function({d:t,color:c,theme:u}){let h=(0,e8.j)(),f=(0,eJ.Hg)("zoomLevel",()=>h.zoomLevel,[h]),g=h.zoomLevel<=.18;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("path",{fill:u[c].pattern,d:t}),(0,G.jsx)("path",{fill:g?u[c].semi:`url(#${to.iF[`${Math.ceil(f)}_${u.id}`]})`,d:t})]})};function getShapeFillSvg({d:t,color:c,fill:u,theme:h}){if("none"===u)return;if("pattern"===u){let u=document.createElementNS("http://www.w3.org/2000/svg","g"),f=document.createElementNS("http://www.w3.org/2000/svg","path");f.setAttribute("d",t),f.setAttribute("fill",h[c].pattern);let g=document.createElementNS("http://www.w3.org/2000/svg","path");return g.setAttribute("d",t),g.setAttribute("fill","url(#hash_pattern)"),u.appendChild(f),u.appendChild(g),u}let f=document.createElementNS("http://www.w3.org/2000/svg","path");switch(f.setAttribute("d",t),u){case"semi":f.setAttribute("fill",h.solid);break;case"solid":f.setAttribute("fill",h[c].semi)}return f}function getSvgWithShapeFill(t,c){if(!c)return t;{let u=document.createElementNS("http://www.w3.org/2000/svg","g");return u.appendChild(c),u.appendChild(t),u}}function correctSpacesToNbsp(t){return t.replace(/\s/g,"\xa0")}function createTextSvgElementFromSpans(t,c,u){let{padding:h=0}=u,f=document.createElementNS("http://www.w3.org/2000/svg","text");if(f.setAttribute("font-size",u.fontSize+"px"),f.setAttribute("font-family",u.fontFamily),f.setAttribute("font-style",u.fontStyle),f.setAttribute("font-weight",u.fontWeight),f.setAttribute("line-height",u.lineHeight*u.fontSize+"px"),f.setAttribute("dominant-baseline","mathematical"),f.setAttribute("alignment-baseline","mathematical"),0===c.length)return f;let g=nS.No.From(c[0].box);for(let{box:t}of c)g.union(t);let b=h+(u.offsetX??0),v=(u.offsetY??0)+u.fontSize/2+("start"===u.verticalTextAlign?h:"end"===u.verticalTextAlign?u.height-h-g.height:(Math.ceil(u.height)-g.height)/2),x=null;for(let{text:t,box:u}of c){let c=null!==x&&u.y>x;if(c){let t=document.createElementNS("http://www.w3.org/2000/svg","tspan");t.setAttribute("alignment-baseline","mathematical"),t.setAttribute("x",b+"px"),t.setAttribute("y",u.y+v+"px"),t.textContent="\n",f.appendChild(t)}let h=document.createElementNS("http://www.w3.org/2000/svg","tspan");h.setAttribute("alignment-baseline","mathematical"),h.setAttribute("x",u.x+b+"px"),h.setAttribute("y",u.y+v+"px");let g=correctSpacesToNbsp(t);h.textContent=g,f.appendChild(h),x=u.y}return u.stroke&&u.strokeWidth&&(f.setAttribute("stroke",u.stroke),f.setAttribute("stroke-width",u.strokeWidth+"px")),u.fill&&f.setAttribute("fill",u.fill),f}function getFontDefForExport(t){return{key:`${e0.Y8.id}:${t}`,getElement:async()=>{let c=findFont(t);if(!c)return null;let u=c.$$_url,h=c.$$_fontface;if(!u||!h)return null;let f=await (await fetch(u)).blob(),g=await new Promise((t,c)=>{let u=new FileReader;u.onload=()=>t(u.result),u.onerror=c,u.readAsDataURL(f)}),b=h.replace(u,g),v=document.createElementNS("http://www.w3.org/2000/svg","style");return v.textContent=b,v}}}function findFont(t){let c=e0.p6[t];for(let t of document.fonts)if(c.includes(t.family))return t;return null}function getFillDefForExport(t,c){return{key:`${e0.Y8.id}:${t}`,getElement:async()=>{if("pattern"!==t)return null;let u=8/12,h=document.createElement("div");return h.innerHTML=`
				<svg>
					<defs>
						<mask id="hash_pattern_mask">
							<rect x="0" y="0" width="8" height="8" fill="white" />
							<g
								strokeLinecap="round"
								stroke="black"
							>
								<line x1="${1*u}" y1="${3*u}" x2="${3*u}" y2="${1*u}" />
								<line x1="${5*u}" y1="${7*u}" x2="${7*u}" y2="${5*u}" />
								<line x1="${9*u}" y1="${11*u}" x2="${11*u}" y2="${9*u}" />
							</g>
						</mask>
						<pattern
							id="hash_pattern"
							width="8"
							height="8"
							patternUnits="userSpaceOnUse"
						>
							<rect x="0" y="0" width="8" height="8" fill="${c.solid}" mask="url(#hash_pattern_mask)" />
						</pattern>
					</defs>
				</svg>
			`,Array.from(h.querySelectorAll("defs > *"))}}}function getFillDefForCanvas(){return{key:`${e0.Y8.id}:pattern`,component:PatternFillDefForCanvas}}let generateImage=(t,c,u)=>new Promise((h,f)=>{let g=8*c*t,b=document.createElement("canvas");b.width=g,b.height=g;let v=b.getContext("2d");if(!v)return;v.fillStyle=u?"#212529":"#f8f9fa",v.fillRect(0,0,g,g),v.globalCompositeOperation="destination-out",v.lineCap="round",v.lineWidth=1.25*c*t;let x=8/12,s=u=>u*c*t;v.beginPath(),v.moveTo(s(1*x),s(3*x)),v.lineTo(s(3*x),s(1*x)),v.moveTo(s(5*x),s(7*x)),v.lineTo(s(7*x),s(5*x)),v.moveTo(s(9*x),s(11*x)),v.lineTo(s(11*x),s(9*x)),v.stroke(),b.toBlob(t=>{!t||e4.throwToBlob.value?f():h(t)})}),canvasBlob=(t,c)=>{let u=document.createElement("canvas");u.width=t[0],u.height=t[1];let h=u.getContext("2d");return h?(c(h),u.toDataURL()):""},getDefaultPatterns=()=>{let t=[];for(let c=1;c<=Math.ceil(to.sZ);c++){let u=canvasBlob([1,1],t=>{t.fillStyle=e0.qi.lightMode.black.semi,t.fillRect(0,0,1,1)}),h=canvasBlob([1,1],t=>{t.fillStyle=e0.qi.darkMode.black.semi,t.fillRect(0,0,1,1)});t.push({zoom:c,url:u,darkMode:!1}),t.push({zoom:c,url:h,darkMode:!0})}return t};function usePattern(){let t=(0,e8.j)(),c=t.instanceState.devicePixelRatio,[u,h]=(0,U.useState)(!1),f=(0,U.useMemo)(()=>getDefaultPatterns(),[]),[g,b]=(0,U.useState)(f);(0,U.useEffect)(()=>{let t=[];for(let u=1;u<=Math.ceil(to.sZ);u++)t.push(generateImage(c,u,!1).then(t=>({zoom:u,url:URL.createObjectURL(t),darkMode:!1}))),t.push(generateImage(c,u,!0).then(t=>({zoom:u,url:URL.createObjectURL(t),darkMode:!0})));let u=!1;return Promise.all(t).then(t=>{u||(b(t),h(!0))}),()=>{u=!0,h(!1)}},[c]);let v=(0,G.jsx)(G.Fragment,{children:g.map(t=>{let c=t.zoom+(t.darkMode?"_dark":"_light");return(0,G.jsx)("pattern",{id:to.iF[c],width:8,height:8,patternUnits:"userSpaceOnUse",children:(0,G.jsx)("image",{href:t.url,width:8,height:8})},c)})});return{defs:v,isReady:u}}function PatternFillDefForCanvas(){let t=(0,e8.j)(),c=(0,U.useRef)(null),{defs:u,isReady:h}=usePattern();return(0,U.useEffect)(()=>{if(h&&t.environment.isSafari){let t=findHtmlLayerParent(c.current);t&&requestAnimationFrame(()=>{t.style.display="none",requestAnimationFrame(()=>{t.style.display=""})})}},[t,h]),(0,G.jsx)("g",{ref:c,children:u})}function findHtmlLayerParent(t){return t.classList.contains("tl-html-layer")?t:t.parentElement?findHtmlLayerParent(t.parentElement):null}function getPerfectDashProps(t,c,u={}){let{closed:h=!1,snap:f=1,start:g="outset",end:b="outset",lengthRatio:v=2,style:x="dashed"}=u,w=0,_=0,k=1,E=0,$=0;switch(x){case"dashed":k=1,w=Math.min(c*v,t/4);break;case"dotted":w=c/(k=100);break;default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return h||("outset"===g?(t+=w/2,$+=w/2):"skip"===g&&(t-=w,$-=w),"outset"===b?t+=w/2:"skip"!==b||(t-=w)),_=Math.floor(t/w/(2*k)),(_-=_%f)<3&&"dashed"===x?t/c<5?(w=t,_=1,E=0):(w=.333*t,E=.333*t):(w=t/(_=Math.max(_,3))/(2*k),h?($=w/2,E=(t-_*w)/_):E=(t-_*w)/Math.max(1,_-1)),{strokeDasharray:[w,E].join(" "),strokeDashoffset:$.toString()}}function useEditableText(t,c,u){let h=(0,e8.j)(),f=(0,U.useRef)(null),g=(0,U.useRef)(!1),b=(0,U.useRef)(),v=(0,eJ.Hg)("isEditing",()=>h.editingShapeId===t,[h,t]);(0,U.useEffect)(()=>{let t=f.current;t&&v&&document.activeElement!==t&&t.focus()},[v]);let x=(0,U.useCallback)(()=>{let c=g.current;g.current=!1,requestAnimationFrame(()=>{let u=f.current;if(!u)return;let g=h.getShape(t);g&&(u.value=g.props.text,u.value.length&&!c&&u.select())})},[h,t]),w=(0,U.useCallback)(()=>{let c=b.current;requestAnimationFrame(()=>{let u=f.current,{editingShapeId:b}=h;if(u&&b){if(b===t){if(c){if(c.length){g.current=!0,u.focus();let t=window.getSelection();t&&c.forEach(c=>t.addRange(c))}else u.focus()}else u.focus()}}else window.getSelection()?.removeAllRanges(),h.complete()})},[h,t]),_=(0,U.useCallback)(t=>{if(v)switch((t.ctrlKey||t.metaKey)&&stopEventPropagation(t),t.key){case"Enter":(t.ctrlKey||t.metaKey)&&h.complete();break;case"Tab":preventDefault(t),t.shiftKey?TextHelpers.unindent(t.currentTarget):TextHelpers.indent(t.currentTarget)}},[h,v]),k=(0,U.useCallback)(u=>{if(!v)return;let f=TextHelpers.normalizeText(u.currentTarget.value),g=f.replace(/\t/g,"  ");if(g!==f){let t=u.currentTarget.selectionStart;u.currentTarget.value=g,u.currentTarget.selectionStart=t+(g.length-f.length),u.currentTarget.selectionEnd=t+(g.length-f.length),f=g}h.updateShapes([{id:t,type:c,props:{text:f}}])},[h,t,c,v]),E=0===u.trim().length;(0,U.useEffect)(()=>{if(!v)return;let t=f.current;if(t){let updateSelection2=function(){let t=window.getSelection?.();if(t&&"None"!==t.type){let c=[];if(t)for(let u=0;u<t.rangeCount;u++)c.push(t.getRangeAt?.(u));b.current=c}};return document.addEventListener("selectionchange",updateSelection2),()=>{document.removeEventListener("selectionchange",updateSelection2)}}},[v]);let $=(0,U.useCallback)(c=>{h.dispatch({...getPointerInfo(c),type:"pointer",name:"pointer_down",target:"shape",shape:h.getShape(t)}),stopEventPropagation(c)},[h,t]);return{rInput:f,isEditing:v,handleFocus:x,handleBlur:w,handleKeyDown:_,handleChange:k,handleInputPointerDown:$,handleDoubleClick:stopEventPropagation,isEmpty:E}}let iR=U.memo(function({id:t,text:c,size:u,font:h,position:f,width:g,labelColor:b}){let{rInput:v,isEditing:x,handleFocus:w,handleBlur:_,handleKeyDown:k,handleChange:E,isEmpty:$,handleInputPointerDown:T,handleDoubleClick:I}=useEditableText(t,"arrow",c),M=TextHelpers.normalizeTextForDom(c),j=M.trim().length>0;return x||j?(0,G.jsx)("div",{className:"tl-arrow-label","data-font":h,"data-align":"center","data-hastext":!$,"data-isediting":x,style:{textAlign:"center",fontSize:i$[u],lineHeight:i$[u]*ik.lineHeight+"px",transform:`translate(${f.x}px, ${f.y}px)`,color:b},children:(0,G.jsxs)("div",{className:"tl-arrow-label__inner",children:[(0,G.jsx)("p",{style:{width:g||"9px"},children:c?TextHelpers.normalizeTextForDom(c):" "}),x&&(0,G.jsx)("textarea",{ref:v,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:c,onFocus:w,onChange:E,onKeyDown:k,onBlur:_,onContextMenu:stopEventPropagation,onPointerDown:T,onDoubleClick:I})]})}):null}),iL=0;let ArrowShapeUtil=class ArrowShapeUtil extends nf.E{static type="arrow";static props=e0.si;static migrations=e0.Vm;canEdit=()=>!0;canBind=()=>!1;canSnap=()=>!1;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsBg=()=>!0;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{type:"point",x:0,y:0},end:{type:"point",x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",font:"draw"}}getGeometry(t){let c;let u=this.editor.getArrowInfo(t),h=u.isStraight?new nP.W({start:tn.G.From(u.start.point),end:tn.G.From(u.end.point)}):new Arc2d({center:tn.G.Cast(u.handleArc.center),radius:u.handleArc.radius,start:tn.G.Cast(u.start.point),end:tn.G.Cast(u.end.point),sweepFlag:u.bodyArc.sweepFlag,largeArcFlag:u.bodyArc.largeArcFlag});if(t.props.text.trim()){let f=h.bounds,{w:g,h:b}=this.editor.textMeasure.measureText(t.props.text,{...ik,fontFamily:iT[t.props.font],fontSize:i$[t.props.size],maxWidth:null}),v=g,x=b;if(f.width>f.height){v=Math.max(Math.min(g,64),Math.min(f.width-64,g));let{w:c,h:u}=this.editor.textMeasure.measureText(t.props.text,{...ik,fontFamily:iT[t.props.font],fontSize:i$[t.props.size],maxWidth:v});v=c,x=u}if(v>16*i$[t.props.size]){v=16*i$[t.props.size];let{w:c,h:u}=this.editor.textMeasure.measureText(t.props.text,{...ik,fontFamily:iT[t.props.font],fontSize:i$[t.props.size],maxWidth:v});v=c,x=u}c=new nh.z({x:u.middle.x-v/2-4.25,y:u.middle.y-x/2-4.25,width:v+8.5,height:x+8.5,isFilled:!0,isLabel:!0})}return new nE.m({children:c?[h,c]:[h],isSnappable:!1})}getHandles(t){let c=this.editor.getArrowInfo(t);return[{id:"start",type:"vertex",index:"a0",x:c.start.handle.x,y:c.start.handle.y,canBind:!0},{id:"middle",type:"virtual",index:"a2",x:c.middle.x,y:c.middle.y,canBind:!1},{id:"end",type:"vertex",index:"a3",x:c.end.handle.x,y:c.end.handle.y,canBind:!0}]}onHandleChange=(t,{handle:c,isPrecise:u})=>{let h=c.id;if("middle"===h){let{start:u,end:h}=(0,ny.Qs)(this.editor,t),f=tn.G.Sub(h,u),g=tn.G.Per(f),b=tn.G.Med(h,u),v=tn.G.Sub(b,g),x=tn.G.Add(b,g),w=tn.G.NearestPointOnLineSegment(v,x,c,!1),_=tn.G.Dist(w,b);return tn.G.Clockwise(w,h,b)&&(_*=-1),{id:t.id,type:t.type,props:{bend:_}}}let f=(0,e1.p$)(t),g=this.editor.getShapePageTransform(f.id),b=g.applyToPoint(c);if(this.editor.inputs.ctrlKey)return f.props[h]={type:"point",x:c.x,y:c.y},f;let v=this.editor.getShapePageTransform(t.id).applyToPoint(c),x=this.editor.getShapeAtPoint(v,{hitInside:!0,hitFrameInside:!0,margin:0,filter:t=>!t.isLocked&&this.editor.getShapeUtil(t).canBind(t)});if(!x)return f.props[h]={type:"point",x:c.x,y:c.y},f;let w=this.editor.getShapeGeometry(x),_=nS.No.ZeroFix(w.bounds),k=this.editor.getPointInShapeSpace(x,b),E=u;if(!E){let t=f.props[h];("point"===t.type||"binding"===t.type&&x.id!==t.boundShapeId)&&(E=.5>this.editor.inputs.pointerVelocity.len())}if(E&&(E=tn.G.Dist(k,_.center)>Math.max(4,Math.min(.15*Math.min(_.width,_.height),16))/this.editor.zoomLevel),!u){w.isClosed||(E=!0);let t=f.props["start"===h?"end":"start"];"binding"===t.type&&x.id===t.boundShapeId&&tn.G.Equals(t.normalizedAnchor,{x:.5,y:.5})&&(E=!0)}return f.props[h]={type:"binding",boundShapeId:x.id,normalizedAnchor:E?{x:(k.x-_.minX)/_.width,y:(k.y-_.minY)/_.height}:{x:.5,y:.5},isExact:this.editor.inputs.altKey},"binding"===f.props.start.type&&"binding"===f.props.end.type&&f.props.start.boundShapeId===f.props.end.boundShapeId&&tn.G.Equals(f.props.start.normalizedAnchor,f.props.end.normalizedAnchor)&&(f.props.end.normalizedAnchor.x+=.05),f};onTranslateStart=t=>{let c="binding"===t.props.start.type?t.props.start.boundShapeId:null,u="binding"===t.props.end.type?t.props.end.boundShapeId:null,{selectedShapeIds:h}=this.editor;if(c&&(h.includes(c)||this.editor.isAncestorSelected(c))||u&&(h.includes(u)||this.editor.isAncestorSelected(u)))return;let{start:f,end:g}=(0,ny.Qs)(this.editor,t);return{id:t.id,type:t.type,props:{...t.props,start:{type:"point",x:f.x,y:f.y},end:{type:"point",x:g.x,y:g.y}}}};onResize=(t,c)=>{let{scaleX:u,scaleY:h}=c,f=(0,ny.Qs)(this.editor,t),{start:g,end:b}=(0,e1.p$)(t.props),{bend:v}=t.props;"point"===g.type&&(g.x=f.start.x*u,g.y=f.start.y*h),"point"===b.type&&(b.x=f.end.x*u,b.y=f.end.y*h);let x=Math.abs(u),w=Math.abs(h);u<0&&h>=0?(0!==v&&(v*=-1*Math.max(x,w)),"binding"===g.type&&(g.normalizedAnchor.x=1-g.normalizedAnchor.x),"binding"===b.type&&(b.normalizedAnchor.x=1-b.normalizedAnchor.x)):u>=0&&h<0?(0!==v&&(v*=-1*Math.max(x,w)),"binding"===g.type&&(g.normalizedAnchor.y=1-g.normalizedAnchor.y),"binding"===b.type&&(b.normalizedAnchor.y=1-b.normalizedAnchor.y)):u>=0&&h>=0?0!==v&&(v*=Math.max(x,w)):u<0&&h<0&&(0!==v&&(v*=Math.max(x,w)),"binding"===g.type&&(g.normalizedAnchor.x=1-g.normalizedAnchor.x,g.normalizedAnchor.y=1-g.normalizedAnchor.y),"binding"===b.type&&(b.normalizedAnchor.x=1-b.normalizedAnchor.x,b.normalizedAnchor.y=1-b.normalizedAnchor.y));let _={props:{start:g,end:b,bend:v}};return _};onDoubleClickHandle=(t,c)=>{switch(c.id){case"start":return{id:t.id,type:t.type,props:{...t.props,arrowheadStart:"none"===t.props.arrowheadStart?"arrow":"none"}};case"end":return{id:t.id,type:t.type,props:{...t.props,arrowheadEnd:"none"===t.props.arrowheadEnd?"arrow":"none"}}}};component(t){let c=useDefaultColorTheme(),u=this.editor.onlySelectedShape,h=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","arrow.dragging")&&!this.editor.instanceState.isReadonly,f=this.editor.getArrowInfo(t),g=nS.No.ZeroFix(this.editor.getShapeGeometry(t).bounds),b=U.useMemo(()=>this.editor.environment.isSafari?iL+=1:0,[t]);if(!f?.isValid)return null;let v=iC[t.props.size],x=f.start.arrowhead&&getArrowheadPathForType(f,"start",v),w=f.end.arrowhead&&getArrowheadPathForType(f,"end",v),_=f.isStraight?(0,nv.N7)(f):(0,nb.t9)(f),k=null;if(u===t&&h){let{strokeDasharray:c,strokeDashoffset:u}=getPerfectDashProps(f.isStraight?tn.G.Dist(f.start.handle,f.end.handle):Math.abs(f.handleArc.length),2,{end:"skip",start:"skip",lengthRatio:2.5});k="binding"===t.props.start.type||"binding"===t.props.end.type?(0,G.jsx)("path",{className:"tl-arrow-hint",d:f.isStraight?(0,nv.$w)(f):(0,nb.dz)(f),strokeDasharray:c,strokeDashoffset:u,strokeWidth:2,markerStart:"binding"===t.props.start.type?t.props.start.isExact?"":isPrecise(t.props.start.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:"binding"===t.props.end.type?t.props.end.isExact?"":isPrecise(t.props.end.normalizedAnchor)?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}let{strokeDasharray:E,strokeDashoffset:$}=getPerfectDashProps(f.isStraight?f.length:Math.abs(f.bodyArc.length),v,{style:t.props.dash}),T=t.props.text.trim()?this.editor.getShapeGeometry(t).children[1]:null,I=!("none"===f.start.arrowhead||"arrow"===f.start.arrowhead),M=!("none"===f.end.arrowhead||"arrow"===f.end.arrowhead),j=(t.id+"_clip_"+b).replace(":","_");return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(nu.g,{id:t.id,style:{minWidth:50,minHeight:50},children:[(0,G.jsx)("defs",{children:(0,G.jsxs)("mask",{id:j,children:[(0,G.jsx)("rect",{x:(0,tt.$Z)(-100+g.minX),y:(0,tt.$Z)(-100+g.minY),width:(0,tt.$Z)(g.width+200),height:(0,tt.$Z)(g.height+200),fill:"white"}),T&&(0,G.jsx)("rect",{x:T.x,y:T.y,width:T.w,height:T.h,fill:"black",rx:4,ry:4}),x&&I&&(0,G.jsx)("path",{d:x,fill:"arrow"===f.start.arrowhead?"none":"black",stroke:"none"}),w&&M&&(0,G.jsx)("path",{d:w,fill:"arrow"===f.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,G.jsxs)("g",{fill:"none",stroke:c[t.props.color].solid,strokeWidth:v,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[k,(0,G.jsxs)("g",{mask:`url(#${j})`,children:[(0,G.jsx)("rect",{x:(0,tt.$Z)(g.minX-100),y:(0,tt.$Z)(g.minY-100),width:(0,tt.$Z)(g.width+200),height:(0,tt.$Z)(g.height+200),opacity:0}),(0,G.jsx)("path",{d:_,strokeDasharray:E,strokeDashoffset:$})]}),x&&I&&"none"!==t.props.fill&&(0,G.jsx)(iF,{theme:c,d:x,color:t.props.color,fill:t.props.fill}),w&&M&&"none"!==t.props.fill&&(0,G.jsx)(iF,{theme:c,d:w,color:t.props.color,fill:t.props.fill}),x&&(0,G.jsx)("path",{d:x}),w&&(0,G.jsx)("path",{d:w})]})]}),(0,G.jsx)(iR,{id:t.id,text:t.props.text,font:t.props.font,size:t.props.size,position:f.middle,width:T?.w??0,labelColor:c[t.props.labelColor].solid})]})}indicator(t){let{start:c,end:u}=(0,ny.Qs)(this.editor,t),h=this.editor.getArrowInfo(t),f=this.editor.getShapeGeometry(t),g=f.bounds,b=t.props.text.trim()?f.children[1]:null,v=useIsEditing(t.id);if(!h||tn.G.Equals(c,u))return null;let x=iC[t.props.size],w=h.start.arrowhead&&getArrowheadPathForType(h,"start",x),_=h.end.arrowhead&&getArrowheadPathForType(h,"end",x),k=h.isStraight?(0,nv.N7)(h):(0,nb.t9)(h),E=w&&"arrow"!==h.start.arrowhead||_&&"arrow"!==h.end.arrowhead||!!b,$=(t.id+"_clip").replace(":","_");return v&&b?(0,G.jsx)("rect",{x:(0,tt.$Z)(b.x),y:(0,tt.$Z)(b.y),width:b.w,height:b.h,rx:3.5,ry:3.5}):(0,G.jsxs)("g",{children:[E&&(0,G.jsx)("defs",{children:(0,G.jsxs)("mask",{id:$,children:[(0,G.jsx)("rect",{x:g.minX-100,y:g.minY-100,width:g.w+200,height:g.h+200,fill:"white"}),b&&(0,G.jsx)("rect",{x:(0,tt.$Z)(b.x),y:(0,tt.$Z)(b.y),width:b.w,height:b.h,fill:"black",rx:3.5,ry:3.5}),w&&(0,G.jsx)("path",{d:w,fill:"arrow"===h.start.arrowhead?"none":"black",stroke:"none"}),_&&(0,G.jsx)("path",{d:_,fill:"arrow"===h.end.arrowhead?"none":"black",stroke:"none"})]})}),(0,G.jsxs)("g",{...E?{mask:`url(#${$})`}:void 0,children:[E&&(0,G.jsx)("rect",{x:g.minX-100,y:g.minY-100,width:g.width+200,height:g.height+200,opacity:0}),(0,G.jsx)("path",{d:k})]}),w&&(0,G.jsx)("path",{d:w}),_&&(0,G.jsx)("path",{d:_}),b&&(0,G.jsx)("rect",{x:(0,tt.$Z)(b.x),y:(0,tt.$Z)(b.y),width:b.w,height:b.h,rx:3.5,ry:3.5})]})}onEditEnd=t=>{let{id:c,type:u,props:{text:h}}=t;h.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:c,type:u,props:{text:h.trimEnd()}}])};toSvg(t,c){let u=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode});c.addExportDef(getFillDefForExport(t.props.fill,u));let h=u[t.props.color].solid,f=this.editor.getArrowInfo(t),g=iC[t.props.size],b=document.createElementNS("http://www.w3.org/2000/svg","g");if(!f)return b;let v=f.start.arrowhead&&getArrowheadPathForType(f,"start",g),x=f.end.arrowhead&&getArrowheadPathForType(f,"end",g),w=this.editor.getShapeGeometry(t),_=w.bounds,k=t.props.text.trim()?w.children[1]:null,E=(t.id+"_clip").replace(":","_");if(v||x||k){let t=document.createElementNS("http://www.w3.org/2000/svg","defs"),c=document.createElementNS("http://www.w3.org/2000/svg","mask");c.id=E;let u=document.createElementNS("http://www.w3.org/2000/svg","rect");if(u.setAttribute("x",_.minX-100+""),u.setAttribute("y",_.minY-100+""),u.setAttribute("width",_.width+200+""),u.setAttribute("height",_.height+200+""),u.setAttribute("fill","white"),c.appendChild(u),v&&c.appendChild(getArrowheadSvgMask(v,f.start.arrowhead)),x&&c.appendChild(getArrowheadSvgMask(x,f.end.arrowhead)),k){let t=document.createElementNS("http://www.w3.org/2000/svg","rect");t.setAttribute("x",k.x+""),t.setAttribute("y",k.y+""),t.setAttribute("width",k.w+""),t.setAttribute("height",k.h+""),t.setAttribute("fill","black"),c.appendChild(t)}t.appendChild(c),b.appendChild(t)}let $=document.createElementNS("http://www.w3.org/2000/svg","g");$.setAttribute("mask",`url(#${E})`),b.appendChild($);let T=document.createElementNS("http://www.w3.org/2000/svg","rect");T.setAttribute("x","-100"),T.setAttribute("y","-100"),T.setAttribute("width",_.width+200+""),T.setAttribute("height",_.height+200+""),T.setAttribute("fill","transparent"),T.setAttribute("stroke","none"),$.appendChild(T);let I=getArrowSvgPath(f.isStraight?(0,nv.N7)(f):(0,nb.t9)(f),h,g),{strokeDasharray:M,strokeDashoffset:j}=getPerfectDashProps(f.isStraight?f.length:Math.abs(f.bodyArc.length),g,{style:t.props.dash});if(I.setAttribute("stroke-dasharray",M),I.setAttribute("stroke-dashoffset",j),$.appendChild(I),v&&b.appendChild(getArrowheadSvgPath(v,t.props.color,g,"arrow"===t.props.arrowheadStart?"none":t.props.fill,u)),x&&b.appendChild(getArrowheadSvgPath(x,t.props.color,g,"arrow"===t.props.arrowheadEnd?"none":t.props.fill,u)),k){c.addExportDef(getFontDefForExport(t.props.font));let h={fontSize:i$[t.props.size],lineHeight:ik.lineHeight,fontFamily:e0.p6[t.props.font],padding:0,textAlign:"middle",width:k.w-8,verticalTextAlign:"middle",height:k.h,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},f=createTextSvgElementFromSpans(this.editor,this.editor.textMeasure.measureTextSpans(t.props.text,h),h);f.setAttribute("fill",u[t.props.labelColor].solid);let g=Array.from(f.children);g.forEach(t=>{let c=parseFloat(t.getAttribute("x")||"0"),u=parseFloat(t.getAttribute("y")||"0");t.setAttribute("x",c+4+k.x+"px"),t.setAttribute("y",u+k.y+"px")});let v=f.cloneNode(!0);v.setAttribute("stroke-width","2"),v.setAttribute("fill",u.background),v.setAttribute("stroke",u.background),b.appendChild(v),b.appendChild(f)}return b}getCanvasSvgDefs(){return[getFillDefForCanvas()]}};function getArrowheadSvgMask(t,c){let u=document.createElementNS("http://www.w3.org/2000/svg","path");return u.setAttribute("d",t),u.setAttribute("fill","arrow"===c?"none":"black"),u.setAttribute("stroke","none"),u}function getArrowSvgPath(t,c,u){let h=document.createElementNS("http://www.w3.org/2000/svg","path");return h.setAttribute("d",t),h.setAttribute("fill","none"),h.setAttribute("stroke",c),h.setAttribute("stroke-width",u+""),h}function getArrowheadSvgPath(t,c,u,h,f){let g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("d",t),g.setAttribute("fill","none"),g.setAttribute("stroke",f[c].solid),g.setAttribute("stroke-width",u+"");let b=getShapeFillSvg({d:t,fill:h,color:c,theme:f});if(!b)return g;{let t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.appendChild(b),t.appendChild(g),t}}function isPrecise(t){return .5!==t.x||.5!==t.y}let iN=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function getRotatedBoxShadow(t){let c=iN.map(c=>{let{offsetX:u,offsetY:h,blur:f,spread:g,color:b}=c,v=new tn.G(u,h),{x,y:w}=v.rot(-t);return`${x}px ${w}px ${f}px ${g}px ${b}`});return c.join(", ")}let iz="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function HyperlinkButton({url:t,zoomLevel:c}){return(0,G.jsx)("a",{className:eX("tl-hyperlink-button",{"tl-hyperlink-button__hidden":c<.32}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:stopEventPropagation,onPointerUp:stopEventPropagation,title:t,draggable:!1,children:(0,G.jsx)("div",{className:"tl-hyperlink-button__icon",style:{mask:`url("${iz}") center 100% / 100% no-repeat`,WebkitMask:`url("${iz}") center 100% / 100% no-repeat`}})})}let BookmarkShapeUtil=class BookmarkShapeUtil extends BaseBoxShapeUtil{static type="bookmark";static props=e0.qU;static migrations=e0.h9;canResize=()=>!1;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{url:"",w:300,h:320,assetId:null}}component(t){let c=t.props.assetId?this.editor.getAsset(t.props.assetId):null,u=this.editor.getShapePageTransform(t).rotation(),h=getHumanReadableAddress(t);return(0,G.jsx)(HTMLContainer,{children:(0,G.jsxs)("div",{className:"tl-bookmark__container",style:{boxShadow:getRotatedBoxShadow(u)},children:[(0,G.jsxs)("div",{className:"tl-bookmark__image_container",children:[c?.props.image?(0,G.jsx)("img",{className:"tl-bookmark__image",draggable:!1,src:c?.props.image,alt:c?.props.title||""}):(0,G.jsx)("div",{className:"tl-bookmark__placeholder"}),(0,G.jsx)(HyperlinkButton,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]}),(0,G.jsxs)("div",{className:"tl-bookmark__copy_container",children:[c?.props.title&&(0,G.jsx)("h2",{className:"tl-bookmark__heading",children:truncateStringWithEllipsis(c?.props.title||"",54)}),c?.props.description&&(0,G.jsx)("p",{className:"tl-bookmark__description",children:truncateStringWithEllipsis(c?.props.description||"",128)}),(0,G.jsx)("a",{className:"tl-bookmark__link",href:t.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:stopEventPropagation,onPointerUp:stopEventPropagation,onClick:stopEventPropagation,children:truncateStringWithEllipsis(h,45)})]})]})})}indicator(t){return(0,G.jsx)("rect",{width:(0,tt.$Z)(t.props.w),height:(0,tt.$Z)(t.props.h),rx:"8",ry:"8"})}onBeforeCreate=t=>{updateBookmarkAssetOnUrlChange(this.editor,t)};onBeforeUpdate=(t,c)=>{if(t.props.url!==c.props.url){if(!(0,e1.jv)(c.props.url))return{...c,props:{...c.props,url:t.props.url}};updateBookmarkAssetOnUrlChange(this.editor,c)}}};let getHumanReadableAddress=t=>{try{let c=new URL(t.props.url),u=c.pathname.replace(/\/*$/,"");return`${c.hostname}${u}`}catch(c){return t.props.url}};function updateBookmarkAssetOnUrlChange(t,c){let{url:u}=c.props,h=e0.Yk.createId((0,e1.jK)(u));t.getAsset(h)?c.props.assetId!==h&&t.updateShapes([{id:c.id,type:c.type,props:{assetId:h}}]):(t.updateShapes([{id:c.id,type:c.type,props:{assetId:null}}]),iB(t,c))}let iB=(0,e1.Ds)(async(t,c)=>{let{url:u}=c.props,h=await t.getAssetForExternalContent({type:"url",url:u});h&&t.batch(()=>{t.createAssets([h]),t.updateShapes([{id:c.id,type:c.type,props:{assetId:h.id}}])})},500);function getSvgPathFromStrokePoints(t,c=!1){let u=t.length;if(u<2)return"";let h=t[0].point,f=t[1].point;if(2===u)return`M${(0,tt.Yk)(h)}L${(0,tt.Yk)(f)}`;let g="";for(let c=2,b=u-1;c<b;c++)h=t[c].point,f=t[c+1].point,g+=(0,tt.Y8)(h,f);return c?`M${(0,tt.Y8)(t[0].point,t[1].point)}Q${(0,tt.Yk)(t[1].point)}${(0,tt.Y8)(t[1].point,t[2].point)}T${g}${(0,tt.Y8)(t[u-1].point,t[0].point)}${(0,tt.Y8)(t[0].point,t[1].point)}Z`:`M${(0,tt.Yk)(t[0].point)}Q${(0,tt.Yk)(t[1].point)}${(0,tt.Y8)(t[1].point,t[2].point)}${t.length>3?"T":""}${g}L${(0,tt.Yk)(t[u-1].point)}`}function useForceSolid(){let t=(0,e8.j)();return(0,eJ.Hg)("zoom",()=>t.zoomLevel<.35,[t])}let PEN_EASING=t=>.65*t+.35*(0,tt.dv)(t*tt.PI/2),simulatePressureSettings=t=>({size:1+t,thinning:.5,streamline:.62+(1+t)/8*.06,smoothing:.62,easing:n_.L.easeOutSine,simulatePressure:!0}),realPressureSettings=t=>({size:1+1.2*t,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:PEN_EASING}),solidSettings=t=>({size:1+t,thinning:0,streamline:.62+(1+t)/8*.06,smoothing:.62,simulatePressure:!1,easing:n_.L.linear});function getHighlightFreehandSettings({strokeWidth:t,showAsComplete:c}){return{size:1+t,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:n_.L.easeOutSine,last:c}}function getFreehandOptions(t,c,u,h){return{...h?solidSettings(c):"draw"===t.dash?t.isPen?realPressureSettings(c):simulatePressureSettings(c):solidSettings(c),last:t.isComplete||u}}function getPointsFromSegments(t){let c=[];for(let u of t)if("free"===u.type||u.points.length<2)c.push(...u.points.map(tn.G.Cast));else{let t=Math.max(4,Math.floor(tn.G.Dist(u.points[0],u.points[1])/16));c.push(...tn.G.PointsBetween(u.points[0],u.points[1],t))}return c}function getDrawShapeStrokeDashArray(t,c){return({draw:"none",solid:"none",dotted:`0.1 ${2*c}`,dashed:`${2*c} ${2*c}`})[t.props.dash]}let DrawShapeUtil=class DrawShapeUtil extends nf.E{static type="draw";static props=e0.wu;static migrations=e0._l;hideResizeHandles=t=>getIsDot(t);hideRotateHandle=t=>getIsDot(t);hideSelectionBoundsFg=t=>getIsDot(t);getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1}}getGeometry(t){let c=getPointsFromSegments(t.props.segments),u=iC[t.props.size];if(1===t.props.segments.length){let t=nS.No.FromPoints(c);if(t.width<2*u&&t.height<2*u)return new Circle2d({x:-u,y:-u,radius:u,isFilled:!0})}let h=getStrokePoints(c,getFreehandOptions(t.props,u,!0,!0)).map(t=>t.point);return t.props.isClosed?new n$.w({points:h,isFilled:"none"!==t.props.fill}):new nC.q({points:h})}component(t){let c=useDefaultColorTheme(),u=useForceSolid(),h=iC[t.props.size],f=getPointsFromSegments(t.props.segments),g=t.props.isComplete||e1.Z$(t.props.segments)?.type==="straight",b=h;u||t.props.isPen||"draw"!==t.props.dash||1!==f.length||(b+=(0,e1.Vk)(t.id)()*(h/6));let v=getFreehandOptions(t.props,b,g,u),x=getStrokePoints(f,v),w=x.length>1?getSvgPathFromStrokePoints(x,t.props.isClosed):getDot(f[0],b);if(!u&&"draw"===t.props.dash||x.length<2){setStrokePointRadii(x,v);let u=getStrokeOutlinePoints_getStrokeOutlinePoints(x,v);return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{theme:c,fill:t.props.isClosed?t.props.fill:"none",color:t.props.color,d:w}),(0,G.jsx)("path",{d:getSvgPathFromPoints_getSvgPathFromPoints(u,!0),strokeLinecap:"round",fill:c[t.props.color].solid})]})}return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{theme:c,color:t.props.color,fill:t.props.isClosed?t.props.fill:"none",d:w}),(0,G.jsx)("path",{d:w,strokeLinecap:"round",fill:"none",stroke:c[t.props.color].solid,strokeWidth:h,strokeDasharray:getDrawShapeStrokeDashArray(t,h),strokeDashoffset:"0"})]})}indicator(t){let c=useForceSolid(),u=iC[t.props.size],h=getPointsFromSegments(t.props.segments),f=u;c||t.props.isPen||"draw"!==t.props.dash||1!==h.length||(f+=(0,e1.Vk)(t.id)()*(u/6));let g=t.props.isComplete||e1.Z$(t.props.segments)?.type==="straight",b=getFreehandOptions(t.props,f,g,!0),v=getStrokePoints(h,b),x=v.length>1?getSvgPathFromStrokePoints(v,t.props.isClosed):getDot(h[0],f);return(0,G.jsx)("path",{d:x})}toSvg(t,c){let u;let h=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode});c.addExportDef(getFillDefForExport(t.props.fill,h));let{color:f}=t.props,g=iC[t.props.size],b=getPointsFromSegments(t.props.segments),v=t.props.isComplete||e1.Z$(t.props.segments)?.type==="straight",x=g;t.props.isPen||"draw"!==t.props.dash||1!==b.length||(x+=(0,e1.Vk)(t.id)()*(g/6));let w=getFreehandOptions(t.props,x,v,!1),_=getStrokePoints(b,w),k=_.length>1?getSvgPathFromStrokePoints(_,t.props.isClosed):getDot(b[0],x);if("draw"===t.props.dash||_.length<2){setStrokePointRadii(_,w);let t=getStrokeOutlinePoints_getStrokeOutlinePoints(_,w),c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",getSvgPathFromPoints_getSvgPathFromPoints(t,!0)),c.setAttribute("fill",h[f].solid),c.setAttribute("stroke-linecap","round"),u=c}else{let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("d",k),c.setAttribute("stroke",h[f].solid),c.setAttribute("fill","none"),c.setAttribute("stroke-linecap","round"),c.setAttribute("stroke-width",g.toString()),c.setAttribute("stroke-dasharray",getDrawShapeStrokeDashArray(t,g)),c.setAttribute("stroke-dashoffset","0"),u=c}let E=getShapeFillSvg({fill:t.props.isClosed?t.props.fill:"none",d:k,color:t.props.color,theme:h});if(E){let t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.appendChild(E),t.appendChild(u),t}return u}getCanvasSvgDefs(){return[getFillDefForCanvas()]}onResize=(t,c)=>{let{scaleX:u,scaleY:h}=c,f=[];for(let c of t.props.segments)f.push({...c,points:c.points.map(({x:t,y:c,z:f})=>({x:(0,tt.FH)(u*t),y:(0,tt.FH)(h*c),z:f}))});return{props:{segments:f}}};expandSelectionOutlinePx(t){let c="draw"===t.props.dash?1.6:1;return iC[t.props.size]*c/2}};function getDot(t,c){let u=(c+1)*.5;return`M ${t.x} ${t.y} m -${u}, 0 a ${u},${u} 0 1,0 ${2*u},0 a ${u},${u} 0 1,0 -${2*u},0`}function getIsDot(t){return 1===t.props.segments.length&&t.props.segments[0].points.length<2}function resizeBox_resizeBox(t,c,u={}){let{newPoint:h,handle:f,scaleX:g,scaleY:b}=c,{minWidth:v=1,maxWidth:x=1/0,minHeight:w=1,maxHeight:_=1/0}=u,k=t.props.w*g,E=t.props.h*b,$=new tn.G(0,0);if(k>0){if(k<v){switch(f){case"top_left":case"left":case"bottom_left":$.x=k-v;break;case"top":case"bottom":$.x=(k-v)/2;break;default:$.x=0}k=v}}else if($.x=k,(k=-k)<v){switch(f){case"top_left":case"left":case"bottom_left":$.x=-k;break;default:$.x=-v}k=v}if(E>0){if(E<w){switch(f){case"top_left":case"top":case"top_right":$.y=E-w;break;case"right":case"left":$.y=(E-w)/2;break;default:$.y=0}E=w}}else if($.y=E,(E=-E)<w){switch(f){case"top_left":case"top":case"top_right":$.y=-E;break;default:$.y=-w}E=w}let{x:T,y:I}=$.rot(t.rotation).add(h);return{x:T,y:I,props:{w:Math.min(x,k),h:Math.min(_,E)}}}let getSandboxPermissions=t=>Object.entries(t).filter(([t,c])=>c).map(([t])=>t).join(" ");let EmbedShapeUtil=class EmbedShapeUtil extends BaseBoxShapeUtil{static type="embed";static props=e0.DW;static migrations=e0.BF;hideSelectionBoundsFg=t=>!this.canResize(t);canEdit=()=>!0;canUnmount=t=>!!getEmbedInfo(t.props.url)?.definition?.canUnmount;canResize=t=>!!getEmbedInfo(t.props.url)?.definition?.doesResize;canEditInReadOnly=()=>!0;getDefaultProps(){return{w:300,h:300,url:""}}isAspectRatioLocked=t=>{let c=getEmbedInfo(t.props.url);return c?.definition.isAspectRatioLocked??!1};onResize=(t,c)=>{let u=this.isAspectRatioLocked(t),h=getEmbedInfo(t.props.url),f=h?.definition.minWidth??200,g=h?.definition.minHeight??200;if(u){let c=t.props.w/t.props.h;c>1?f*=c:g/=c}return resizeBox_resizeBox(t,c,{minWidth:f,minHeight:g})};component(t){let{w:c,h:u,url:h}=t.props,f=useIsEditing(t.id),g=(0,U.useMemo)(()=>getEmbedInfoUnsafely(h),[h]),b=(0,eJ.Hg)("is hovering",()=>{let{editingShapeId:t,hoveredShapeId:c}=this.editor.currentPageState;if(t&&c!==t){let c=this.editor.getShape(t);if(c&&this.editor.isShapeOfType(c,"embed"))return!0}return!1},[]),v=this.editor.getShapePageTransform(t).rotation(),x=f||b;if(g?.definition.type==="github_gist"){let h=g.url.split("/").pop();if(!h)throw Error("No gist id!");return(0,G.jsx)(HTMLContainer,{className:"tl-embed-container",id:t.id,children:(0,G.jsx)(Gist,{id:h,width:(0,tt.$Z)(c),height:(0,tt.$Z)(u),isInteractive:x,pageRotation:v})})}let w=getSandboxPermissions({...e0.gB,...g?.definition.overridePermissions??{}});return(0,G.jsx)(HTMLContainer,{className:"tl-embed-container",id:t.id,children:g?.definition?(0,G.jsx)("iframe",{className:"tl-embed",sandbox:w,src:g.embedUrl,width:(0,tt.$Z)(c),height:(0,tt.$Z)(u),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:x?"auto":"none",zIndex:x?"":"-1",boxShadow:getRotatedBoxShadow(v),borderRadius:g?.definition.overrideOutlineRadius??8,background:g?.definition.backgroundColor}}):null})}indicator(t){let c=(0,U.useMemo)(()=>getEmbedInfo(t.props.url),[t.props.url]);return(0,G.jsx)("rect",{width:(0,tt.$Z)(t.props.w),height:(0,tt.$Z)(t.props.h),rx:c?.definition.overrideOutlineRadius??8,ry:c?.definition.overrideOutlineRadius??8})}};function Gist({id:t,file:c,isInteractive:u,width:h,height:f,style:g,pageRotation:b}){return(0,G.jsx)("iframe",{className:"tl-embed",draggable:!1,width:(0,tt.$Z)(h),height:(0,tt.$Z)(f),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...g,pointerEvents:u?"all":"none",zIndex:u?"":"-1",boxShadow:getRotatedBoxShadow(b)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=https://gist.github.com/${t}.js${c?`?file=${c}`:""}></script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}let iG=(0,U.forwardRef)(({id:t,name:c,isEditing:u},h)=>{let f=(0,e8.j)(),g=(0,U.useCallback)(t=>{"Enter"!==t.key||t.nativeEvent.isComposing||(stopEventPropagation(t),t.currentTarget.blur(),f.setEditingShape(null))},[f]),b=(0,U.useCallback)(c=>{let u=f.getShape(t);if(!u)return;let h=u.props.name,g=c.currentTarget.value.trim();h!==g&&f.updateShapes([{id:t,type:"frame",props:{name:g}}],{squashing:!0})},[t,f]),v=(0,U.useCallback)(c=>{let u=f.getShape(t);if(!u)return;let h=u.props.name,g=c.currentTarget.value;h!==g&&f.updateShapes([{id:t,type:"frame",props:{name:g}}],{squashing:!0})},[t,f]);return(0,G.jsxs)("div",{className:`tl-frame-label ${u?"tl-frame-label__editing":""}`,children:[(0,G.jsx)("input",{className:"tl-frame-name-input",ref:h,style:{display:u?void 0:"none"},value:c,autoFocus:!0,onKeyDown:g,onBlur:b,onChange:v}),defaultEmptyAs(c,"Frame")+String.fromCharCode(8203)]})}),FrameHeading=function({id:t,name:c,width:u,height:h}){let f;let g=(0,e8.j)(),b=(0,tt.f5)(g.getShapePageTransform(t).rotation()),v=useIsEditing(t),x=(0,U.useRef)(null),w=(0,U.useCallback)(c=>{let u=getPointerInfo(c);g.editingShapeId!==t&&(g.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:g.getShape(t),...u}),c.preventDefault())},[g,t]);(0,U.useEffect)(()=>{let t=x.current;t&&v&&(t.focus(),t.select(),requestAnimationFrame(()=>{document.activeElement!==t&&(t.focus(),t.select())}))},[x,v]);let _=["top","left","bottom","right"][Math.floor(((b+Math.PI/4)*(2/Math.PI)+4)%4)];switch(_){case"top":f="";break;case"right":f=`translate(${(0,tt.$Z)(u)}px, 0px) rotate(90deg)`;break;case"bottom":f=`translate(${(0,tt.$Z)(u)}px, ${(0,tt.$Z)(h)}px) rotate(180deg)`;break;case"left":f=`translate(0px, ${(0,tt.$Z)(h)}px) rotate(270deg)`}return(0,G.jsx)("div",{className:"tl-frame-heading",style:{overflow:v?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${"top"===_||"bottom"===_?Math.ceil(u):Math.ceil(h)}px + var(--space-5))`,bottom:"100%",transform:`${f} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:w,children:(0,G.jsx)("div",{className:"tl-frame-heading-hit-area",children:(0,G.jsx)(iG,{ref:x,id:t,name:c,isEditing:v})})})};function defaultEmptyAs(t,c){return t.match(/^\s*$/)?c:t}let FrameShapeUtil=class FrameShapeUtil extends BaseBoxShapeUtil{static type="frame";static props=e0.k7;static migrations=e0.gR;canBind=()=>!0;canEdit=()=>!0;getDefaultProps(){return{w:320,h:180,name:""}}getGeometry(t){return new nh.z({width:t.props.w,height:t.props.h,isFilled:!1})}component(t){let c=this.editor.getShapeGeometry(t).bounds,u=useDefaultColorTheme();return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(nu.g,{children:(0,G.jsx)("rect",{className:"tl-frame__body",width:c.width,height:c.height,fill:u.solid,stroke:u.text})}),(0,G.jsx)(FrameHeading,{id:t.id,name:t.props.name,width:c.width,height:c.height})]})}toSvg(t){let c;let u=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode}),h=document.createElementNS("http://www.w3.org/2000/svg","g"),f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("width",t.props.w.toString()),f.setAttribute("height",t.props.h.toString()),f.setAttribute("fill",u.solid),f.setAttribute("stroke",u.black.solid),f.setAttribute("stroke-width","1"),f.setAttribute("rx","1"),f.setAttribute("ry","1"),h.appendChild(f);let g=(0,tt.f5)(this.editor.getShapePageTransform(t.id).rotation()),b=["top","left","bottom","right"][Math.floor(((g+Math.PI/4)*(2/Math.PI)+4)%4)];switch(b){case"top":default:c="";break;case"right":c=`translate(${(0,tt.$Z)(t.props.w)}px, 0px) rotate(90deg)`;break;case"bottom":c=`translate(${(0,tt.$Z)(t.props.w)}px, ${(0,tt.$Z)(t.props.h)}px) rotate(180deg)`;break;case"left":c=`translate(0px, ${(0,tt.$Z)(t.props.h)}px) rotate(270deg)`}let v={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:t.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},x=this.editor.textMeasure.measureTextSpans(defaultEmptyAs(t.props.name,"Frame")+String.fromCharCode(8203),v),w=x[0],_=(0,e1.Z$)(x),k=_.box.w+_.box.x-w.box.x,E=createTextSvgElementFromSpans(this.editor,x,{offsetY:-v.height-2,...v});E.style.setProperty("transform",c);let $=document.createElementNS("http://www.w3.org/2000/svg","rect");return $.setAttribute("x","-8px"),$.setAttribute("y",-v.height-4+"px"),$.setAttribute("width",k+16+"px"),$.setAttribute("height",`${v.height}px`),$.setAttribute("rx","4px"),$.setAttribute("ry","4px"),$.setAttribute("fill",u.background),h.appendChild($),h.appendChild(E),h}indicator(t){let c=this.editor.getShapeGeometry(t).bounds;return(0,G.jsx)("rect",{width:(0,tt.$Z)(c.width),height:(0,tt.$Z)(c.height),className:"tl-frame-indicator"})}canReceiveNewChildrenOfType=(t,c)=>!t.isLocked;providesBackgroundForChildren(){return!0}canDropShapes=(t,c)=>!t.isLocked;onDragShapesOver=(t,c)=>c.every(c=>c.parentId===t.id)?{shouldHint:!1}:(this.editor.reparentShapes(c.map(t=>t.id),t.id),{shouldHint:!0});onDragShapesOut=(t,c)=>{let u=this.editor.getShape(t.parentId),h=u&&this.editor.isShapeOfType(u,"group");h?this.editor.reparentShapes(c,u.id):this.editor.reparentShapes(c,this.editor.currentPageId)};onResizeEnd=t=>{let c=this.editor.getShapePageBounds(t),u=this.editor.getSortedChildIdsForParent(t.id),h=[];for(let t of u){let u=this.editor.getShapePageBounds(t);c.includes(u)||h.push(t)}h.length>0&&this.editor.reparentShapes(h,this.editor.currentPageId)}};function getLegacyOffsetX(t,c,u,h){if(("start-legacy"===t||"end-legacy"===t)&&0!==u.length){let f=nS.No.From(u[0].box);for(let{box:t}of u)f.union(t);if("start-legacy"===t)return(h-2*c-f.width)/2;if("end-legacy"===t)return-(h-2*c-f.width)/2}}function isLegacyAlign(t){return"start-legacy"===t||"middle-legacy"===t||"end-legacy"===t}let iH=U.memo(function({id:t,type:c,text:u,size:h,labelColor:f,font:g,align:b,verticalAlign:v,wrap:x,bounds:w}){let{rInput:_,isEmpty:k,isEditing:E,handleFocus:$,handleChange:T,handleKeyDown:I,handleBlur:M,handleInputPointerDown:j,handleDoubleClick:D}=useEditableText(t,c,u),F=TextHelpers.normalizeTextForDom(u),L=F.length>0,B=isLegacyAlign(b),U=useDefaultColorTheme();return E||L?(0,G.jsx)("div",{className:"tl-text-label","data-font":g,"data-align":b,"data-hastext":!k,"data-isediting":E,"data-textwrap":!!x,style:{justifyContent:"middle"===b||B?"center":b,alignItems:"middle"===v?"center":v,...w?{top:w.minY,left:w.minX,width:w.width,height:w.height,position:"absolute"}:{}},children:(0,G.jsxs)("div",{className:"tl-text-label__inner",style:{fontSize:iE[h],lineHeight:iE[h]*ik.lineHeight+"px",minHeight:ik.lineHeight+32,minWidth:0,color:U[f].solid},children:[(0,G.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:F}),E&&(0,G.jsx)("textarea",{ref:_,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:!0,placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",datatype:"wysiwyg",defaultValue:u,onFocus:$,onChange:T,onKeyDown:I,onBlur:M,onContextMenu:stopEventPropagation,onPointerDown:j,onDoubleClick:D})]})}):null});function getTextLabelSvgElement({bounds:t,editor:c,font:u,shape:h}){let f={fontSize:iE[h.props.size],fontFamily:u,textAlign:h.props.align,verticalTextAlign:h.props.verticalAlign,width:Math.ceil(t.width),height:Math.ceil(t.height),padding:16,lineHeight:ik.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0},g=c.textMeasure.measureTextSpans(h.props.text,f),b=getLegacyOffsetX(h.props.align,16,g,t.width);b&&(f.offsetX=b);let v=createTextSvgElementFromSpans(c,g,f);return v}function precise(t){return`${(0,tt.$Z)(t.x)},${(0,tt.$Z)(t.y)} `}function rng(t=""){let c=0,u=0,h=0,f=0;function next(){let t=c^c<<11;return c=u,u=h,h=f,(f^=(f>>>19^t^t>>>8)>>>0)/4294967296*2}for(let u=0;u<t.length+64;u++)c^=0|t.charCodeAt(u),next();return next}function getRoundedInkyPolygonPath(t){let c,u,h,f="M",g=t.length;for(let b=0;b<g;b+=3)c=t[b],u=t[b+1],h=t[b+2],f+=`${precise(c)}L${precise(u)}Q${precise(h)}`;return f+`${precise(t[0])}`}function getRoundedPolygonPoints(t,c,u,h,f){let g;let b=[],v=rng(t),x=c[0],w=c.length;for(let t=0,_=w*f;t<_;t++){g=tn.G.AddXY(c[(t+1)%w],v()*u,v()*u);let f=tn.G.Sub(g,x),_=tn.G.Len(f),k=tn.G.Div(f,_).mul(Math.min(_/4,h));b.push(tn.G.Add(x,k),tn.G.Add(g,k.neg()),g),x=g}return b}function getDrawLinePathData(t,c,u){let h,f,g=`M ${precise(c[0])}L`,b=`M ${precise(c[0])}L`,v=u/3,x=2*u,w=rng(t),_=c[0],k=c[0],E=c.length;for(let t=0,u=E-1;t<u;t++){h=c[t+1],f=tn.G.AddXY(c[t+1],w()*v,w()*v);let E=tn.G.Sub(h,_),$=tn.G.Len(E),T=tn.G.Div(E,$).mul(Math.min($/4,x)),I=tn.G.Add(_,T),M=tn.G.Add(h,T.neg()),j=tn.G.Sub(f,k),D=tn.G.Len(j),F=tn.G.Div(j,D).mul(Math.min(D/4,x)),L=tn.G.Add(k,F),B=tn.G.Add(f,F.neg());t===u-1?(g+=`${precise(I)}L ${precise(h)}`,b+=`${precise(L)}L ${precise(f)}`):(g+=`${precise(I)}L ${precise(M)}Q ${precise(h)}`,b+=`${precise(L)}L ${precise(B)}Q ${precise(f)}`,_=h,k=f)}return[g,g+b]}function getPillCircumference(t,c){let u=Math.min(t,c)/2;return Math.PI*(2*u)+2*(Math.max(t,c)-2*u)}function getPillPoints(t,c,u){let h=Math.min(t,c)/2,f=Math.max(t,c)-2*h,g=Math.PI*(2*h)+2*f,b=g/u,v=t>c?[{type:"straight",start:new tn.G(h,0),delta:new tn.G(1,0)},{type:"arc",center:new tn.G(t-h,h),startAngle:-tt.PI/2},{type:"straight",start:new tn.G(t-h,c),delta:new tn.G(-1,0)},{type:"arc",center:new tn.G(h,h),startAngle:tt.PI/2}]:[{type:"straight",start:new tn.G(t,h),delta:new tn.G(0,1)},{type:"arc",center:new tn.G(h,c-h),startAngle:0},{type:"straight",start:new tn.G(0,c-h),delta:new tn.G(0,-1)},{type:"arc",center:new tn.G(h,h),startAngle:tt.PI}],x=0,w=[];for(let t=0;t<u;t++){let t=v[0];"straight"===t.type?w.push(tn.G.Add(t.start,tn.G.Mul(t.delta,x))):w.push((0,tt.XD)(t.center.x,t.center.y,h,t.startAngle+x/h)),x+=b;let c="straight"===t.type?f:tt.PI*h;for(;x>c;)x-=c,v.push(v.shift()),c="straight"===v[0].type?f:tt.PI*h}return w}let switchSize=(t,c,u,h,f)=>{switch(t){case"s":return c;case"m":return u;case"l":return h;case"xl":return f}};function getCloudArcs(t,c,u,h){let f=(0,e1.Vk)(u),g=getPillCircumference(t,c),b=Math.max(Math.ceil(g/switchSize(h,50,70,100,130)),6,Math.ceil(g/Math.min(t,c))),v=g/b*.2,x=Math.max(t-2*v,1),w=Math.max(c-2*v,1),_=(t-x)/2,k=(c-w)/2,E=getPillCircumference(x,w)/b,$=getPillPoints(x,w,b).map(t=>t.addXY(_,k)),T=t<20?0:.3*v,I=c<20?0:.3*v,M=$.slice(0);for(let t=0;t<Math.floor(b/2);t++)M[t]=tn.G.AddXY(M[t],f()*T,f()*I),M[b-t-1]=tn.G.AddXY(M[b-t-1],f()*T,f()*I);let j=[];for(let u=0;u<M.length;u++){let h=u===M.length-1?0:u+1,f=M[u],g=M[h],b=$[u],v=$[h],x=tn.G.Average([b,v]),w=tn.G.Angle(b,v)-Math.PI/2,T=tn.G.Dist(b,v),I=E-T,D=tn.G.Dist(f,g),F=D/T,L=(Math.max(_,k)+I)*F,B=tn.G.Add(x,tn.G.FromAngle(w,L));B.x<0?B.x=0:B.x>t&&(B.x=t),B.y<0?B.y=0:B.y>c&&(B.y=c);let G=getCenterOfCircleGivenThreePoints(f,g,B),U=tn.G.Dist(G||tn.G.Average([f,g]),f);j.push({leftPoint:f,rightPoint:g,arcPoint:B,center:G,radius:U})}return j}function getCenterOfCircleGivenThreePoints(t,c,u){let h=t.x*(c.y-u.y)-t.y*(c.x-u.x)+c.x*u.y-u.x*c.y,f=(t.x*t.x+t.y*t.y)*(u.y-c.y)+(c.x*c.x+c.y*c.y)*(t.y-u.y)+(u.x*u.x+u.y*u.y)*(c.y-t.y),g=(t.x*t.x+t.y*t.y)*(c.x-u.x)+(c.x*c.x+c.y*c.y)*(u.x-t.x)+(u.x*u.x+u.y*u.y)*(t.x-c.x),b=-f/(2*h),v=-g/(2*h);return Number.isFinite(b)&&Number.isFinite(v)?new tn.G(b,v):null}function cloudOutline(t,c,u,h){let f=[],g=getCloudArcs(t,c,u,h);for(let{center:t,radius:c,leftPoint:u,rightPoint:h}of g)f.push(...pointsOnArc(u,h,t,c,10));return f}function cloudSvgPath(t,c,u,h){let f=getCloudArcs(t,c,u,h),g=`M${(0,tt.$Z)(f[0].leftPoint.x)},${(0,tt.$Z)(f[0].leftPoint.y)}`;for(let{leftPoint:t,rightPoint:c,radius:u,center:h}of f){if(null===h){g+=` L${(0,tt.$Z)(c.x)},${(0,tt.$Z)(c.y)}`;continue}let f=isLeft(t,c,h)?"0":"1";g+=` A${(0,tt.$Z)(u)},${(0,tt.$Z)(u)} 0 ${f},1 ${(0,tt.$Z)(c.x)},${(0,tt.$Z)(c.y)}`}return g+" Z"}function inkyCloudSvgPath(t,c,u,h){let f=(0,e1.Vk)(u),g="s"===h?.5:"m"===h?.7:"l"===h?.9:1.6,mut=t=>t+f()*g*2,b=getCloudArcs(t,c,u,h),v=b.reduce((t,c)=>t+tn.G.Dist(c.leftPoint,c.rightPoint),0)/b.length,x=v>15*g?t=>new tn.G(mut(t.x),mut(t.y)):t=>t,w=`M${(0,tt.$Z)(b[0].leftPoint.x)},${(0,tt.$Z)(b[0].leftPoint.y)}`,_=x(b[0].leftPoint),k=`M${(0,tt.$Z)(_.x)},${(0,tt.$Z)(_.y)}`;for(let{leftPoint:t,center:c,rightPoint:u,radius:h,arcPoint:f}of b){if(null===c){w+=` L${(0,tt.$Z)(u.x)},${(0,tt.$Z)(u.y)}`;let t=x(u);k+=` L${(0,tt.$Z)(t.x)},${(0,tt.$Z)(t.y)}`,_=t;continue}let g=isLeft(t,u,c)?"0":"1";w+=` A${(0,tt.$Z)(h)},${(0,tt.$Z)(h)} 0 ${g},1 ${(0,tt.$Z)(u.x)},${(0,tt.$Z)(u.y)}`;let b=x(u),v=x(f),E=getCenterOfCircleGivenThreePoints(_,b,v);if(!E){k+=` L${(0,tt.$Z)(b.x)},${(0,tt.$Z)(b.y)}`,_=b;continue}let $=Math.abs(tn.G.Dist(E,_));k+=` A${(0,tt.$Z)($)},${(0,tt.$Z)($)} 0 ${g},1 ${(0,tt.$Z)(b.x)},${(0,tt.$Z)(b.y)}`,_=b}return w+k+" Z"}function pointsOnArc(t,c,u,h,f){if(null===u)return[tn.G.From(t),tn.G.From(c)];let g=[],b=tn.G.Angle(u,t),v=tn.G.Angle(u,c),x=(0,tt.VK)(b,v);for(let t=0;t<f;t++){let c=t/(f-1),v=b+x*c,w=(0,tt.XD)(u.x,u.y,h,v);g.push(w)}return g}function isLeft(t,c,u){return(c.x-t.x)*(u.y-t.y)-(c.y-t.y)*(u.x-t.x)>0}let iU=U.memo(function({dash:t,fill:c,color:u,strokeWidth:h,w:f,h:g,id:b,size:v}){let x=useDefaultColorTheme(),w=cloudSvgPath(f,g,b,v),_=getCloudArcs(f,g,b,v);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:x,d:w,fill:c,color:u}),(0,G.jsx)("g",{strokeWidth:h,stroke:x[u].solid,fill:"none",pointerEvents:"all",children:_.map(({leftPoint:c,rightPoint:u,center:f,radius:g},b)=>{let v=f?g*(0,tt.f5)((0,tt.f5)(tn.G.Angle(f,u))-(0,tt.f5)(tn.G.Angle(f,c))):tn.G.Dist(c,u),{strokeDasharray:x,strokeDashoffset:w}=getPerfectDashProps(v,h,{style:t,start:"outset",end:"outset"});return(0,G.jsx)("path",{d:f?`M${c.x},${c.y}A${g},${g},0,0,1,${u.x},${u.y}`:`M${c.x},${c.y}L${u.x},${u.y}`,strokeDasharray:x,strokeDashoffset:w},b)})})]})});function DashStyleCloudSvg({dash:t,fill:c,color:u,theme:h,strokeWidth:f,w:g,h:b,id:v,size:x}){let w=cloudSvgPath(g,b,v,x),_=getCloudArcs(g,b,v,x),k=document.createElementNS("http://www.w3.org/2000/svg","g");for(let{leftPoint:c,rightPoint:g,center:b,radius:v}of(k.setAttribute("stroke-width",f.toString()),k.setAttribute("stroke",h[u].solid),k.setAttribute("fill","none"),_)){let u=b?v*(0,tt.f5)((0,tt.f5)(tn.G.Angle(b,g))-(0,tt.f5)(tn.G.Angle(b,c))):tn.G.Dist(c,g),{strokeDasharray:h,strokeDashoffset:x}=getPerfectDashProps(u,f,{style:t,start:"outset",end:"outset"}),w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d",b?`M${c.x},${c.y}A${v},${v},0,0,1,${g.x},${g.y}`:`M${c.x},${c.y}L${g.x},${g.y}`),w.setAttribute("stroke-dasharray",h.toString()),w.setAttribute("stroke-dashoffset",x.toString()),k.appendChild(w)}let E=getShapeFillSvg({d:w,fill:c,color:u,theme:h});return getSvgWithShapeFill(k,E)}let iV=U.memo(function({w:t,h:c,strokeWidth:u,dash:h,color:f,fill:g}){let b=useDefaultColorTheme(),v=t/2,x=c/2,w=Math.max(0,v),_=Math.max(0,x),k=(0,tt.Rp)(w,_),{strokeDasharray:E,strokeDashoffset:$}=getPerfectDashProps(k<64?2*k:k,u,{style:h,snap:4,closed:!0}),T=`M${v-w},${x}a${w},${_},0,1,1,${2*w},0a${w},${_},0,1,1,-${2*w},0`;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:b,d:T,color:f,fill:g}),(0,G.jsx)("path",{d:T,strokeWidth:u,width:(0,tt.$Z)(t),height:(0,tt.$Z)(c),fill:"none",stroke:b[f].solid,strokeDasharray:E,strokeDashoffset:$,pointerEvents:"all"})]})});function DashStyleEllipseSvg({w:t,h:c,strokeWidth:u,dash:h,color:f,theme:g,fill:b}){let v=t/2,x=c/2,w=Math.max(0,v-u/2),_=Math.max(0,x-u/2),k=(0,tt.Rp)(w,_),{strokeDasharray:E,strokeDashoffset:$}=getPerfectDashProps(k<64?2*k:k,u,{style:h,snap:4,closed:!0}),T=`M${v-w},${x}a${w},${_},0,1,1,${2*w},0a${w},${_},0,1,1,-${2*w},0`,I=document.createElementNS("http://www.w3.org/2000/svg","path");I.setAttribute("d",T),I.setAttribute("stroke-width",u.toString()),I.setAttribute("width",t.toString()),I.setAttribute("height",c.toString()),I.setAttribute("fill","none"),I.setAttribute("stroke",g[f].solid),I.setAttribute("stroke-dasharray",E),I.setAttribute("stroke-dashoffset",$);let M=getShapeFillSvg({d:T,fill:b,color:f,theme:g});return getSvgWithShapeFill(I,M)}function getOvalSolidPath(t,c){if(c>t){let u=t/2;return`
    M0,${u}
    a${u},${u},0,1,1,${2*u},0
    L${t},${c-u}
    a${u},${u},0,1,1,-${2*u},0
    Z`}let u=c/2;return`
    M${u},0
    L${t-u},0
    a${u},${u},0,1,1,0,${2*u}
    L${u},${c}
    a${u},${u},0,1,1,0,${-(2*u)}
    Z`}function getOvalPerimeter(t,c){if(t>c){let u=c/2;return(0,tt.Rp)(u,u)+(t-2*u)*2}let u=t/2;return(0,tt.Rp)(u,u)+(c-2*u)*2}let iW=U.memo(function({w:t,h:c,strokeWidth:u,dash:h,color:f,fill:g}){let b=useDefaultColorTheme(),v=getOvalSolidPath(t,c),x=getOvalPerimeter(t,c),{strokeDasharray:w,strokeDashoffset:_}=getPerfectDashProps(x<64?2*x:x,u,{style:h,snap:4,start:"outset",end:"outset",closed:!0});return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:b,d:v,color:f,fill:g}),(0,G.jsx)("path",{d:v,strokeWidth:u,width:(0,tt.$Z)(t),height:(0,tt.$Z)(c),fill:"none",stroke:b[f].solid,strokeDasharray:w,strokeDashoffset:_,pointerEvents:"all"})]})});function DashStyleOvalSvg({w:t,h:c,strokeWidth:u,dash:h,color:f,theme:g,fill:b}){let v=getOvalSolidPath(t,c),x=getOvalPerimeter(t,c),{strokeDasharray:w,strokeDashoffset:_}=getPerfectDashProps(x<64?2*x:x,u,{style:h,snap:4,closed:!0}),k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",v),k.setAttribute("stroke-width",u.toString()),k.setAttribute("width",t.toString()),k.setAttribute("height",c.toString()),k.setAttribute("fill","none"),k.setAttribute("stroke",g[f].solid),k.setAttribute("stroke-dasharray",w),k.setAttribute("stroke-dashoffset",_);let E=getShapeFillSvg({d:v,fill:b,color:f,theme:g});return getSvgWithShapeFill(k,E)}let iK=U.memo(function({dash:t,fill:c,color:u,strokeWidth:h,outline:f,lines:g}){let b=useDefaultColorTheme(),v="M"+f[0]+"L"+f.slice(1)+"Z";return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:b,d:v,fill:c,color:u}),(0,G.jsxs)("g",{strokeWidth:h,stroke:b[u].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(f.length)).map((c,u)=>{let g=f[u],b=f[(u+1)%f.length],v=tn.G.Dist(g,b),{strokeDasharray:x,strokeDashoffset:w}=getPerfectDashProps(v,h,{style:t,start:"outset",end:"outset"});return(0,G.jsx)("line",{x1:g.x,y1:g.y,x2:b.x,y2:b.y,strokeDasharray:x,strokeDashoffset:w},u)}),g&&g.map(([c,f],g)=>{let v=tn.G.Dist(c,f),{strokeDasharray:x,strokeDashoffset:w}=getPerfectDashProps(v,h,{style:t,start:"skip",end:"outset",snap:"dotted"===t?4:void 0});return(0,G.jsx)("path",{d:`M${c.x},${c.y}L${f.x},${f.y}`,stroke:b[u].solid,strokeWidth:h,fill:"none",strokeDasharray:x,strokeDashoffset:w},`line_fg_${g}`)})]})]})});function DashStylePolygonSvg({dash:t,fill:c,color:u,theme:h,strokeWidth:f,outline:g,lines:b}){let v=document.createElementNS("http://www.w3.org/2000/svg","g");if(v.setAttribute("stroke-width",f.toString()),v.setAttribute("stroke",h[u].solid),v.setAttribute("fill","none"),Array.from(Array(g.length)).forEach((c,u)=>{let h=g[u],b=g[(u+1)%g.length],x=tn.G.Dist(h,b),{strokeDasharray:w,strokeDashoffset:_}=getPerfectDashProps(x,f,{style:t}),k=document.createElementNS("http://www.w3.org/2000/svg","line");k.setAttribute("x1",h.x.toString()),k.setAttribute("y1",h.y.toString()),k.setAttribute("x2",b.x.toString()),k.setAttribute("y2",b.y.toString()),k.setAttribute("stroke-dasharray",w.toString()),k.setAttribute("stroke-dashoffset",_.toString()),v.appendChild(k)}),b)for(let[c,u]of b){let h=tn.G.Dist(c,u),{strokeDasharray:g,strokeDashoffset:b}=getPerfectDashProps(h,f,{style:t,start:"skip",end:"skip",snap:"dotted"===t?4:2}),x=document.createElementNS("http://www.w3.org/2000/svg","line");x.setAttribute("x1",c.x.toString()),x.setAttribute("y1",c.y.toString()),x.setAttribute("x2",u.x.toString()),x.setAttribute("y2",u.y.toString()),x.setAttribute("stroke-dasharray",g.toString()),x.setAttribute("stroke-dashoffset",b.toString()),v.appendChild(x)}let x=getShapeFillSvg({d:"M"+g[0]+"L"+g.slice(1)+"Z",fill:c,color:u,theme:h});return getSvgWithShapeFill(v,x)}let iZ=U.memo(function({fill:t,color:c,strokeWidth:u,w:h,h:f,id:g,size:b}){let v=useDefaultColorTheme(),x=inkyCloudSvgPath(h,f,g,b);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:v,d:x,fill:t,color:c}),(0,G.jsx)("path",{d:x,stroke:v[c].solid,strokeWidth:u,fill:"none"})]})});function DrawStyleCloudSvg({fill:t,color:c,strokeWidth:u,theme:h,w:f,h:g,id:b,size:v}){let x=inkyCloudSvgPath(f,g,b,v),w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d",x),w.setAttribute("stroke-width",u.toString()),w.setAttribute("stroke",h[c].solid),w.setAttribute("fill","none");let _=getShapeFillSvg({d:x,fill:t,color:c,theme:h});return getSvgWithShapeFill(w,_)}function DrawStyleEllipseSvg({id:t,w:c,h:u,strokeWidth:h,fill:f,color:g,theme:b}){let v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",getEllipsePath(t,c,u,h)),v.setAttribute("fill",b[g].solid);let x=getShapeFillSvg({d:getSvgPathFromStrokePoints(getEllipseStrokePoints(t,c,u,h)),fill:f,color:g,theme:b});return getSvgWithShapeFill(v,x)}function getEllipseStrokeOptions(t){return{size:1+t,thinning:.25,end:{taper:t},start:{taper:t},streamline:0,smoothing:1,simulatePressure:!1}}function getEllipseStrokePoints(t,c,u,h){let f=(0,e1.Vk)(t),g=c/2,b=u/2,v=(0,tt.Rp)(g,b),x=[],w=tt.yo*f(),_=tt.yo+tt.gc/2+Math.abs(f())*tt.gc,k=Math.max(16,v/10);for(let t=0;t<k;t++){let h=t/(k-1),v=w+h*_,E=Math.cos(v),$=Math.sin(v);x.push(new tn.G(g*E+.5*c+.05*f(),b*$+u/2+.05*f(),Math.min(1,.5+Math.abs(.5-(f()>0?n_.L.easeInOutSine(h):n_.L.easeInExpo(h)))/2)))}return getStrokePoints(x,getEllipseStrokeOptions(h))}function getEllipsePath(t,c,u,h){let f=getEllipseStrokeOptions(h);return getSvgPathFromPoints_getSvgPathFromPoints(getStrokeOutlinePoints_getStrokeOutlinePoints(setStrokePointRadii(getEllipseStrokePoints(t,c,u,h),f),f))}U.memo(function({id:t,w:c,h:u,strokeWidth:h,fill:f,color:g}){let b=useDefaultColorTheme(),v=getSvgPathFromStrokePoints(getEllipseStrokePoints(t,c,u,h)),x=getEllipsePath(t,c,u,h);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:b,d:v,color:g,fill:f}),(0,G.jsx)("path",{d:x,fill:b[g].solid,strokeWidth:0,pointerEvents:"all"})]})});let iY=U.memo(function({id:t,outline:c,lines:u,fill:h,color:f,strokeWidth:g}){let b=useDefaultColorTheme(),v=getRoundedPolygonPoints(t,c,g/3,2*g,2),x=getRoundedInkyPolygonPath(v);if(u)for(let[t,c]of u)x+=`M${t.x},${t.y}L${c.x},${c.y}`;let w=getRoundedPolygonPoints(t,c,0,2*g,1),_=getRoundedInkyPolygonPath(w);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{d:_,fill:h,color:f,theme:b}),(0,G.jsx)("path",{d:x,stroke:b[f].solid,strokeWidth:g,fill:"none"})]})});function DrawStylePolygonSvg({id:t,outline:c,lines:u,fill:h,color:f,theme:g,strokeWidth:b}){let v=getRoundedPolygonPoints(t,c,b/3,2*b,2),x=getRoundedInkyPolygonPath(v);if(u)for(let[t,c]of u)x+=`M${t.x},${t.y}L${c.x},${c.y}`;let w=getRoundedPolygonPoints(t,c,0,2*b,1),_=getRoundedInkyPolygonPath(w),k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",x),k.setAttribute("fill","none"),k.setAttribute("stroke",g[f].solid),k.setAttribute("stroke-width",b.toString());let E=getShapeFillSvg({d:_,fill:h,color:f,theme:g});return getSvgWithShapeFill(k,E)}let iq=U.memo(function({fill:t,color:c,strokeWidth:u,w:h,h:f,id:g,size:b}){let v=useDefaultColorTheme(),x=cloudSvgPath(h,f,g,b);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{theme:v,d:x,fill:t,color:c}),(0,G.jsx)("path",{d:x,stroke:v[c].solid,strokeWidth:u,fill:"none"})]})});function SolidStyleCloudSvg({fill:t,color:c,strokeWidth:u,theme:h,w:f,h:g,id:b,size:v}){let x=cloudSvgPath(f,g,b,v),w=document.createElementNS("http://www.w3.org/2000/svg","path");w.setAttribute("d",x),w.setAttribute("stroke-width",u.toString()),w.setAttribute("stroke",h[c].solid),w.setAttribute("fill","none");let _=getShapeFillSvg({d:x,fill:t,color:c,theme:h});return getSvgWithShapeFill(w,_)}let iX=U.memo(function({w:t,h:c,strokeWidth:u,fill:h,color:f}){let g=useDefaultColorTheme(),b=t/2,v=c/2,x=Math.max(0,b),w=Math.max(0,v),_=`M${b-x},${v}a${x},${w},0,1,1,${2*x},0a${x},${w},0,1,1,-${2*x},0`;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{d:_,color:f,fill:h,theme:g}),(0,G.jsx)("path",{d:_,stroke:g[f].solid,strokeWidth:u,fill:"none"})]})});function SolidStyleEllipseSvg({w:t,h:c,strokeWidth:u,fill:h,color:f,theme:g}){let b=t/2,v=c/2,x=Math.max(0,b),w=Math.max(0,v),_=`M${b-x},${v}a${x},${w},0,1,1,${2*x},0a${x},${w},0,1,1,-${2*x},0`,k=document.createElementNS("http://www.w3.org/2000/svg","path");k.setAttribute("d",_),k.setAttribute("stroke-width",u.toString()),k.setAttribute("width",t.toString()),k.setAttribute("height",c.toString()),k.setAttribute("fill","none"),k.setAttribute("stroke",g[f].solid);let E=getShapeFillSvg({d:_,fill:h,color:f,theme:g});return getSvgWithShapeFill(k,E)}let iJ=U.memo(function({w:t,h:c,strokeWidth:u,fill:h,color:f}){let g=useDefaultColorTheme(),b=getOvalIndicatorPath(t,c);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{d:b,color:f,fill:h,theme:g}),(0,G.jsx)("path",{d:b,stroke:g[f].solid,strokeWidth:u,fill:"none"})]})});function SolidStyleOvalSvg({w:t,h:c,strokeWidth:u,fill:h,color:f,theme:g}){let b=getOvalIndicatorPath(t,c),v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("d",b),v.setAttribute("stroke-width",u.toString()),v.setAttribute("width",t.toString()),v.setAttribute("height",c.toString()),v.setAttribute("fill","none"),v.setAttribute("stroke",g[f].solid);let x=getShapeFillSvg({d:b,fill:h,color:f,theme:g});return getSvgWithShapeFill(v,x)}function getOvalIndicatorPath(t,c){let u;if(c>t){let h=t/2;u=`
    M0,${h}
    a${h},${h},0,1,1,${2*h},0
    L${t},${c-h}
    a${h},${h},0,1,1,-${2*h},0
    Z`}else{let h=c/2;u=`
    M${h},0
    L${t-h},0
    a${h},${h},0,1,1,0,${2*h}
    L${h},${c}
    a${h},${h},0,1,1,0,${-(2*h)}
    Z`}return u}let iQ=U.memo(function({outline:t,lines:c,fill:u,color:h,strokeWidth:f}){let g=useDefaultColorTheme(),b="M"+t[0]+"L"+t.slice(1)+"Z";if(c)for(let[t,u]of c)b+=`M${t.x},${t.y}L${u.x},${u.y}`;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(iF,{d:b,fill:u,color:h,theme:g}),(0,G.jsx)("path",{d:b,stroke:g[h].solid,strokeWidth:f,fill:"none"})]})});function SolidStylePolygonSvg({outline:t,lines:c,fill:u,color:h,strokeWidth:f,theme:g}){let b="M"+t[0]+"L"+t.slice(1)+"Z",v=b;if(c)for(let[t,u]of c)v+=`M${t.x},${t.y}L${u.x},${u.y}`;let x=document.createElementNS("http://www.w3.org/2000/svg","path");x.setAttribute("d",v),x.setAttribute("stroke-width",f.toString()),x.setAttribute("stroke",g[h].solid),x.setAttribute("fill","none");let w=getShapeFillSvg({d:b,fill:u,color:h,theme:g});return getSvgWithShapeFill(x,w)}let GeoShapeUtil=class GeoShapeUtil extends BaseBoxShapeUtil{static type="geo";static props=e0.eG;static migrations=e0.P3;canEdit=()=>!0;getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:""}}getGeometry(t){let c;let u=Math.max(1,t.props.w),h=Math.max(1,t.props.h+t.props.growY),f=u/2,g=h/2,b=iC[t.props.size],v="none"!==t.props.fill;switch(t.props.geo){case"cloud":c=new n$.w({points:cloudOutline(u,h,t.id,t.props.size),isFilled:v});break;case"triangle":c=new n$.w({points:[new tn.G(f,0),new tn.G(u,h),new tn.G(0,h)],isFilled:v});break;case"diamond":c=new n$.w({points:[new tn.G(f,0),new tn.G(u,g),new tn.G(f,h),new tn.G(0,g)],isFilled:v});break;case"pentagon":c=new n$.w({points:(0,tt.Oe)(u,h,5),isFilled:v});break;case"hexagon":c=new n$.w({points:(0,tt.Oe)(u,h,6),isFilled:v});break;case"octagon":c=new n$.w({points:(0,tt.Oe)(u,h,8),isFilled:v});break;case"ellipse":c=new Ellipse2d({width:u,height:h,isFilled:v});break;case"oval":c=new Stadium2d({width:u,height:h,isFilled:v});break;case"star":{let t=tt.yo/5/2,f=2*Math.floor(5/4),g=Math.cos(-tt.gc+f*t)*u/2,b=Math.cos(-tt.gc+(10-f)*t)*u/2,x=Math.sin(-tt.gc+0*t)*h/2,w=Math.sin(-tt.gc+2*Math.floor(2.5)*t)*h/2,_=u-Math.abs(g-b),k=h-Math.abs(w-x),E=u/2+b-(u/2-g),$=h/2+x-(h/2-w),T=(u-E)/2,I=(h-$)/2,M=(u+_)/2,j=(h+k)/2,D=1*M/2,F=1*j/2;c=new n$.w({points:Array.from(Array(10)).map((c,u)=>{let h=-tt.gc+u*t;return new tn.G(T+(u%2?D:M)*Math.cos(h),I+(u%2?F:j)*Math.sin(h))}),isFilled:v});break}case"rhombus":{let t=Math.min(.38*u,.38*h);c=new n$.w({points:[new tn.G(t,0),new tn.G(u,0),new tn.G(u-t,h),new tn.G(0,h)],isFilled:v});break}case"rhombus-2":{let t=Math.min(.38*u,.38*h);c=new n$.w({points:[new tn.G(0,0),new tn.G(u-t,0),new tn.G(u,h),new tn.G(t,h)],isFilled:v});break}case"trapezoid":{let t=Math.min(.38*u,.38*h);c=new n$.w({points:[new tn.G(t,0),new tn.G(u-t,0),new tn.G(u,h),new tn.G(0,h)],isFilled:v});break}case"arrow-right":{let t=.38*Math.min(u,h),f=.16*h;c=new n$.w({points:[new tn.G(0,f),new tn.G(u-t,f),new tn.G(u-t,0),new tn.G(u,h/2),new tn.G(u-t,h),new tn.G(u-t,h-f),new tn.G(0,h-f)],isFilled:v});break}case"arrow-left":{let t=.38*Math.min(u,h),f=.16*h;c=new n$.w({points:[new tn.G(t,0),new tn.G(t,f),new tn.G(u,f),new tn.G(u,h-f),new tn.G(t,h-f),new tn.G(t,h),new tn.G(0,h/2)],isFilled:v});break}case"arrow-up":{let t=.16*u,f=.38*Math.min(u,h);c=new n$.w({points:[new tn.G(u/2,0),new tn.G(u,f),new tn.G(u-t,f),new tn.G(u-t,h),new tn.G(t,h),new tn.G(t,f),new tn.G(0,f)],isFilled:v});break}case"arrow-down":{let t=.16*u,f=.38*Math.min(u,h);c=new n$.w({points:[new tn.G(t,0),new tn.G(u-t,0),new tn.G(u-t,h-f),new tn.G(u,h-f),new tn.G(u/2,h),new tn.G(0,h-f),new tn.G(t,h-f)],isFilled:v});break}case"check-box":case"x-box":case"rectangle":c=new nh.z({width:u,height:h,isFilled:v,isSnappable:!0})}let x=getLabelSize(this.editor,t),w=Math.min(u,Math.max(x.w,Math.min(32,Math.max(1,u-8)))),_=Math.min(h,Math.max(x.h,Math.min(32,Math.max(1,u-8)))),k=getLines(t.props,b),E=k?k.map(t=>new nC.q({points:t})):[];return new nE.m({children:[c,new nh.z({x:"start"===t.props.align?0:"end"===t.props.align?u-w:(u-w)/2,y:"start"===t.props.verticalAlign?0:"end"===t.props.verticalAlign?h-_:(h-_)/2,width:w,height:_,isFilled:!0,isSnappable:!1,isLabel:!0}),...E],isSnappable:!1})}onEditEnd=t=>{let{id:c,type:u,props:{text:h}}=t;h.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:c,type:u,props:{text:h.trimEnd()}}])};component(t){let{id:c,type:u,props:h}=t,f=iC[h.size],{w:g,color:b,labelColor:v,fill:x,dash:w,growY:_,font:k,align:E,verticalAlign:$,size:T,text:I}=h;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(nu.g,{id:c,children:(()=>{let u=h.h+_;switch(h.geo){case"cloud":if("solid"===w)return(0,G.jsx)(iq,{color:b,fill:x,strokeWidth:f,w:g,h:u,id:c,size:T});if("dashed"===w||"dotted"===w)return(0,G.jsx)(iU,{color:b,fill:x,strokeWidth:f,w:g,h:u,id:c,size:T,dash:w});if("draw"===w)return(0,G.jsx)(iZ,{color:b,fill:x,strokeWidth:f,w:g,h:u,id:c,size:T});break;case"ellipse":if("solid"===w)return(0,G.jsx)(iX,{strokeWidth:f,w:g,h:u,color:b,fill:x});if("dashed"===w||"dotted"===w)return(0,G.jsx)(iV,{id:c,strokeWidth:f,w:g,h:u,dash:w,color:b,fill:x});if("draw"===w)return(0,G.jsx)(iX,{strokeWidth:f,w:g,h:u,color:b,fill:x});break;case"oval":if("solid"===w)return(0,G.jsx)(iJ,{strokeWidth:f,w:g,h:u,color:b,fill:x});if("dashed"===w||"dotted"===w)return(0,G.jsx)(iW,{id:c,strokeWidth:f,w:g,h:u,dash:w,color:b,fill:x});if("draw"===w)return(0,G.jsx)(iJ,{strokeWidth:f,w:g,h:u,color:b,fill:x});break;default:{let u=this.editor.getShapeGeometry(t),h=u instanceof nE.m?u.children[0].vertices:u.vertices,g=getLines(t.props,f);if("solid"===w)return(0,G.jsx)(iQ,{fill:x,color:b,strokeWidth:f,outline:h,lines:g});if("dashed"===w||"dotted"===w)return(0,G.jsx)(iK,{dash:w,fill:x,color:b,strokeWidth:f,outline:h,lines:g});if("draw"===w)return(0,G.jsx)(iY,{id:c,fill:x,color:b,strokeWidth:f,outline:h,lines:g})}}})()}),(0,G.jsx)(iH,{id:c,type:u,font:k,fill:x,size:T,align:E,verticalAlign:$,text:I,labelColor:v,wrap:!0,bounds:"cloud"===h.geo?this.getGeometry(t).bounds:void 0}),t.props.url&&(0,G.jsx)(HyperlinkButton,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(t){let{id:c,props:u}=t,{w:h,size:f}=u,g=u.h+u.growY,b=iC[f];switch(u.geo){case"ellipse":if("draw"===u.dash)return(0,G.jsx)("path",{d:getSvgPathFromStrokePoints(getEllipseStrokePoints(c,h,g,b))});return(0,G.jsx)("ellipse",{cx:h/2,cy:g/2,rx:h/2,ry:g/2});case"oval":return(0,G.jsx)("path",{d:getOvalIndicatorPath(h,g)});case"cloud":return(0,G.jsx)("path",{d:cloudSvgPath(h,g,c,f)});default:{let h;let f=this.editor.getShapeGeometry(t),g=f instanceof nE.m?f.children[0].vertices:f.vertices;if("draw"===u.dash){let t=getRoundedPolygonPoints(c,g,0,2*b,1);h=getRoundedInkyPolygonPath(t)}else h="M"+g[0]+"L"+g.slice(1)+"Z";let v=getLines(t.props,b);if(v)for(let[t,c]of v)h+=`M${t.x},${t.y}L${c.x},${c.y}`;return(0,G.jsx)("path",{d:h})}}}toSvg(t,c){let u;let{id:h,props:f}=t,g=iC[f.size],b=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode});switch(c.addExportDef(getFillDefForExport(t.props.fill,b)),f.geo){case"ellipse":switch(f.dash){case"draw":u=DrawStyleEllipseSvg({id:h,w:f.w,h:f.h,color:f.color,fill:f.fill,strokeWidth:g,theme:b});break;case"solid":u=SolidStyleEllipseSvg({strokeWidth:g,w:f.w,h:f.h,color:f.color,fill:f.fill,theme:b});break;default:u=DashStyleEllipseSvg({id:h,strokeWidth:g,w:f.w,h:f.h,dash:f.dash,color:f.color,fill:f.fill,theme:b})}break;case"oval":switch(f.dash){case"draw":default:u=DashStyleOvalSvg({id:h,strokeWidth:g,w:f.w,h:f.h,dash:f.dash,color:f.color,fill:f.fill,theme:b});break;case"solid":u=SolidStyleOvalSvg({strokeWidth:g,w:f.w,h:f.h,color:f.color,fill:f.fill,theme:b})}break;case"cloud":switch(f.dash){case"draw":u=DrawStyleCloudSvg({id:h,strokeWidth:g,w:f.w,h:f.h,color:f.color,fill:f.fill,size:f.size,theme:b});break;case"solid":u=SolidStyleCloudSvg({strokeWidth:g,w:f.w,h:f.h,color:f.color,fill:f.fill,size:f.size,id:h,theme:b});break;default:u=DashStyleCloudSvg({id:h,strokeWidth:g,w:f.w,h:f.h,dash:f.dash,color:f.color,fill:f.fill,theme:b,size:f.size})}break;default:{let c=this.editor.getShapeGeometry(t),v=c instanceof nE.m?c.children[0].vertices:c.vertices,x=getLines(t.props,g);switch(f.dash){case"draw":u=DrawStylePolygonSvg({id:h,fill:f.fill,color:f.color,strokeWidth:g,outline:v,lines:x,theme:b});break;case"solid":u=SolidStylePolygonSvg({fill:f.fill,color:f.color,strokeWidth:g,outline:v,lines:x,theme:b});break;default:u=DashStylePolygonSvg({dash:f.dash,fill:f.fill,color:f.color,strokeWidth:g,outline:v,lines:x,theme:b})}}}if(f.text){let h=this.editor.getShapeGeometry(t).bounds;c.addExportDef(getFontDefForExport(t.props.font));let f=getTextLabelSvgElement({editor:this.editor,shape:t,font:e0.p6[t.props.font],bounds:h}),g=f.cloneNode(!0);g.setAttribute("fill",b[t.props.labelColor].solid),g.setAttribute("stroke","none");let v=f.cloneNode(!0);v.setAttribute("stroke-width","2"),v.setAttribute("fill",b.background),v.setAttribute("stroke",b.background);let x=document.createElementNS("http://www.w3.org/2000/svg","g");if(x.append(v),x.append(g),"g"===u.nodeName)u.appendChild(x);else{let t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.appendChild(u),t.appendChild(x),t}}return u}getCanvasSvgDefs(){return[getFillDefForCanvas()]}onResize=(t,{handle:c,newPoint:u,scaleX:h,scaleY:f,initialShape:g})=>{let b=g.props.w*h,v=(g.props.h+g.props.growY)*f,x=0,w=0;if(t.props.text.trim()){let c=Math.max(Math.abs(b),51),u=Math.max(Math.abs(v),51);c<51&&51===u&&(c=51),51===c&&u<51&&(u=51);let h=getLabelSize(this.editor,{...t,props:{...t.props,w:c,h:u}}),f=Math.max(Math.abs(b),h.w)*Math.sign(b),g=Math.max(Math.abs(v),h.h)*Math.sign(v);x=Math.abs(f)-Math.abs(b),w=Math.abs(g)-Math.abs(v),b=f,v=g}let _=new tn.G(0,0);h<0&&(_.x+=b),("left"===c||"top_left"===c||"bottom_left"===c)&&(_.x+=h<0?x:-x),f<0&&(_.y+=v),("top"===c||"top_left"===c||"top_right"===c)&&(_.y+=f<0?w:-w);let{x:k,y:E}=_.rot(t.rotation).add(u);return{x:k,y:E,props:{w:Math.max(Math.abs(b),1),h:Math.max(Math.abs(v),1),growY:0}}};onBeforeCreate=t=>{if(!t.props.text)return t.props.growY?{...t,props:{...t.props,growY:0}}:void 0;let c=t.props.h,u=getLabelSize(this.editor,t).h,h=null;if(u>c?h=u-c:t.props.growY&&(h=0),null!==h)return{...t,props:{...t.props,growY:h}}};onBeforeUpdate=(t,c)=>{let u=t.props.text,h=c.props.text;if(u===h&&t.props.font===c.props.font&&t.props.size===c.props.size)return;if(u&&!h)return{...c,props:{...c.props,growY:0}};let f=t.props.w,g=t.props.h,b=getLabelSize(this.editor,c),v=b.w,x=b.h;if(!u&&h&&1===h.length){let u=Math.max(f,v),h=Math.max(g,x);return t.props.w<51&&t.props.h<51&&(h=Math.max(u=Math.max(u=Math.max(u,51),h=Math.max(h,51)),h)),{...c,props:{...c.props,w:u,h,growY:0}}}let w=null;return(x>g?w=x-g:t.props.growY&&(w=0),null!==w)?{...c,props:{...c.props,growY:w,w:Math.max(c.props.w,v)}}:v>t.props.w?{...c,props:{...c.props,w:v}}:void 0};onDoubleClick=t=>{if(this.editor.inputs.altKey)switch(t.props.geo){case"rectangle":return{...t,props:{geo:"check-box"}};case"check-box":return{...t,props:{geo:"rectangle"}}}}};function getLabelSize(t,c){let u=c.props.text;if(!u)return{w:0,h:0};let h=t.textMeasure.measureText("w",{...ik,fontFamily:iT[c.props.font],fontSize:iE[c.props.size],maxWidth:100}),f=t.textMeasure.measureText(u,{...ik,fontFamily:iT[c.props.font],fontSize:iE[c.props.size],minWidth:h.w+"px",maxWidth:Math.max(0,Math.ceil(h.w+({s:2,m:3.5,l:5,xl:10})[c.props.size]),Math.ceil(c.props.w-32))});return{w:f.w+32,h:f.h+32}}function getLines(t,c){switch(t.geo){case"x-box":return getXBoxLines(t.w,t.h,c,t.dash);case"check-box":return getCheckBoxLines(t.w,t.h);default:return}}function getXBoxLines(t,c,u,h){let f="draw"===h?.62:0;if("dashed"===h)return[[new tn.G(0,0),new tn.G(t/2,c/2)],[new tn.G(t,c),new tn.G(t/2,c/2)],[new tn.G(0,c),new tn.G(t/2,c/2)],[new tn.G(t,0),new tn.G(t/2,c/2)]];let clampX=c=>Math.max(0,Math.min(t,c)),clampY=t=>Math.max(0,Math.min(c,t));return[[new tn.G(clampX(u*f),clampY(u*f)),new tn.G(clampX(t-u*f),clampY(c-u*f))],[new tn.G(clampX(u*f),clampY(c-u*f)),new tn.G(clampX(t-u*f),clampY(u*f))]]}function getCheckBoxLines(t,c){let u=.82*Math.min(t,c),h=(t-u)/2,f=(c-u)/2,clampX=c=>Math.max(0,Math.min(t,c)),clampY=t=>Math.max(0,Math.min(c,t));return[[new tn.G(clampX(h+.25*u),clampY(f+.52*u)),new tn.G(clampX(h+.45*u),clampY(f+.82*u))],[new tn.G(clampX(h+.45*u),clampY(f+.82*u)),new tn.G(clampX(h+.82*u),clampY(f+.22*u))]]}function useColorSpace(){let[t,c]=(0,U.useState)(!1);(0,U.useEffect)(()=>{let t=CSS.supports("color","color(display-p3 1 1 1)"),u=matchMedia("(color-gamut: p3)");c(t&&u.matches);let onChange=()=>c(t&&u.matches);return u.addEventListener("change",onChange),()=>u.removeEventListener("change",onChange)},[]);let u=(0,eJ.Hg)(e4.forceSrgb);return u||!t?"srgb":"p3"}let HighlightShapeUtil=class HighlightShapeUtil extends nf.E{static type="highlight";static props=e0.VW;static migrations=e0.J1;hideResizeHandles=t=>HighlightShapeUtil_getIsDot(t);hideRotateHandle=t=>HighlightShapeUtil_getIsDot(t);hideSelectionBoundsFg=t=>HighlightShapeUtil_getIsDot(t);getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1}}getGeometry(t){let c=getStrokeWidth(t);if(HighlightShapeUtil_getIsDot(t))return new Circle2d({x:-c/2,y:-c/2,radius:c/2,isFilled:!0});let{strokePoints:u,sw:h}=getHighlightStrokePoints(t,c,!0),f=getHighlightFreehandSettings({strokeWidth:h,showAsComplete:!0});return setStrokePointRadii(u,f),new n$.w({points:getStrokeOutlinePoints_getStrokeOutlinePoints(u,f),isFilled:!0})}component(t){return(0,G.jsx)(HighlightRenderer,{strokeWidth:getStrokeWidth(t),shape:t,opacity:.35})}backgroundComponent(t){return(0,G.jsx)(HighlightRenderer,{strokeWidth:getStrokeWidth(t),shape:t,opacity:.82})}indicator(t){let c;let u=useForceSolid(),h=getStrokeWidth(t),f=getPointsFromSegments(t.props.segments),g=h;u||t.props.isPen||1!==f.length||(g+=(0,e1.Vk)(t.id)()*(h/6));let b=t.props.isComplete||e1.Z$(t.props.segments)?.type==="straight",v=getHighlightFreehandSettings({strokeWidth:h,showAsComplete:b}),x=getStrokePoints(f,v);return c=x.length<2?getIndicatorDot(f[0],g):getSvgPathFromStrokePoints(x,!1),(0,G.jsx)("path",{d:c})}toSvg(t){let c=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode});return highlighterToSvg(getStrokeWidth(t),t,.35,c)}toBackgroundSvg(t){let c=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode});return highlighterToSvg(getStrokeWidth(t),t,.82,c)}onResize=(t,c)=>{let{scaleX:u,scaleY:h}=c,f=[];for(let c of t.props.segments)f.push({...c,points:c.points.map(({x:t,y:c,z:f})=>({x:u*t,y:h*c,z:f}))});return{props:{segments:f}}}};function getShapeDot(t){return`M ${t.x} ${t.y} m -0.1, 0 a 0.1,0.1 0 1,0 0.2,0 a 0.1,0.1 0 1,0 -0.2,0`}function getIndicatorDot(t,c){let u=c/2;return`M ${t.x} ${t.y} m -${u}, 0 a ${u},${u} 0 1,0 ${2*u},0 a ${u},${u} 0 1,0 -${2*u},0`}function getHighlightStrokePoints(t,c,u){let h=getPointsFromSegments(t.props.segments),f=t.props.isComplete||e1.Z$(t.props.segments)?.type==="straight",g=c;u||t.props.isPen||1!==h.length||(g+=(0,e1.Vk)(t.id)()*(c/6));let b=getHighlightFreehandSettings({strokeWidth:g,showAsComplete:f}),v=getStrokePoints(h,b);return{strokePoints:v,sw:g}}function getHighlightSvgPath(t,c,u){let{strokePoints:h,sw:f}=getHighlightStrokePoints(t,c,u),g=h.length>1?getSvgPathFromStrokePoints(h,!1):getShapeDot(t.props.segments[0].points[0]);return{solidStrokePath:g,sw:f}}function HighlightRenderer({strokeWidth:t,shape:c,opacity:u}){let h=useDefaultColorTheme(),f=useForceSolid(),{solidStrokePath:g,sw:b}=getHighlightSvgPath(c,t,f),v=useColorSpace(),x=h[c.props.color].highlight[v];return(0,G.jsx)(nu.g,{id:c.id,style:{opacity:u},children:(0,G.jsx)("path",{d:g,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:x,strokeWidth:b})})}function highlighterToSvg(t,c,u,h){let{solidStrokePath:f,sw:g}=getHighlightSvgPath(c,t,!1),b=document.createElementNS("http://www.w3.org/2000/svg","path");return b.setAttribute("d",f),b.setAttribute("fill","none"),b.setAttribute("stroke",h[c.props.color].highlight.srgb),b.setAttribute("stroke-width",`${g}`),b.setAttribute("opacity",`${u}`),b}function getStrokeWidth(t){return 1.12*iP[t.props.size]}function HighlightShapeUtil_getIsDot(t){return 1===t.props.segments.length&&t.props.segments[0].points.length<2}function usePrefersReducedMotion(){let[t,c]=(0,U.useState)(!1);return(0,U.useEffect)(()=>{let t=window.matchMedia("(prefers-reduced-motion: reduce)"),handler=()=>{c(t.matches)};return handler(),t.addEventListener("change",handler),()=>t.removeEventListener("change",handler)},[]),t}let loadImage=async t=>new Promise((c,u)=>{let h=new Image;h.onload=()=>c(h),h.onerror=()=>u(Error("Failed to load image")),h.crossOrigin="anonymous",h.src=t}),getStateFrame=async t=>{let c=await loadImage(t),u=document.createElement("canvas");u.width=c.width,u.height=c.height;let h=u.getContext("2d");if(h)return h.drawImage(c,0,0),u.toDataURL()};async function getDataURIFromURL(t){let c=await fetch(t),u=await c.blob();return new Promise((t,c)=>{let h=new FileReader;h.onloadend=()=>t(h.result),h.onerror=c,h.readAsDataURL(u)})}let ImageShapeUtil=class ImageShapeUtil extends BaseBoxShapeUtil{static type="image";static props=e0.Fc;static migrations=e0.y5;isAspectRatioLocked=()=>!0;canCrop=()=>!0;getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null}}component(t){let c=getContainerStyle(t),u=useIsCropping(t.id),h=usePrefersReducedMotion(),[f,g]=(0,U.useState)(""),b=t.props.assetId?this.editor.getAsset(t.props.assetId):void 0;if(b?.type==="bookmark")throw Error("Bookmark assets can't be rendered as images");let v=(0,eJ.Hg)("onlySelectedShape",()=>t.id===this.editor.onlySelectedShape?.id,[this.editor]),x=v&&u&&this.editor.isInAny("select.crop","select.cropping","select.pointing_crop_handle"),w=h&&(b?.props.mimeType?.includes("video")||b?.props.mimeType?.includes("gif"));return(0,U.useEffect)(()=>{if(b?.props.src&&"mimeType"in b.props&&b?.props.mimeType==="image/gif"){let t=!1,run=async()=>{let c=await getStateFrame(b.props.src);!t&&c&&g(c)};return run(),()=>{t=!0}}},[h,b?.props]),(0,G.jsxs)(G.Fragment,{children:[b?.props.src&&x&&(0,G.jsx)("div",{style:c,children:(0,G.jsx)("div",{className:"tl-image",style:{opacity:.1,backgroundImage:`url(${!t.props.playing||w?f:b.props.src})`},draggable:!1})}),(0,G.jsx)(HTMLContainer,{id:t.id,style:{overflow:"hidden",width:t.props.w,height:t.props.h},children:(0,G.jsxs)("div",{className:"tl-image-container",style:c,children:[b?.props.src?(0,G.jsx)("div",{className:"tl-image",style:{backgroundImage:`url(${!t.props.playing||w?f:b.props.src})`},draggable:!1}):null,b?.props.isAnimated&&!t.props.playing&&(0,G.jsx)("div",{className:"tl-image__tg",children:"GIF"})]})}),"url"in t.props&&t.props.url&&(0,G.jsx)(HyperlinkButton,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(t){let c=useIsCropping(t.id);return c?null:(0,G.jsx)("rect",{width:(0,tt.$Z)(t.props.w),height:(0,tt.$Z)(t.props.h)})}async toSvg(t){let c=document.createElementNS("http://www.w3.org/2000/svg","g"),u=t.props.assetId?this.editor.getAsset(t.props.assetId):null,h=u?.props.src||"";h&&h.startsWith("http")&&(h=await getDataURIFromURL(h)||"");let f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttributeNS("http://www.w3.org/1999/xlink","href",h);let g=getContainerStyle(t),b=t.props.crop;if(g.transform&&b){let{transform:t,width:u,height:h}=g,v=[new tn.G(b.topLeft.x*u,b.topLeft.y*h),new tn.G(b.bottomRight.x*u,b.topLeft.y*h),new tn.G(b.bottomRight.x*u,b.bottomRight.y*h),new tn.G(b.topLeft.x*u,b.bottomRight.y*h)],x=document.createElementNS("http://www.w3.org/2000/svg","g");x.style.clipPath=`polygon(${v.map(t=>`${t.x}px ${t.y}px`).join(",")})`,f.setAttribute("width",u.toString()),f.setAttribute("height",h.toString()),f.style.transform=t,x.appendChild(f),c.appendChild(x)}else f.setAttribute("width",t.props.w.toString()),f.setAttribute("height",t.props.h.toString()),c.appendChild(f);return c}onDoubleClick=t=>{let c=t.props.assetId?this.editor.getAsset(t.props.assetId):void 0;if(!c)return;let u=c.props.src&&"mimeType"in c.props&&"image/gif"===c.props.mimeType;u&&this.editor.updateShapes([{type:"image",id:t.id,props:{playing:!t.props.playing}}])};onDoubleClickEdge=t=>{let c=t.props;if(!c||this.editor.croppingShapeId!==t.id)return;let u=(0,e1.p$)(c.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},h=1/(u.bottomRight.x-u.topLeft.x)*t.props.w,f=1/(u.bottomRight.y-u.topLeft.y)*t.props.h,g=new tn.G(u.topLeft.x*h,u.topLeft.y*f).rot(t.rotation),b={id:t.id,type:t.type,x:t.x-g.x,y:t.y-g.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:h,h:f}};this.editor.updateShapes([b])}};function getContainerStyle(t){let c=t.props.crop,u=c?.topLeft;if(!u)return{width:t.props.w,height:t.props.h};let h=1/(c.bottomRight.x-c.topLeft.x)*t.props.w,f=1/(c.bottomRight.y-c.topLeft.y)*t.props.h,g=-u.x*h,b=-u.y*f;return{transform:`translate(${g}px, ${b}px)`,width:h,height:f}}function getSvgPathForEdge(t,c){let{start:u,end:h}=t;return c?`M${(0,tt.$Z)(u.x)},${(0,tt.$Z)(u.y)} L${(0,tt.$Z)(h.x)},${(0,tt.$Z)(h.y)} `:`${(0,tt.$Z)(h.x)},${(0,tt.$Z)(h.y)} `}function getSvgPathForBezierCurve(t,c){let{a:u,b:h,c:f,d:g}=t;return tn.G.Equals(u,g)?"":`${c?`M${(0,tt.$Z)(u.x)},${(0,tt.$Z)(u.y)}`:""}C${(0,tt.$Z)(h.x)},${(0,tt.$Z)(h.y)} ${(0,tt.$Z)(f.x)},${(0,tt.$Z)(f.y)} ${(0,tt.$Z)(g.x)},${(0,tt.$Z)(g.y)}`}function getSvgPathForCubicSpline(t,c){let u=t.segments.reduce((t,c,u)=>t+getSvgPathForBezierCurve(c,0===u),"");return c&&(u+="Z"),u}function getSvgPathForPolylineSpline(t,c){let u=t.segments.reduce((t,c,u)=>t+getSvgPathForEdge(c,0===u),"");return c&&(u+="Z"),u}function getSvgPathForLineGeometry(t,c=!1){return t instanceof nC.q?getSvgPathForPolylineSpline(t,c):getSvgPathForCubicSpline(t,c)}function getLineDrawFreehandOptions(t){return{size:t,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function getLineStrokePoints(t,c,u){let h=c.vertices,f=getLineDrawFreehandOptions(u);return getStrokePoints(h,f)}function getLineDrawStrokeOutlinePoints(t,c,u){let h=getLineDrawFreehandOptions(u);return getStrokeOutlinePoints_getStrokeOutlinePoints(setStrokePointRadii(getLineStrokePoints(t,c,u),h),h)}function getLineDrawPath(t,c,u){let h=getLineDrawStrokeOutlinePoints(t,c,u);return getSvgPathFromPoints_getSvgPathFromPoints(h)}function getLineIndicatorPath(t,c,u){if("draw"===t.props.dash){let h=getLineStrokePoints(t,c,u);return getSvgPathFromStrokePoints(h)}return getSvgPathForLineGeometry(c)}let i0=new nI._;let LineShapeUtil=class LineShapeUtil extends nf.E{static type="line";static props=e0.BG;static migrations=e0.FH;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;hideSelectionBoundsFg=()=>!0;hideSelectionBoundsBg=()=>!0;getDefaultProps(){return{dash:"draw",size:"m",color:"black",spline:"line",handles:{start:{id:"start",type:"vertex",canBind:!1,canSnap:!0,index:"a1",x:0,y:0},end:{id:"end",type:"vertex",canBind:!1,canSnap:!0,index:"a2",x:.1,y:.1}}}}getGeometry(t){return getGeometryForLineShape(t)}getHandles(t){return i0.get(t.props,()=>{let c=t.props.handles,u=getGeometryForLineShape(t),h=Object.values(c).sort(nj.hl),f=h.slice();for(let t=0;t<u.segments.length;t++){let c=u.segments[t],g=c.midPoint(),b=(0,nj.eI)(h[t].index,h[t+1].index);f.push({id:`mid-${t}`,type:"create",index:b,x:g.x,y:g.y})}return f.sort(nj.hl)})}getOutlineSegments(t){let c=this.editor.getShapeGeometry(t);return c.segments.map(t=>t.vertices)}onResize=(t,c)=>{let{scaleX:u,scaleY:h}=c,f=(0,e1.p$)(t.props.handles);return Object.values(t.props.handles).forEach(({id:t,x:c,y:g})=>{f[t].x=c*u,f[t].y=g*h}),{props:{handles:f}}};onHandleChange=(t,{handle:c})=>{let u=(0,e1.p$)(t);switch(c.id){case"start":case"end":u.props.handles[c.id]={...u.props.handles[c.id],x:c.x,y:c.y};break;default:{let h="handle:"+c.index,f=t.props.handles[h];f?u.props.handles[h]={...f,x:c.x,y:c.y}:u.props.handles[h]={id:h,type:"vertex",canBind:!1,index:c.index,x:c.x,y:c.y}}}return u};component(t){let c=useDefaultColorTheme(),u=getGeometryForLineShape(t),h=iC[t.props.size],{dash:f,color:g}=t.props;if("line"===t.props.spline){if("solid"===f){let f=u.points,b="M"+f[0]+"L"+f.slice(1);return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{d:b,fill:"none",color:g,theme:c}),(0,G.jsx)("path",{d:b,stroke:c[g].solid,strokeWidth:h,fill:"none"})]})}if("dashed"===f||"dotted"===f){let b=u.points,v="M"+b[0]+"L"+b.slice(1);return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{d:v,fill:"none",color:g,theme:c}),(0,G.jsx)("g",{stroke:c[g].solid,strokeWidth:h,children:u.segments.map((t,c)=>{let{strokeDasharray:g,strokeDashoffset:b}=getPerfectDashProps(t.length,h,{style:f,start:c>0?"outset":"none",end:c<u.segments.length-1?"outset":"none"});return(0,G.jsx)("path",{strokeDasharray:g,strokeDashoffset:b,d:getSvgPathForEdge(t,!0),fill:"none"},c)})})]})}if("draw"===f){let f=u.points,[b,v]=getDrawLinePathData(t.id,f,h);return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{d:b,fill:"none",color:g,theme:c}),(0,G.jsx)("path",{d:v,stroke:c[g].solid,strokeWidth:h,fill:"none"})]})}}if("cubic"===t.props.spline){let b=getSvgPathForLineGeometry(u);if("solid"===f)return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{d:b,fill:"none",color:g,theme:c}),(0,G.jsx)("path",{strokeWidth:h,stroke:c[g].solid,fill:"none",d:b})]});if("dashed"===f||"dotted"===f)return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{d:b,fill:"none",color:g,theme:c}),(0,G.jsx)("g",{stroke:c[g].solid,strokeWidth:h,children:u.segments.map((t,c)=>{let{strokeDasharray:g,strokeDashoffset:b}=getPerfectDashProps(t.length,h,{style:f,start:c>0?"outset":"none",end:c<u.segments.length-1?"outset":"none"});return(0,G.jsx)("path",{strokeDasharray:g,strokeDashoffset:b,d:getSvgPathForBezierCurve(t,!0),fill:"none"},c)})})]});if("draw"===f)return(0,G.jsxs)(nu.g,{id:t.id,children:[(0,G.jsx)(iF,{d:b,fill:"none",color:g,theme:c}),(0,G.jsx)("path",{d:getLineDrawPath(t,u,h),strokeWidth:1,stroke:c[g].solid,fill:c[g].solid})]})}}indicator(t){let c;let u=iC[t.props.size],h=getGeometryForLineShape(t),{dash:f}=t.props;if("line"===t.props.spline){let g=h.points;if("solid"===f||"dotted"===f||"dashed"===f)c="M"+g[0]+"L"+g.slice(1);else{let[h]=getDrawLinePathData(t.id,g,u);c=h}}else c=getLineIndicatorPath(t,h,u);return(0,G.jsx)("path",{d:c})}toSvg(t){let c=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode}),u=c[t.props.color].solid,h=getGeometryForLineShape(t),f=iC[t.props.size];switch(t.props.dash){case"draw":{let c;if(h instanceof CubicSpline2d)c=getLineDrawPath(t,h,f);else{let[u,g]=getDrawLinePathData(t.id,h.points,f);c=g}let g=document.createElementNS("http://www.w3.org/2000/svg","path");return g.setAttribute("stroke-width",f+"px"),g.setAttribute("stroke",u),g.setAttribute("fill","none"),g.setAttribute("d",c),g}case"solid":{let t;if(h instanceof CubicSpline2d)t=getSvgPathForCubicSpline(h,!1);else{let c=h.points;t="M"+c[0]+"L"+c.slice(1)}let c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("stroke-width",f+"px"),c.setAttribute("stroke",u),c.setAttribute("fill","none"),c.setAttribute("d",t),c}default:{let{segments:c}=h,g=document.createElementNS("http://www.w3.org/2000/svg","g");g.setAttribute("stroke",u),g.setAttribute("stroke-width",f.toString());let b=h instanceof CubicSpline2d?getSvgPathForBezierCurve:getSvgPathForEdge;return c.forEach((u,h)=>{let v=document.createElementNS("http://www.w3.org/2000/svg","path"),{strokeDasharray:x,strokeDashoffset:w}=getPerfectDashProps(u.length,f,{style:t.props.dash,start:h>0?"outset":"none",end:h<c.length-1?"outset":"none"});v.setAttribute("stroke-dasharray",x.toString()),v.setAttribute("stroke-dashoffset",w.toString()),v.setAttribute("d",b(u,!0)),v.setAttribute("fill","none"),g.appendChild(v)}),g}}}};function getGeometryForLineShape(t){let{spline:c,handles:u}=t.props,h=Object.values(u).sort(nj.hl).map(tn.G.From);switch(c){case"cubic":return new CubicSpline2d({points:h});case"line":return new nC.q({points:h})}}let NoteShapeUtil=class NoteShapeUtil extends nf.E{static type="note";static props=e0.m0;static migrations=e0.C_;canEdit=()=>!0;hideResizeHandles=()=>!0;hideSelectionBoundsFg=()=>!0;getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,url:""}}getHeight(t){return 200+t.props.growY}getGeometry(t){let c=this.getHeight(t);return new nh.z({width:200,height:c,isFilled:!0})}component(t){let{id:c,type:u,props:{color:h,font:f,size:g,align:b,text:v,verticalAlign:x}}=t,w=useDefaultColorTheme(),_="black"===h?"yellow":h;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{style:{position:"absolute",width:200,height:this.getHeight(t)},children:(0,G.jsxs)("div",{className:"tl-note__container",style:{color:w[_].solid,backgroundColor:w[_].solid},children:[(0,G.jsx)("div",{className:"tl-note__scrim"}),(0,G.jsx)(iH,{id:c,type:u,font:f,size:g,align:b,verticalAlign:x,text:v,labelColor:"black",wrap:!0})]})}),"url"in t.props&&t.props.url&&(0,G.jsx)(HyperlinkButton,{url:t.props.url,zoomLevel:this.editor.zoomLevel})]})}indicator(t){return(0,G.jsx)("rect",{rx:"7",width:(0,tt.$Z)(200),height:(0,tt.$Z)(this.getHeight(t))})}toSvg(t,c){c.addExportDef(getFontDefForExport(t.props.font));let u=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode}),h=this.editor.getShapeGeometry(t).bounds,f=document.createElementNS("http://www.w3.org/2000/svg","g"),g="black"===t.props.color?"yellow":t.props.color,b=document.createElementNS("http://www.w3.org/2000/svg","rect");b.setAttribute("rx","10"),b.setAttribute("width","200"),b.setAttribute("height",h.height.toString()),b.setAttribute("fill",u[g].solid),b.setAttribute("stroke",u[g].solid),b.setAttribute("stroke-width","1"),f.appendChild(b);let v=document.createElementNS("http://www.w3.org/2000/svg","rect");v.setAttribute("rx","10"),v.setAttribute("width","200"),v.setAttribute("height",h.height.toString()),v.setAttribute("fill",u.background),v.setAttribute("opacity",".28"),f.appendChild(v);let x=getTextLabelSvgElement({editor:this.editor,shape:t,font:e0.p6[t.props.font],bounds:h});return x.setAttribute("fill",u.text),x.setAttribute("stroke","none"),f.appendChild(x),f}onBeforeCreate=t=>getGrowY(this.editor,t,t.props.growY);onBeforeUpdate=(t,c)=>{if(t.props.text!==c.props.text||t.props.font!==c.props.font||t.props.size!==c.props.size)return getGrowY(this.editor,c,t.props.growY)};onEditEnd=t=>{let{id:c,type:u,props:{text:h}}=t;h.trimEnd()!==t.props.text&&this.editor.updateShapes([{id:c,type:u,props:{text:h.trimEnd()}}])}};function getGrowY(t,c,u=0){let h=t.textMeasure.measureText(c.props.text,{...ik,fontFamily:iT[c.props.font],fontSize:iE[c.props.size],maxWidth:166}),f=h.h+34,g=null;if(f>200?g=f-200:u&&(g=0),null!==g)return{...c,props:{...c.props,growY:g}}}function resizeScaled(t,{initialBounds:c,scaleX:u,scaleY:h,newPoint:f}){let g=Math.max(.01,Math.min(Math.abs(u),Math.abs(h))),b=new tn.G(0,0);u<0&&(b.x=-(c.width*g)),h<0&&(b.y=-(c.height*g));let{x:v,y:x}=tn.G.Add(f,b.rot(t.rotation));return{x:v,y:x,props:{scale:g*t.props.scale}}}let i1=new nI._;let TextShapeUtil=class TextShapeUtil extends nf.E{static type="text";static props=e0.XB;static migrations=e0.pL;getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",align:"middle",autoSize:!0,scale:1}}getMinDimensions(t){return i1.get(t.props,t=>getTextSize(this.editor,t))}getGeometry(t){let{scale:c}=t.props,{width:u,height:h}=this.getMinDimensions(t);return new nh.z({width:u*c,height:h*c,isFilled:!0})}canEdit=()=>!0;isAspectRatioLocked=()=>!0;component(t){let{id:c,type:u,props:{text:h,color:f}}=t,g=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode}),{width:b,height:v}=this.getMinDimensions(t),{rInput:x,isEmpty:w,isEditing:_,handleFocus:k,handleChange:E,handleKeyDown:$,handleBlur:T,handleInputPointerDown:I,handleDoubleClick:M}=useEditableText(c,u,h);return(0,G.jsx)(HTMLContainer,{id:t.id,children:(0,G.jsxs)("div",{className:"tl-text-shape__wrapper tl-text-shadow","data-font":t.props.font,"data-align":t.props.align,"data-hastext":!w,"data-isediting":_,"data-textwrap":!0,style:{fontSize:iP[t.props.size],lineHeight:iP[t.props.size]*ik.lineHeight+"px",transform:`scale(${t.props.scale})`,transformOrigin:"top left",width:Math.max(1,b),height:Math.max(iP[t.props.size]*ik.lineHeight,v),color:g[f].solid},children:[(0,G.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:h}),_?(0,G.jsx)("textarea",{ref:x,className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",autoFocus:_,placeholder:"",spellCheck:"true",wrap:"off",dir:"ltr",datatype:"wysiwyg",defaultValue:h,onFocus:k,onChange:E,onKeyDown:$,onBlur:T,onTouchEnd:stopEventPropagation,onContextMenu:stopEventPropagation,onPointerDown:I,onDoubleClick:M}):null]})})}indicator(t){let c=this.editor.getShapeGeometry(t).bounds;return(0,G.jsx)("rect",{width:(0,tt.$Z)(c.width),height:(0,tt.$Z)(c.height)})}toSvg(t,c){c.addExportDef(getFontDefForExport(t.props.font));let u=(0,e0.y6)({isDarkMode:this.editor.user.isDarkMode}),h=this.editor.getShapeGeometry(t).bounds,f=t.props.text,g=h.width/(t.props.scale??1),b=h.height/(t.props.scale??1),v={fontSize:iP[t.props.size],fontFamily:e0.p6[t.props.font],textAlign:t.props.align,verticalTextAlign:"middle",width:g,height:b,padding:0,lineHeight:ik.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap"},x=u[t.props.color].solid,w=document.createElementNS("http://www.w3.org/2000/svg","g"),_=createTextSvgElementFromSpans(this.editor,this.editor.textMeasure.measureTextSpans(f,v),{...v,stroke:u.background,strokeWidth:2,fill:u.background,padding:0}),k=_.cloneNode(!0);return k.setAttribute("fill",x),k.setAttribute("stroke","none"),w.append(_),w.append(k),w}onResize=(t,c)=>{let{initialBounds:u,initialShape:h,scaleX:f,handle:g}=c;if("scale_shape"===c.mode||"right"!==g&&"left"!==g)return{id:t.id,type:t.type,...resizeScaled(t,c)};{let c=u.width,b=c*f,v=new tn.G(0,0);b=Math.max(1,Math.abs(b)),"left"===g?(v.x=c-b,f<0&&(v.x+=b)):f<0&&(v.x-=b);let{x,y:w}=v.rot(t.rotation).add(h);return{id:t.id,type:t.type,x,y:w,props:{w:b/h.props.scale,autoSize:!1}}}};onBeforeCreate=t=>{if(!t.props.autoSize||t.props.text.trim())return;let c=this.getMinDimensions(t);return{...t,x:t.x-c.width/2,y:t.y-c.height/2}};onEditEnd=t=>{let{id:c,type:u,props:{text:h}}=t,f=t.props.text.trimEnd();0===f.length?this.editor.deleteShapes([t.id]):f!==t.props.text&&this.editor.updateShapes([{id:c,type:u,props:{text:h.trimEnd()}}])};onBeforeUpdate=(t,c)=>{let u;if(!c.props.autoSize)return;let h=t.props.size!==c.props.size||t.props.align!==c.props.align||t.props.font!==c.props.font||1!==t.props.scale&&1===c.props.scale,f=t.props.text!==c.props.text;if(!h&&!f)return;let g=this.getMinDimensions(t),b=getTextSize(this.editor,c.props),v=g.width*t.props.scale,x=g.height*t.props.scale,w=b.width*c.props.scale,_=b.height*c.props.scale;switch(c.props.align){case"middle":u=new tn.G((w-v)/2,f?0:(_-x)/2);break;case"end":u=new tn.G(w-v,f?0:(_-x)/2);break;default:if(f)break;u=new tn.G(0,(_-x)/2)}if(!u)return{...c,props:{...c.props,w:w}};{u.rot(c.rotation);let{x:t,y:h}=c;return{...c,x:t-u.x,y:h-u.y,props:{...c.props,w:w}}}};onDoubleClickEdge=t=>t.props.autoSize?1!==t.props.scale?{id:t.id,type:t.type,props:{scale:1}}:void 0:{id:t.id,type:t.type,props:{autoSize:!0}}};function getTextSize(t,c){let{font:u,text:h,autoSize:f,size:g,w:b}=c,v=f?16:Math.max(16,b),x=iP[g],w=t.textMeasure.measureText(h,{...ik,fontFamily:iT[u],fontSize:x,maxWidth:f?null:Math.floor(Math.max(v,b))});return f&&(w.w+=1),{width:Math.max(v,w.w),height:Math.max(x,w.h)}}let VideoShapeUtil=class VideoShapeUtil extends BaseBoxShapeUtil{static type="video";static props=e0.p$;static migrations=e0.lY;canEdit=()=>!0;isAspectRatioLocked=()=>!0;getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(t){return(0,G.jsx)(i2,{shape:t,videoUtil:this})}indicator(t){return(0,G.jsx)("rect",{width:(0,tt.$Z)(t.props.w),height:(0,tt.$Z)(t.props.h)})}toSvg(t){let c=document.createElementNS("http://www.w3.org/2000/svg","g"),u=document.createElementNS("http://www.w3.org/2000/svg","image");return u.setAttributeNS("http://www.w3.org/1999/xlink","href",serializeVideo(t.id)),u.setAttribute("width",t.props.w.toString()),u.setAttribute("height",t.props.h.toString()),c.appendChild(u),c}};function serializeVideo(t){let c=t.split(":")[1],u=document.querySelector(`.tl-video-shape-${c}`);if(u){let t=document.createElement("canvas");return t.width=u.videoWidth,t.height=u.videoHeight,t.getContext("2d").drawImage(u,0,0),t.toDataURL("image/png")}throw Error("Video with id "+c+" not found")}let i2=(0,eJ.j)(function(t){let{shape:c,videoUtil:u}=t,h=u.editor.getShapeGeometry(c).bounds.w*u.editor.zoomLevel>=110,f=c.props.assetId?u.editor.getAsset(c.props.assetId):null,{time:g,playing:b}=c.props,v=useIsEditing(c.id),x=usePrefersReducedMotion(),w=U.useRef(null),_=U.useCallback(t=>{let h=t.currentTarget;u.editor.updateShapes([{type:"video",id:c.id,props:{playing:!0,time:h.currentTime}}])},[c.id,u.editor]),k=U.useCallback(t=>{let h=t.currentTarget;u.editor.updateShapes([{type:"video",id:c.id,props:{playing:!1,time:h.currentTime}}])},[c.id,u.editor]),E=U.useCallback(t=>{let h=t.currentTarget;v&&u.editor.updateShapes([{type:"video",id:c.id,props:{time:h.currentTime}}])},[v,c.id,u.editor]),[$,T]=U.useState(!1),I=U.useCallback(t=>{let c=t.currentTarget;g!==c.currentTime&&(c.currentTime=g),b||c.pause(),T(!0)},[b,g]);return U.useEffect(()=>{let t=w.current;t&&($&&!v&&g!==t.currentTime&&(t.currentTime=g),v&&document.activeElement!==t&&t.focus())},[v,$,g]),U.useEffect(()=>{if(x){let t=w.current;t.pause(),t.currentTime=0}},[w,x]),(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(HTMLContainer,{id:c.id,children:(0,G.jsx)("div",{className:"tl-counter-scaled",children:f?.props.src?(0,G.jsx)("video",{ref:w,style:v?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${c.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:v&&h,onPlay:_,onPause:k,onTimeUpdate:E,onLoadedData:I,hidden:!$,children:(0,G.jsx)("source",{src:f.props.src})}):null})}),"url"in c.props&&c.props.url&&(0,G.jsx)(HyperlinkButton,{url:c.props.url,zoomLevel:u.editor.zoomLevel})]})}),i3=[TextShapeUtil,BookmarkShapeUtil,DrawShapeUtil,GeoShapeUtil,NoteShapeUtil,LineShapeUtil,FrameShapeUtil,ArrowShapeUtil,HighlightShapeUtil,EmbedShapeUtil,ImageShapeUtil,VideoShapeUtil];function registerDefaultSideEffects(t){return[t.sideEffects.registerAfterChangeHandler("instance",(c,u)=>{c.isFocused!==u.isFocused&&(u.isFocused?t.getContainer().focus():(t.complete(),t.getContainer().blur()),t.updateViewportScreenBounds())}),t.sideEffects.registerAfterChangeHandler("instance_page_state",(c,u)=>{if(c.croppingShapeId!==u.croppingShapeId){let h=t.isInAny("select.crop","select.pointing_crop_handle","select.cropping");!c.croppingShapeId&&u.croppingShapeId?h||t.setCurrentTool("select.crop.idle"):c.croppingShapeId&&!u.croppingShapeId&&h&&t.setCurrentTool("select.idle")}c.editingShapeId!==u.editingShapeId&&(!c.editingShapeId&&u.editingShapeId?t.isIn("select.editing_shape")||t.setCurrentTool("select.editing_shape"):c.editingShapeId&&!u.editingShapeId&&t.isIn("select.editing_shape")&&t.setCurrentTool("select.idle"))})]}let ScribbleManager=class ScribbleManager{state;points;size;color;opacity;delay;timeoutMs=0;delayRemaining=0;onUpdate;onComplete;prev=null;next=null;constructor(t){let{size:c=20,color:u="accent",opacity:h=.8,delay:f=0,onComplete:g,onUpdate:b}=t;this.onUpdate=b,this.onComplete=g,this.size=c,this.color=u,this.delay=f,this.opacity=h,this.points=[],this.state="starting",this.prev=null,this.next=null,this.delayRemaining=this.delay,this.resume()}resume=()=>{this.state="active"};pause=()=>{this.state="starting"};stop=()=>{this.delayRemaining=Math.min(this.delayRemaining,200),this.state="stopping"};addPoint=(t,c)=>{let{prev:u}=this,h={x:t,y:c,z:.5};u&&1>tn.G.Dist(u,h)||(this.next=h)};getScribble(){return{state:this.state,size:this.size,color:this.color,opacity:this.opacity,delay:this.delay,points:[...this.points]}}updateScribble(){this.onUpdate(this.getScribble())}tick=t=>{this.timeoutMs+=t,this.delayRemaining>0&&(this.delayRemaining=Math.max(0,this.delayRemaining-t)),this.timeoutMs>=16&&(this.timeoutMs=0);let{timeoutMs:c,state:u,prev:h,next:f,points:g}=this;switch(u){case"active":f&&f!==h?(this.prev=f,g.push(f),0===this.delayRemaining&&g.length>8&&g.shift(),this.updateScribble()):0===c&&(g.length>1?(g.shift(),this.updateScribble()):this.delayRemaining=this.delay);break;case"stopping":if(0===this.delayRemaining&&0===c){if(1===g.length){this.state="paused",this.onComplete();return}this.size*=.9,g.shift(),this.updateScribble()}}}};let Erasing=class Erasing extends nx.n{static id="erasing";info={};scribble={};markId="";excludedShapeIds=new Set;onEnter=t=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=t;let{originPagePoint:c}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.currentPageShapes.filter(t=>{if(this.editor.isShapeOrAncestorLocked(t))return!0;if(this.editor.isShapeOfType(t,"group")||this.editor.isShapeOfType(t,"frame")){let u=this.editor.getPointInShapeSpace(t,c),h=this.editor.getShapeGeometry(t);return h.bounds.containsPoint(u)}return!1}).map(t=>t.id)),this.startScribble(),this.update()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new ScribbleManager({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"muted-1",size:12}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:t,y:c}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(t,c)};onScribbleUpdate=t=>{this.editor.updateInstanceState({scribble:t})};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.updateInstanceState({scribble:null})};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};update(){let{zoomLevel:t,currentPageShapes:c,erasingShapeIds:u,inputs:{currentPagePoint:h,previousPagePoint:f}}=this.editor,{excludedShapeIds:g}=this;this.pushPointToScribble();let b=new Set(u);for(let u of c){if(this.editor.isShapeOfType(u,"group"))continue;let c=this.editor.getShapeMask(u.id);if(c&&!(0,tt.Of)(h,c))continue;let g=this.editor.getShapeGeometry(u),v=this.editor.getPointInShapeSpace(u,f),x=this.editor.getPointInShapeSpace(u,h);g.hitTestLineSegment(v,x,to.wM/t)&&b.add(this.editor.getOutermostSelectableShape(u).id)}this.editor.setErasingShapes([...b].filter(t=>!g.has(t)))}complete(){this.editor.deleteShapes(this.editor.currentPageState.erasingShapeIds),this.editor.setErasingShapes([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingShapes([]),this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}};let children_Idle_Idle=class children_Idle_Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("pointing",t)};onCancel=()=>{this.editor.setCurrentTool("select")}};let children_Pointing_Pointing=class children_Pointing_Pointing extends nx.n{static id="pointing";onEnter=()=>{let{inputs:{currentPagePoint:t},currentPageShapesSorted:c,zoomLevel:u}=this.editor,h=new Set,f=h.size;for(let g=c.length,b=g-1;b>=0;b--){let g=c[b];if(!(this.editor.isShapeOrAncestorLocked(g)||this.editor.isShapeOfType(g,"group"))&&this.editor.isPointInShape(g,t,{hitInside:!1,margin:to.wM/u})){let t=this.editor.getOutermostSelectableShape(g);if(this.editor.isShapeOfType(t,"frame")&&h.size>f)break;h.add(t.id)}}this.editor.setErasingShapes([...h])};onPointerMove=t=>{this.editor.inputs.isDragging&&this.parent.transition("erasing",t)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.cancel()};complete(){let{erasingShapeIds:t}=this.editor;t.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(t)),this.editor.setErasingShapes([]),this.parent.transition("idle",{})}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle",{})}};let EraserTool=class EraserTool extends nx.n{static id="eraser";static initial="idle";static children=()=>[children_Idle_Idle,children_Pointing_Pointing,Erasing];onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})}};let Dragging=class Dragging extends nx.n{static id="dragging";onEnter=()=>{this.update()};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};update(){let{currentScreenPoint:t,previousScreenPoint:c}=this.editor.inputs,u=tn.G.Sub(t,c);(Math.abs(u.x)>0||Math.abs(u.y)>0)&&this.editor.pan(u)}complete(){this.editor.slideCamera({speed:Math.min(2,this.editor.inputs.pointerVelocity.len()),direction:this.editor.inputs.pointerVelocity,friction:to.$G}),this.parent.transition("idle",{})}};let HandTool_children_Idle_Idle=class HandTool_children_Idle_Idle extends nx.n{static id="idle";onEnter=()=>{this.editor.setCursor({type:"grab",rotation:0})};onPointerDown=t=>{this.parent.transition("pointing",t)};onCancel=()=>{this.editor.setCurrentTool("select")}};let HandTool_children_Pointing_Pointing=class HandTool_children_Pointing_Pointing extends nx.n{static id="pointing";onEnter=()=>{this.editor.stopCameraAnimation(),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})};onPointerMove=t=>{this.editor.inputs.isDragging&&this.parent.transition("dragging",t)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.complete()};complete(){this.parent.transition("idle",{})}};let HandTool=class HandTool extends nx.n{static id="hand";static initial="idle";static children=()=>[HandTool_children_Idle_Idle,HandTool_children_Pointing_Pointing,Dragging];onDoubleClick=t=>{if("settle"===t.phase){let{currentScreenPoint:t}=this.editor.inputs;this.editor.zoomIn(t,{duration:220,easing:n_.L.easeOutQuint})}};onTripleClick=t=>{if("settle"===t.phase){let{currentScreenPoint:t}=this.editor.inputs;this.editor.zoomOut(t,{duration:320,easing:n_.L.easeOutQuint})}};onQuadrupleClick=t=>{if("settle"===t.phase){let{zoomLevel:t,inputs:{currentScreenPoint:c}}=this.editor;1===t?this.editor.zoomToFit({duration:400,easing:n_.L.easeOutQuint}):this.editor.resetZoom(c,{duration:320,easing:n_.L.easeOutQuint})}}};let LaserTool_children_Idle_Idle=class LaserTool_children_Idle_Idle extends nx.n{static id="idle";onPointerDown=t=>{this.parent.transition("lasering",t)}};let Lasering=class Lasering extends nx.n{static id="lasering";scribble={};onEnter=()=>{this.startScribble(),this.pushPointToScribble()};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.pushPointToScribble()};onPointerUp=()=>{this.complete()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new ScribbleManager({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"laser",opacity:.7,size:4,delay:1200}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:t,y:c}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(t,c)};onScribbleUpdate=t=>{this.editor.updateInstanceState({scribble:t})};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.updateInstanceState({scribble:null})};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};complete(){this.parent.transition("idle",{})}cancel(){this.parent.transition("idle",{})}};let LaserTool=class LaserTool extends nx.n{static id="laser";static initial="idle";static children=()=>[LaserTool_children_Idle_Idle,Lasering];onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})}};let Brushing=class Brushing extends nx.n{static id="brushing";info={};brush=new nS.No;initialSelectedShapeIds=[];excludedShapeIds=new Set;initialStartShape=null;onEnter=t=>{let{altKey:c,currentPagePoint:u}=this.editor.inputs;if(c){this.parent.transition("scribble_brushing",t);return}this.excludedShapeIds=new Set(this.editor.currentPageShapes.filter(t=>this.editor.isShapeOfType(t,"group")||this.editor.isShapeOrAncestorLocked(t)).map(t=>t.id)),this.info=t,this.initialSelectedShapeIds=this.editor.selectedShapeIds.slice(),this.initialStartShape=this.editor.getShapesAtPoint(u)[0],this.onPointerMove()};onExit=()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})};onPointerMove=()=>{this.hitTestShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=t=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds,{squashing:!0}),this.parent.transition("idle",t)};onKeyDown=t=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",t):this.hitTestShapes()};onKeyUp=()=>{this.hitTestShapes()};complete(){this.parent.transition("idle",{})}hitTestShapes(){let t,c,u,h,f,g;let{zoomLevel:b,currentPageId:v,currentPageShapes:x,inputs:{originPagePoint:w,currentPagePoint:_,shiftKey:k,ctrlKey:E}}=this.editor;this.brush.setTo(nS.No.FromPoints([w,_]));let $=new Set(k?this.initialSelectedShapeIds:[]),{corners:T}=this.brush,{excludedShapeIds:I}=this;for(let w=0,k=x.length;w<k;w++)if(u=x[w],!(I.has(u.id)||$.has(u.id))&&(h=this.editor.getShapePageBounds(u))){if(this.brush.contains(h)){this.handleHit(u,_,v,$,T);continue}if(!(E||this.editor.isShapeOfType(u,"frame"))&&this.brush.collides(h)){let h=this.editor.getShapeGeometry(u);if(!(f=this.editor.getShapePageTransform(u)))continue;g=f.clone().invert().applyToPoints(T);for(let f=0;f<g.length;f++)if(t=g[f],c=g[(f+1)%g.length],h.hitTestLineSegment(t,c,to.wM/b)){this.handleHit(u,_,v,$,T);break}}}this.editor.updateInstanceState({brush:{...this.brush.toJson()}}),this.editor.setSelectedShapes(Array.from($),{squashing:!0})}onInterrupt=()=>{this.editor.updateInstanceState({brush:null})};handleHit(t,c,u,h,f){if(t.parentId===u){h.add(t.id);return}let g=this.editor.getOutermostSelectableShape(t),b=this.editor.getShapeMask(g.id);(!b||(0,nm.UQ)(b,f)||(0,tt.Of)(c,b))&&h.add(g.id)}};function getHitShapeOnCanvasPointerDown(t){let{zoomLevel:c,inputs:{currentPagePoint:u}}=t;return t.getShapeAtPoint(u,{hitInside:!1,hitLabels:!1,margin:to.wM/c,renderingOnly:!0})??t.getSelectedShapeAtPoint(u)}function getTranslateCroppedImageChange(t,c,u){if(!c)throw Error("Needs to translate a cropped shape!");let{crop:h}=c.props;if(!h)return;let f=t.inputs.shiftKey?Math.abs(u.x)<Math.abs(u.y)?"x":"y":null;"x"===f?u.x=0:"y"===f&&(u.y=0),u.rot(-c.rotation);let g=1/(h.bottomRight.x-h.topLeft.x)*c.props.w,b=1/(h.bottomRight.y-h.topLeft.y)*c.props.h,v=h.bottomRight.y-h.topLeft.y,x=h.bottomRight.x-h.topLeft.x,w=(0,e1.p$)(h);w.topLeft.x=Math.min(1-x,Math.max(0,w.topLeft.x-u.x/g)),w.topLeft.y=Math.min(1-v,Math.max(0,w.topLeft.y-u.y/b)),w.bottomRight.x=w.topLeft.x+x,w.bottomRight.y=w.topLeft.y+v;let _={id:c.id,type:c.type,props:{crop:w}};return _}let Crop_children_Idle_Idle=class Crop_children_Idle_Idle extends nx.n{static id="idle";onEnter=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0});let{onlySelectedShape:t}=this.editor;this.editor.on("change-history",this.cleanupCroppingState),t&&(this.editor.mark("crop"),this.editor.setCroppingShape(t.id))};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.off("change-history",this.cleanupCroppingState)};onCancel=()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})};onPointerDown=t=>{if(!this.editor.isMenuOpen){if(t.ctrlKey){this.cancel(),this.editor.root.handleEvent(t);return}switch(t.target){case"canvas":{let c=getHitShapeOnCanvasPointerDown(this.editor);if(c&&!this.editor.isShapeOfType(c,"group")){this.onPointerDown({...t,shape:c,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(t);break}case"shape":if(t.shape.id===this.editor.croppingShapeId){this.editor.setCurrentTool("select.crop.pointing_crop",t);return}this.editor.getShapeUtil(t.shape)?.canCrop(t.shape)?(this.editor.setCroppingShape(t.shape.id),this.editor.setSelectedShapes([t.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",t)):(this.cancel(),this.editor.root.handleEvent(t));break;case"selection":switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.editor.setCurrentTool("select.pointing_rotate_handle",{...t,onInteractionEnd:"select.crop"});break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":this.editor.setCurrentTool("select.pointing_crop_handle",{...t,onInteractionEnd:"select.crop"});break;default:this.cancel()}}}};onDoubleClick=t=>{if(this.editor.inputs.shiftKey||"up"!==t.phase||!this.editor.croppingShapeId)return;let c=this.editor.getShape(this.editor.croppingShapeId);if(!c)return;let u=this.editor.getShapeUtil(c);u&&"selection"===t.target&&u.onDoubleClickEdge?.(c)};onKeyDown=()=>{this.nudgeCroppingImage(!1)};onKeyRepeat=()=>{this.nudgeCroppingImage(!0)};onKeyUp=t=>{"Enter"===t.code&&(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{}))};cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}cleanupCroppingState=()=>{this.editor.croppingShapeId||this.editor.setCurrentTool("select.idle",{})};nudgeCroppingImage(t=!1){let{editor:{inputs:{keys:c}}}=this,u=c.has("ShiftLeft"),h=new tn.G(0,0);if(c.has("ArrowLeft")&&(h.x+=1),c.has("ArrowRight")&&(h.x-=1),c.has("ArrowUp")&&(h.y+=1),c.has("ArrowDown")&&(h.y-=1),h.equals(new tn.G(0,0)))return;u&&h.mul(10);let f=this.editor.getShape(this.editor.croppingShapeId);if(!f)return;let g=getTranslateCroppedImageChange(this.editor,f,h);g&&(t||this.editor.mark("translate crop"),this.editor.updateShapes([g]))}};let PointingCrop=class PointingCrop extends nx.n{static id="pointing_crop";onCancel=()=>{this.editor.setCurrentTool("select.crop.idle",{})};onPointerMove=t=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",t)};onPointerUp=t=>{this.editor.setCurrentTool("select.crop.idle",t)}};let TranslatingCrop=class TranslatingCrop extends nx.n{static id="translating_crop";info={};markId="translating crop";snapshot={};onEnter=t=>{this.info=t,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onKeyDown=t=>{switch(t.key){case"Alt":case"Shift":this.updateShapes();return}};onKeyUp=t=>{switch(t.key){case"Enter":this.complete();return;case"Alt":case"Shift":this.updateShapes()}};complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){let t=this.editor.onlySelectedShape;return{shape:t}}updateShapes(){let t=this.snapshot.shape;if(!t)return;let{originPagePoint:c,currentPagePoint:u}=this.editor.inputs,h=u.clone().sub(c),f=getTranslateCroppedImageChange(this.editor,t,h);f&&this.editor.updateShapes([f],{squashing:!0})}};let Crop=class Crop extends nx.n{static id="crop";static initial="idle";static children=()=>[Crop_children_Idle_Idle,TranslatingCrop,PointingCrop]};let i5={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};let PointingResizeHandle=class PointingResizeHandle extends nx.n{static id="pointing_resize_handle";info={};updateCursor(){let t=this.editor.selectedShapes,c=i5[this.info.handle];this.editor.updateInstanceState({cursor:{type:c,rotation:1===t.length?t[0].rotation:0}})}onEnter=t=>{this.info=t,this.updateCursor()};onPointerMove=()=>{let t=this.editor.inputs.isDragging;t&&this.parent.transition("resizing",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}};let Cropping=class Cropping extends nx.n{static id="cropping";info={};markId="";snapshot={};onEnter=t=>{this.info=t,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};updateCursor(){let t=this.editor.selectedShapes[0];if(!t)return;let c=i5[this.info.handle];this.editor.updateInstanceState({cursor:{type:c,rotation:t.rotation}})}getDefaultCrop=()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}});updateShapes(){let{shape:t,cursorHandleOffset:c}=this.snapshot;if(!t)return;let u=this.editor.getShapeUtil("image");if(!u)return;let h=t.props,f=this.editor.inputs.currentPagePoint.clone().sub(c),g=this.editor.inputs.originPagePoint.clone().sub(c),b=f.clone().sub(g).rot(-t.rotation),v=h.crop??this.getDefaultCrop(),x=(0,e1.p$)(v),w=new tn.G(t.x,t.y),_=new tn.G(0,0),k=1/(v.bottomRight.x-v.topLeft.x)*h.w,E=1/(v.bottomRight.y-v.topLeft.y)*h.h,$=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(E<8)break;$=!0,x.topLeft.y=x.topLeft.y+b.y/E;let t=E*(x.bottomRight.y-x.topLeft.y);t<8?(x.topLeft.y=x.bottomRight.y-8/E,_.y=(x.topLeft.y-v.topLeft.y)*E):x.topLeft.y<=0?(x.topLeft.y=0,_.y=(x.topLeft.y-v.topLeft.y)*E):_.y=b.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(E<8)break;$=!0,x.bottomRight.y=Math.min(1,x.bottomRight.y+b.y/E);let t=E*(x.bottomRight.y-x.topLeft.y);t<8&&(x.bottomRight.y=x.topLeft.y+8/E)}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(k<8)break;$=!0,x.topLeft.x=x.topLeft.x+b.x/k;let t=k*(x.bottomRight.x-x.topLeft.x);t<8?(x.topLeft.x=x.bottomRight.x-8/k,_.x=(x.topLeft.x-v.topLeft.x)*k):x.topLeft.x<=0?(x.topLeft.x=0,_.x=(x.topLeft.x-v.topLeft.x)*k):_.x=b.x;break}case"right":case"top_right":case"bottom_right":{if(k<8)break;$=!0,x.bottomRight.x=Math.min(1,x.bottomRight.x+b.x/k);let t=k*(x.bottomRight.x-x.topLeft.x);t<8&&(x.bottomRight.x=x.topLeft.x+8/k)}}if(!$)return;w.add(_.rot(t.rotation));let T={id:t.id,type:t.type,x:w.x,y:w.y,props:{crop:x,w:(x.bottomRight.x-x.topLeft.x)*k,h:(x.bottomRight.y-x.topLeft.y)*E}};this.editor.updateShapes([T],{squashing:!0}),this.updateCursor()}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))}createSnapshot(){let{selectionRotation:t,inputs:{originPagePoint:c}}=this.editor,u=this.editor.onlySelectedShape,h=this.editor.selectionRotatedPageBounds,f=tn.G.RotWith(h.getHandlePoint(this.info.handle),h.point,t),g=tn.G.Sub(c,f);return{shape:u,cursorHandleOffset:g}}};let DraggingHandle=class DraggingHandle extends nx.n{static id="dragging_handle";shapeId="";initialHandle={};initialAdjacentHandle=null;initialPagePoint={};markId="";initialPageTransform;initialPageRotation;info={};isPrecise=!1;isPreciseId=null;pointingId=null;onEnter=t=>{let{shape:c,isCreating:u,handle:h}=t;this.info=t,this.parent.currentToolIdMask=t.onInteractionEnd,this.shapeId=c.id,this.markId=u?`creating:${c.id}`:"dragging handle",u||this.editor.mark(this.markId),this.initialHandle=(0,e1.p$)(h),this.initialPageTransform=this.editor.getShapePageTransform(c),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.updateInstanceState({cursor:{type:u?"cross":"grabbing",rotation:0}},{ephemeral:!0});let f=this.editor.getShapeHandles(c).sort(nj.hl),g=f.findIndex(c=>c.id===t.handle.id);this.initialAdjacentHandle=null;for(let c=g+1;c<f.length;c++){let u=f[c];if("vertex"===u.type&&"middle"!==u.id&&u.id!==t.handle.id){this.initialAdjacentHandle=u;break}}if(!this.initialAdjacentHandle)for(let c=f.length-1;c>=0;c--){let u=f[c];if("vertex"===u.type&&"middle"!==u.id&&u.id!==t.handle.id){this.initialAdjacentHandle=u;break}}let b=c.props[t.handle.id];this.isPrecise=!1,b?.type==="binding"?(this.editor.setHintingShapes([b.boundShapeId]),this.isPrecise=!tn.G.Equals(b.normalizedAnchor,{x:.5,y:.5}),this.isPrecise?this.isPreciseId=b.boundShapeId:this.resetExactTimeout()):this.editor.setHintingShapes([]),this.update(),this.editor.select(this.shapeId)};exactTimeout=-1;resetExactTimeout(){-1!==this.exactTimeout&&this.clearExactTimeout(),this.exactTimeout=setTimeout(()=>{this.isActive&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){-1!==this.exactTimeout&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.setHintingShapes([]),this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};complete(){this.editor.snaps.clear();let{onInteractionEnd:t}=this.info;if(this.editor.instanceState.isToolLocked&&t){this.editor.setCurrentTool(t,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clear();let{onInteractionEnd:t}=this.info;if(t){this.editor.setCurrentTool(t,{shapeId:this.shapeId});return}this.parent.transition("idle",{})}update(){let{editor:t,shapeId:c,initialPagePoint:u}=this,{initialHandle:h,initialPageRotation:f,initialAdjacentHandle:g}=this,{user:{isSnapMode:b},hintingShapeIds:v,snaps:x,inputs:{currentPagePoint:w,shiftKey:_,ctrlKey:k,altKey:E,pointerVelocity:$}}=t,T=t.getShape(c);if(!T)return;let I=t.getShapeUtil(T),M=w.clone().sub(u).rot(-f).add(h);if(_&&g&&"middle"!==h.id){let t=tn.G.Angle(g,M),c=(0,tt.nD)(t,24),u=c-t;M=tn.G.RotWith(M,g,u)}if(t.snaps.clear(),h.canSnap&&(b?!k:k)){let c=t.getShapePageTransform(T.id);if(!c)throw Error("Expected a page transform");let u=t.getShapeHandles(T).filter(({type:t})=>"vertex"===t).sort(nj.hl).findIndex(({index:t})=>h.index===t),f=I.getOutlineSegments(T).map(t=>t$.y.applyToPoints(c,t)).filter((t,c)=>c!==u-1&&c!==u),g=x.getSnappingHandleDelta({additionalSegments:f,handlePoint:t$.y.applyToPoint(c,M)});g&&(g.rot(-t.getShapeParentTransform(T).rotation()),M.add(g))}let j=I.onHandleChange?.(T,{handle:{...h,x:M.x,y:M.y},isPrecise:this.isPrecise||E}),D={...T,...j};if(h.canBind){let c=D.props[h.id];c?.type==="binding"?v[0]!==c.boundShapeId&&(t.setHintingShapes([c.boundShapeId]),this.pointingId=c.boundShapeId,this.isPrecise=.5>$.len()||E,this.isPreciseId=this.isPrecise?c.boundShapeId:null,this.resetExactTimeout()):v.length>0&&(t.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}j&&t.updateShapes([D],{squashing:!0})}};let EditingShape=class EditingShape extends nx.n{static id="editing_shape";onEnter=()=>{let{editingShape:t}=this.editor;if(!t)throw Error("Entered editing state without an editing shape");updateHoveredId(this.editor),this.editor.select(t)};onExit=()=>{let{editingShapeId:t}=this.editor.currentPageState;if(!t)return;this.editor.setEditingShape(null);let c=this.editor.getShape(t),u=this.editor.getShapeUtil(c);u.onEditEnd?.(c),setTimeout(()=>{this.editor.updateViewportScreenBounds()},500)};onPointerMove=t=>{switch(t.target){case"shape":case"canvas":updateHoveredId(this.editor);return}};onPointerDown=t=>{switch(t.target){case"canvas":{let c=getHitShapeOnCanvasPointerDown(this.editor);if(c){this.onPointerDown({...t,shape:c,target:"shape"});return}break}case"shape":{let{shape:c}=t,{editingShape:u}=this.editor;if(!u)throw Error("Expected an editing shape!");if(c.type===u.type){if(this.editor.isShapeOfType(c,"geo")||this.editor.isShapeOfType(c,"arrow")){let h=this.editor.getShapeUtil(c).getGeometry(c),f=h.children[1];if(f){let h=this.editor.getPointInShapeSpace(c,this.editor.inputs.currentPagePoint);if(f.bounds.containsPoint(h)){if(c.id===u.id)return;this.parent.transition("pointing_shape",t);return}}}else{c.id===u.id?this.editor.isShapeOfType(c,"frame")&&this.editor.setEditingShape(null):this.parent.transition("pointing_shape",t);return}}}}this.parent.transition("idle",t),this.editor.root.handleEvent(t)};onComplete=t=>{this.parent.transition("idle",t)};onCancel=t=>{this.parent.transition("idle",t)}};function getShouldEnterCropMode(t){let{onlySelectedShape:c}=t;return!!(c&&!t.isShapeOrAncestorLocked(c)&&t.getShapeUtil(c).canCrop(c))}function selectOnCanvasPointerUp(t){let{selectedShapeIds:c}=t,{shiftKey:u,altKey:h,currentPagePoint:f}=t.inputs,g=t.getShapeAtPoint(f,{hitInside:!1,margin:to.wM/t.zoomLevel,hitLabels:!0,renderingOnly:!0,filter:t=>!t.isLocked});if(g){let f=t.getOutermostSelectableShape(g);if(u&&!h)t.cancelDoubleClick(),c.includes(f.id)?(t.mark("deselecting shape"),t.deselect(f)):(t.mark("shift selecting shape"),t.setSelectedShapes([...c,f.id]));else{let u;(u=f===g?g:f.id===t.focusedGroupId||c.includes(f.id)?g:f)&&!c.includes(u.id)&&(t.mark("selecting shape"),t.select(u.id))}}else{if(u)return;{c.length>0&&(t.mark("selecting none"),t.selectNone());let{focusedGroupId:u}=t;if((0,e0.YT)(u)){let c=t.getShape(u);t.isPointInShape(c,f,{margin:0,hitInside:!0})||t.setFocusedGroup(null)}}}}let SelectTool_children_Idle_Idle=class SelectTool_children_Idle_Idle extends nx.n{static id="idle";onEnter=()=>{this.parent.currentToolIdMask=void 0,updateHoveredId(this.editor),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{updateHoveredId(this.editor)};onPointerDown=t=>{if(this.editor.isMenuOpen)return;let c=t.ctrlKey&&getShouldEnterCropMode(this.editor);if(t.ctrlKey&&!c){if("shape"===t.target&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(t.shape)){this.parent.transition("pointing_shape",t);return}this.parent.transition("brushing",t);return}switch(t.target){case"canvas":{let c=getHitShapeOnCanvasPointerDown(this.editor);if(c){this.onPointerDown({...t,shape:c,target:"shape"});return}let{onlySelectedShape:u,selectedShapeIds:h,inputs:{currentPagePoint:f}}=this.editor;if((h.length>1||u&&!this.editor.getShapeUtil(u).hideSelectionBoundsBg(u))&&isPointInRotatedSelectionBounds(this.editor,f)){this.onPointerDown({...t,target:"selection"});return}this.parent.transition("pointing_canvas",t);break}case"shape":if(this.editor.isShapeOrAncestorLocked(t.shape))break;this.parent.transition("pointing_shape",t);break;case"handle":if(this.editor.instanceState.isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",t):this.parent.transition("pointing_handle",t);break;case"selection":switch(t.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":this.parent.transition("pointing_rotate_handle",t);break;case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":c?this.parent.transition("pointing_crop_handle",t):this.parent.transition("pointing_resize_handle",t);break;default:{let{hoveredShape:c}=this.editor;if(c&&!this.editor.selectedShapeIds.includes(c.id)){this.onPointerDown({...t,shape:c,target:"shape"});return}this.parent.transition("pointing_selection",t)}}}};onDoubleClick=t=>{if(!this.editor.inputs.shiftKey&&"up"===t.phase)switch(t.target){case"canvas":{let{hoveredShape:c}=this.editor,u=c&&!this.editor.isShapeOfType(c,"group")?c:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:to.wM/this.editor.zoomLevel,hitInside:!1}),{focusedGroupId:h}=this.editor;if(u){if(this.editor.isShapeOfType(u,"group")){selectOnCanvasPointerUp(this.editor);return}{let t=this.editor.getShape(u.parentId);if(t&&this.editor.isShapeOfType(t,"group")){if(h&&t.id===h);else{selectOnCanvasPointerUp(this.editor);return}}}this.onDoubleClick({...t,shape:u,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(t);break}case"selection":{if(this.editor.instanceState.isReadonly)break;let{onlySelectedShape:c}=this.editor;if(c){let u=this.editor.getShapeUtil(c);if(!this.canInteractWithShapeInReadOnly(c))return;if("right"===t.handle||"left"===t.handle||"top"===t.handle||"bottom"===t.handle){let t=u.onDoubleClickEdge?.(c);if(t){this.editor.mark("double click edge"),this.editor.updateShapes([t]);return}}if(u.canCrop(c)&&!this.editor.isShapeOrAncestorLocked(c)){this.parent.transition("crop",t);return}this.shouldStartEditingShape(c)&&this.startEditingShape(c,t)}break}case"shape":{let{shape:c}=t,u=this.editor.getShapeUtil(c);if("video"!==c.type&&"embed"!==c.type&&this.editor.instanceState.isReadonly)break;if(u.onDoubleClick){let h=u.onDoubleClick?.(c);if(h){this.editor.updateShapes([h]);return}if(u.canCrop(c)&&!this.editor.isShapeOrAncestorLocked(c)){this.editor.mark("select and crop"),this.editor.select(t.shape?.id),this.parent.transition("crop",t);return}}this.shouldStartEditingShape(c)?this.startEditingShape(c,t):this.handleDoubleClickOnCanvas(t);break}case"handle":{if(this.editor.instanceState.isReadonly)break;let{shape:c,handle:u}=t,h=this.editor.getShapeUtil(c),f=h.onDoubleClickHandle?.(c,u);f?this.editor.updateShapes([f]):this.shouldStartEditingShape(c)&&this.startEditingShape(c,t)}}};onRightClick=t=>{switch(t.target){case"canvas":{let{hoveredShape:c}=this.editor,u=c&&!this.editor.isShapeOfType(c,"group")?c:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:to.wM/this.editor.zoomLevel,hitInside:!1,hitLabels:!0,hitFrameInside:!1,renderingOnly:!0});if(u){this.onRightClick({...t,shape:u,target:"shape"});return}let{onlySelectedShape:h,selectedShapeIds:f,inputs:{currentPagePoint:g}}=this.editor;if((f.length>1||h&&!this.editor.getShapeUtil(h).hideSelectionBoundsBg(h))&&isPointInRotatedSelectionBounds(this.editor,g)){this.onRightClick({...t,target:"selection"});return}this.editor.selectNone();break}case"shape":{let{selectedShapeIds:c}=this.editor.currentPageState,{shape:u}=t,h=this.editor.getOutermostSelectableShape(u,t=>!c.includes(t.id));c.includes(h.id)||(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([h.id]))}}};onCancel=()=>{this.editor.focusedGroupId!==this.editor.currentPageId&&this.editor.selectedShapeIds.length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())};onKeyDown=t=>{switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!1)}};onKeyRepeat=t=>{switch(t.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":this.nudgeSelectedShapes(!0)}};onKeyUp=t=>{if("Enter"===t.code){let{selectedShapes:c}=this.editor;if(c.every(t=>this.editor.isShapeOfType(t,"group"))){this.editor.setSelectedShapes(c.flatMap(t=>this.editor.getSortedChildIdsForParent(t.id)));return}let{onlySelectedShape:u}=this.editor;if(u&&this.shouldStartEditingShape(u)){this.startEditingShape(u,{...t,target:"shape",shape:u});return}getShouldEnterCropMode(this.editor)&&this.parent.transition("crop",t)}};shouldStartEditingShape(t=this.editor.onlySelectedShape){return!(!t||this.editor.isShapeOrAncestorLocked(t)&&"embed"!==t.type)&&!!this.canInteractWithShapeInReadOnly(t)&&this.editor.getShapeUtil(t).canEdit(t)}startEditingShape(t,c){this.editor.isShapeOrAncestorLocked(t)&&"embed"!==t.type||(this.editor.mark("editing shape"),this.editor.setEditingShape(t.id),this.parent.transition("editing_shape",c))}isDarwin=window.navigator.userAgent.toLowerCase().indexOf("mac")>-1;handleDoubleClickOnCanvas(t){if(this.editor.instanceState.isReadonly)return;this.editor.mark("creating text shape");let c=(0,e0.F1)(),{x:u,y:h}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:c,type:"text",x:u,y:h,props:{text:"",autoSize:!0}}]);let f=this.editor.getShape(c);if(!f)return;let g=this.editor.getShapeUtil(f);(!this.editor.instanceState.isReadonly||g.canEditInReadOnly(f))&&(this.editor.setEditingShape(c),this.editor.select(c),this.parent.transition("editing_shape",t))}nudgeSelectedShapes(t=!1){let{editor:{inputs:{keys:c}}}=this,u=c.has("ShiftLeft"),h=new tn.G(0,0);if(c.has("ArrowLeft")&&(h.x-=1),c.has("ArrowRight")&&(h.x+=1),c.has("ArrowUp")&&(h.y-=1),c.has("ArrowDown")&&(h.y+=1),h.equals(new tn.G(0,0)))return;t||this.editor.mark("nudge shapes");let{gridSize:f}=this.editor.documentSettings,g=this.editor.instanceState.isGridMode?u?f*i6:f:u?i4:i8;this.editor.nudgeShapes(this.editor.selectedShapeIds,h.mul(g))}canInteractWithShapeInReadOnly(t){if(!this.editor.instanceState.isReadonly)return!0;let c=this.editor.getShapeUtil(t);return!!c.canEditInReadOnly(t)}};let i4=10,i8=1,i6=5;function isPointInRotatedSelectionBounds(t,c){let{selectionRotatedPageBounds:u}=t;if(!u)return!1;let{selectionRotation:h}=t;return h?(0,tt.Of)(c,u.corners.map(t=>tn.G.RotWith(t,u.point,h))):u.containsPoint(c)}let PointingCanvas=class PointingCanvas extends nx.n{static id="pointing_canvas";onEnter=()=>{let{inputs:t}=this.editor;!t.shiftKey&&this.editor.selectedShapeIds.length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())};onPointerMove=t=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",t)};onPointerUp=()=>{selectOnCanvasPointerUp(this.editor),this.complete()};onComplete=()=>{this.complete()};onInterrupt=()=>{this.parent.transition("idle",{})};complete(){this.parent.transition("idle",{})}};let PointingCropHandle=class PointingCropHandle extends nx.n{static id="pointing_crop_handle";info={};updateCursor(t){let c=i5[this.info.handle];this.editor.updateInstanceState({cursor:{type:c,rotation:t.rotation}})}onEnter=t=>{this.info=t,this.parent.currentToolIdMask=t.onInteractionEnd;let c=this.editor.selectedShapes[0];c&&(this.updateCursor(c),this.editor.setCroppingShape(c.id))};onExit=()=>{this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.parent.currentToolIdMask=void 0};onPointerMove=()=>{let t=this.editor.inputs.isDragging;t&&this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})};onPointerUp=()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.parent.transition("idle",{}))}};let PointingHandle=class PointingHandle extends nx.n{static id="pointing_handle";info={};onEnter=t=>{this.info=t;let c=t.shape.props[t.handle.id];c?.type==="binding"&&this.editor.setHintingShapes([c.boundShapeId]),this.editor.updateInstanceState({cursor:{type:"grabbing",rotation:0}},{ephemeral:!0})};onExit=()=>{this.editor.setHintingShapes([]),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerUp=()=>{this.parent.transition("idle",this.info)};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("dragging_handle",this.info)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}};let PointingRotateHandle=class PointingRotateHandle extends nx.n{static id="pointing_rotate_handle";info={};updateCursor(){let{selectionRotation:t}=this.editor;this.editor.updateInstanceState({cursor:{type:i5[this.info.handle],rotation:t}})}onEnter=t=>{this.parent.currentToolIdMask=t.onInteractionEnd,this.info=t,this.updateCursor()};onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0})};onPointerMove=()=>{let{isDragging:t}=this.editor.inputs;t&&this.parent.transition("rotating",this.info)};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}};let PointingSelection=class PointingSelection extends nx.n{static id="pointing_selection";info={};onEnter=t=>{this.info=t};onPointerUp=t=>{selectOnCanvasPointerUp(this.editor),this.parent.transition("idle",t)};onPointerMove=t=>{this.editor.inputs.isDragging&&!this.editor.instanceState.isReadonly&&this.parent.transition("translating",t)};onDoubleClick=t=>{let{hoveredShape:c}=this.editor,u=c&&!this.editor.isShapeOfType(c,"group")?c:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(u){this.parent.transition("idle",{}),this.parent.onDoubleClick?.({...t,target:"shape",shape:this.editor.getShape(u)});return}};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}};let PointingShape=class PointingShape extends nx.n{static id="pointing_shape";hitShape={};hitShapeForPointerUp={};didSelectOnEnter=!1;onEnter=t=>{let{selectedShapeIds:c,focusedGroupId:u,selectionRotatedPageBounds:h,inputs:{currentPagePoint:f,shiftKey:g,altKey:b}}=this.editor;this.hitShape=t.shape;let v=this.editor.getOutermostSelectableShape(t.shape);if(this.editor.getShapeUtil(t.shape).onClick||v.id===u||c.includes(v.id)||this.editor.isAncestorSelected(v.id)||c.length>1&&h?.containsPoint(f)){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=v;return}this.didSelectOnEnter=!0,g&&!b?(this.editor.cancelDoubleClick(),c.includes(v.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...c,v.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([v.id]))};onPointerUp=t=>{let{zoomLevel:c,focusedGroupId:u,selectedShapeIds:h,inputs:{currentPagePoint:f,shiftKey:g}}=this.editor,b=this.editor.getShapeAtPoint(f,{margin:to.wM/c,hitInside:!0,renderingOnly:!0})??this.hitShape,v=b?this.editor.getOutermostSelectableShape(b):this.hitShapeForPointerUp;if(v){let c=this.editor.getShapeUtil(v);if(c.onClick){let u=c.onClick?.(v);if(u){this.editor.mark("shape on click"),this.editor.updateShapes([u]),this.parent.transition("idle",t);return}}if(v.id===u){h.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",t);return}}if(!this.didSelectOnEnter){let t=this.editor.getOutermostSelectableShape(b,t=>!h.includes(t.id));if(h.includes(t.id)){if(g)this.editor.mark("deselecting on pointer up"),this.editor.deselect(v);else if(h.includes(v.id)){if(1===h.length&&(this.editor.isShapeOfType(v,"geo")||this.editor.isShapeOfType(v,"arrow"))){let t=this.editor.getShapeGeometry(v),c=t.children[1];if(c){let t=this.editor.getPointInShapeSpace(v,f);if(c.bounds.containsPoint(t,0)&&c.hitTestPoint(t)){this.editor.batch(()=>{this.editor.mark("editing on pointer up"),this.editor.select(v.id);let t=this.editor.getShapeUtil(v);(!this.editor.instanceState.isReadonly||t.canEditInReadOnly(v))&&(this.editor.setEditingShape(v.id),this.editor.setCurrentTool("select.editing_shape"))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(v.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(v)}else if(g){let c=this.editor.getShapeAncestors(t);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.selectedShapeIds.filter(t=>!c.find(c=>c.id===t)),t.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([t.id])}this.parent.transition("idle",t)};onPointerMove=t=>{this.editor.inputs.isDragging&&!this.editor.instanceState.isReadonly&&this.parent.transition("translating",t)};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};cancel(){this.parent.transition("idle",{})}};let Resizing=class Resizing extends nx.n{static id="resizing";info={};markId="";creationCursorOffset={x:0,y:0};editAfterComplete=!1;snapshot={};onEnter=t=>{let{isCreating:c=!1,editAfterComplete:u=!1,creationCursorOffset:h={x:0,y:0}}=t;this.info=t,this.parent.currentToolIdMask=t.onInteractionEnd,this.editAfterComplete=u,this.creationCursorOffset=h,t.isCreating&&this.editor.updateInstanceState({cursor:{type:"cross",rotation:0}},{ephemeral:!0}),this.snapshot=this._createSnapshot(),this.markId=c?`creating:${this.editor.onlySelectedShape.id}`:"starting resizing",c||this.editor.mark(this.markId),this.handleResizeStart(),this.updateShapes()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{this.updateShapes()};onKeyUp=()=>{this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle",{})}complete(){if(this.handleResizeEnd(),this.editAfterComplete&&this.editor.onlySelectedShape){this.editor.setEditingShape(this.editor.onlySelectedShape.id),this.editor.setCurrentTool("select.editing_shape");return}if(this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle",{})}handleResizeStart(){let{shapeSnapshots:t}=this.snapshot,c=[];t.forEach(({shape:t})=>{let u=this.editor.getShapeUtil(t),h=u.onResizeStart?.(t);h&&c.push(h)}),c.length>0&&this.editor.updateShapes(c)}handleResizeEnd(){let{shapeSnapshots:t}=this.snapshot,c=[];t.forEach(({shape:t})=>{let u=this.editor.getShape(t.id),h=this.editor.getShapeUtil(t),f=h.onResizeEnd?.(t,u);f&&c.push(f)}),c.length>0&&this.editor.updateShapes(c)}updateShapes(){let{altKey:t,shiftKey:c}=this.editor.inputs,{shapeSnapshots:u,selectionBounds:h,cursorHandleOffset:f,selectedShapeIds:g,selectionRotation:b,canShapesDeform:v}=this.snapshot,x=c||!v,{ctrlKey:w}=this.editor.inputs,_=this.editor.inputs.currentPagePoint.clone().sub(f).sub(this.creationCursorOffset),k=this.editor.inputs.originPagePoint.clone().sub(f);if(this.editor.instanceState.isGridMode&&!w){let{gridSize:t}=this.editor.documentSettings;_.snapToGrid(t)}let E=this.info.handle,$=rotateSelectionHandle(E,Math.PI);this.editor.snaps.clear();let T=this.editor.user.isSnapMode?!w:w;if(T&&b%tt.gc==0){let{nudge:c}=this.editor.snaps.snapResize({dragDelta:tn.G.Sub(_,k),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:rotateSelectionHandle(E,b),isAspectRatioLocked:x,isResizingFromCenter:t});_.add(c)}let I=tn.G.RotWith(t?h.center:h.getHandlePoint($),h.point,b),M=tn.G.Sub(_,I).rot(-b),j=tn.G.Sub(k,I).rot(-b),D=tn.G.DivV(M,j);Number.isFinite(D.x)||(D.x=1),Number.isFinite(D.y)||(D.y=1);let F="top"===E||"bottom"===E,L="left"===E||"right"===E;for(let t of(x?L?D.y=Math.abs(D.x):F?D.x=Math.abs(D.y):Math.abs(D.x)>Math.abs(D.y)?D.y=Math.abs(D.x)*(D.y<0?-1:1):D.x=Math.abs(D.y)*(D.x<0?-1:1):(F&&(D.x=1),L&&(D.y=1)),this.info.isCreating||this.updateCursor({dragHandle:E,isFlippedX:D.x<0,isFlippedY:D.y<0,rotation:b}),u.keys())){let c=u.get(t);this.editor.resizeShape(t,D,{initialShape:c.shape,initialBounds:c.bounds,initialPageTransform:c.pageTransform,dragHandle:E,mode:1===g.length&&t===g[0]?"resize_bounds":"scale_shape",scaleOrigin:I,scaleAxisRotation:b})}}updateCursor({dragHandle:t,isFlippedX:c,isFlippedY:u,rotation:h}){let f={...this.editor.instanceState.cursor};switch(t){case"top_left":case"bottom_right":f.type="nwse-resize",c!==u&&(f.type="nesw-resize");break;case"top_right":case"bottom_left":f.type="nesw-resize",c!==u&&(f.type="nwse-resize")}f.rotation=h,this.editor.setCursor(f)}onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.editor.snaps.clear()};_createSnapshot=()=>{let{selectedShapeIds:t,selectionRotation:c,inputs:{originPagePoint:u}}=this.editor,h=this.editor.selectionRotatedPageBounds,f=tn.G.RotWith(h.getHandlePoint(this.info.handle),h.point,c),g=tn.G.Sub(u,f),b=new Map;t.forEach(c=>{let u=this.editor.getShape(c);if(u){if(b.set(u.id,this._createShapeSnapshot(u)),this.editor.isShapeOfType(u,"frame")&&1===t.length)return;this.editor.visitDescendants(u.id,t=>{let c=this.editor.getShape(t);if(c&&(b.set(c.id,this._createShapeSnapshot(c)),this.editor.isShapeOfType(c,"frame")))return!1})}});let v=![...b.values()].some(t=>!(0,tt._G)(t.pageRotation,c)||t.isAspectRatioLocked);return{shapeSnapshots:b,selectionBounds:h,cursorHandleOffset:g,selectionRotation:c,selectedShapeIds:t,canShapesDeform:v,initialSelectionPageBounds:this.editor.selectionPageBounds}};_createShapeSnapshot=t=>{let c=this.editor.getShapePageTransform(t),u=this.editor.getShapeUtil(t);return{shape:t,bounds:this.editor.getShapeGeometry(t).bounds,pageTransform:c,pageRotation:t$.y.Decompose(c).rotation,isAspectRatioLocked:u.isAspectRatioLocked(t)}}};let i7=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function rotateSelectionHandle(t,c){c%=tt.yo;let u=Math.round(c/(tt.PI/4)),h=i7.indexOf(t);return i7[(h+u)%i7.length]}let Rotating=class Rotating extends nx.n{static id="rotating";snapshot={};info={};markId="";onEnter=t=>{this.info=t,this.parent.currentToolIdMask=t.onInteractionEnd,this.markId="rotate start",this.editor.mark(this.markId);let c=(0,nD.o)({editor:this.editor});if(!c)return this.parent.transition("idle",this.info);this.snapshot=c,this.handleStart()};onExit=()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.currentToolIdMask=void 0,this.snapshot={}};onPointerMove=()=>{this.update()};onKeyDown=()=>{this.update()};onKeyUp=()=>{this.update()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};update=()=>{let t=this._getRotationFromPointerPosition({snapToNearestDegree:!1});(0,nD.Z)({editor:this.editor,delta:t,snapshot:this.snapshot,stage:"update"}),this.editor.updateInstanceState({cursor:{type:i5[this.info.handle],rotation:t+this.snapshot.initialSelectionRotation}})};cancel=()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};complete=()=>{(0,nD.Z)({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)};handleStart(){let t=this._getRotationFromPointerPosition({snapToNearestDegree:!1});(0,nD.Z)({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.updateInstanceState({cursor:{type:i5[this.info.handle],rotation:t+this.snapshot.initialSelectionRotation}})}_getRotationFromPointerPosition({snapToNearestDegree:t}){let{selectionRotatedPageBounds:c,selectionRotation:u,inputs:{shiftKey:h,currentPagePoint:f}}=this.editor,{initialCursorAngle:g,initialSelectionRotation:b}=this.snapshot;if(!c)return b;let v=c.center.clone().rotWith(c.point,u),x=v.angle(f)-g,w=b+x;if(h)w=(0,tt.nD)(w,24);else if(t&&(w=Math.round(w/tt.Ib)*tt.Ib,this.editor.instanceState.isCoarsePointer)){let t=(0,tt.nD)(w,4),c=(0,tt.Cc)(w,t);Math.abs(c)<(0,tt.Ht)(5)&&(w=t)}return w-b}};let ScribbleBrushing=class ScribbleBrushing extends nx.n{static id="scribble_brushing";hits=new Set;size=0;scribble={};initialSelectedShapeIds=new Set;newlySelectedShapeIds=new Set;onEnter=()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.selectedShapeIds:[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear(),this.startScribble(),this.updateScribbleSelection(!0),requestAnimationFrame(()=>{this.editor.updateInstanceState({brush:null})})};onExit=()=>{this.scribble.stop()};onPointerMove=()=>{this.updateScribbleSelection(!0)};onPointerUp=()=>{this.complete()};onKeyDown=()=>{this.updateScribbleSelection(!1)};onKeyUp=()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing",{})};onCancel=()=>{this.cancel()};onComplete=()=>{this.complete()};startScribble=()=>{this.scribble.tick&&this.editor.off("tick",this.scribble?.tick),this.scribble=new ScribbleManager({onUpdate:this.onScribbleUpdate,onComplete:this.onScribbleComplete,color:"selection-stroke",opacity:.32,size:12}),this.editor.on("tick",this.scribble.tick)};pushPointToScribble=()=>{let{x:t,y:c}=this.editor.inputs.currentPagePoint;this.scribble.addPoint(t,c)};onScribbleUpdate=t=>{this.editor.updateInstanceState({scribble:t})};onScribbleComplete=()=>{this.editor.off("tick",this.scribble.tick),this.editor.updateInstanceState({scribble:null})};updateScribbleSelection(t){let c,u,h,f;let{zoomLevel:g,currentPageShapes:b,inputs:{shiftKey:v,originPagePoint:x,previousPagePoint:w,currentPagePoint:_}}=this.editor,{newlySelectedShapeIds:k,initialSelectedShapeIds:E}=this;t&&this.pushPointToScribble();for(let t=0,v=b.length;t<v;t++)if(c=b[t],u=this.editor.getShapeGeometry(c),!(this.editor.isShapeOfType(c,"group")||k.has(c.id)||this.editor.isShapeOrAncestorLocked(c))){if(this.editor.isShapeOfType(c,"frame")){let t=this.editor.getPointInShapeSpace(c,x);if(u.bounds.containsPoint(t))continue}if(h=this.editor.getPointInShapeSpace(c,w),f=this.editor.getPointInShapeSpace(c,_),u.hitTestLineSegment(h,f,to.wM/g)){let t=this.editor.getOutermostSelectableShape(c),u=this.editor.getShapeMask(t.id);if(u){let t=(0,nm.Gc)(w,_,u);if(null!==t){let t=(0,tt.Of)(_,u);if(!t)continue}}k.add(t.id)}}this.editor.setSelectedShapes([...new Set(v?[...k,...E]:[...k])],{squashing:!0})}complete(){this.parent.transition("idle",{})}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds],{squashing:!0}),this.parent.transition("idle",{})}};let DragAndDropManager=class DragAndDropManager{constructor(t){this.editor=t,t.disposables.add(this.dispose)}prevDroppingShapeId=null;droppingNodeTimer=null;first=!0;updateDroppingNode(t,c){this.first&&(this.prevDroppingShapeId=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,t)?.id??null,this.first=!1),null===this.droppingNodeTimer?this.setDragTimer(t,1e3,c):this.editor.inputs.pointerVelocity.len()>.5&&(clearInterval(this.droppingNodeTimer),this.setDragTimer(t,100,c))}setDragTimer(t,c,u){this.droppingNodeTimer=setTimeout(()=>{this.editor.batch(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,t,u)}),this.droppingNodeTimer=null},c)}handleDrag(t,c,u){c=(0,e1.oA)(c.map(t=>this.editor.getShape(t.id)));let h=this.editor.getDroppingOverShape(t,c)?.id??null;if(h===this.prevDroppingShapeId)return;let{prevDroppingShapeId:f}=this,g=f&&this.editor.getShape(f),b=h&&this.editor.getShape(h);if(g&&this.editor.getShapeUtil(g).onDragShapesOut?.(g,c),b){let t=this.editor.getShapeUtil(b).onDragShapesOver?.(b,c);t&&t.shouldHint&&this.editor.setHintingShapes([b.id])}else this.editor.setHintingShapes([]);u?.(),this.prevDroppingShapeId=h}dropShapes(t){let{prevDroppingShapeId:c}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,t),c){let u=this.editor.getShape(c);if(!u)return;this.editor.getShapeUtil(u).onDropShapesOver?.(u,t)}}clear(){this.prevDroppingShapeId=null,null!==this.droppingNodeTimer&&clearInterval(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}dispose=()=>{this.clear()}};let Translating=class Translating extends nx.n{static id="translating";info={};selectionSnapshot={};snapshot={};markId="";isCloning=!1;isCreating=!1;editAfterComplete=!1;dragAndDropManager=new DragAndDropManager(this.editor);onEnter=t=>{let{isCreating:c=!1,editAfterComplete:u=!1}=t;if(this.info=t,this.parent.currentToolIdMask=t.onInteractionEnd,this.isCreating=c,this.editAfterComplete=u,this.markId=c?`creating:${this.editor.onlySelectedShape.id}`:"translating",this.editor.mark(this.markId),this.isCloning=!1,this.info=t,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=getTranslatingSnapshot(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes(),this.editor.on("tick",this.updateParent)};onExit=()=>{this.parent.currentToolIdMask=void 0,this.editor.off("tick",this.updateParent),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clear(),this.editor.updateInstanceState({cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.dragAndDropManager.clear()};onPointerMove=()=>{this.updateShapes()};onKeyDown=()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()};onKeyUp=()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()};onPointerUp=()=>{this.complete()};onComplete=()=>{this.complete()};onCancel=()=>{this.cancel()};startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.selectedShapeIds)),this.snapshot=getTranslatingSnapshot(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}updateParent=()=>{let{snapshot:t}=this;this.dragAndDropManager.updateDroppingNode(t.movingShapes,this.updateParentTransforms)};reset(){this.editor.bailToMark(this.markId)}complete(){if(this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),this.handleEnd(),this.editor.instanceState.isToolLocked&&this.info.onInteractionEnd)this.editor.setCurrentTool(this.info.onInteractionEnd);else if(this.editAfterComplete){let t=this.editor.onlySelectedShape;t&&(this.editor.setEditingShape(t.id),this.editor.setCurrentTool("select.editing_shape"))}else this.parent.transition("idle",{})}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){let{movingShapes:t}=this.snapshot,c=[];t.forEach(t=>{let u=this.editor.getShapeUtil(t),h=u.onTranslateStart?.(t);h&&c.push(h)}),c.length>0&&this.editor.updateShapes(c),this.editor.setHoveredShape(null)}handleEnd(){let{movingShapes:t}=this.snapshot,c=[];t.forEach(t=>{let u=this.editor.getShape(t.id),h=this.editor.getShapeUtil(t),f=h.onTranslateEnd?.(t,u);f&&c.push(f)}),c.length>0&&this.editor.updateShapes(c)}handleChange(){let{movingShapes:t}=this.snapshot,c=[];t.forEach(t=>{let u=this.editor.getShape(t.id),h=this.editor.getShapeUtil(t),f=h.onTranslate?.(t,u);f&&c.push(f)}),c.length>0&&this.editor.updateShapes(c)}updateShapes(){let{snapshot:t}=this;this.dragAndDropManager.updateDroppingNode(t.movingShapes,this.updateParentTransforms),moveShapesToPoint({editor:this.editor,shapeSnapshots:t.shapeSnapshots,averagePagePoint:t.averagePagePoint,initialSelectionPageBounds:t.initialPageBounds,initialSelectionSnapPoints:t.initialSnapPoints}),this.handleChange()}updateParentTransforms=()=>{let{editor:t,snapshot:{shapeSnapshots:c}}=this,u=[];c.forEach(c=>{let h=t.getShape(c.shape.id);if(!h)return null;u.push(h);let f=(0,e0.r5)(h.parentId)?null:t$.y.Inverse(t.getShapePageTransform(h.parentId));c.parentTransform=f})}};function getTranslatingSnapshot(t){let c=[],u=[],h=(0,e1.oA)(t.selectedShapeIds.map(h=>{let f=t.getShape(h);if(!f)return null;c.push(f);let g=t.getShapePageTransform(h).point();if(!g)return null;u.push(g);let b=e0.ez.isId(f.parentId)?null:t$.y.Inverse(t.getShapePageTransform(f.parentId));return{shape:f,pagePoint:g,parentTransform:b}}));return{averagePagePoint:tn.G.Average(u),movingShapes:c,shapeSnapshots:h,initialPageBounds:t.selectionPageBounds,initialSnapPoints:1===t.selectedShapeIds.length?t.snaps.snapPointsCache.get(t.selectedShapeIds[0]):t.selectionPageBounds?t.selectionPageBounds.snapPoints.map((t,c)=>({id:"selection:"+c,x:t.x,y:t.y})):[]}}function moveShapesToPoint({editor:t,shapeSnapshots:c,averagePagePoint:u,initialSelectionPageBounds:h,initialSelectionSnapPoints:f}){let{inputs:g,instanceState:{isGridMode:b},documentSettings:{gridSize:v}}=t,x=tn.G.Sub(g.currentPagePoint,g.originPagePoint),w=t.inputs.shiftKey?Math.abs(x.x)<Math.abs(x.y)?"x":"y":null;"x"===w?x.x=0:"y"===w&&(x.y=0),t.snaps.clear();let _=(t.user.isSnapMode?!g.ctrlKey:g.ctrlKey)&&.5>t.inputs.pointerVelocity.len();if(_){let{nudge:c}=t.snaps.snapTranslate({dragDelta:x,initialSelectionPageBounds:h,lockedAxis:w,initialSelectionSnapPoints:f});x.add(c)}let k=tn.G.Add(u,x);b&&!g.ctrlKey&&k.snapToGrid(v);let E=tn.G.Sub(k,u);t.updateShapes((0,e1.oA)(c.map(({shape:t,pagePoint:c,parentTransform:u})=>{let h=tn.G.Add(c,E),f=u?t$.y.applyToPoint(u,h):h;return{id:t.id,type:t.type,x:f.x,y:f.y}})),{squashing:!0})}let SelectTool=class SelectTool extends nx.n{static id="select";static initial="idle";static children=()=>[Crop,Cropping,SelectTool_children_Idle_Idle,PointingCanvas,PointingShape,Translating,Brushing,ScribbleBrushing,PointingCropHandle,PointingSelection,PointingResizeHandle,EditingShape,Resizing,Rotating,PointingRotateHandle,PointingHandle,DraggingHandle];onExit=()=>{this.editor.currentPageState.editingShapeId&&this.editor.setEditingShape(null)}};let ZoomTool_children_Idle_Idle=class ZoomTool_children_Idle_Idle extends nx.n{static id="idle";info={};onEnter=t=>{this.info=t};onPointerDown=()=>{this.parent.transition("pointing",this.info)}};let ZoomTool_children_Pointing_Pointing=class ZoomTool_children_Pointing_Pointing extends nx.n{static id="pointing";info={};onEnter=t=>{this.info=t};onPointerUp=()=>{this.complete()};onPointerMove=()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)};onCancel=()=>{this.cancel()};complete(){let{currentScreenPoint:t}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(t,{duration:220}):this.editor.zoomIn(t,{duration:220}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}};let ZoomBrushing=class ZoomBrushing extends nx.n{static id="zoom_brushing";info={};zoomBrush=new nS.No;onEnter=t=>{this.info=t,this.update()};onExit=()=>{this.editor.updateInstanceState({zoomBrush:null})};onPointerMove=()=>{this.update()};onPointerUp=()=>{this.complete()};onCancel=()=>{this.cancel()};update(){let{inputs:{originPagePoint:t,currentPagePoint:c}}=this.editor;this.zoomBrush.setTo(nS.No.FromPoints([t,c])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){let{zoomBrush:t}=this,c=8/this.editor.zoomLevel;if(t.width<c&&t.height<c){let t=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(t,{duration:220}):this.editor.zoomIn(t,{duration:220})}else{let c=this.editor.inputs.altKey?this.editor.zoomLevel/2:void 0;this.editor.zoomToBounds(t,c,{duration:220})}this.parent.transition("idle",this.info)}};let ZoomTool=class ZoomTool extends nx.n{static id="zoom";static initial="idle";static children=()=>[ZoomTool_children_Idle_Idle,ZoomBrushing,ZoomTool_children_Pointing_Pointing];info={};onEnter=t=>{this.info=t,this.currentToolIdMask=t.onInteractionEnd,this.updateCursor()};onExit=()=>{this.currentToolIdMask=void 0,this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}},{ephemeral:!0}),this.currentToolIdMask=void 0};onKeyDown=()=>{this.updateCursor()};onKeyUp=t=>{this.updateCursor(),"KeyZ"===t.code&&this.complete()};onInterrupt=()=>{this.complete()};complete(){this.info.onInteractionEnd&&"select"!==this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select",{})}updateCursor(){this.editor.inputs.altKey?this.editor.updateInstanceState({cursor:{type:"zoom-out",rotation:0}},{ephemeral:!0}):this.editor.updateInstanceState({cursor:{type:"zoom-in",rotation:0}},{ephemeral:!0})}};let i9=[EraserTool,HandTool,LaserTool,ZoomTool,SelectTool],oe=(0,U.forwardRef)((t,c)=>(0,U.createElement)(ee.span,_extends({},t,{ref:c,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}))),ot="ToastProvider",[on,or,oi]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2("Toast"),[oo,oa]=$c512c27ab02ef895$export$50c7b4e9d9f19c1("Toast",[oi]),[os,ol]=oo(ot),$054eb8030ebde76e$export$f5d03d415824e0e=t=>{let{__scopeToast:c,label:u="Notification",duration:h=5e3,swipeDirection:f="right",swipeThreshold:g=50,children:b}=t,[v,x]=(0,U.useState)(null),[w,_]=(0,U.useState)(0),k=(0,U.useRef)(!1),E=(0,U.useRef)(!1);return(0,U.createElement)(on.Provider,{scope:c},(0,U.createElement)(os,{scope:c,label:u,duration:h,swipeDirection:f,swipeThreshold:g,toastCount:w,viewport:v,onViewportChange:x,onToastAdd:(0,U.useCallback)(()=>_(t=>t+1),[]),onToastRemove:(0,U.useCallback)(()=>_(t=>t-1),[]),isFocusedToastEscapeKeyDownRef:k,isClosePausedRef:E},b))};$054eb8030ebde76e$export$f5d03d415824e0e.propTypes={label(t){if(t.label&&"string"==typeof t.label&&!t.label.trim()){let t=`Invalid prop \`label\` supplied to \`${ot}\`. Expected non-empty \`string\`.`;return Error(t)}return null}};let oc=["F8"],ou="toast.viewportPause",od="toast.viewportResume",op=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,hotkey:h=oc,label:f="Notifications ({hotkey})",...g}=t,b=ol("ToastViewport",u),v=or(u),x=(0,U.useRef)(null),w=(0,U.useRef)(null),_=(0,U.useRef)(null),k=(0,U.useRef)(null),E=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,k,b.onViewportChange),$=h.join("+").replace(/Key/g,"").replace(/Digit/g,""),T=b.toastCount>0;(0,U.useEffect)(()=>{let handleKeyDown=t=>{var c;let u=h.every(c=>t[c]||t.code===c);u&&(null===(c=k.current)||void 0===c||c.focus())};return document.addEventListener("keydown",handleKeyDown),()=>document.removeEventListener("keydown",handleKeyDown)},[h]),(0,U.useEffect)(()=>{let t=x.current,c=k.current;if(T&&t&&c){let handlePause=()=>{if(!b.isClosePausedRef.current){let t=new CustomEvent(ou);c.dispatchEvent(t),b.isClosePausedRef.current=!0}},handleResume=()=>{if(b.isClosePausedRef.current){let t=new CustomEvent(od);c.dispatchEvent(t),b.isClosePausedRef.current=!1}},handleFocusOutResume=c=>{let u=!t.contains(c.relatedTarget);u&&handleResume()},handlePointerLeaveResume=()=>{let c=t.contains(document.activeElement);c||handleResume()};return t.addEventListener("focusin",handlePause),t.addEventListener("focusout",handleFocusOutResume),t.addEventListener("pointermove",handlePause),t.addEventListener("pointerleave",handlePointerLeaveResume),window.addEventListener("blur",handlePause),window.addEventListener("focus",handleResume),()=>{t.removeEventListener("focusin",handlePause),t.removeEventListener("focusout",handleFocusOutResume),t.removeEventListener("pointermove",handlePause),t.removeEventListener("pointerleave",handlePointerLeaveResume),window.removeEventListener("blur",handlePause),window.removeEventListener("focus",handleResume)}}},[T,b.isClosePausedRef]);let I=(0,U.useCallback)(({tabbingDirection:t})=>{let c=v(),u=c.map(c=>{let u=c.ref.current,h=[u,...$054eb8030ebde76e$var$getTabbableCandidates(u)];return"forwards"===t?h:h.reverse()});return("forwards"===t?u.reverse():u).flat()},[v]);return(0,U.useEffect)(()=>{let t=k.current;if(t){let handleKeyDown=c=>{let u=c.altKey||c.ctrlKey||c.metaKey,h="Tab"===c.key&&!u;if(h){var f,g,b;let u=document.activeElement,h=c.shiftKey,v=c.target===t;if(v&&h){null===(f=w.current)||void 0===f||f.focus();return}let x=I({tabbingDirection:h?"backwards":"forwards"}),k=x.findIndex(t=>t===u);$054eb8030ebde76e$var$focusFirst(x.slice(k+1))?c.preventDefault():h?null===(g=w.current)||void 0===g||g.focus():null===(b=_.current)||void 0===b||b.focus()}};return t.addEventListener("keydown",handleKeyDown),()=>t.removeEventListener("keydown",handleKeyDown)}},[v,I]),(0,U.createElement)(ei,{ref:x,role:"region","aria-label":f.replace("{hotkey}",$),tabIndex:-1,style:{pointerEvents:T?void 0:"none"}},T&&(0,U.createElement)(oh,{ref:w,onFocusFromOutsideViewport:()=>{let t=I({tabbingDirection:"forwards"});$054eb8030ebde76e$var$focusFirst(t)}}),(0,U.createElement)(on.Slot,{scope:u},(0,U.createElement)(ee.ol,_extends({tabIndex:-1},g,{ref:E}))),T&&(0,U.createElement)(oh,{ref:_,onFocusFromOutsideViewport:()=>{let t=I({tabbingDirection:"backwards"});$054eb8030ebde76e$var$focusFirst(t)}}))}),oh=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,onFocusFromOutsideViewport:h,...f}=t,g=ol("ToastFocusProxy",u);return(0,U.createElement)(oe,_extends({"aria-hidden":!0,tabIndex:0},f,{ref:c,style:{position:"fixed"},onFocus:t=>{var c;let u=t.relatedTarget,f=!(null!==(c=g.viewport)&&void 0!==c&&c.contains(u));f&&h()}}))}),of="Toast",og=(0,U.forwardRef)((t,c)=>{let{forceMount:u,open:h,defaultOpen:f,onOpenChange:g,...b}=t,[v=!0,x]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:h,defaultProp:f,onChange:g});return(0,U.createElement)($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:u||v},(0,U.createElement)(oy,_extends({open:v},b,{ref:c,onClose:()=>x(!1),onPause:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t.onPause),onResume:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t.onResume),onSwipeStart:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onSwipeStart,t=>{t.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onSwipeMove,t=>{let{x:c,y:u}=t.detail.delta;t.currentTarget.setAttribute("data-swipe","move"),t.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${c}px`),t.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${u}px`)}),onSwipeCancel:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onSwipeCancel,t=>{t.currentTarget.setAttribute("data-swipe","cancel"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),t.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),t.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onSwipeEnd,t=>{let{x:c,y:u}=t.detail.delta;t.currentTarget.setAttribute("data-swipe","end"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),t.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),t.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${c}px`),t.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${u}px`),x(!1)})})))}),[om,ob]=oo(of,{onClose(){}}),oy=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,type:h="foreground",duration:f,open:g,onClose:b,onEscapeKeyDown:v,onPause:x,onResume:w,onSwipeStart:_,onSwipeMove:k,onSwipeCancel:E,onSwipeEnd:$,...T}=t,I=ol(of,u),[M,j]=(0,U.useState)(null),D=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>j(t)),F=(0,U.useRef)(null),L=(0,U.useRef)(null),B=f||I.duration,G=(0,U.useRef)(0),V=(0,U.useRef)(B),K=(0,U.useRef)(0),{onToastAdd:Z,onToastRemove:Y}=I,J=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(()=>{var t;let c=null==M?void 0:M.contains(document.activeElement);c&&(null===(t=I.viewport)||void 0===t||t.focus()),b()}),Q=(0,U.useCallback)(t=>{t&&t!==1/0&&(window.clearTimeout(K.current),G.current=new Date().getTime(),K.current=window.setTimeout(J,t))},[J]);(0,U.useEffect)(()=>{let t=I.viewport;if(t){let handleResume=()=>{Q(V.current),null==w||w()},handlePause=()=>{let t=new Date().getTime()-G.current;V.current=V.current-t,window.clearTimeout(K.current),null==x||x()};return t.addEventListener(ou,handlePause),t.addEventListener(od,handleResume),()=>{t.removeEventListener(ou,handlePause),t.removeEventListener(od,handleResume)}}},[I.viewport,B,x,w,Q]),(0,U.useEffect)(()=>{g&&!I.isClosePausedRef.current&&Q(B)},[g,B,I.isClosePausedRef,Q]),(0,U.useEffect)(()=>(Z(),()=>Y()),[Z,Y]);let et=(0,U.useMemo)(()=>M?$054eb8030ebde76e$var$getAnnounceTextContent(M):null,[M]);return I.viewport?(0,U.createElement)(U.Fragment,null,et&&(0,U.createElement)($054eb8030ebde76e$var$ToastAnnounce,{__scopeToast:u,role:"status","aria-live":"foreground"===h?"assertive":"polite","aria-atomic":!0},et),(0,U.createElement)(om,{scope:u,onClose:J},(0,X.createPortal)((0,U.createElement)(on.ItemSlot,{scope:u},(0,U.createElement)(er,{asChild:!0,onEscapeKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(v,()=>{I.isFocusedToastEscapeKeyDownRef.current||J(),I.isFocusedToastEscapeKeyDownRef.current=!1})},(0,U.createElement)(ee.li,_extends({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":g?"open":"closed","data-swipe-direction":I.swipeDirection},T,{ref:D,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,t=>{"Escape"!==t.key||(null==v||v(t.nativeEvent),t.nativeEvent.defaultPrevented||(I.isFocusedToastEscapeKeyDownRef.current=!0,J()))}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDown,t=>{0===t.button&&(F.current={x:t.clientX,y:t.clientY})}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerMove,t=>{if(!F.current)return;let c=t.clientX-F.current.x,u=t.clientY-F.current.y,h=!!L.current,f=["left","right"].includes(I.swipeDirection),g=["left","up"].includes(I.swipeDirection)?Math.min:Math.max,b=f?g(0,c):0,v=f?0:g(0,u),x="touch"===t.pointerType?10:2,w={x:b,y:v},E={originalEvent:t,delta:w};h?(L.current=w,$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeMove",k,E,{discrete:!1})):$054eb8030ebde76e$var$isDeltaInDirection(w,I.swipeDirection,x)?(L.current=w,$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeStart",_,E,{discrete:!1}),t.target.setPointerCapture(t.pointerId)):(Math.abs(c)>x||Math.abs(u)>x)&&(F.current=null)}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerUp,t=>{let c=L.current,u=t.target;if(u.hasPointerCapture(t.pointerId)&&u.releasePointerCapture(t.pointerId),L.current=null,F.current=null,c){let u=t.currentTarget,h={originalEvent:t,delta:c};$054eb8030ebde76e$var$isDeltaInDirection(c,I.swipeDirection,I.swipeThreshold)?$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeEnd",$,h,{discrete:!0}):$054eb8030ebde76e$var$handleAndDispatchCustomEvent("toast.swipeCancel",E,h,{discrete:!0}),u.addEventListener("click",t=>t.preventDefault(),{once:!0})}})})))),I.viewport))):null});oy.propTypes={type(t){if(t.type&&!["foreground","background"].includes(t.type)){let t=`Invalid prop \`type\` supplied to \`${of}\`. Expected \`foreground | background\`.`;return Error(t)}return null}};let $054eb8030ebde76e$var$ToastAnnounce=t=>{let{__scopeToast:c,children:u,...h}=t,f=ol(of,c),[g,b]=(0,U.useState)(!1),[v,x]=(0,U.useState)(!1);return $054eb8030ebde76e$var$useNextFrame(()=>b(!0)),(0,U.useEffect)(()=>{let t=window.setTimeout(()=>x(!0),1e3);return()=>window.clearTimeout(t)},[]),v?null:(0,U.createElement)(eu,{asChild:!0},(0,U.createElement)(oe,h,g&&(0,U.createElement)(U.Fragment,null,f.label," ",u)))},ov=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,...h}=t;return(0,U.createElement)(ee.div,_extends({},h,{ref:c}))}),ox=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,...h}=t;return(0,U.createElement)(ee.div,_extends({},h,{ref:c}))}),ow=(0,U.forwardRef)((t,c)=>{let{altText:u,...h}=t;return u?(0,U.createElement)(o_,{altText:u,asChild:!0},(0,U.createElement)(oS,_extends({},h,{ref:c}))):null});ow.propTypes={altText:t=>t.altText?null:Error("Missing prop `altText` expected on `ToastAction`")};let oS=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,...h}=t,f=ob("ToastClose",u);return(0,U.createElement)(o_,{asChild:!0},(0,U.createElement)(ee.button,_extends({type:"button"},h,{ref:c,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onClick,f.onClose)})))}),o_=(0,U.forwardRef)((t,c)=>{let{__scopeToast:u,altText:h,...f}=t;return(0,U.createElement)(ee.div,_extends({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":h||void 0},f,{ref:c}))});function $054eb8030ebde76e$var$getAnnounceTextContent(t){let c=[],u=Array.from(t.childNodes);return u.forEach(t=>{if(t.nodeType===t.TEXT_NODE&&t.textContent&&c.push(t.textContent),$054eb8030ebde76e$var$isHTMLElement(t)){let u=t.ariaHidden||t.hidden||"none"===t.style.display,h=""===t.dataset.radixToastAnnounceExclude;if(!u){if(h){let u=t.dataset.radixToastAnnounceAlt;u&&c.push(u)}else c.push(...$054eb8030ebde76e$var$getAnnounceTextContent(t))}}}),c}function $054eb8030ebde76e$var$handleAndDispatchCustomEvent(t,c,u,{discrete:h}){let f=u.originalEvent.currentTarget,g=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:u});c&&f.addEventListener(t,c,{once:!0}),h?$8927f6f2acc4f386$export$6d1a0317bde7de7f(f,g):f.dispatchEvent(g)}let $054eb8030ebde76e$var$isDeltaInDirection=(t,c,u=0)=>{let h=Math.abs(t.x),f=Math.abs(t.y),g=h>f;return"left"===c||"right"===c?g&&h>u:!g&&f>u};function $054eb8030ebde76e$var$useNextFrame(t=()=>{}){let c=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t);K(()=>{let t=0,u=0;return t=window.requestAnimationFrame(()=>u=window.requestAnimationFrame(c)),()=>{window.cancelAnimationFrame(t),window.cancelAnimationFrame(u)}},[c])}function $054eb8030ebde76e$var$isHTMLElement(t){return t.nodeType===t.ELEMENT_NODE}function $054eb8030ebde76e$var$getTabbableCandidates(t){let c=[],u=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{let c="INPUT"===t.tagName&&"hidden"===t.type;return t.disabled||t.hidden||c?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;u.nextNode();)c.push(u.currentNode);return c}function $054eb8030ebde76e$var$focusFirst(t){let c=document.activeElement;return t.some(t=>t===c||(t.focus(),document.activeElement!==c))}let ok="2.0.0-alpha.17",oC={fonts:{draw:`https://unpkg.com/@tldraw/assets@${ok}/fonts/Shantell_Sans-Normal-SemiBold.woff2`,serif:`https://unpkg.com/@tldraw/assets@${ok}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`https://unpkg.com/@tldraw/assets@${ok}/fonts/IBMPlexSans-Medium.woff2`,monospace:`https://unpkg.com/@tldraw/assets@${ok}/fonts/IBMPlexMono-Medium.woff2`}};function setDefaultEditorAssetUrls(t){oC=t}function useDefaultEditorAssetsWithOverrides(t){return(0,U.useMemo)(()=>t?{fonts:{...oC.fonts,...t?.fonts}}:oC,[t])}let oP={...oC,icons:Object.fromEntries(["align-bottom-center","align-bottom-left","align-bottom-right","align-bottom","align-center-center","align-center-horizontal","align-center-left","align-center-right","align-center-vertical","align-left","align-right","align-top-center","align-top-left","align-top-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","aspect-ratio","avatar","blob","bring-forward","bring-to-front","check","checkbox-checked","checkbox-empty","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","code","collab","color","comment","cross-2","cross","dash-dashed","dash-dotted","dash-draw","dash-solid","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","file","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","hidden","image","info-circle","leading","link","lock-small","lock","menu","minus","mixed","pack","page","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","ruler","search","send-backward","send-to-back","settings-horizontal","settings-vertical-1","settings-vertical","share-1","share-2","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","status-online","stretch-horizontal","stretch-vertical","text-align-center","text-align-justify","text-align-left","text-align-right","tool-arrow","tool-embed","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-text","trash","triangle-down","triangle-up","twitter","undo","ungroup","unlock-small","unlock","vertical-align-center","vertical-align-end","vertical-align-start","visible","warning-triangle","zoom-in","zoom-out"].map(t=>[t,`https://unpkg.com/@tldraw/assets@${ok}/icons/icon/${t}.svg`])),translations:Object.fromEntries(e0.a2.map(t=>[t.locale,`https://unpkg.com/@tldraw/assets@${ok}/translations/${t.locale}.json`])),embedIcons:Object.fromEntries(e0.Lu.map(t=>[t.type,`https://unpkg.com/@tldraw/assets@${ok}/embed-icons/${t.type}.png`]))};function setDefaultUiAssetUrls(t){oP=t}function useDefaultUiAssetUrlsWithOverrides(t){return t?{fonts:Object.assign({...oP.fonts},{...t?.fonts}),icons:Object.assign({...oP.icons},{...t?.icons}),embedIcons:Object.assign({...oP.embedIcons},{...t?.embedIcons}),translations:Object.assign({...oP.translations},{...t?.translations})}:oP}let oE=U.forwardRef(function({className:t,label:c,icon:u,iconLeft:h,autoselect:f=!1,autofocus:g=!1,defaultValue:b,placeholder:v,onComplete:x,onValueChange:w,onCancel:_,onBlur:k,shouldManuallyMaintainScrollPositionWhenFocused:E=!1,children:$,value:T},I){let M=(0,e8.j)(),j=U.useRef(null);U.useImperativeHandle(I,()=>j.current);let D=useTranslation(),F=U.useRef(b??""),L=U.useRef(b??""),[B,V]=U.useState(!1),K=U.useCallback(t=>{V(!0);let c=t.currentTarget;L.current=c.value,requestAnimationFrame(()=>{f&&c.select()})},[f]),Z=U.useCallback(t=>{let c=t.currentTarget.value;L.current=c,w?.(c)},[w]),Y=U.useCallback(t=>{switch(t.key){case"Enter":t.currentTarget.blur(),stopEventPropagation(t),x?.(t.currentTarget.value);break;case"Escape":t.currentTarget.value=F.current,t.currentTarget.blur(),stopEventPropagation(t),_?.(t.currentTarget.value)}},[x,_]),X=U.useCallback(t=>{V(!1);let c=t.currentTarget.value;k?.(c)},[k]);return U.useEffect(()=>{if(!M.environment.isIos)return;let t=window.visualViewport;if(B&&E&&t){let onViewportChange=()=>{j.current?.scrollIntoView({block:"center"})};return t.addEventListener("resize",onViewportChange),t.addEventListener("scroll",onViewportChange),requestAnimationFrame(()=>{j.current?.scrollIntoView({block:"center"})}),()=>{t.removeEventListener("resize",onViewportChange),t.removeEventListener("scroll",onViewportChange)}}},[M,B,E]),(0,G.jsxs)("div",{draggable:!1,className:"tlui-input__wrapper",children:[$,c&&(0,G.jsx)("label",{children:D(c)}),h&&(0,G.jsx)(nz,{icon:h,className:"tlui-icon-left",small:!0}),(0,G.jsx)("input",{ref:j,className:eX("tlui-input",t),type:"text",defaultValue:b,onKeyUp:Y,onChange:Z,onFocus:K,onBlur:X,autoFocus:g,placeholder:v,value:T}),u&&(0,G.jsx)(nz,{icon:u,small:!!c})]})});function validateUrl(t){return(0,e1.jv)(t)?{isValid:!0,hasProtocol:!0}:(0,e1.jv)("https://"+t)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}let o$=(0,eJ.j)(function({onClose:t}){let c=(0,e8.j)(),u=c.onlySelectedShape;return u&&"url"in u.props&&"string"==typeof u.props.url?(0,G.jsx)(oT,{onClose:t,selectedShape:u}):null}),oT=(0,eJ.j)(function({onClose:t,selectedShape:c}){let u=(0,e8.j)(),h=useTranslation(),f=(0,U.useRef)(null);(0,U.useEffect)(()=>{requestAnimationFrame(()=>f.current?.focus())},[]);let g=(0,U.useRef)(c.props.url),[b,v]=(0,U.useState)(()=>{let t=validateUrl(c.props.url),u=!0===t.isValid?t.hasProtocol?c.props.url:"https://"+c.props.url:"https://";return{actual:u,safe:u,valid:!0}}),x=(0,U.useCallback)(t=>{let c=t.replace(/https?:\/\/(https?:\/\/)/,(t,c)=>c),u=validateUrl(c),h=!0===u.isValid?u.hasProtocol?c:"https://"+c:"https://";v({actual:c,safe:h,valid:u.isValid})},[]),w=(0,U.useCallback)(()=>{let{onlySelectedShape:c}=u;c&&(u.updateShapes([{id:c.id,type:c.type,props:{url:""}}]),t())},[u,t]),_=(0,U.useCallback)(()=>{let{onlySelectedShape:c}=u;c&&(c&&"url"in c.props&&c.props.url!==b.safe&&u.updateShapes([{id:c.id,type:c.type,props:{url:b.safe}}]),t())},[u,t,b]),k=(0,U.useCallback)(()=>{t()},[t]);if(!c)return t(),null;let E=g.current&&!b.valid;return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(Header,{children:[(0,G.jsx)(Title,{children:h("edit-link-dialog.title")}),(0,G.jsx)(CloseButton,{})]}),(0,G.jsx)(Body,{children:(0,G.jsxs)("div",{className:"tlui-edit-link-dialog",children:[(0,G.jsx)(oE,{ref:f,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autofocus:!0,value:b.actual,onValueChange:x,onComplete:_,onCancel:k}),(0,G.jsx)("div",{children:h(b.valid?"edit-link-dialog.detail":"edit-link-dialog.invalid-url")})]})}),(0,G.jsxs)(Footer,{className:"tlui-dialog__footer__actions",children:[(0,G.jsx)(nU,{onClick:k,onTouchEnd:k,children:h("edit-link-dialog.cancel")}),E?(0,G.jsx)(nU,{type:"danger",onTouchEnd:w,onClick:w,children:h("edit-link-dialog.clear")}):(0,G.jsx)(nU,{type:"primary",disabled:!b.valid,onTouchEnd:_,onClick:_,children:h("edit-link-dialog.save")})]})]})}),oI=(0,eJ.j)(function({onClose:t}){let c=(0,e8.j)(),u=useTranslation(),h=useAssetUrls(),[f,g]=(0,U.useState)(null),[b,v]=(0,U.useState)(""),[x,w]=(0,U.useState)(null),[_,k]=(0,U.useState)(!1),E=(0,U.useRef)(-1);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(Header,{children:[(0,G.jsx)(Title,{children:f?`${u("embed-dialog.title")} \u2014 ${f.title}`:u("embed-dialog.title")}),(0,G.jsx)(CloseButton,{})]}),f?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(Body,{className:"tlui-embed-dialog__enter",children:[(0,G.jsx)(oE,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autofocus:!0,onValueChange:t=>{v(t);let c=getEmbedInfo(t);w(c&&c.definition.type===f.type?c:null),k(!1),clearTimeout(E.current),E.current=setTimeout(()=>k(!c),320)}}),""===b?(0,G.jsxs)("div",{className:"tlui-embed-dialog__instruction",children:[(0,G.jsx)("span",{children:u("embed-dialog.instruction")})," ",f.instructionLink&&(0,G.jsxs)("a",{target:"_blank",rel:"noopener noreferrer",href:f.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",(0,G.jsx)(nz,{icon:"external-link",small:!0})]})]}):(0,G.jsx)("div",{className:"tlui-embed-dialog__warning",children:_?u("embed-dialog.invalid-url"):"\xa0"})]}),(0,G.jsxs)(Footer,{className:"tlui-dialog__footer__actions",children:[(0,G.jsx)(nU,{onClick:()=>{g(null),w(null),v("")},label:"embed-dialog.back"}),(0,G.jsx)("div",{className:"tlui-embed__spacer"}),(0,G.jsx)(nU,{label:"embed-dialog.cancel",onClick:t}),(0,G.jsx)(nU,{type:"primary",disabled:!x,label:"embed-dialog.create",onClick:()=>{x&&(c.putExternalContent({type:"embed",url:b,point:c.viewportPageCenter,embed:x.definition}),t())}})]})]}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(Body,{className:"tlui-embed-dialog__list",children:e0.Lu.map(t=>(0,G.jsxs)("button",{className:"tlui-embed-dialog__item",onClick:()=>g(t),children:[(0,G.jsx)("div",{className:"tlui-embed-dialog__item__image",children:(0,G.jsx)("div",{className:"tlui-embed-dialog__item__image__img",style:{backgroundImage:`url(${h.embedIcons[t.type]})`}})}),(0,G.jsx)("div",{className:"tlui-embed-dialog__item__title",children:t.title})]},t.type))}),(0,G.jsx)("div",{className:"tlui-dialog__scrim"})]})]})});var oA=u(352);async function pasteExcalidrawContent(t,c,u){let{elements:h,files:f}=c,g={shapes:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},b=new Map,v=new Map,{currentPageId:x}=t,w=new Map,_=[],k=new Set;h.forEach(t=>{if(w.set(t.id,(0,e0.F1)()),null!==t.boundElements)for(let c of t.boundElements)"text"===c.type&&k.add(c.id)});let E="a1";for(let t of h){if(k.has(t.id))continue;let c=w.get(t.id),u={id:c,typeName:"shape",parentId:x,index:E,x:t.x,y:t.y,rotation:0,isLocked:t.locked,opacity:getOpacity(t.opacity),meta:{}};switch(0!==t.angle&&v.set(c,t.angle),t.groupIds&&t.groupIds.length>0?b.has(t.groupIds[0])?b.get(t.groupIds[0])?.push(c):b.set(t.groupIds[0],[c]):_.push(c),t.type){case"rectangle":case"ellipse":case"diamond":{let c="",f="middle";if(null!==t.boundElements){for(let u of t.boundElements)if("text"===u.type){let t=h.find(t=>t.id===u.id);t&&(c=t.text,f=oL[t.textAlign])}}let b="transparent"===t.backgroundColor?t.strokeColor:t.backgroundColor;g.shapes.push({...u,type:"geo",props:{geo:t.type,url:t.link??"",w:t.width,h:t.height,size:oM[t.strokeWidth]??"draw",color:oO[b]??"black",text:c,align:f,dash:getDash(t),fill:getFill(t)}});break}case"freedraw":g.shapes.push({...u,type:"draw",props:{dash:getDash(t),size:oM[t.strokeWidth],color:oO[t.strokeColor]??"black",segments:[{type:"free",points:t.points.map(([t,c,u=.5])=>({x:t,y:c,z:u}))}]}});break;case"line":{let c=t.points[0],h=t.points[t.points.length-1],f=(0,nj.H$)(t.points.length);g.shapes.push({...u,type:"line",props:{dash:getDash(t),size:oM[t.strokeWidth],color:oO[t.strokeColor]??"black",spline:t.roundness?"cubic":"line",handles:{start:{id:"start",type:"vertex",index:f[0],x:c[0],y:c[1]},end:{id:"end",type:"vertex",index:f[f.length-1],x:h[0],y:h[1]},...Object.fromEntries(t.points.slice(1,-1).map(([t,c],u)=>{let h=(0,tK.E)();return[h,{id:h,type:"vertex",index:f[u+1],x:t,y:c}]}))}}});break}case"arrow":{let c="";if(null!==t.boundElements){for(let u of t.boundElements)if("text"===u.type){let t=h.find(t=>t.id===u.id);t&&(c=t.text)}}let f=t.points[0],b=t.points[t.points.length-1],v=w.get(t.startBinding?.elementId),x=w.get(t.endBinding?.elementId);g.shapes.push({...u,type:"arrow",props:{text:c,bend:getBend(t,f,b),dash:getDash(t),size:oM[t.strokeWidth]??"m",color:oO[t.strokeColor]??"black",start:v?{type:"binding",boundShapeId:v,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:f[0],y:f[1]},end:x?{type:"binding",boundShapeId:x,normalizedAnchor:{x:.5,y:.5},isExact:!1}:{type:"point",x:b[0],y:b[1]},arrowheadEnd:oN[t.endArrowhead]??"none",arrowheadStart:oN[t.startArrowhead]??"none"}});break}case"text":{let{size:c,scale:h}=getFontSizeAndScale(t.fontSize);g.shapes.push({...u,type:"text",props:{size:c,scale:h,font:oD[t.fontFamily]??"draw",color:oO[t.strokeColor]??"black",text:t.text,align:oL[t.textAlign]}});break}case"image":{let c=f[t.fileId];if(!c)break;let h=e0.Yk.createId();g.assets.push({id:h,typeName:"asset",type:"image",props:{w:t.width,h:t.height,name:t.id??"Untitled",isAnimated:!1,mimeType:c.mimeType,src:c.dataURL},meta:{}}),g.shapes.push({...u,type:"image",props:{w:t.width,h:t.height,assetId:h}})}}E=(0,nj._L)(E)}let $=u??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);for(let c of(t.mark("paste"),t.putContentOntoCurrentPage(g,{point:$,select:!1,preserveIds:!0}),b.values()))if(c.length>1){t.groupShapes(c);let u=t.getShape(c[0]);u?.parentId&&(0,e0.YT)(u.parentId)&&_.push(u.parentId)}for(let[c,u]of v)t.select(c),t.rotateShapesBy([c],u);let T=(0,e1.oA)(_.map(c=>t.getShape(c))),I=nS.No.Common(T.map(c=>t.getShapePageBounds(c))),M=t.viewportPageBounds.center;t.updateShapes(T.map(t=>{let c={x:(t.x??0)-(I.x+I.w/2),y:(t.y??0)-(I.y+I.h/2)};return{id:t.id,type:t.type,x:M.x+c.x,y:M.y+c.y}})),t.setSelectedShapes(_)}let getOpacity=t=>{let c=t/100;return c<.2?.1:c<.4?.25:c<.6?.5:c<.8?.75:1},oM={1:"s",2:"m",3:"l",4:"xl"},oj={16:"s",20:"m",28:"l",36:"xl"};function getFontSizeAndScale(t){let c=oj[t];return c?{size:c,scale:1}:t<16?{size:"s",scale:t/16}:t>36?{size:"xl",scale:t/36}:{size:"m",scale:1}}let oD={1:"draw",2:"sans",3:"mono"},oO={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},oF={solid:"draw",dashed:"dashed",dotted:"dotted"},oR={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},oL={left:"start",center:"middle",right:"end"},oN={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function getBend(t,c,u){let h=0;if(t.points.length>2){let f=new tn.G(c[0],c[1]),g=new tn.G(u[0],u[1]),b=new tn.G(t.points[1][0],t.points[1][1]),v=tn.G.Sub(g,f),x=tn.G.Per(v),w=tn.G.Med(g,f),_=tn.G.Sub(w,x),k=tn.G.Add(w,x),E=tn.G.NearestPointOnLineSegment(_,k,b,!1);h=tn.G.Dist(E,w),tn.G.Clockwise(E,g,w)&&(h*=-1)}return h}let getDash=t=>{let c=oF[t.strokeStyle]??"draw";return"draw"===c&&0===t.roughness&&(c="solid"),c},getFill=t=>"transparent"===t.backgroundColor?"none":oR[t.fillStyle]??"solid";async function pasteFiles(t,c,u,h){let f=await Promise.all(c.map(async t=>await (await fetch(t)).blob())),g=f.map(t=>new File([t],"tldrawFile",{type:t.type}));t.mark("paste"),await t.putExternalContent({type:"files",files:g,point:u,ignoreParent:!1,sources:h}),c.forEach(t=>URL.revokeObjectURL(t))}function pasteTldrawContent(t,c,u){let h=u??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.mark("paste"),t.putContentOntoCurrentPage(c,{point:h,select:!0})}async function pasteUrl(t,c,u,h){try{let u=await fetch(c);if(u.headers.get("content-type")?.match(/^image\//)){t.mark("paste"),pasteFiles(t,[c]);return}}catch(t){"Failed to fetch"!==t.message&&console.error(t)}return t.mark("paste"),await t.putExternalContent({type:"url",point:u,url:c,sources:h})}function stripHtml(t){let c=document.implementation.createHTMLDocument("");return c.documentElement.innerHTML=t.trim(),c.body.textContent||c.body.innerText||""}let isValidHttpURL=t=>{try{let c=new URL(t);return"http:"===c.protocol||"https:"===c.protocol}catch(t){return!1}},getValidHttpURLList=t=>{let c=t.split(/[\n\s]/);for(let t of c)try{let c=new URL(t);if(!("http:"===c.protocol||"https:"===c.protocol))return}catch(t){return}return tI(c)},isSvgText=t=>/^<svg/.test(t),oz=["input","select","textarea"];function disallowClipboardEvents(t){let{activeElement:c}=document;return t.isMenuOpen||c&&(c.getAttribute("contenteditable")||oz.indexOf(c.tagName.toLowerCase())>-1)}async function blobAsString(t){return new Promise((c,u)=>{let h=new FileReader;h.addEventListener("loadend",()=>{let t=h.result;c(t)}),h.addEventListener("error",()=>{u(h.error)}),h.readAsText(t)})}let isFile=t=>t.types.find(t=>t.match(/^image\//)),handleText=(t,c,u,h)=>{let f=getValidHttpURLList(c);if(f)for(let c of f)pasteUrl(t,c,u);else isValidHttpURL(c)?pasteUrl(t,c,u):isSvgText(c)?(t.mark("paste"),t.putExternalContent({type:"svg-text",text:c,point:u,sources:h})):(t.mark("paste"),t.putExternalContent({type:"text",text:c,point:u,sources:h}))},handlePasteFromEventClipboardData=async(t,c,u)=>{if(null!==t.editingShapeId)return;if(!c)throw Error("No clipboard data");let h=[];for(let t of Object.values(c.items))switch(t.kind){case"file":h.push({type:"file",source:new Promise(c=>c(t.getAsFile()))});break;case"string":"text/html"===t.type?h.push({type:"html",source:new Promise(c=>t.getAsString(c))}):"text/plain"===t.type?h.push({type:"text",source:new Promise(c=>t.getAsString(c))}):h.push({type:t.type,source:new Promise(c=>t.getAsString(c))})}handleClipboardThings(t,h,u)},handlePasteFromClipboardApi=async(t,c,u)=>{let h=[];for(let t of c){if(isFile(t))for(let c of t.types)c.match(/^image\//)&&h.push({type:"blob",source:t.getType(c)});t.types.includes("text/html")&&h.push({type:"html",source:new Promise(c=>t.getType("text/html").then(t=>blobAsString(t).then(c)))}),t.types.includes("text/uri-list")&&h.push({type:"url",source:new Promise(c=>t.getType("text/uri-list").then(t=>blobAsString(t).then(c)))}),t.types.includes("text/plain")&&h.push({type:"text",source:new Promise(c=>t.getType("text/plain").then(t=>blobAsString(t).then(c)))})}return await handleClipboardThings(t,h,u)};async function handleClipboardThings(t,c,u){let h=c.filter(t=>("file"===t.type||"blob"===t.type)&&null!==t.source);if(h.length){let c=await Promise.all(h.map(t=>t.source)),f=c.filter(Boolean).map(t=>URL.createObjectURL(t));return await pasteFiles(t,f,u)}let f=await Promise.all(c.filter(t=>"file"!==t.type).map(t=>new Promise(c=>{if("file"===t.type){c({type:"error",data:null,reason:"unexpected file"});return}t.source.then(u=>{let h=u.match(/<tldraw[^>]*>(.*)<\/tldraw>/)?.[1];if(h)try{let t=(0,oA.decompressFromBase64)(h);if(null===t){c({type:"error",data:t,reason:"found tldraw data comment but could not parse base64"});return}{let u=JSON.parse(t);if("application/tldraw"!==u.type&&c({type:"error",data:u,reason:`found tldraw data comment but JSON was of a different type: ${u.type}`}),"string"==typeof u.data){c({type:"error",data:u,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}c({type:"tldraw",data:u.data});return}}catch(t){c({type:"error",data:h,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if("html"===t.type){c({type:"text",data:u,subtype:"html"});return}if("url"===t.type){c({type:"text",data:u,subtype:"url"});return}try{let t=JSON.parse(u);if("excalidraw/clipboard"===t.type){c({type:"excalidraw",data:t});return}c({type:"text",data:u,subtype:"json"});return}catch(t){c({type:"text",data:u,subtype:"text"});return}}c({type:"error",data:u,reason:"unhandled case"})})})));for(let c of f)if("tldraw"===c.type){pasteTldrawContent(t,c.data,u);return}for(let c of f)if("excalidraw"===c.type){pasteExcalidrawContent(t,c.data,u);return}for(let c of f)if("text"===c.type&&"html"===c.subtype){let h=new DOMParser().parseFromString(c.data,"text/html"),g=h.querySelector("body"),b=g&&1===Array.from(g.children).filter(t=>1===t.nodeType).length&&g.firstElementChild&&"A"===g.firstElementChild.tagName&&g.firstElementChild.hasAttribute("href")&&""!==g.firstElementChild.getAttribute("href");if(b){let c=g.firstElementChild.getAttribute("href");handleText(t,c,u,f);return}if(!f.some(t=>"text"===t.type&&"html"!==t.subtype)&&c.data.trim()){handleText(t,stripHtml(c.data),u,f);return}}for(let c of f)if("text"===c.type&&"url"===c.subtype){pasteUrl(t,c.data,u,f);return}for(let c of f)if("text"===c.type&&"text"===c.subtype&&c.data.trim()){handleText(t,c.data,u,f);return}}let handleNativeOrMenuCopy=t=>{let c=t.getContentFromCurrentPage(t.selectedShapeIds);if(!c){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}let u=(0,oA.compressToBase64)(JSON.stringify({type:"application/tldraw",kind:"content",data:c}));if("undefined"!=typeof navigator){let h=c.shapes.map(c=>t.isShapeOfType(c,"text")||t.isShapeOfType(c,"geo")||t.isShapeOfType(c,"arrow")?c.props.text:t.isShapeOfType(c,"bookmark")||t.isShapeOfType(c,"embed")?c.props.url:null).filter(e1.GT);if(navigator.clipboard?.write){let t=new Blob([`<tldraw>${u}</tldraw>`],{type:"text/html"}),c=h.join(" ");""===c&&(c=" "),navigator.clipboard.write([new ClipboardItem({"text/html":t,"text/plain":new Blob([c],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<tldraw>${u}</tldraw>`)}};function useMenuClipboardEvents(){let t=(0,e8.j)(),c=useUiEvents(),u=(0,U.useCallback)(function(u){0!==t.selectedShapeIds.length&&(handleNativeOrMenuCopy(t),c("copy",{source:u}))},[t,c]),h=(0,U.useCallback)(function(u){0!==t.selectedShapeIds.length&&(handleNativeOrMenuCopy(t),t.deleteShapes(t.selectedShapeIds),c("cut",{source:u}))},[t,c]),f=(0,U.useCallback)(async function(u,h,g){null!==t.editingShapeId||disallowClipboardEvents(t)||(Array.isArray(u)&&u[0]instanceof ClipboardItem?(handlePasteFromClipboardApi(t,u,g),c("paste",{source:"menu"})):navigator.clipboard.read().then(t=>{f(t,h,g)}))},[t,c]);return{copy:u,cut:h,paste:f}}function useNativeClipboardEvents(){let t=(0,e8.j)(),c=useUiEvents(),u=(0,eJ.Hg)("editor.isFocused",()=>t.instanceState.isFocused,[t]);(0,U.useEffect)(()=>{if(!u)return;let copy=()=>{0===t.selectedShapeIds.length||null!==t.editingShapeId||disallowClipboardEvents(t)||(handleNativeOrMenuCopy(t),c("copy",{source:"kbd"}))};function cut(){0===t.selectedShapeIds.length||null!==t.editingShapeId||disallowClipboardEvents(t)||(handleNativeOrMenuCopy(t),t.deleteShapes(t.selectedShapeIds),c("cut",{source:"kbd"}))}let h=!1,pointerUpHandler=t=>{1===t.button&&(h=!0,requestAnimationFrame(()=>{h=!1}))},paste=u=>{if(h){u.stopPropagation();return}null!==t.editingShapeId||disallowClipboardEvents(t)||(u.clipboardData&&!t.inputs.shiftKey?handlePasteFromEventClipboardData(t,u.clipboardData):navigator.clipboard.read().then(c=>{Array.isArray(c)&&c[0]instanceof ClipboardItem&&handlePasteFromClipboardApi(t,c,t.inputs.currentPagePoint)}),c("paste",{source:"kbd"}))};return document.addEventListener("copy",copy),document.addEventListener("cut",cut),document.addEventListener("paste",paste),document.addEventListener("pointerup",pointerUpHandler),()=>{document.removeEventListener("copy",copy),document.removeEventListener("cut",cut),document.removeEventListener("paste",paste),document.removeEventListener("pointerup",pointerUpHandler)}},[t,c,u])}function getSvgAsString(t){let c=t.cloneNode(!0);t.setAttribute("width",+t.getAttribute("width")+""),t.setAttribute("height",+t.getAttribute("height")+"");let u=new XMLSerializer().serializeToString(c).replaceAll("&#10;      ","").replaceAll(/((\s|")[0-9]*\.[0-9]{2})([0-9]*)(\b|"|\))/g,"$1");return u}async function getSvgAsImage(t,c){let{type:u,quality:h,scale:f}=c,g=+t.getAttribute("width"),b=+t.getAttribute("height"),v=g*f,x=b*f,w=await getSvgAsDataUrl(t),_=await getBrowserCanvasMaxSize();if(g>_.maxWidth&&(x=(v=_.maxWidth)/g*b),b>_.maxHeight&&(v=(x=_.maxHeight)/b*g),v*x>_.maxArea){let t=Math.sqrt(_.maxArea/(v*x));v*=t,x*=t}v=Math.floor(v),x=Math.floor(x);let k=v/g,E=await new Promise(t=>{let c=new Image;c.crossOrigin="anonymous",c.onload=async()=>{await new Promise(t=>setTimeout(t,250));let u=document.createElement("canvas"),h=u.getContext("2d");u.width=v,u.height=x,h.imageSmoothingEnabled=!0,h.imageSmoothingQuality="high",h.drawImage(c,0,0,v,x),URL.revokeObjectURL(w),t(u)},c.onerror=()=>{t(null)},c.src=w});if(!E)return null;let $=await new Promise(t=>E.toBlob(c=>{(!c||e4.throwToBlob.value)&&t(null),t(c)},"image/"+u,h));if(!$)return null;let T=new DataView(await $.arrayBuffer());return e1.bM.setPhysChunk(T,k,{type:"image/"+u})}async function getSvgAsDataUrl(t){let c=t.cloneNode(!0);c.setAttribute("encoding",'UTF-8"');let u=new FileReader,h=Array.from(c.querySelectorAll("image"));for(let t of h){let c=t.getAttribute("xlink:href");if(c&&!c.startsWith("data:")){let h=await (await fetch(c)).blob(),f=await new Promise((t,c)=>{u.onload=()=>t(u.result),u.onerror=()=>c(u.error),u.readAsDataURL(h)});t.setAttribute("xlink:href",f)}}return getSvgAsDataUrlSync(c)}function getSvgAsDataUrlSync(t){let c=new XMLSerializer().serializeToString(t),u=window.btoa(unescape(encodeURIComponent(c)));return`data:image/svg+xml;base64,${u}`}function downloadDataURLAsFile(t,c){let u=document.createElement("a");u.href=t,u.download=c,u.click()}let oB=(0,U.createContext)({});function ToastsProvider({children:t}){let[c,u]=(0,U.useState)([]),h=(0,U.useCallback)(t=>{let c=t.id??(0,tK.E)();return u(u=>[...u.filter(c=>c.id!==t.id),{...t,id:c}]),c},[]),f=(0,U.useCallback)(t=>(u(c=>c.filter(c=>c.id!==t)),t),[]),g=(0,U.useCallback)(()=>{u(()=>[])},[]);return(0,G.jsx)(oB.Provider,{value:{toasts:c,addToast:h,removeToast:f,clearToasts:g},children:t})}function useToasts(){let t=(0,U.useContext)(oB);if(!t)throw Error("useToasts must be used within a ToastsProvider");return t}function useCopyAs(){let t=(0,e8.j)(),{addToast:c}=useToasts(),u=useTranslation();return(0,U.useCallback)(function(h=t.selectedShapeIds,f="svg"){if(0===h.length&&(h=[...t.currentPageShapeIds]),0!==h.length)switch(f){case"svg":window.navigator.clipboard&&(window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":getExportedSvgBlob(t,h)})]):fallbackWriteTextAsync(async()=>getSvgAsString(await getExportSvgElement(t,h))));break;case"jpeg":case"png":{let g="jpeg"===f?"image/jpeg":"image/png",b=getExportedImageBlob(t,h,f).then(t=>{if(t){if(window.navigator.clipboard)return t;throw Error("Copy not supported")}throw c({id:"copy-fail",icon:"warning-triangle",title:u("toast.error.copy-fail.title"),description:u("toast.error.copy-fail.desc")}),Error("Copy not possible")});window.navigator.clipboard.write([new ClipboardItem({[g]:b})]).catch(t=>{t.toString().match(/^TypeError: DOMString not supported/)||console.error(t),b.then(t=>{window.navigator.clipboard.write([new ClipboardItem({[g]:t})])})});break}case"json":{let c=t.getContentFromCurrentPage(h);if(window.navigator.clipboard){let t=JSON.stringify(c);window.navigator.clipboard.write?window.navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})})]):fallbackWriteTextAsync(async()=>t)}break}default:throw Error(`Copy type ${f} not supported.`)}},[t,c,u])}async function getExportSvgElement(t,c){let u=await t.getSvg(c,{scale:1,background:t.instanceState.exportBackground});if(!u)throw Error("Could not construct SVG.");return u}async function getExportedSvgBlob(t,c){return new Blob([getSvgAsString(await getExportSvgElement(t,c))],{type:"text/plain"})}async function getExportedImageBlob(t,c,u){return await getSvgAsImage(await getExportSvgElement(t,c),{type:u,quality:1,scale:2})}async function fallbackWriteTextAsync(t){navigator&&navigator.clipboard&&navigator.clipboard.writeText(await t())}let oG=(0,U.createContext)({});function DialogsProvider({children:t}){let c=(0,e8.j)(),u=useUiEvents(),[h,f]=(0,U.useState)([]),g=(0,U.useCallback)(t=>{let h=t.id??(0,tK.E)();return f(c=>[...c.filter(c=>c.id!==t.id),{...t,id:h}]),u("open-menu",{source:"dialog",id:h}),c.addOpenMenu(h),h},[c,u]),b=(0,U.useCallback)((t,h)=>(f(c=>c.map(c=>c.id===t?{...c,...h}:c)),u("open-menu",{source:"dialog",id:t}),c.addOpenMenu(t),t),[c,u]),v=(0,U.useCallback)(t=>(f(c=>c.filter(c=>c.id!==t||(c.onClose?.(),!1))),u("close-menu",{source:"dialog",id:t}),c.deleteOpenMenu(t),t),[c,u]),x=(0,U.useCallback)(()=>{f(t=>(t.forEach(t=>{t.onClose?.(),u("close-menu",{source:"dialog",id:t.id}),c.deleteOpenMenu(t.id)}),[]))},[c,u]);return(0,G.jsx)(oG.Provider,{value:{dialogs:h,addDialog:g,removeDialog:v,clearDialogs:x,updateDialog:b},children:t})}function useDialogs(){let t=(0,U.useContext)(oG);if(!t)throw Error("useDialogs must be used within a DialogsProvider");return t}function useExportAs(){let t=(0,e8.j)(),{addToast:c}=useToasts(),u=useTranslation();return(0,U.useCallback)(async function(h=t.selectedShapeIds,f="png"){if(0===h.length&&(h=[...t.currentPageShapeIds]),0===h.length)return;let g=await t.getSvg(h,{scale:1,background:t.instanceState.exportBackground});if(!g)throw Error("Could not construct SVG.");let b="shapes"+getTimestamp();if(1===h.length){let c=t.getShape(h[0]);b=t.isShapeOfType(c,"frame")?c.props.name??"frame":c.id.replace(/:/,"_")}switch(f){case"svg":{let t=await getSvgAsDataUrl(g);downloadDataURLAsFile(t,`${b}.svg`);return}case"webp":case"png":{let t=await getSvgAsImage(g,{type:f,quality:1,scale:2});if(!t){c({id:"export-fail",title:u("toast.error.export-fail.title"),description:u("toast.error.export-fail.desc")});return}let h=URL.createObjectURL(t);downloadDataURLAsFile(h,`${b}.${f}`),URL.revokeObjectURL(h);return}case"json":{let c=t.getContentFromCurrentPage(h),u=URL.createObjectURL(new Blob([JSON.stringify(c,null,4)],{type:"application/json"}));downloadDataURLAsFile(u,`${b||"shapes"}.json`),URL.revokeObjectURL(u);return}default:throw Error(`Export type ${f} not supported.`)}},[t,c,u])}function getTimestamp(){let t=new Date,c=String(t.getFullYear()).slice(2),u=String(t.getMonth()+1).padStart(2,"0"),h=String(t.getDate()).padStart(2,"0"),f=String(t.getHours()).padStart(2,"0"),g=String(t.getMinutes()).padStart(2,"0"),b=String(t.getSeconds()).padStart(2,"0");return` at ${c}-${u}-${h} ${f}.${g}.${b}`}function useInsertMedia(){let t=(0,e8.j)(),c=(0,U.useRef)();return(0,U.useEffect)(()=>{let u=window.document.createElement("input");async function onchange(c){let h=c.target.files;h&&0!==h.length&&(await t.putExternalContent({type:"files",files:Array.from(h),point:t.viewportPageBounds.center,ignoreParent:!1}),u.value="")}return u.type="file",u.accept="image/jpeg,image/png,image/gif,image/svg+xml,video/mp4,video/quicktime",u.multiple=!0,c.current=u,u.addEventListener("change",onchange),()=>{c.current=void 0,u.removeEventListener("change",onchange)}},[t]),(0,U.useCallback)(()=>{c.current?.click()},[c])}function usePrint(){let t=(0,e8.j)(),c=(0,U.useRef)(null),u=(0,U.useRef)(null);return(0,U.useCallback)(async function(){let h=document.createElement("div"),f=document.createElement("style"),clearElements=(t,c)=>{t&&(t.innerHTML=""),c&&document.head.contains(c)&&document.head.removeChild(c),t&&document.body.contains(t)&&document.body.removeChild(t)};clearElements(c.current,u.current),c.current=h,u.current=f;let g=`tl-print-surface-${(0,tK.E)()}`;h.className=g,f.innerHTML=`
			.${g} {
				display: none;
			}

			.${g} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.${g} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${g}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${g}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${g}__item__header {
					display: none;
				}

				.${g}__item__footer {
					display: none;
					text-align: right;
				}

				.${g}__item__footer__hide {
					display: none;
				}

				
			}

		`;let beforePrintHandler=()=>{document.head.appendChild(f),document.body.appendChild(h)},afterPrintHandler=()=>{t.once("change-history",()=>{clearElements(h,f)})};function addPageToPrint(t,c,u){try{h.innerHTML+=`<div class="${g}__item">
        <div class="${g}__item__header">
          ${t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${g}__item__main">
          ${u.outerHTML}
        </div>
        <div class="${g}__item__footer ${g}__item__footer__${c?"":"hide"}">
          ${c??""}
        </div>
      </div>`}catch(t){console.error(t)}}function triggerPrint(){t.environment.isChromeForIos?(beforePrintHandler(),window.print()):t.environment.isSafari?(beforePrintHandler(),document.execCommand("print",!1)):window.print()}window.addEventListener("beforeprint",beforePrintHandler),window.addEventListener("afterprint",afterPrintHandler);let{pages:b,currentPageId:v,selectedShapeIds:x}=t,w={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.selectedShapeIds.length>0){let c=await t.getSvg(x,w);if(c){let t=b.find(t=>t.id===v);addPageToPrint(`tldraw \u2014 ${t?.name}`,null,c),triggerPrint()}}else{let c=t.currentPage,u=await t.getSvg(t.getSortedChildIdsForParent(c.id),w);u&&(addPageToPrint(`tldraw \u2014 ${c.name}`,null,u),triggerPrint())}window.removeEventListener("beforeprint",beforePrintHandler),window.removeEventListener("afterprint",afterPrintHandler)},[t])}let oH=U.createContext({});function makeActions(t){return Object.fromEntries(t.map(t=>[t.id,t]))}function ActionsProvider({overrides:t,children:c}){let u=(0,e8.j)(),{addDialog:h,clearDialogs:f}=useDialogs(),{clearToasts:g}=useToasts(),b=useInsertMedia(),v=usePrint(),{cut:x,copy:w,paste:_}=useMenuClipboardEvents(),k=useCopyAs(),E=useExportAs(),$=useUiEvents(),T=U.useMemo(()=>{function mustGoBackToSelectToolFirst(){return u.isIn("select")||(u.complete(),u.setCurrentTool("select")),!1}function hasSelectedShapes(){return u.selectedShapeIds.length>0}let c=makeActions([{id:"edit-link",label:"action.edit-link",icon:"link",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("edit-link",{source:t}),u.mark("edit-link"),h({component:o$})))}},{id:"insert-embed",label:"action.insert-embed",readonlyOk:!1,kbd:"$i",onSelect(t){$("insert-embed",{source:t}),h({component:oI})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",readonlyOk:!1,onSelect(t){$("insert-media",{source:t}),b()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",readonlyOk:!1,onSelect(t){$("undo",{source:t}),u.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",readonlyOk:!1,onSelect(t){$("redo",{source:t}),u.redo()}},{id:"export-as-svg",label:"action.export-as-svg",menuLabel:"action.export-as-svg.short",contextMenuLabel:"action.export-as-svg.short",readonlyOk:!0,onSelect(t){$("export-as",{format:"svg",source:t}),E(u.selectedShapeIds,"svg")}},{id:"export-as-png",label:"action.export-as-png",menuLabel:"action.export-as-png.short",contextMenuLabel:"action.export-as-png.short",readonlyOk:!0,onSelect(t){$("export-as",{format:"png",source:t}),E(u.selectedShapeIds,"png")}},{id:"export-as-json",label:"action.export-as-json",menuLabel:"action.export-as-json.short",contextMenuLabel:"action.export-as-json.short",readonlyOk:!0,onSelect(t){$("export-as",{format:"json",source:t}),E(u.selectedShapeIds,"json")}},{id:"copy-as-svg",label:"action.copy-as-svg",menuLabel:"action.copy-as-svg.short",contextMenuLabel:"action.copy-as-svg.short",kbd:"$!c",readonlyOk:!0,onSelect(t){$("copy-as",{format:"svg",source:t}),k(u.selectedShapeIds,"svg")}},{id:"copy-as-png",label:"action.copy-as-png",menuLabel:"action.copy-as-png.short",contextMenuLabel:"action.copy-as-png.short",readonlyOk:!0,onSelect(t){$("copy-as",{format:"png",source:t}),k(u.selectedShapeIds,"png")}},{id:"copy-as-json",label:"action.copy-as-json",menuLabel:"action.copy-as-json.short",contextMenuLabel:"action.copy-as-json.short",readonlyOk:!0,onSelect(t){$("copy-as",{format:"json",source:t}),k(u.selectedShapeIds,"json")}},{id:"toggle-auto-size",label:"action.toggle-auto-size",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("toggle-auto-size",{source:t}),u.mark("toggling auto size"),u.updateShapes(u.selectedShapes.filter(t=>u.isShapeOfType(t,"text")&&!1===t.props.autoSize).map(t=>({id:t.id,type:t.type,props:{...t.props,w:8,autoSize:!0}})))))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(t){$("open-embed-link",{source:t});let c=u.selectedShapeIds,h="No embed shapes selected";if(1!==c.length){console.error(h);return}let f=u.getShape(c[0]);if(!f||!u.isShapeOfType(f,"embed")){console.error(h);return}openWindow(f.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(t){if(u.root.current.value?.id!=="zoom"&&($("zoom-tool",{source:t}),!(u.inputs.shiftKey||u.inputs.ctrlKey))){let t=u.root.current.value;t&&t.current.value?.id==="idle"&&u.setCurrentTool("zoom",{onInteractionEnd:t.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||u.batch(()=>{$("convert-to-bookmark",{source:t});let c=u.selectedShapes,h=[],f=[];for(let t of c){if(!t||!u.isShapeOfType(t,"embed")||!t.props.url)continue;let c=new tn.G(t.x,t.y);c.rot(-t.rotation),c.add(new tn.G(t.props.w/2-150,t.props.h/2-160)),c.rot(t.rotation);let g={id:(0,e0.F1)(),type:"bookmark",rotation:t.rotation,x:c.x,y:c.y,opacity:1,props:{url:t.props.url}};h.push(g),f.push(t.id)}u.mark("convert shapes to bookmark"),u.deleteShapes(f),u.createShapes(h)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("convert-to-embed",{source:t}),u.batch(()=>{let t=u.selectedShapeIds,c=(0,e1.oA)(t.map(t=>u.getShape(t))),h=[],f=[];for(let t of c){if(!u.isShapeOfType(t,"bookmark"))continue;let{url:c}=t.props,g=getEmbedInfo(t.props.url);if(!g||!g.definition)continue;let{width:b,height:v}=g.definition,x=new tn.G(t.x,t.y);x.rot(-t.rotation),x.add(new tn.G(t.props.w/2-b/2,t.props.h/2-v/2)),x.rot(t.rotation);let w={id:(0,e0.F1)(),type:"embed",x:x.x,y:x.y,rotation:t.rotation,props:{url:c,w:b,h:v}};h.push(w),f.push(t.id)}u.mark("convert shapes to embed"),u.deleteShapes(f),u.createShapes(h)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",readonlyOk:!1,onSelect(t){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;$("duplicate-shapes",{source:t});let c=u.selectedShapeIds,h=nS.No.Common((0,e1.oA)(c.map(t=>u.getShapePageBounds(t)))),f=u.instanceState.canMoveCamera?{x:h.width+10,y:0}:{x:16/u.zoomLevel,y:16/u.zoomLevel};u.mark("duplicate shapes"),u.duplicateShapes(c,f)}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("ungroup-shapes",{source:t}),u.mark("ungroup"),u.ungroupShapes(u.selectedShapeIds)))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",readonlyOk:!1,onSelect(t){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;$("group-shapes",{source:t});let{onlySelectedShape:c}=u;c&&u.isShapeOfType(c,"group")?(u.mark("ungroup"),u.ungroupShapes(u.selectedShapeIds)):(u.mark("group"),u.groupShapes(u.selectedShapeIds))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("align-shapes",{operation:"left",source:t}),u.mark("align left"),u.alignShapes(u.selectedShapeIds,"left")))}},{id:"align-center-horizontal",label:"action.align-center-horizontal",contextMenuLabel:"action.align-center-horizontal.short",kbd:"?H",icon:"align-center-horizontal",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("align-shapes",{operation:"center-horizontal",source:t}),u.mark("align center horizontal"),u.alignShapes(u.selectedShapeIds,"center-horizontal")))}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("align-shapes",{operation:"right",source:t}),u.mark("align right"),u.alignShapes(u.selectedShapeIds,"right")))}},{id:"align-center-vertical",label:"action.align-center-vertical",contextMenuLabel:"action.align-center-vertical.short",kbd:"?V",icon:"align-center-vertical",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("align-shapes",{operation:"center-vertical",source:t}),u.mark("align center vertical"),u.alignShapes(u.selectedShapeIds,"center-vertical")))}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("align-shapes",{operation:"top",source:t}),u.mark("align top"),u.alignShapes(u.selectedShapeIds,"top")))}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("align-shapes",{operation:"bottom",source:t}),u.mark("align bottom"),u.alignShapes(u.selectedShapeIds,"bottom")))}},{id:"distribute-horizontal",label:"action.distribute-horizontal",contextMenuLabel:"action.distribute-horizontal.short",icon:"distribute-horizontal",kbd:"?!h",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("distribute-shapes",{operation:"horizontal",source:t}),u.mark("distribute horizontal"),u.distributeShapes(u.selectedShapeIds,"horizontal")))}},{id:"distribute-vertical",label:"action.distribute-vertical",contextMenuLabel:"action.distribute-vertical.short",icon:"distribute-vertical",kbd:"?!V",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("distribute-shapes",{operation:"vertical",source:t}),u.mark("distribute vertical"),u.distributeShapes(u.selectedShapeIds,"vertical")))}},{id:"stretch-horizontal",label:"action.stretch-horizontal",contextMenuLabel:"action.stretch-horizontal.short",icon:"stretch-horizontal",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("stretch-shapes",{operation:"horizontal",source:t}),u.mark("stretch horizontal"),u.stretchShapes(u.selectedShapeIds,"horizontal")))}},{id:"stretch-vertical",label:"action.stretch-vertical",contextMenuLabel:"action.stretch-vertical.short",icon:"stretch-vertical",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("stretch-shapes",{operation:"vertical",source:t}),u.mark("stretch vertical"),u.stretchShapes(u.selectedShapeIds,"vertical")))}},{id:"flip-horizontal",label:"action.flip-horizontal",contextMenuLabel:"action.flip-horizontal.short",kbd:"!h",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("flip-shapes",{operation:"horizontal",source:t}),u.mark("flip horizontal"),u.flipShapes(u.selectedShapeIds,"horizontal")))}},{id:"flip-vertical",label:"action.flip-vertical",contextMenuLabel:"action.flip-vertical.short",kbd:"!v",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("flip-shapes",{operation:"vertical",source:t}),u.mark("flip vertical"),u.flipShapes(u.selectedShapeIds,"vertical")))}},{id:"pack",label:"action.pack",icon:"pack",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("pack-shapes",{source:t}),u.mark("pack"),u.packShapes(u.selectedShapeIds,16)))}},{id:"stack-vertical",label:"action.stack-vertical",contextMenuLabel:"action.stack-vertical.short",icon:"stack-vertical",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("stack-shapes",{operation:"vertical",source:t}),u.mark("stack-vertical"),u.stackShapes(u.selectedShapeIds,"vertical",16)))}},{id:"stack-horizontal",label:"action.stack-horizontal",contextMenuLabel:"action.stack-horizontal.short",icon:"stack-horizontal",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("stack-shapes",{operation:"horizontal",source:t}),u.mark("stack-horizontal"),u.stackShapes(u.selectedShapeIds,"horizontal",16)))}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("reorder-shapes",{operation:"toFront",source:t}),u.mark("bring to front"),u.bringToFront(u.selectedShapeIds)))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("reorder-shapes",{operation:"forward",source:t}),u.mark("bring forward"),u.bringForward(u.selectedShapeIds)))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("reorder-shapes",{operation:"backward",source:t}),u.mark("send backward"),u.sendBackward(u.selectedShapeIds)))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("reorder-shapes",{operation:"toBack",source:t}),u.mark("send to back"),u.sendToBack(u.selectedShapeIds)))}},{id:"cut",label:"action.cut",kbd:"$x",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||(u.mark("cut"),x(t)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||w(t))}},{id:"paste",label:"action.paste",kbd:"$v",readonlyOk:!1,onSelect(t){navigator.clipboard?.read().then(c=>{_(c,t,"context-menu"===t?u.inputs.currentPagePoint:void 0)})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(t){u.batch(()=>{mustGoBackToSelectToolFirst()||($("select-all-shapes",{source:t}),u.mark("select all kbd"),u.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("select-none-shapes",{source:t}),u.mark("select none"),u.selectNone()))}},{id:"delete",label:"action.delete",kbd:"⌫,del,backspace",icon:"trash",readonlyOk:!1,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("delete-shapes",{source:t}),u.mark("delete"),u.deleteShapes(u.selectedShapeIds)))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",readonlyOk:!1,onSelect(t){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;$("rotate-cw",{source:t}),u.mark("rotate-cw");let c=u.selectionRotation%(tt.gc/2),h=(0,tt.C2)(c,0)||(0,tt.C2)(c,tt.gc/2);u.rotateShapesBy(u.selectedShapeIds,tt.gc/2-(h?0:c))}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",readonlyOk:!1,onSelect(t){if(!hasSelectedShapes()||mustGoBackToSelectToolFirst())return;$("rotate-ccw",{source:t}),u.mark("rotate-ccw");let c=u.selectionRotation%(tt.gc/2),h=(0,tt.C2)(c,0);u.rotateShapesBy(u.selectedShapeIds,h?-(tt.gc/2):-c)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(t){$("zoom-in",{source:t}),u.zoomIn(u.viewportScreenCenter,{duration:to.KD})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(t){$("zoom-out",{source:t}),u.zoomOut(u.viewportScreenCenter,{duration:to.KD})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(t){$("reset-zoom",{source:t}),u.resetZoom(u.viewportScreenCenter,{duration:to.KD})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(t){$("zoom-to-fit",{source:t}),u.zoomToFit({duration:to.KD})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(t){hasSelectedShapes()&&(mustGoBackToSelectToolFirst()||($("zoom-to-selection",{source:t}),u.zoomToSelection({duration:to.KD})))}},{id:"toggle-snap-mode",label:"action.toggle-snap-mode",menuLabel:"action.toggle-snap-mode.menu",readonlyOk:!1,onSelect(t){$("toggle-snap-mode",{source:t}),u.user.updateUserPreferences({isSnapMode:!u.user.isSnapMode})},checkbox:!0},{id:"toggle-dark-mode",label:"action.toggle-dark-mode",menuLabel:"action.toggle-dark-mode.menu",kbd:"$/",readonlyOk:!0,onSelect(t){$("toggle-dark-mode",{source:t}),u.user.updateUserPreferences({isDarkMode:!u.user.isDarkMode})},checkbox:!0},{id:"toggle-reduce-motion",label:"action.toggle-reduce-motion",menuLabel:"action.toggle-reduce-motion.menu",readonlyOk:!0,onSelect(t){$("toggle-reduce-motion",{source:t}),u.user.updateUserPreferences({animationSpeed:0===u.user.animationSpeed?1:0})},checkbox:!0},{id:"toggle-transparent",label:"action.toggle-transparent",menuLabel:"action.toggle-transparent.menu",contextMenuLabel:"action.toggle-transparent.context-menu",readonlyOk:!0,onSelect(t){$("toggle-transparent",{source:t}),u.updateInstanceState({exportBackground:!u.instanceState.exportBackground},{ephemeral:!0})},checkbox:!0},{id:"toggle-tool-lock",label:"action.toggle-tool-lock",menuLabel:"action.toggle-tool-lock.menu",readonlyOk:!1,kbd:"q",onSelect(t){$("toggle-tool-lock",{source:t}),u.updateInstanceState({isToolLocked:!u.instanceState.isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",readonlyOk:!1,onSelect(t){$("unlock-all",{source:t});let c=[];for(let t of u.currentPageShapes)t.isLocked&&c.push({id:t.id,type:t.type,isLocked:!1});c.length>0&&u.updateShapes(c)}},{id:"toggle-focus-mode",label:"action.toggle-focus-mode",menuLabel:"action.toggle-focus-mode.menu",readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(t){requestAnimationFrame(()=>{u.batch(()=>{$("toggle-focus-mode",{source:t}),f(),g(),u.updateInstanceState({isFocusMode:!u.instanceState.isFocusMode})})})}},{id:"toggle-grid",label:"action.toggle-grid",menuLabel:"action.toggle-grid.menu",readonlyOk:!0,kbd:"$'",onSelect(t){$("toggle-grid-mode",{source:t}),u.updateInstanceState({isGridMode:!u.instanceState.isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:"action.toggle-debug-mode",menuLabel:"action.toggle-debug-mode.menu",readonlyOk:!0,onSelect(t){$("toggle-debug-mode",{source:t}),u.updateInstanceState({isDebugMode:!u.instanceState.isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(t){$("print",{source:t}),v()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(t){$("exit-pen-mode",{source:t}),u.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(t){$("stop-following",{source:t}),u.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(t){$("zoom-to-content",{source:t}),u.zoomToContent()}},{id:"toggle-lock",label:"action.toggle-lock",readonlyOk:!1,kbd:"!l",onSelect(t){u.mark("locking"),$("toggle-lock",{source:t}),u.toggleLock(u.selectedShapeIds)}}]);return t?t(u,c,void 0):c},[$,t,u,h,b,E,k,x,w,_,f,g,v]);return(0,G.jsx)(oH.Provider,{value:asActions(T),children:c})}function useActions(){let t=U.useContext(oH);if(!t)throw Error("useTools must be used within a ToolProvider");return t}function asActions(t){return t}function compactMenuItems(t){return t.filter(t=>null!=t&&!1!==t)}function menuGroup(t,...c){let u=compactMenuItems(c);return 0===u.length?null:{id:t,type:"group",checkbox:u.every(t=>"item"===t.type&&t.actionItem.checkbox),disabled:u.every(t=>t.disabled),readonlyOk:u.some(t=>t.readonlyOk),children:u}}function menuSubmenu(t,c,...u){let h=compactMenuItems(u);return 0===h.length?null:{id:t,type:"submenu",label:c,children:h,disabled:h.every(t=>t.disabled),readonlyOk:h.some(t=>t.readonlyOk)}}function menuCustom(t,c={}){let{readonlyOk:u=!0,disabled:h=!1}=c;return{id:t,type:"custom",disabled:h,readonlyOk:u}}function menuItem(t,c={}){if(!t)throw Error("No action item provided to menuItem");if(!t.label)throw Error("Trying to create menu item for action item that doesn't have a label");let{checked:u=!1,disabled:h=!1}=c;return{id:t.id,type:"item",actionItem:t,disabled:h,checked:u,readonlyOk:t.readonlyOk}}function shapesWithUnboundArrows(t){let{selectedShapeIds:c}=t,u=c.map(c=>t.getShape(c));return u.filter(c=>!(!c||t.isShapeOfType(c,"arrow")&&"binding"===c.props.start.type||t.isShapeOfType(c,"arrow")&&"binding"===c.props.end.type))}let useThreeStackableItems=()=>{let t=(0,e8.j)();return(0,eJ.Hg)("threeStackableItems",()=>shapesWithUnboundArrows(t).length>2,[t])},useAllowGroup=()=>{let t=(0,e8.j)();return(0,eJ.Hg)("allowGroup",()=>shapesWithUnboundArrows(t).length>1,[t])},useAllowUngroup=()=>{let t=(0,e8.j)();return(0,eJ.Hg)("allowUngroup",()=>t.selectedShapeIds.some(c=>t.getShape(c)?.type==="group"),[])};function findMenuItem(t,c){let u=_findMenuItem(t,c);return(0,e1.hu)(u,`Menu item ${c.join(" > ")} not found`),u}function _findMenuItem(t,c){let[u,...h]=c;if(!u)return null;let f=t.find(t=>t.id===u);if(!f)return null;switch(f.type){case"group":case"submenu":return 0===h.length?f:_findMenuItem(f.children,h);case"item":case"custom":return 0===h.length?f:null;default:(0,e1.iP)(f,"type")}}let oU="undefined"!=typeof window&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read,oV=[0,380,420,460,580,640,840,1023],oW=U.createContext(0);function BreakPointProvider({children:t}){let c=(0,e8.j)(),u=(0,eJ.Hg)("breakpoint",()=>{let{width:t}=c.viewportScreenBounds;for(let c=0;c<oV.length-1;c++)if(t>oV[c]&&t<=oV[c+1])return c;return oV.length},[c]);return(0,G.jsx)(oW.Provider,{value:u,children:t})}function useBreakpoint(){let t=(0,U.useContext)(oW),c=new URL(window.location.href).searchParams.get("layout");return"desktop"===c?t=7:"mobile"===c&&(t=1),t}function useHasLinkShapeSelected(){let t=(0,e8.j)();return(0,eJ.Hg)("hasLinkShapeSelected",()=>{let{selectedShapes:c}=t;return 1===c.length&&"url"in c[0].props&&"embed"!==c[0].type},[t])}let oK=U.createContext({}),oZ=(0,eJ.j)(function({overrides:t,children:c}){let u=(0,e8.j)(),h=useActions(),f=u.selectedShapeIds.length,g=f>0,b=f>1,v=f>2,x=useThreeStackableItems(),w=useAllowGroup(),_=useAllowUngroup(),k=useHasLinkShapeSelected(),E=useBreakpoint(),$=1===u.zoomLevel,T=(0,U.useMemo)(()=>{let c=[menuItem(h["align-left"],{disabled:!b}),menuItem(h["align-center-horizontal"],{disabled:!b}),menuItem(h["align-right"],{disabled:!b}),menuItem(h["stretch-horizontal"],{disabled:!b}),menuItem(h["align-top"],{disabled:!b}),menuItem(h["align-center-vertical"],{disabled:!b}),menuItem(h["align-bottom"],{disabled:!b}),menuItem(h["stretch-vertical"],{disabled:!b}),menuItem(h["distribute-horizontal"],{disabled:!v}),menuItem(h["distribute-vertical"],{disabled:!v}),menuItem(h["stack-horizontal"],{disabled:!x}),menuItem(h["stack-vertical"],{disabled:!x}),menuItem(h["send-to-back"],{disabled:!g}),menuItem(h["send-backward"],{disabled:!g}),menuItem(h["bring-forward"],{disabled:!g}),menuItem(h["bring-to-front"],{disabled:!g}),E<5?menuItem(h["zoom-to-100"],{disabled:!!$}):menuItem(h["rotate-ccw"],{disabled:!g}),menuItem(h["rotate-cw"],{disabled:!g}),menuItem(h["edit-link"],{disabled:!k}),w?menuItem(h.group,{disabled:!b}):_?menuItem(h.ungroup):menuItem(h.group,{disabled:!b})];return t?t(u,c,{actions:h,oneSelected:g,twoSelected:b,threeSelected:v}):c},[u,$,w,t,h,g,b,v,x,_,k,E]);return(0,G.jsx)(oK.Provider,{value:T,children:c})});function useActionsMenuSchema(){let t=U.useContext(oK);if(!t)throw Error("useActionsMenuSchema must be used inside of a ActionsMenuSchemaProvider.");return t}function useOnlyFlippableShape(){let t=(0,e8.j)();return(0,eJ.Hg)("onlyFlippableShape",()=>{let{selectedShapes:c}=t;return 1===c.length&&c.every(c=>t.isShapeOfType(c,"group")||t.isShapeOfType(c,"arrow")||t.isShapeOfType(c,"line")||t.isShapeOfType(c,"draw"))},[t])}function useShowAutoSizeToggle(){let t=(0,e8.j)();return(0,eJ.Hg)("showAutoSizeToggle",()=>{let{selectedShapes:c}=t;return 1===c.length&&t.isShapeOfType(c[0],"text")&&!1===c[0].props.autoSize},[t])}let oY=U.createContext({}),oq=(0,eJ.j)(function({overrides:t,children:c}){let u=(0,e8.j)(),h=useActions(),f=useShowAutoSizeToggle(),g=useOnlyFlippableShape(),b=u.selectedShapeIds.length,v=b>0,x=b>1,w=b>2,_=useThreeStackableItems(),k=(0,eJ.Hg)("atLeastOneShapeOnPage",()=>u.currentPageShapeIds.size>0,[]),E=(0,eJ.Hg)("isTransparentBg",()=>u.instanceState.exportBackground,[]),$=useAllowGroup(),T=useAllowUngroup(),I=!!window.navigator.clipboard?.write,M=useHasLinkShapeSelected(),{onlySelectedShape:j}=u,D=j&&u.isShapeOrAncestorLocked(j),F=(0,U.useMemo)(()=>{let c=compactMenuItems([menuGroup("selection",f&&menuItem(h["toggle-auto-size"]),M&&!D&&menuItem(h["edit-link"]),v&&!D&&menuItem(h.duplicate),$&&!D&&menuItem(h.group),T&&!D&&menuItem(h.ungroup),v&&menuItem(h["toggle-lock"])),menuGroup("modify",(x||g)&&menuSubmenu("arrange","context-menu.arrange",x&&menuGroup("align",menuItem(h["align-left"]),menuItem(h["align-center-horizontal"]),menuItem(h["align-right"]),menuItem(h["align-top"]),menuItem(h["align-center-vertical"]),menuItem(h["align-bottom"])),w&&menuGroup("distribute",menuItem(h["distribute-horizontal"]),menuItem(h["distribute-vertical"])),x&&menuGroup("stretch",menuItem(h["stretch-horizontal"]),menuItem(h["stretch-vertical"])),g&&!D&&menuGroup("flip",menuItem(h["flip-horizontal"]),menuItem(h["flip-vertical"])),x&&menuGroup("order",menuItem(h.pack,{disabled:!x}),_&&menuItem(h["stack-vertical"]),_&&menuItem(h["stack-horizontal"]))),v&&!D&&menuSubmenu("reorder","context-menu.reorder",menuGroup("reorder",menuItem(h["bring-to-front"]),menuItem(h["bring-forward"]),menuItem(h["send-backward"]),menuItem(h["send-to-back"]))),v&&!D&&menuCustom("MOVE_TO_PAGE_MENU",{readonlyOk:!1})),menuGroup("clipboard-group",v&&!D&&menuItem(h.cut),v&&menuItem(h.copy),oU&&menuItem(h.paste)),k&&menuGroup("conversions",menuSubmenu("copy-as","context-menu.copy-as",menuGroup("copy-as-group",menuItem(h["copy-as-svg"]),I&&menuItem(h["copy-as-png"]),menuItem(h["copy-as-json"])),menuGroup("export-bg",menuItem(h["toggle-transparent"],{checked:!E}))),menuSubmenu("export-as","context-menu.export-as",menuGroup("export-as-group",menuItem(h["export-as-svg"]),menuItem(h["export-as-png"]),menuItem(h["export-as-json"])),menuGroup("export-bg,",menuItem(h["toggle-transparent"],{checked:!E})))),k&&menuGroup("set-selection-group",menuItem(h["select-all"]),v&&menuItem(h["select-none"])),v&&!D&&menuGroup("delete-group",menuItem(h.delete))]);return t&&(c=t(u,c,{actions:h,oneSelected:v,twoSelected:x,threeSelected:w,showAutoSizeToggle:f,showUngroup:T,onlyFlippableShapeSelected:g})),c},[u,t,h,v,x,w,f,g,k,_,$,T,I,M,E,D]);return(0,G.jsx)(oY.Provider,{value:F,children:c})});function useContextMenuSchema(){let t=U.useContext(oY);if(!t)throw Error("useContextMenuSchema must be used inside of a TLUiContextMenuSchemaProvider.");return t}let oX=U.createContext({});function ToolsProvider({overrides:t,children:c}){let u=(0,e8.j)(),h=useUiEvents(),{addDialog:f}=useDialogs(),g=useInsertMedia(),b=U.useMemo(()=>{let c=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(t){u.setCurrentTool("select"),h("select-tool",{source:t,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(t){u.setCurrentTool("hand"),h("select-tool",{source:t,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",readonlyOk:!1,onSelect(t){u.setCurrentTool("eraser"),h("select-tool",{source:t,id:"eraser"})}},{id:"draw",label:"tool.draw",readonlyOk:!1,icon:"tool-pencil",kbd:"d,b,x",onSelect(t){u.setCurrentTool("draw"),h("select-tool",{source:t,id:"draw"})}},...[...e0.Zu.values].map(t=>({id:t,label:`tool.${t}`,readonlyOk:!1,meta:{geo:t},kbd:"rectangle"===t?"r":"ellipse"===t?"o":void 0,icon:"geo-"+t,onSelect(c){u.batch(()=>{u.updateInstanceState({stylesForNextShape:{...u.instanceState.stylesForNextShape,[e0.Zu.id]:t}},{ephemeral:!0}),u.setCurrentTool("geo"),h("select-tool",{source:c,id:`geo-${t}`})})}})),{id:"arrow",label:"tool.arrow",readonlyOk:!1,icon:"tool-arrow",kbd:"a",onSelect(t){u.setCurrentTool("arrow"),h("select-tool",{source:t,id:"arrow"})}},{id:"line",label:"tool.line",readonlyOk:!1,icon:"tool-line",kbd:"l",onSelect(t){u.setCurrentTool("line"),h("select-tool",{source:t,id:"line"})}},{id:"frame",label:"tool.frame",readonlyOk:!1,icon:"tool-frame",kbd:"f",onSelect(t){u.setCurrentTool("frame"),h("select-tool",{source:t,id:"frame"})}},{id:"text",label:"tool.text",readonlyOk:!1,icon:"tool-text",kbd:"t",onSelect(t){u.setCurrentTool("text"),h("select-tool",{source:t,id:"text"})}},{id:"asset",label:"tool.asset",readonlyOk:!1,icon:"tool-media",kbd:"$u",onSelect(t){g(),h("select-tool",{source:t,id:"media"})}},{id:"note",label:"tool.note",readonlyOk:!1,icon:"tool-note",kbd:"n",onSelect(t){u.setCurrentTool("note"),h("select-tool",{source:t,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(t){u.setCurrentTool("laser"),h("select-tool",{source:t,id:"laser"})}},{id:"embed",label:"tool.embed",readonlyOk:!1,icon:"tool-embed",onSelect(t){f({component:oI}),h("select-tool",{source:t,id:"embed"})}}];c.push({id:"highlight",label:"tool.highlight",readonlyOk:!0,icon:"tool-highlight",kbd:"!d",onSelect(t){u.setCurrentTool("highlight"),h("select-tool",{source:t,id:"highlight"})}});let b=Object.fromEntries(c.map(t=>[t.id,t]));return t?t(u,b,{insertMedia:g}):b},[t,u,h,g,f]);return(0,G.jsx)(oX.Provider,{value:b,children:c})}function useTools(){let t=U.useContext(oX);if(!t)throw Error("useTools must be used within a ToolProvider");return t}let oJ=U.createContext({}),oQ=(0,eJ.j)(function({overrides:t,children:c}){let u=(0,e8.j)(),h=useTools(),f=useActions(),g=(0,U.useMemo)(()=>{let c=(0,e1.oA)([menuGroup("shortcuts-dialog.tools",menuItem(f["toggle-tool-lock"]),menuItem(h.select),menuItem(h.draw),menuItem(h.eraser),menuItem(h.hand),menuItem(h.rectangle),menuItem(h.ellipse),menuItem(h.arrow),menuItem(h.line),menuItem(h.text),menuItem(h.frame),menuItem(h.note),menuItem(h.laser)),menuGroup("shortcuts-dialog.file",menuItem(f["insert-media"]),menuItem(f.print)),menuGroup("shortcuts-dialog.preferences",menuItem(f["toggle-dark-mode"]),menuItem(f["toggle-focus-mode"]),menuItem(f["toggle-grid"])),menuGroup("shortcuts-dialog.edit",menuItem(f.undo),menuItem(f.redo),menuItem(f.cut),menuItem(f.copy),menuItem(f.paste),menuItem(f["select-all"]),menuItem(f.delete),menuItem(f.duplicate),menuItem(f["export-as-svg"]),menuItem(f["export-as-png"])),menuGroup("shortcuts-dialog.view",menuItem(f["zoom-in"]),menuItem(f["zoom-out"]),menuItem(f["zoom-to-100"]),menuItem(f["zoom-to-fit"]),menuItem(f["zoom-to-selection"])),menuGroup("shortcuts-dialog.transform",menuItem(f["bring-to-front"]),menuItem(f["bring-forward"]),menuItem(f["send-backward"]),menuItem(f["send-to-back"]),menuItem(f.group),menuItem(f.ungroup),menuItem(f["flip-horizontal"]),menuItem(f["flip-vertical"]),menuItem(f["align-top"]),menuItem(f["align-center-vertical"]),menuItem(f["align-bottom"]),menuItem(f["align-left"]),menuItem(f["align-center-horizontal"]),menuItem(f["align-right"]))]);return t?t(u,c,{tools:h,actions:f}):c},[u,t,f,h]);return(0,G.jsx)(oJ.Provider,{value:g,children:c})});function useKeyboardShortcutsSchema(){let t=U.useContext(oJ);if(!t)throw Error("Shortcuts must be used inside of a ShortcutsProvider.");return t}let KeyboardShortcutsDialog=()=>{let t=useTranslation(),c=useReadonly(),u=useKeyboardShortcutsSchema();function getKeyboardShortcutItem(u){if(c&&!u.readonlyOk)return null;switch(u.type){case"group":return(0,G.jsxs)("div",{className:"tlui-shortcuts-dialog__group",children:[(0,G.jsx)("h2",{className:"tlui-shortcuts-dialog__group__title",children:t(u.id)}),(0,G.jsx)("div",{className:"tlui-shortcuts-dialog__group__content",children:u.children.filter(t=>"item"===t.type&&t.actionItem.kbd).map(getKeyboardShortcutItem)})]},u.id);case"item":{let{id:c,label:h,shortcutsLabel:f,kbd:g}=u.actionItem;return(0,G.jsxs)("div",{className:"tlui-shortcuts-dialog__key-pair",children:[(0,G.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:t(f??h)}),(0,G.jsx)("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:(0,G.jsx)(Kbd,{children:g})})]},c)}}}return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(Header,{className:"tlui-shortcuts-dialog__header",children:[(0,G.jsx)(Title,{children:t("shortcuts-dialog.title")}),(0,G.jsx)(CloseButton,{})]}),(0,G.jsx)(Body,{className:"tlui-shortcuts-dialog__body",children:u.map(getKeyboardShortcutItem)}),(0,G.jsx)("div",{className:"tlui-dialog__scrim"})]})};function useLanguages(){let t=(0,e8.j)();return{languages:e0.a2,currentLanguage:t.user.locale}}let o0=U.createContext({}),o1=(0,eJ.j)(function({overrides:t,children:c}){let u=(0,e8.j)(),h=useActions(),f=u.selectedShapeIds.length,g=f>0,b=f>1,v=f>2,{languages:x,currentLanguage:w}=useLanguages(),{addDialog:_}=useDialogs(),k=(0,U.useMemo)(()=>{let c=(0,e1.oA)([menuGroup("top",menuCustom("LANGUAGE_MENU",{readonlyOk:!0}),menuItem({id:"keyboard-shortcuts",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect(){_({component:KeyboardShortcutsDialog})}}))]);return t?t(u,c,{actions:h,currentLanguage:w,languages:x,oneSelected:g,twoSelected:b,threeSelected:v}):c},[u,t,x,h,g,b,v,w,_]);return(0,G.jsx)(o0.Provider,{value:k,children:c})});function useHelpMenuSchema(){let t=U.useContext(o0);if(!t)throw Error("useHelpMenuSchema must be used inside of a helpTLUiMenuSchemaProvider.");return t}function useCanRedo(){let t=(0,e8.j)();return(0,eJ.Hg)("useCanRedo",()=>t.canRedo,[t])}function useCanUndo(){let t=(0,e8.j)();return(0,eJ.Hg)("useCanUndo",()=>t.canUndo,[t])}let o2=U.createContext({});function TLUiMenuSchemaProvider({overrides:t,children:c}){let u=(0,e8.j)(),h=useActions(),f=useBreakpoint(),g=f<5,b=(0,eJ.Hg)("isDarkMode",()=>u.user.isDarkMode,[u]),v=(0,eJ.Hg)("animationSpeed",()=>u.user.animationSpeed,[u]),x=(0,eJ.Hg)("isGridMode",()=>u.instanceState.isGridMode,[u]),w=(0,eJ.Hg)("isSnapMode",()=>u.user.isSnapMode,[u]),_=(0,eJ.Hg)("isToolLock",()=>u.instanceState.isToolLocked,[u]),k=(0,eJ.Hg)("isFocusMode",()=>u.instanceState.isFocusMode,[u]),E=(0,eJ.Hg)("isDebugMode",()=>u.instanceState.isDebugMode,[u]),$=(0,eJ.Hg)("exportBackground",()=>u.instanceState.exportBackground,[u]),T=(0,eJ.Hg)("emptyPage",()=>0===u.currentPageShapeIds.size,[u]),I=(0,eJ.Hg)("selectedCount",()=>u.selectedShapeIds.length,[u]),M=0===I,j=I>0,D=I>1,F=I>2,L=!!window.navigator.clipboard?.write,B=useHasLinkShapeSelected(),V=useShowAutoSizeToggle(),K=useAllowGroup(),Z=useAllowUngroup(),Y=useCanUndo(),X=useCanRedo(),J=(0,eJ.Hg)("isZoomedTo100",()=>1===u.zoomLevel,[u]),Q=(0,eJ.Hg)("oneEmbedSelected",()=>{let{onlySelectedShape:t}=u;return!!t&&!!(u.isShapeOfType(t,"embed")&&t.props.url&&!u.isShapeOrAncestorLocked(t))},[]),ee=(0,eJ.Hg)("oneEmbeddableBookmarkSelected",()=>{let{onlySelectedShape:t}=u;return!!t&&!!(u.isShapeOfType(t,"bookmark")&&t.props.url&&getEmbedInfo(t.props.url)&&!u.isShapeOrAncestorLocked(t))},[]),et=(0,U.useMemo)(()=>{let c=compactMenuItems([menuGroup("menu",menuSubmenu("file","menu.file",menuGroup("print",menuItem(h.print,{disabled:T}))),menuSubmenu("edit","menu.edit",menuGroup("undo-actions",menuItem(h.undo,{disabled:!Y}),menuItem(h.redo,{disabled:!X})),menuGroup("clipboard-actions",menuItem(h.cut,{disabled:M}),menuItem(h.copy,{disabled:M}),menuItem(h.paste,{disabled:!oU})),menuGroup("conversions",menuSubmenu("copy-as","menu.copy-as",menuGroup("copy-as-group",menuItem(h["copy-as-svg"],{disabled:T}),menuItem(h["copy-as-png"],{disabled:T||!L}),menuItem(h["copy-as-json"],{disabled:T})),menuGroup("export-bg",menuItem(h["toggle-transparent"],{checked:!$}))),menuSubmenu("export-as","menu.export-as",menuGroup("export-as-group",menuItem(h["export-as-svg"],{disabled:T}),menuItem(h["export-as-png"],{disabled:T}),menuItem(h["export-as-json"],{disabled:T})),menuGroup("export-bg",menuItem(h["toggle-transparent"],{checked:!$})))),menuGroup("set-selection-group",menuItem(h["select-all"],{disabled:T}),menuItem(h["select-none"],{disabled:!j})),menuGroup("selection",V&&menuItem(h["toggle-auto-size"]),B&&menuItem(h["edit-link"]),menuItem(h.duplicate,{disabled:!j}),K&&menuItem(h.group),Z&&menuItem(h.ungroup),menuItem(h["unlock-all"],{disabled:T})),menuGroup("delete-group",menuItem(h.delete,{disabled:!j})),menuGroup("embeds",Q&&menuItem(h["open-embed-link"]),Q&&menuItem(h["convert-to-bookmark"]),ee&&menuItem(h["convert-to-embed"]))),menuSubmenu("view","menu.view",menuGroup("view-actions",menuItem(h["zoom-in"]),menuItem(h["zoom-out"]),menuItem(h["zoom-to-100"],{disabled:J}),menuItem(h["zoom-to-fit"],{disabled:T}),menuItem(h["zoom-to-selection"],{disabled:T||!j})))),menuGroup("extras",menuItem(h["insert-embed"]),menuItem(h["insert-media"])),menuGroup("preferences",menuSubmenu("preferences","menu.preferences",menuGroup("preferences-actions",menuItem(h["toggle-snap-mode"],{checked:w}),menuItem(h["toggle-tool-lock"],{checked:_}),menuItem(h["toggle-grid"],{checked:x}),menuItem(h["toggle-dark-mode"],{checked:b}),menuItem(h["toggle-focus-mode"],{checked:k}),menuItem(h["toggle-reduce-motion"],{checked:0===v}),menuItem(h["toggle-debug-mode"],{checked:E}))),g&&menuCustom("LANGUAGE_MENU",{readonlyOk:!0}))]);return t?t(u,c,{actions:h,noneSelected:M,oneSelected:j,twoSelected:D,threeSelected:F}):c},[u,t,h,j,D,F,T,g,K,Z,B,L,V,M,Y,X,v,b,x,w,_,k,$,E,J,ee,Q]);return(0,G.jsx)(o2.Provider,{value:et,children:c})}function useMenuSchema(){let t=U.useContext(o2);if(!t)throw Error("useMenuSchema must be used inside of a TLUiMenuSchemaProvider.");return t}function toolbarItem(t){return{id:t.id,type:"item",readonlyOk:t.readonlyOk,toolItem:t}}let o3=U.createContext([]);function ToolbarSchemaProvider({overrides:t,children:c}){let u=(0,e8.j)(),h=useTools(),f=U.useMemo(()=>{let c=(0,e1.oA)([toolbarItem(h.select),toolbarItem(h.hand),toolbarItem(h.draw),toolbarItem(h.eraser),toolbarItem(h.arrow),toolbarItem(h.text),toolbarItem(h.note),toolbarItem(h.asset),toolbarItem(h.rectangle),toolbarItem(h.ellipse),toolbarItem(h.diamond),toolbarItem(h.triangle),toolbarItem(h.trapezoid),toolbarItem(h.rhombus),toolbarItem(h.hexagon),toolbarItem(h.cloud),toolbarItem(h.star),toolbarItem(h.oval),toolbarItem(h["x-box"]),toolbarItem(h["check-box"]),toolbarItem(h["arrow-left"]),toolbarItem(h["arrow-up"]),toolbarItem(h["arrow-down"]),toolbarItem(h["arrow-right"]),toolbarItem(h.frame),toolbarItem(h.line),toolbarItem(h.highlight),toolbarItem(h.laser)]);return t?t(u,c,{tools:h}):c},[u,t,h]);return(0,G.jsx)(o3.Provider,{value:f,children:c})}function useToolbarSchema(){let t=U.useContext(o3);if(!t)throw Error("useToolbarSchema must be used within a ToolbarSchemaProvider");return t}function useDefaultHelpers(){let{addToast:t,removeToast:c,clearToasts:u}=useToasts(),{addDialog:h,clearDialogs:f,removeDialog:g,updateDialog:b}=useDialogs(),v=useBreakpoint(),x=v<5,w=useTranslation();return(0,U.useMemo)(()=>({addToast:t,removeToast:c,clearToasts:u,addDialog:h,clearDialogs:f,removeDialog:g,updateDialog:b,msg:w,isMobile:x}),[h,t,f,u,w,g,c,b,x])}function mergeOverrides(t,c){let u={};for(let c of t)if(c.translations)for(let[t,h]of(0,e1.EP)(c.translations)){let c=u[t];c||(c=u[t]={}),Object.assign(c,h)}return{actionsMenu:(u,h,f)=>{for(let g of t)g.actionsMenu&&(h=g.actionsMenu(u,h,{...c,...f}));return h},actions:(u,h)=>{for(let f of t)f.actions&&(h=f.actions(u,h,c));return h},contextMenu:(u,h,f)=>{for(let g of t)g.contextMenu&&(h=g.contextMenu(u,h,{...c,...f}));return h},helpMenu:(u,h,f)=>{for(let g of t)g.helpMenu&&(h=g.helpMenu(u,h,{...c,...f}));return h},menu:(u,h,f)=>{for(let g of t)g.menu&&(h=g.menu(u,h,{...c,...f}));return h},toolbar:(u,h,f)=>{for(let g of t)g.toolbar&&(h=g.toolbar(u,h,{...c,...f}));return h},keyboardShortcutsMenu:(u,h,f)=>{for(let g of t)g.keyboardShortcutsMenu&&(h=g.keyboardShortcutsMenu(u,h,{...c,...f}));return h},tools:(u,h,f)=>{for(let g of t)g.tools&&(h=g.tools(u,h,{...c,...f}));return h},translations:u}}function useShallowArrayEquality(t){return(0,U.useMemo)(()=>t,t)}function useMergedTranslationOverrides(t){let c=useShallowArrayEquality(null==t?[]:Array.isArray(t)?t:[t]);return(0,U.useMemo)(()=>{let t={};for(let u of c)if(u.translations)for(let[c,h]of(0,e1.EP)(u.translations)){let u=t[c];u||(u=t[c]={}),Object.assign(u,h)}return t},[c])}function useMergedOverrides(t){let c=useDefaultHelpers(),u=useShallowArrayEquality(null==t?[]:Array.isArray(t)?t:[t]);return(0,U.useMemo)(()=>mergeOverrides(u,c),[u,c])}function TldrawUiContextProvider({overrides:t,assetUrls:c,onUiEvent:u,children:h}){return(0,G.jsx)(AssetUrlsProvider,{assetUrls:useDefaultUiAssetUrlsWithOverrides(c),children:(0,G.jsx)(nN,{overrides:useMergedTranslationOverrides(t),children:(0,G.jsx)(UiEventsProvider,{onEvent:u,children:(0,G.jsx)(ToastsProvider,{children:(0,G.jsx)(DialogsProvider,{children:(0,G.jsx)(BreakPointProvider,{children:(0,G.jsx)(InternalProviders,{overrides:t,children:h})})})})})})})}function InternalProviders({overrides:t,children:c}){let u=useMergedOverrides(t);return(0,G.jsx)(ActionsProvider,{overrides:u.actions,children:(0,G.jsx)(ToolsProvider,{overrides:u.tools,children:(0,G.jsx)(ToolbarSchemaProvider,{overrides:u.toolbar,children:(0,G.jsx)(oZ,{overrides:u.actionsMenu,children:(0,G.jsx)(oQ,{overrides:u.keyboardShortcutsMenu,children:(0,G.jsx)(oq,{overrides:u.contextMenu,children:(0,G.jsx)(o1,{overrides:u.helpMenu,children:(0,G.jsx)(TLUiMenuSchemaProvider,{overrides:u.menu,children:c})})})})})})})})}function BackToContent(){let t=(0,e8.j)(),c=useActions(),u=c["back-to-content"],[h,f]=(0,U.useState)(!1);return((0,U.useEffect)(()=>{let c=!1,u=setInterval(()=>{let{renderingShapes:u,renderingBounds:h}=t,g=u.filter(t=>t.maskedPageBounds&&h.includes(t.maskedPageBounds)),b=0===g.length&&t.currentPageShapes.length>0;c!==b&&(f(b),c=b)},1e3);return()=>{clearInterval(u)}},[t]),h)?(0,G.jsx)(nU,{iconLeft:u.icon,label:u.label,onClick:()=>{u.onSelect("helper-buttons"),f(!1)}}):null}let o5=0;function createNShapes(t,c){let u=Array(c),h=Math.floor(Math.sqrt(c));for(let t=0;t<c;t++)o5++,u[t]={id:(0,e0.F1)("box"+o5),type:"geo",x:t%h*132,y:132*Math.floor(t/h)};t.batch(()=>{t.createShapes(u).setSelectedShapes(u.map(t=>t.id))})}let o4=U.memo(function({renderDebugMenuItems:t}){let c=useTranslation();return(0,G.jsxs)("div",{className:"tlui-debug-panel",children:[(0,G.jsx)(o8,{}),(0,G.jsx)(ShapeCount,{}),(0,G.jsxs)(Root,{id:"debug",children:[(0,G.jsx)(Trigger,{children:(0,G.jsx)(nU,{icon:"dots-horizontal",title:c("debug-panel.more")})}),(0,G.jsx)(Content,{side:"top",align:"end",alignOffset:0,children:(0,G.jsx)(o6,{renderDebugMenuItems:t})})]})]})}),o8=(0,eJ.j)(function(){let t=(0,e8.j)();return(0,G.jsx)("div",{className:"tlui-debug-panel__current-state",children:t.root.path.value})}),ShapeCount=function(){let t=(0,e8.j)(),c=(0,eJ.Hg)("rendering shapes count",()=>t.renderingShapes.length,[t]);return(0,G.jsxs)("div",{children:[c," Shapes"]})},o6=(0,eJ.j)(function({renderDebugMenuItems:t}){let c=(0,e8.j)(),{addToast:u}=useToasts(),{addDialog:h}=useDialogs(),[f,g]=U.useState(!1);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(Group,{children:[(0,G.jsx)(Item,{onClick:()=>{u({id:(0,tK.E)(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!"})},children:(0,G.jsx)("span",{children:"Show toast"})}),(0,G.jsx)(Item,{onClick:()=>{h({component:({onClose:t})=>(0,G.jsx)(ExampleDialog,{displayDontShowAgain:!0,onCancel:()=>{t()},onContinue:()=>{t()}}),onClose:()=>{}})},children:(0,G.jsx)("span",{children:"Show dialog"})}),(0,G.jsx)(Item,{onClick:()=>createNShapes(c,100),children:(0,G.jsx)("span",{children:"Create 100 shapes"})}),(0,G.jsx)(Item,{onClick:()=>{function countDescendants({children:t}){let c=0;if(!t.length)return 0;for(let u of[...t])c++,c+=countDescendants(u);return c}let{selectedShapes:t}=c,u=0===t.length?c.renderingShapes:t,h=u.map(t=>document.getElementById(t.id).parentElement),f=h.length;for(let t of h)f+=countDescendants(t);window.alert(`Shapes ${u.length}, DOM nodes:${f}`)},children:(0,G.jsx)("span",{children:"Count shapes and nodes"})}),(()=>{if(f)throw Error("oh no!")})(),(0,G.jsx)(Item,{onClick:()=>{g(!0)},children:(0,G.jsx)("span",{children:"Throw error"})}),(0,G.jsx)(Item,{onClick:()=>{hardResetEditor()},children:(0,G.jsx)("span",{children:"Hard reset"})})]}),(0,G.jsxs)(Group,{children:[(0,G.jsx)(o7,{flag:e4.debugSvg}),(0,G.jsx)(o7,{flag:e4.forceSrgb}),(0,G.jsx)(o7,{flag:e4.debugGeometry}),(0,G.jsx)(o7,{flag:e4.hideShapes})]}),(0,G.jsx)(Group,{children:Object.values(e5).map(t=>(0,G.jsx)(o7,{flag:t},t.name))}),t?.()]})});function Toggle({label:t,value:c,onChange:u}){return(0,G.jsx)(CheckboxItem,{title:t,checked:c,onSelect:()=>u(!c),children:t})}let o7=(0,eJ.j)(function({flag:t,onChange:c}){return(0,G.jsx)(Toggle,{label:t.name.replace(/([a-z0-9])([A-Z])/g,t=>`${t[0]} ${t[1].toLowerCase()}`).replace(/^[a-z]/,t=>t.toUpperCase()),value:t.value,onChange:u=>{t.set(u),c?.(u)}})});function ExampleDialog({title:t="title",body:c="hello hello hello",cancel:u="Cancel",confirm:h="Continue",displayDontShowAgain:f=!1,onCancel:g,onContinue:b}){let[v,x]=U.useState(!1);return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)(Header,{children:[(0,G.jsx)(Title,{children:t}),(0,G.jsx)(CloseButton,{})]}),(0,G.jsx)(Body,{style:{maxWidth:350},children:c}),(0,G.jsxs)(Footer,{className:"tlui-dialog__footer__actions",children:[f&&(0,G.jsx)(nU,{onClick:()=>x(!v),iconLeft:v?"checkbox-checked":"checkbox-empty",style:{marginRight:"auto"},children:"Don't show again"}),(0,G.jsx)(nU,{onClick:g,children:u}),(0,G.jsx)(nU,{type:"primary",onClick:async()=>b(),children:h})]})]})}let Dialog=({id:t,component:c,onClose:u})=>{let{removeDialog:h}=useDialogs(),f=useContainer(),g=(0,U.useCallback)(c=>{if(!c){if(u)try{u()}catch(t){console.warn(t)}h(t)}},[t,u,h]);return(0,G.jsx)($5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9,{onOpenChange:g,defaultOpen:!0,children:(0,G.jsx)($5d3850c4d0b4e6c7$export$602eac185826482c,{container:f,children:(0,G.jsx)(eL,{dir:"ltr",className:"tlui-dialog__overlay",children:(0,G.jsx)(eB,{dir:"ltr",className:"tlui-dialog__content",children:(0,G.jsx)(c,{onClose:()=>g(!1)})})})})})};function _Dialogs(){let{dialogs:t}=useDialogs();return(0,G.jsx)(G.Fragment,{children:t.map(t=>(0,G.jsx)(Dialog,{...t},t.id))})}let o9=U.memo(_Dialogs);function FollowingIndicator(){let t=(0,e8.j)(),c=(0,eJ.Hg)("follow",()=>t.instanceState.followingUserId,[t]);return c?(0,G.jsx)(FollowingIndicatorInner,{userId:c}):null}function FollowingIndicatorInner({userId:t}){let c=usePresence(t);return c?(0,G.jsx)("div",{className:"tlui-following",style:{borderColor:c.color}}):null}function LanguageMenu(){let t=(0,e8.j)(),{languages:c,currentLanguage:u}=useLanguages(),h=(0,U.useCallback)(c=>t.user.updateUserPreferences({locale:c}),[t]);return(0,G.jsxs)(Sub,{id:"help menu language",children:[(0,G.jsx)(SubTrigger,{label:"menu.language","data-direction":"left"}),(0,G.jsx)(SubContent,{sideOffset:-4,children:(0,G.jsx)(Group,{children:c.map(({locale:t,label:c})=>(0,G.jsx)(RadioItem,{title:t,checked:t===u,onSelect:()=>h(t),children:(0,G.jsx)("span",{children:c})},t))})})]})}let ae=U.memo(function(){let t=useContainer(),c=useTranslation(),[u,h]=useMenuIsOpen("help menu");return(0,G.jsx)("div",{className:"tlui-help-menu",children:(0,G.jsxs)($d08ef79370b62062$export$be92b6f5f03c0fe9,{dir:"ltr",open:u,onOpenChange:h,modal:!1,children:[(0,G.jsx)(il,{className:"tlui-button tlui-help-menu__button",dir:"ltr",title:c("help-menu.title"),children:(0,G.jsx)(nz,{icon:"question-mark"})}),(0,G.jsx)($d08ef79370b62062$export$602eac185826482c,{container:t,dir:"ltr",children:(0,G.jsx)(ic,{className:"tlui-menu",side:"top",sideOffset:8,align:"end",alignOffset:0,collisionPadding:4,children:(0,G.jsx)(HelpMenuContent,{})})})]})})});function HelpMenuContent(){let t=useHelpMenuSchema(),c=useReadonly();function getHelpMenuItem(t){if(c&&!t.readonlyOk)return null;switch(t.type){case"custom":if("LANGUAGE_MENU"===t.id)return(0,G.jsx)(LanguageMenu,{},"item");break;case"group":return(0,G.jsx)(Group,{size:"small",children:t.children.map(getHelpMenuItem)},t.id);case"submenu":return(0,G.jsxs)(Sub,{id:`help menu ${t.id}`,children:[(0,G.jsx)(SubTrigger,{label:t.label}),(0,G.jsx)(SubContent,{children:t.children.map(getHelpMenuItem)})]},t.id);case"item":{let{id:c,kbd:u,label:h,onSelect:f,icon:g}=t.actionItem;return(0,G.jsx)(Item,{kbd:u,label:h,onClick:()=>f("help-menu"),iconLeft:g},c)}}}return(0,G.jsx)(G.Fragment,{children:t.map(getHelpMenuItem)})}function index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t,c,{checkForDefaultPrevented:u=!0}={}){return function(h){if(null==t||t(h),!1===u||!h.defaultPrevented)return null==c?void 0:c(h)}}function index_module_$6ed0406888f73fc4$var$setRef(t,c){"function"==typeof t?t(c):null!=t&&(t.current=c)}function index_module_$6ed0406888f73fc4$export$43e446d32b3d21af(...t){return c=>t.forEach(t=>index_module_$6ed0406888f73fc4$var$setRef(t,c))}function index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(...t){return(0,U.useCallback)(index_module_$6ed0406888f73fc4$export$43e446d32b3d21af(...t),t)}function index_module_$c512c27ab02ef895$export$50c7b4e9d9f19c1(t,c=[]){let u=[];function $c512c27ab02ef895$export$fd42f52fd3ae1109(c,h){let f=(0,U.createContext)(h),g=u.length;function Provider(c){let{scope:u,children:h,...b}=c,v=(null==u?void 0:u[t][g])||f,x=(0,U.useMemo)(()=>b,Object.values(b));return(0,U.createElement)(v.Provider,{value:x},h)}function useContext(u,b){let v=(null==b?void 0:b[t][g])||f,x=(0,U.useContext)(v);if(x)return x;if(void 0!==h)return h;throw Error(`\`${u}\` must be used within \`${c}\``)}return u=[...u,h],Provider.displayName=c+"Provider",[Provider,useContext]}let createScope=()=>{let c=u.map(t=>(0,U.createContext)(t));return function(u){let h=(null==u?void 0:u[t])||c;return(0,U.useMemo)(()=>({[`__scope${t}`]:{...u,[t]:h}}),[u,h])}};return createScope.scopeName=t,[$c512c27ab02ef895$export$fd42f52fd3ae1109,index_module_$c512c27ab02ef895$var$composeContextScopes(createScope,...c)]}function index_module_$c512c27ab02ef895$var$composeContextScopes(...t){let c=t[0];if(1===t.length)return c;let createScope1=()=>{let u=t.map(t=>({useScope:t(),scopeName:t.scopeName}));return function(t){let h=u.reduce((c,{useScope:u,scopeName:h})=>{let f=u(t),g=f[`__scope${h}`];return{...c,...g}},{});return(0,U.useMemo)(()=>({[`__scope${c.scopeName}`]:h}),[h])}};return createScope1.scopeName=c.scopeName,createScope1}let at=(0,U.forwardRef)((t,c)=>{let{children:u,...h}=t,f=U.Children.toArray(u),g=f.find(index_module_$5e63c961fc1ce211$var$isSlottable);if(g){let t=g.props.children,u=f.map(c=>c!==g?c:U.Children.count(t)>1?U.Children.only(null):(0,U.isValidElement)(t)?t.props.children:null);return(0,U.createElement)(an,_extends({},h,{ref:c}),(0,U.isValidElement)(t)?(0,U.cloneElement)(t,void 0,u):null)}return(0,U.createElement)(an,_extends({},h,{ref:c}),u)});at.displayName="Slot";let an=(0,U.forwardRef)((t,c)=>{let{children:u,...h}=t;return(0,U.isValidElement)(u)?(0,U.cloneElement)(u,{...index_module_$5e63c961fc1ce211$var$mergeProps(h,u.props),ref:index_module_$6ed0406888f73fc4$export$43e446d32b3d21af(c,u.ref)}):U.Children.count(u)>1?U.Children.only(null):null});an.displayName="SlotClone";let index_module_$5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:t})=>(0,U.createElement)(U.Fragment,null,t);function index_module_$5e63c961fc1ce211$var$isSlottable(t){return(0,U.isValidElement)(t)&&t.type===index_module_$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function index_module_$5e63c961fc1ce211$var$mergeProps(t,c){let u={...c};for(let h in c){let f=t[h],g=c[h],b=/^on[A-Z]/.test(h);b?f&&g?u[h]=(...t)=>{g(...t),f(...t)}:f&&(u[h]=f):"style"===h?u[h]={...f,...g}:"className"===h&&(u[h]=[f,g].filter(Boolean).join(" "))}return{...t,...u}}let ar=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((t,c)=>{let u=(0,U.forwardRef)((t,u)=>{let{asChild:h,...f}=t,g=h?at:c;return(0,U.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,U.createElement)(g,_extends({},f,{ref:u}))});return u.displayName=`Primitive.${c}`,{...t,[c]:u}},{});function index_module_$8927f6f2acc4f386$export$6d1a0317bde7de7f(t,c){t&&(0,X.flushSync)(()=>t.dispatchEvent(c))}function index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t){let c=(0,U.useRef)(t);return(0,U.useEffect)(()=>{c.current=t}),(0,U.useMemo)(()=>(...t)=>{var u;return null===(u=c.current)||void 0===u?void 0:u.call(c,...t)},[])}function index_module_$addc16e1bbe58fd0$export$3a72a57244d6e765(t,c=null==globalThis?void 0:globalThis.document){let u=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t);(0,U.useEffect)(()=>{let handleKeyDown=t=>{"Escape"===t.key&&u(t)};return c.addEventListener("keydown",handleKeyDown),()=>c.removeEventListener("keydown",handleKeyDown)},[u,c])}let ai="dismissableLayer.update",ao=(0,U.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),aa=(0,U.forwardRef)((t,c)=>{var u;let{disableOutsidePointerEvents:h=!1,onEscapeKeyDown:f,onPointerDownOutside:g,onFocusOutside:v,onInteractOutside:x,onDismiss:w,..._}=t,k=(0,U.useContext)(ao),[E,$]=(0,U.useState)(null),T=null!==(u=null==E?void 0:E.ownerDocument)&&void 0!==u?u:null==globalThis?void 0:globalThis.document,[,I]=(0,U.useState)({}),M=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>$(t)),j=Array.from(k.layers),[D]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),F=j.indexOf(D),L=E?j.indexOf(E):-1,B=k.layersWithOutsidePointerEventsDisabled.size>0,G=L>=F,V=index_module_$5cb92bef7577960e$var$usePointerDownOutside(t=>{let c=t.target,u=[...k.branches].some(t=>t.contains(c));!G||u||(null==g||g(t),null==x||x(t),t.defaultPrevented||null==w||w())},T),K=index_module_$5cb92bef7577960e$var$useFocusOutside(t=>{let c=t.target,u=[...k.branches].some(t=>t.contains(c));u||(null==v||v(t),null==x||x(t),t.defaultPrevented||null==w||w())},T);return index_module_$addc16e1bbe58fd0$export$3a72a57244d6e765(t=>{let c=L===k.layers.size-1;c&&(null==f||f(t),!t.defaultPrevented&&w&&(t.preventDefault(),w()))},T),(0,U.useEffect)(()=>{if(E)return h&&(0===k.layersWithOutsidePointerEventsDisabled.size&&(b=T.body.style.pointerEvents,T.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(E)),k.layers.add(E),index_module_$5cb92bef7577960e$var$dispatchUpdate(),()=>{h&&1===k.layersWithOutsidePointerEventsDisabled.size&&(T.body.style.pointerEvents=b)}},[E,T,h,k]),(0,U.useEffect)(()=>()=>{E&&(k.layers.delete(E),k.layersWithOutsidePointerEventsDisabled.delete(E),index_module_$5cb92bef7577960e$var$dispatchUpdate())},[E,k]),(0,U.useEffect)(()=>{let handleUpdate=()=>I({});return document.addEventListener(ai,handleUpdate),()=>document.removeEventListener(ai,handleUpdate)},[]),(0,U.createElement)(ar.div,_extends({},_,{ref:M,style:{pointerEvents:B?G?"auto":"none":void 0,...t.style},onFocusCapture:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocusCapture,K.onFocusCapture),onBlurCapture:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onBlurCapture,K.onBlurCapture),onPointerDownCapture:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDownCapture,V.onPointerDownCapture)}))});function index_module_$5cb92bef7577960e$var$usePointerDownOutside(t,c=null==globalThis?void 0:globalThis.document){let u=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t),h=(0,U.useRef)(!1),f=(0,U.useRef)(()=>{});return(0,U.useEffect)(()=>{let handlePointerDown=t=>{if(t.target&&!h.current){let h={originalEvent:t};function handleAndDispatchPointerDownOutsideEvent(){index_module_$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.pointerDownOutside",u,h,{discrete:!0})}"touch"===t.pointerType?(c.removeEventListener("click",f.current),f.current=handleAndDispatchPointerDownOutsideEvent,c.addEventListener("click",f.current,{once:!0})):handleAndDispatchPointerDownOutsideEvent()}h.current=!1},t=window.setTimeout(()=>{c.addEventListener("pointerdown",handlePointerDown)},0);return()=>{window.clearTimeout(t),c.removeEventListener("pointerdown",handlePointerDown),c.removeEventListener("click",f.current)}},[c,u]),{onPointerDownCapture:()=>h.current=!0}}function index_module_$5cb92bef7577960e$var$useFocusOutside(t,c=null==globalThis?void 0:globalThis.document){let u=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(t),h=(0,U.useRef)(!1);return(0,U.useEffect)(()=>{let handleFocus=t=>{t.target&&!h.current&&index_module_$5cb92bef7577960e$var$handleAndDispatchCustomEvent("dismissableLayer.focusOutside",u,{originalEvent:t},{discrete:!1})};return c.addEventListener("focusin",handleFocus),()=>c.removeEventListener("focusin",handleFocus)},[c,u]),{onFocusCapture:()=>h.current=!0,onBlurCapture:()=>h.current=!1}}function index_module_$5cb92bef7577960e$var$dispatchUpdate(){let t=new CustomEvent(ai);document.dispatchEvent(t)}function index_module_$5cb92bef7577960e$var$handleAndDispatchCustomEvent(t,c,u,{discrete:h}){let f=u.originalEvent.target,g=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:u});c&&f.addEventListener(t,c,{once:!0}),h?index_module_$8927f6f2acc4f386$export$6d1a0317bde7de7f(f,g):f.dispatchEvent(g)}let as=0;function index_module_$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(){(0,U.useEffect)(()=>{var t,c;let u=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",null!==(t=u[0])&&void 0!==t?t:index_module_$3db38b7d1fb3fe6a$var$createFocusGuard()),document.body.insertAdjacentElement("beforeend",null!==(c=u[1])&&void 0!==c?c:index_module_$3db38b7d1fb3fe6a$var$createFocusGuard()),as++,()=>{1===as&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),as--}},[])}function index_module_$3db38b7d1fb3fe6a$var$createFocusGuard(){let t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}let al="focusScope.autoFocusOnMount",ac="focusScope.autoFocusOnUnmount",au={bubbles:!1,cancelable:!0},ad=(0,U.forwardRef)((t,c)=>{let{loop:u=!1,trapped:h=!1,onMountAutoFocus:f,onUnmountAutoFocus:g,...b}=t,[v,x]=(0,U.useState)(null),w=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(f),_=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g),k=(0,U.useRef)(null),E=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>x(t)),$=(0,U.useRef)({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;(0,U.useEffect)(()=>{if(h){function handleFocusIn(t){if($.paused||!v)return;let c=t.target;v.contains(c)?k.current=c:index_module_$d3863c46a17e8a28$var$focus(k.current,{select:!0})}function handleFocusOut(t){$.paused||!v||v.contains(t.relatedTarget)||index_module_$d3863c46a17e8a28$var$focus(k.current,{select:!0})}return document.addEventListener("focusin",handleFocusIn),document.addEventListener("focusout",handleFocusOut),()=>{document.removeEventListener("focusin",handleFocusIn),document.removeEventListener("focusout",handleFocusOut)}}},[h,v,$.paused]),(0,U.useEffect)(()=>{if(v){ap.add($);let t=document.activeElement,c=v.contains(t);if(!c){let c=new CustomEvent(al,au);v.addEventListener(al,w),v.dispatchEvent(c),c.defaultPrevented||(index_module_$d3863c46a17e8a28$var$focusFirst(index_module_$d3863c46a17e8a28$var$removeLinks(index_module_$d3863c46a17e8a28$var$getTabbableCandidates(v)),{select:!0}),document.activeElement===t&&index_module_$d3863c46a17e8a28$var$focus(v))}return()=>{v.removeEventListener(al,w),setTimeout(()=>{let c=new CustomEvent(ac,au);v.addEventListener(ac,_),v.dispatchEvent(c),c.defaultPrevented||index_module_$d3863c46a17e8a28$var$focus(null!=t?t:document.body,{select:!0}),v.removeEventListener(ac,_),ap.remove($)},0)}}},[v,w,_,$]);let T=(0,U.useCallback)(t=>{if(!u&&!h||$.paused)return;let c="Tab"===t.key&&!t.altKey&&!t.ctrlKey&&!t.metaKey,f=document.activeElement;if(c&&f){let c=t.currentTarget,[h,g]=index_module_$d3863c46a17e8a28$var$getTabbableEdges(c),b=h&&g;b?t.shiftKey||f!==g?t.shiftKey&&f===h&&(t.preventDefault(),u&&index_module_$d3863c46a17e8a28$var$focus(g,{select:!0})):(t.preventDefault(),u&&index_module_$d3863c46a17e8a28$var$focus(h,{select:!0})):f===c&&t.preventDefault()}},[u,h,$.paused]);return(0,U.createElement)(ar.div,_extends({tabIndex:-1},b,{ref:E,onKeyDown:T}))});function index_module_$d3863c46a17e8a28$var$focusFirst(t,{select:c=!1}={}){let u=document.activeElement;for(let h of t)if(index_module_$d3863c46a17e8a28$var$focus(h,{select:c}),document.activeElement!==u)return}function index_module_$d3863c46a17e8a28$var$getTabbableEdges(t){let c=index_module_$d3863c46a17e8a28$var$getTabbableCandidates(t),u=index_module_$d3863c46a17e8a28$var$findVisible(c,t),h=index_module_$d3863c46a17e8a28$var$findVisible(c.reverse(),t);return[u,h]}function index_module_$d3863c46a17e8a28$var$getTabbableCandidates(t){let c=[],u=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{let c="INPUT"===t.tagName&&"hidden"===t.type;return t.disabled||t.hidden||c?NodeFilter.FILTER_SKIP:t.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;u.nextNode();)c.push(u.currentNode);return c}function index_module_$d3863c46a17e8a28$var$findVisible(t,c){for(let u of t)if(!index_module_$d3863c46a17e8a28$var$isHidden(u,{upTo:c}))return u}function index_module_$d3863c46a17e8a28$var$isHidden(t,{upTo:c}){if("hidden"===getComputedStyle(t).visibility)return!0;for(;t&&(void 0===c||t!==c);){if("none"===getComputedStyle(t).display)return!0;t=t.parentElement}return!1}function index_module_$d3863c46a17e8a28$var$isSelectableInput(t){return t instanceof HTMLInputElement&&"select"in t}function index_module_$d3863c46a17e8a28$var$focus(t,{select:c=!1}={}){if(t&&t.focus){let u=document.activeElement;t.focus({preventScroll:!0}),t!==u&&index_module_$d3863c46a17e8a28$var$isSelectableInput(t)&&c&&t.select()}}let ap=index_module_$d3863c46a17e8a28$var$createFocusScopesStack();function index_module_$d3863c46a17e8a28$var$createFocusScopesStack(){let t=[];return{add(c){let u=t[0];c!==u&&(null==u||u.pause()),(t=index_module_$d3863c46a17e8a28$var$arrayRemove(t,c)).unshift(c)},remove(c){var u;null===(u=(t=index_module_$d3863c46a17e8a28$var$arrayRemove(t,c))[0])||void 0===u||u.resume()}}}function index_module_$d3863c46a17e8a28$var$arrayRemove(t,c){let u=[...t],h=u.indexOf(c);return -1!==h&&u.splice(h,1),u}function index_module_$d3863c46a17e8a28$var$removeLinks(t){return t.filter(t=>"A"!==t.tagName)}let ah=(null==globalThis?void 0:globalThis.document)?U.useLayoutEffect:()=>{},af=V["useId".toString()]||(()=>void 0),ag=0;function index_module_$1746a345f3d73bb7$export$f680877a34711e37(t){let[c,u]=U.useState(af());return ah(()=>{t||u(t=>null!=t?t:String(ag++))},[t]),t||(c?`radix-${c}`:"")}function floating_ui_core_browser_min_t(t){return t.split("-")[0]}function e(t){return t.split("-")[1]}function n(t){return["top","bottom"].includes(floating_ui_core_browser_min_t(t))?"x":"y"}function r(t){return"y"===t?"height":"width"}function i(t,c,u){let h,{reference:f,floating:g}=t,b=f.x+f.width/2-g.width/2,v=f.y+f.height/2-g.height/2,x=n(c),w=r(x),_=f[w]/2-g[w]/2,k="x"===x;switch(floating_ui_core_browser_min_t(c)){case"top":h={x:b,y:f.y-g.height};break;case"bottom":h={x:b,y:f.y+f.height};break;case"right":h={x:f.x+f.width,y:v};break;case"left":h={x:f.x-g.width,y:v};break;default:h={x:f.x,y:f.y}}switch(e(c)){case"start":h[x]-=_*(u&&k?-1:1);break;case"end":h[x]+=_*(u&&k?-1:1)}return h}let floating_ui_core_browser_min_o=async(t,c,u)=>{let{placement:h="bottom",strategy:f="absolute",middleware:g=[],platform:b}=u,v=await (null==b.isRTL?void 0:b.isRTL(c)),x=await b.getElementRects({reference:t,floating:c,strategy:f}),{x:w,y:_}=i(x,h,v),k=h,E={},$=0;for(let u=0;u<g.length;u++){let{name:T,fn:I}=g[u],{x:M,y:j,data:D,reset:F}=await I({x:w,y:_,initialPlacement:h,placement:k,strategy:f,middlewareData:E,rects:x,platform:b,elements:{reference:t,floating:c}});w=null!=M?M:w,_=null!=j?j:_,E={...E,[T]:{...E[T],...D}},F&&$<=50&&($++,"object"==typeof F&&(F.placement&&(k=F.placement),F.rects&&(x=!0===F.rects?await b.getElementRects({reference:t,floating:c,strategy:f}):F.rects),{x:w,y:_}=i(x,k,v)),u=-1)}return{x:w,y:_,placement:k,strategy:f,middlewareData:E}};function a(t){return"number"!=typeof t?{top:0,right:0,bottom:0,left:0,...t}:{top:t,right:t,bottom:t,left:t}}function l(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function s(t,c){var u;void 0===c&&(c={});let{x:h,y:f,platform:g,rects:b,elements:v,strategy:x}=t,{boundary:w="clippingAncestors",rootBoundary:_="viewport",elementContext:k="floating",altBoundary:E=!1,padding:$=0}=c,T=a($),I=v[E?"floating"===k?"reference":"floating":k],M=l(await g.getClippingRect({element:null==(u=await (null==g.isElement?void 0:g.isElement(I)))||u?I:I.contextElement||await (null==g.getDocumentElement?void 0:g.getDocumentElement(v.floating)),boundary:w,rootBoundary:_,strategy:x})),j=l(g.convertOffsetParentRelativeRectToViewportRelativeRect?await g.convertOffsetParentRelativeRectToViewportRelativeRect({rect:"floating"===k?{...b.floating,x:h,y:f}:b.reference,offsetParent:await (null==g.getOffsetParent?void 0:g.getOffsetParent(v.floating)),strategy:x}):b[k]);return{top:M.top-j.top+T.top,bottom:j.bottom-M.bottom+T.bottom,left:M.left-j.left+T.left,right:j.right-M.right+T.right}}let am=Math.min,ab=Math.max,m=t=>({name:"arrow",options:t,async fn(c){let{element:u,padding:h=0}=null!=t?t:{},{x:f,y:g,placement:b,rects:v,platform:x}=c;if(null==u)return{};let w=a(h),_={x:f,y:g},k=n(b),E=e(b),$=r(k),T=await x.getDimensions(u),I="y"===k?"top":"left",M="y"===k?"bottom":"right",j=v.reference[$]+v.reference[k]-_[k]-v.floating[$],D=_[k]-v.reference[k],F=await (null==x.getOffsetParent?void 0:x.getOffsetParent(u)),L=F?"y"===k?F.clientHeight||0:F.clientWidth||0:0;0===L&&(L=v.floating[$]);let B=w[I],G=L-T[$]-w[M],U=L/2-T[$]/2+(j/2-D/2),V=ab(B,am(U,G)),K=("start"===E?w[I]:w[M])>0&&U!==V&&v.reference[$]<=v.floating[$];return{[k]:_[k]-(K?U<B?B-U:G-U:0),data:{[k]:V,centerOffset:U-V}}}}),ay={left:"right",right:"left",bottom:"top",top:"bottom"};function d(t){return t.replace(/left|right|bottom|top/g,t=>ay[t])}function p(t,c,u){void 0===u&&(u=!1);let h=e(t),f=n(t),g=r(f),b="x"===f?h===(u?"end":"start")?"right":"left":"start"===h?"bottom":"top";return c.reference[g]>c.floating[g]&&(b=d(b)),{main:b,cross:d(b)}}let av={start:"end",end:"start"};function y(t){return t.replace(/start|end/g,t=>av[t])}let ax=["top","right","bottom","left"];function R(t,c){return{top:t.top-c.height,right:t.right-c.width,bottom:t.bottom-c.height,left:t.left-c.width}}function A(t){return ax.some(c=>t[c]>=0)}ax.reduce((t,c)=>t.concat(c,c+"-start",c+"-end"),[]);let P=function(t){let{strategy:c="referenceHidden",...u}=void 0===t?{}:t;return{name:"hide",async fn(t){let{rects:h}=t;switch(c){case"referenceHidden":{let c=R(await s(t,{...u,elementContext:"reference"}),h.reference);return{data:{referenceHiddenOffsets:c,referenceHidden:A(c)}}}case"escaped":{let c=R(await s(t,{...u,altBoundary:!0}),h.floating);return{data:{escapedOffsets:c,escaped:A(c)}}}default:return{}}}}};function O(t){return"x"===t?"y":"x"}function floating_ui_dom_browser_min_n(t){return t&&t.document&&t.location&&t.alert&&t.setInterval}function o(t){if(null==t)return window;if(!floating_ui_dom_browser_min_n(t)){let c=t.ownerDocument;return c&&c.defaultView||window}return t}function floating_ui_dom_browser_min_i(t){return o(t).getComputedStyle(t)}function floating_ui_dom_browser_min_r(t){return floating_ui_dom_browser_min_n(t)?"":t?(t.nodeName||"").toLowerCase():""}function floating_ui_dom_browser_min_l(){let t=navigator.userAgentData;return null!=t&&t.brands?t.brands.map(t=>t.brand+"/"+t.version).join(" "):navigator.userAgent}function floating_ui_dom_browser_min_c(t){return t instanceof o(t).HTMLElement}function floating_ui_dom_browser_min_f(t){return t instanceof o(t).Element}function floating_ui_dom_browser_min_s(t){return"undefined"!=typeof ShadowRoot&&(t instanceof o(t).ShadowRoot||t instanceof ShadowRoot)}function floating_ui_dom_browser_min_u(t){let{overflow:c,overflowX:u,overflowY:h}=floating_ui_dom_browser_min_i(t);return/auto|scroll|overlay|hidden/.test(c+h+u)}function floating_ui_dom_browser_min_d(t){return["table","td","th"].includes(floating_ui_dom_browser_min_r(t))}function floating_ui_dom_browser_min_h(t){let c=/firefox/i.test(floating_ui_dom_browser_min_l()),u=floating_ui_dom_browser_min_i(t);return"none"!==u.transform||"none"!==u.perspective||"paint"===u.contain||["transform","perspective"].includes(u.willChange)||c&&"filter"===u.willChange||c&&!!u.filter&&"none"!==u.filter}function floating_ui_dom_browser_min_a(){return!/^((?!chrome|android).)*safari/i.test(floating_ui_dom_browser_min_l())}let aw=Math.min,aS=Math.max,a_=Math.round;function floating_ui_dom_browser_min_w(t,c,u){var h,f,g,b;void 0===c&&(c=!1),void 0===u&&(u=!1);let v=t.getBoundingClientRect(),x=1,w=1;c&&floating_ui_dom_browser_min_c(t)&&(x=t.offsetWidth>0&&a_(v.width)/t.offsetWidth||1,w=t.offsetHeight>0&&a_(v.height)/t.offsetHeight||1);let _=floating_ui_dom_browser_min_f(t)?o(t):window,k=!floating_ui_dom_browser_min_a()&&u,E=(v.left+(k&&null!=(h=null==(f=_.visualViewport)?void 0:f.offsetLeft)?h:0))/x,$=(v.top+(k&&null!=(g=null==(b=_.visualViewport)?void 0:b.offsetTop)?g:0))/w,T=v.width/x,I=v.height/w;return{width:T,height:I,top:$,right:E+T,bottom:$+I,left:E,x:E,y:$}}function floating_ui_dom_browser_min_v(t){return((t instanceof o(t).Node?t.ownerDocument:t.document)||window.document).documentElement}function floating_ui_dom_browser_min_y(t){return floating_ui_dom_browser_min_f(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function floating_ui_dom_browser_min_x(t){return floating_ui_dom_browser_min_w(floating_ui_dom_browser_min_v(t)).left+floating_ui_dom_browser_min_y(t).scrollLeft}function floating_ui_dom_browser_min_b(t,c,u){let h=floating_ui_dom_browser_min_c(c),f=floating_ui_dom_browser_min_v(c),g=floating_ui_dom_browser_min_w(t,h&&function(t){let c=floating_ui_dom_browser_min_w(t);return a_(c.width)!==t.offsetWidth||a_(c.height)!==t.offsetHeight}(c),"fixed"===u),b={scrollLeft:0,scrollTop:0},v={x:0,y:0};if(h||!h&&"fixed"!==u){if(("body"!==floating_ui_dom_browser_min_r(c)||floating_ui_dom_browser_min_u(f))&&(b=floating_ui_dom_browser_min_y(c)),floating_ui_dom_browser_min_c(c)){let t=floating_ui_dom_browser_min_w(c,!0);v.x=t.x+c.clientLeft,v.y=t.y+c.clientTop}else f&&(v.x=floating_ui_dom_browser_min_x(f))}return{x:g.left+b.scrollLeft-v.x,y:g.top+b.scrollTop-v.y,width:g.width,height:g.height}}function floating_ui_dom_browser_min_L(t){return"html"===floating_ui_dom_browser_min_r(t)?t:t.assignedSlot||t.parentNode||(floating_ui_dom_browser_min_s(t)?t.host:null)||floating_ui_dom_browser_min_v(t)}function floating_ui_dom_browser_min_R(t){return floating_ui_dom_browser_min_c(t)&&"fixed"!==getComputedStyle(t).position?t.offsetParent:null}function floating_ui_dom_browser_min_T(t){let c=o(t),u=floating_ui_dom_browser_min_R(t);for(;u&&floating_ui_dom_browser_min_d(u)&&"static"===getComputedStyle(u).position;)u=floating_ui_dom_browser_min_R(u);return u&&("html"===floating_ui_dom_browser_min_r(u)||"body"===floating_ui_dom_browser_min_r(u)&&"static"===getComputedStyle(u).position&&!floating_ui_dom_browser_min_h(u))?c:u||function(t){let c=floating_ui_dom_browser_min_L(t);for(floating_ui_dom_browser_min_s(c)&&(c=c.host);floating_ui_dom_browser_min_c(c)&&!["html","body"].includes(floating_ui_dom_browser_min_r(c));){if(floating_ui_dom_browser_min_h(c))return c;c=c.parentNode}return null}(t)||c}function W(t){if(floating_ui_dom_browser_min_c(t))return{width:t.offsetWidth,height:t.offsetHeight};let c=floating_ui_dom_browser_min_w(t);return{width:c.width,height:c.height}}function floating_ui_dom_browser_min_E(t){let c=floating_ui_dom_browser_min_L(t);return["html","body","#document"].includes(floating_ui_dom_browser_min_r(c))?t.ownerDocument.body:floating_ui_dom_browser_min_c(c)&&floating_ui_dom_browser_min_u(c)?c:floating_ui_dom_browser_min_E(c)}function H(t,c){var u;void 0===c&&(c=[]);let h=floating_ui_dom_browser_min_E(t),f=h===(null==(u=t.ownerDocument)?void 0:u.body),g=o(h),b=f?[g].concat(g.visualViewport||[],floating_ui_dom_browser_min_u(h)?h:[]):h,v=c.concat(b);return f?v:v.concat(H(b))}function C(t,c,u){return"viewport"===c?l(function(t,c){let u=o(t),h=floating_ui_dom_browser_min_v(t),f=u.visualViewport,g=h.clientWidth,b=h.clientHeight,v=0,x=0;if(f){g=f.width,b=f.height;let t=floating_ui_dom_browser_min_a();(t||!t&&"fixed"===c)&&(v=f.offsetLeft,x=f.offsetTop)}return{width:g,height:b,x:v,y:x}}(t,u)):floating_ui_dom_browser_min_f(c)?function(t,c){let u=floating_ui_dom_browser_min_w(t,!1,"fixed"===c),h=u.top+t.clientTop,f=u.left+t.clientLeft;return{top:h,left:f,x:f,y:h,right:f+t.clientWidth,bottom:h+t.clientHeight,width:t.clientWidth,height:t.clientHeight}}(c,u):l(function(t){var c;let u=floating_ui_dom_browser_min_v(t),h=floating_ui_dom_browser_min_y(t),f=null==(c=t.ownerDocument)?void 0:c.body,g=aS(u.scrollWidth,u.clientWidth,f?f.scrollWidth:0,f?f.clientWidth:0),b=aS(u.scrollHeight,u.clientHeight,f?f.scrollHeight:0,f?f.clientHeight:0),v=-h.scrollLeft+floating_ui_dom_browser_min_x(t),x=-h.scrollTop;return"rtl"===floating_ui_dom_browser_min_i(f||u).direction&&(v+=aS(u.clientWidth,f?f.clientWidth:0)-g),{width:g,height:b,x:v,y:x}}(floating_ui_dom_browser_min_v(t)))}function S(t){let c=H(t),u=["absolute","fixed"].includes(floating_ui_dom_browser_min_i(t).position)&&floating_ui_dom_browser_min_c(t)?floating_ui_dom_browser_min_T(t):t;return floating_ui_dom_browser_min_f(u)?c.filter(t=>floating_ui_dom_browser_min_f(t)&&function(t,c){let u=null==c.getRootNode?void 0:c.getRootNode();if(t.contains(c))return!0;if(u&&floating_ui_dom_browser_min_s(u)){let u=c;do{if(u&&t===u)return!0;u=u.parentNode||u.host}while(u)}return!1}(t,u)&&"body"!==floating_ui_dom_browser_min_r(t)):[]}let ak={getClippingRect:function(t){let{element:c,boundary:u,rootBoundary:h,strategy:f}=t,g=[..."clippingAncestors"===u?S(c):[].concat(u),h],b=g[0],v=g.reduce((t,u)=>{let h=C(c,u,f);return t.top=aS(h.top,t.top),t.right=aw(h.right,t.right),t.bottom=aw(h.bottom,t.bottom),t.left=aS(h.left,t.left),t},C(c,b,f));return{width:v.right-v.left,height:v.bottom-v.top,x:v.left,y:v.top}},convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:c,offsetParent:u,strategy:h}=t,f=floating_ui_dom_browser_min_c(u),g=floating_ui_dom_browser_min_v(u);if(u===g)return c;let b={scrollLeft:0,scrollTop:0},v={x:0,y:0};if((f||!f&&"fixed"!==h)&&(("body"!==floating_ui_dom_browser_min_r(u)||floating_ui_dom_browser_min_u(g))&&(b=floating_ui_dom_browser_min_y(u)),floating_ui_dom_browser_min_c(u))){let t=floating_ui_dom_browser_min_w(u,!0);v.x=t.x+u.clientLeft,v.y=t.y+u.clientTop}return{...c,x:c.x-b.scrollLeft+v.x,y:c.y-b.scrollTop+v.y}},isElement:floating_ui_dom_browser_min_f,getDimensions:W,getOffsetParent:floating_ui_dom_browser_min_T,getDocumentElement:floating_ui_dom_browser_min_v,getElementRects:t=>{let{reference:c,floating:u,strategy:h}=t;return{reference:floating_ui_dom_browser_min_b(c,floating_ui_dom_browser_min_T(u),h),floating:{...W(u),x:0,y:0}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>"rtl"===floating_ui_dom_browser_min_i(t).direction};function N(t,c,u,h){void 0===h&&(h={});let{ancestorScroll:f=!0,ancestorResize:g=!0,elementResize:b=!0,animationFrame:v=!1}=h,x=f&&!v,w=g&&!v,_=x||w?[...floating_ui_dom_browser_min_f(t)?H(t):[],...H(c)]:[];_.forEach(t=>{x&&t.addEventListener("scroll",u,{passive:!0}),w&&t.addEventListener("resize",u)});let k,E=null;if(b){let h=!0;E=new ResizeObserver(()=>{h||u(),h=!1}),floating_ui_dom_browser_min_f(t)&&!v&&E.observe(t),E.observe(c)}let $=v?floating_ui_dom_browser_min_w(t):null;return v&&function e(){let c=floating_ui_dom_browser_min_w(t);$&&(c.x!==$.x||c.y!==$.y||c.width!==$.width||c.height!==$.height)&&u(),$=c,k=requestAnimationFrame(e)}(),u(),()=>{var t;_.forEach(t=>{x&&t.removeEventListener("scroll",u),w&&t.removeEventListener("resize",u)}),null==(t=E)||t.disconnect(),E=null,v&&cancelAnimationFrame(k)}}let z=(t,c,u)=>floating_ui_core_browser_min_o(t,c,{platform:ak,...u});var aC="undefined"!=typeof document?U.useLayoutEffect:U.useEffect;function floating_ui_react_dom_esm_deepEqual(t,c){let u,h,f;if(t===c)return!0;if(typeof t!=typeof c)return!1;if("function"==typeof t&&t.toString()===c.toString())return!0;if(t&&c&&"object"==typeof t){if(Array.isArray(t)){if((u=t.length)!=c.length)return!1;for(h=u;0!=h--;)if(!floating_ui_react_dom_esm_deepEqual(t[h],c[h]))return!1;return!0}if((u=(f=Object.keys(t)).length)!==Object.keys(c).length)return!1;for(h=u;0!=h--;)if(!Object.prototype.hasOwnProperty.call(c,f[h]))return!1;for(h=u;0!=h--;){let u=f[h];if(("_owner"!==u||!t.$$typeof)&&!floating_ui_react_dom_esm_deepEqual(t[u],c[u]))return!1}return!0}return t!=t&&c!=c}function floating_ui_react_dom_esm_useLatestRef(t){let c=U.useRef(t);return aC(()=>{c.current=t}),c}function floating_ui_react_dom_esm_useFloating(t){let{middleware:c,placement:u="bottom",strategy:h="absolute",whileElementsMounted:f}=void 0===t?{}:t,g=U.useRef(null),b=U.useRef(null),v=floating_ui_react_dom_esm_useLatestRef(f),x=U.useRef(null),[w,_]=U.useState({x:null,y:null,strategy:h,placement:u,middlewareData:{}}),[k,E]=U.useState(c);floating_ui_react_dom_esm_deepEqual(null==k?void 0:k.map(t=>{let{options:c}=t;return c}),null==c?void 0:c.map(t=>{let{options:c}=t;return c}))||E(c);let $=U.useCallback(()=>{g.current&&b.current&&z(g.current,b.current,{middleware:k,placement:u,strategy:h}).then(t=>{T.current&&X.flushSync(()=>{_(t)})})},[k,u,h]);aC(()=>{T.current&&$()},[$]);let T=U.useRef(!1);aC(()=>(T.current=!0,()=>{T.current=!1}),[]);let I=U.useCallback(()=>{if("function"==typeof x.current&&(x.current(),x.current=null),g.current&&b.current){if(v.current){let t=v.current(g.current,b.current,$);x.current=t}else $()}},[$,v]),M=U.useCallback(t=>{g.current=t,I()},[I]),j=U.useCallback(t=>{b.current=t,I()},[I]),D=U.useMemo(()=>({reference:g,floating:b}),[]);return U.useMemo(()=>({...w,update:$,refs:D,reference:M,floating:j}),[w,$,D,M,j])}let floating_ui_react_dom_esm_arrow=t=>{let{element:c,padding:u}=t;function isRef(t){return Object.prototype.hasOwnProperty.call(t,"current")}return{name:"arrow",options:t,fn(t){if(isRef(c)){if(null!=c.current)return m({element:c.current,padding:u}).fn(t)}else if(c)return m({element:c,padding:u}).fn(t);return{}}}},aP=(0,U.forwardRef)((t,c)=>{let{children:u,width:h=10,height:f=5,...g}=t;return(0,U.createElement)(ar.svg,_extends({},g,{ref:c,width:h,height:f,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),t.asChild?u:(0,U.createElement)("polygon",{points:"0,0 30,0 15,10"}))});function index_module_$db6c3485150b8e66$export$1ab7ae714698c4b8(t){let[c,u]=(0,U.useState)(void 0);return ah(()=>{if(t){u({width:t.offsetWidth,height:t.offsetHeight});let c=new ResizeObserver(c=>{let h,f;if(!Array.isArray(c)||!c.length)return;let g=c[0];if("borderBoxSize"in g){let t=g.borderBoxSize,c=Array.isArray(t)?t[0]:t;h=c.inlineSize,f=c.blockSize}else h=t.offsetWidth,f=t.offsetHeight;u({width:h,height:f})});return c.observe(t,{box:"border-box"}),()=>c.unobserve(t)}u(void 0)},[t]),c}let aE="Popper",[a$,aT]=index_module_$c512c27ab02ef895$export$50c7b4e9d9f19c1(aE),[aI,aA]=a$(aE),aM=(0,U.forwardRef)((t,c)=>{let{__scopePopper:u,virtualRef:h,...f}=t,g=aA("PopperAnchor",u),b=(0,U.useRef)(null),v=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,b);return(0,U.useEffect)(()=>{g.onAnchorChange((null==h?void 0:h.current)||b.current)}),h?null:(0,U.createElement)(ar.div,_extends({},f,{ref:v}))}),aj="PopperContent",[aD,aO]=a$(aj),[aF,aR]=a$(aj,{hasParent:!1,positionUpdateFns:new Set}),aL=(0,U.forwardRef)((t,c)=>{var u,h,f,g,b,v,x,w,_,k,E,$,T;let{__scopePopper:I,side:M="bottom",sideOffset:j=0,align:D="center",alignOffset:F=0,arrowPadding:L=0,collisionBoundary:B=[],collisionPadding:G=0,sticky:V="partial",hideWhenDetached:K=!1,avoidCollisions:Z=!0,onPlaced:Y,...X}=t,J=aA(aj,I),[Q,ee]=(0,U.useState)(null),et=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>ee(t)),[en,er]=(0,U.useState)(null),ei=index_module_$db6c3485150b8e66$export$1ab7ae714698c4b8(en),eo=null!==(u=null==ei?void 0:ei.width)&&void 0!==u?u:0,ea=null!==(h=null==ei?void 0:ei.height)&&void 0!==h?h:0,es="number"==typeof G?G:{top:0,right:0,bottom:0,left:0,...G},el=Array.isArray(B)?B:[B],ec=el.length>0,eu={padding:es,boundary:el.filter(index_module_$cf1ac5d9fe0e8206$var$isNotNull),altBoundary:ec},{reference:ed,floating:ep,strategy:eh,x:ef,y:eg,placement:em,middlewareData:eb,update:ey}=floating_ui_react_dom_esm_useFloating({strategy:"fixed",placement:M+("center"!==D?"-"+D:""),whileElementsMounted:N,middleware:[{name:"offset",options:_={mainAxis:j+ea,alignmentAxis:F},async fn(t){let{x:c,y:u}=t,h=await async function(t,c){let{placement:u,platform:h,elements:f}=t,g=await (null==h.isRTL?void 0:h.isRTL(f.floating)),b=floating_ui_core_browser_min_t(u),v=e(u),x="x"===n(u),w=["left","top"].includes(b)?-1:1,_=g&&x?-1:1,k="function"==typeof c?c(t):c,{mainAxis:E,crossAxis:$,alignmentAxis:T}="number"==typeof k?{mainAxis:k,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...k};return v&&"number"==typeof T&&($="end"===v?-1*T:T),x?{x:$*_,y:E*w}:{x:E*w,y:$*_}}(t,_);return{x:c+h.x,y:u+h.y,data:h}}},Z?{name:"shift",options:E={mainAxis:!0,crossAxis:!1,limiter:"partial"===V?(void 0===k&&(k={}),{options:k,fn(t){let{x:c,y:u,placement:h,rects:f,middlewareData:g}=t,{offset:b=0,mainAxis:v=!0,crossAxis:x=!0}=k,w={x:c,y:u},_=n(h),E=O(_),$=w[_],T=w[E],I="function"==typeof b?b({...f,placement:h}):b,M="number"==typeof I?{mainAxis:I,crossAxis:0}:{mainAxis:0,crossAxis:0,...I};if(v){let t="y"===_?"height":"width",c=f.reference[_]-f.floating[t]+M.mainAxis,u=f.reference[_]+f.reference[t]-M.mainAxis;$<c?$=c:$>u&&($=u)}if(x){var j,D,F,L;let t="y"===_?"width":"height",c=["top","left"].includes(floating_ui_core_browser_min_t(h)),u=f.reference[E]-f.floating[t]+(c&&null!=(j=null==(D=g.offset)?void 0:D[E])?j:0)+(c?0:M.crossAxis),b=f.reference[E]+f.reference[t]+(c?0:null!=(F=null==(L=g.offset)?void 0:L[E])?F:0)-(c?M.crossAxis:0);T<u?T=u:T>b&&(T=b)}return{[_]:$,[E]:T}}}):void 0,...eu},async fn(t){let{x:c,y:u,placement:h}=t,{mainAxis:f=!0,crossAxis:g=!1,limiter:b={fn:t=>{let{x:c,y:u}=t;return{x:c,y:u}}},...v}=E,x={x:c,y:u},w=await s(t,v),_=n(floating_ui_core_browser_min_t(h)),k=O(_),$=x[_],T=x[k];if(f){let t="y"===_?"bottom":"right";$=ab($+w["y"===_?"top":"left"],am($,$-w[t]))}g&&(T=ab(T+w["y"===k?"top":"left"],am(T,T-w["y"===k?"bottom":"right"])));let I=b.fn({...t,[_]:$,[k]:T});return{...I,data:{x:I.x-c,y:I.y-u}}}}:void 0,Z?{name:"flip",options:$={...eu},async fn(t){var c,u,h,f;let{placement:g,middlewareData:b,rects:v,initialPlacement:x,platform:w,elements:_}=t,{mainAxis:k=!0,crossAxis:E=!0,fallbackPlacements:T,fallbackStrategy:I="bestFit",flipAlignment:M=!0,...j}=$,D=floating_ui_core_browser_min_t(g),F=T||(D!==x&&M?function(t){let c=d(t);return[y(t),c,y(c)]}(x):[d(x)]),L=[x,...F],B=await s(t,j),G=[],U=(null==(c=b.flip)?void 0:c.overflows)||[];if(k&&G.push(B[D]),E){let{main:t,cross:c}=p(g,v,await (null==w.isRTL?void 0:w.isRTL(_.floating)));G.push(B[t],B[c])}if(U=[...U,{placement:g,overflows:G}],!G.every(t=>t<=0)){let t=(null!=(u=null==(h=b.flip)?void 0:h.index)?u:0)+1,c=L[t];if(c)return{data:{index:t,overflows:U},reset:{placement:c}};let v="bottom";switch(I){case"bestFit":{let t=null==(f=U.map(t=>[t,t.overflows.filter(t=>t>0).reduce((t,c)=>t+c,0)]).sort((t,c)=>t[1]-c[1])[0])?void 0:f[0].placement;t&&(v=t);break}case"initialPlacement":v=x}if(g!==v)return{reset:{placement:v}}}return{}}}:void 0,{name:"size",options:T={...eu,apply:({elements:t,rects:c,availableWidth:u,availableHeight:h})=>{let{width:f,height:g}=c.reference,b=t.floating.style;b.setProperty("--radix-popper-available-width",`${u}px`),b.setProperty("--radix-popper-available-height",`${h}px`),b.setProperty("--radix-popper-anchor-width",`${f}px`),b.setProperty("--radix-popper-anchor-height",`${g}px`)}},async fn(t){let c,u;let{placement:h,rects:f,platform:g,elements:b}=t,{apply:v,...x}=T,w=await s(t,x),_=floating_ui_core_browser_min_t(h),k=e(h);"top"===_||"bottom"===_?(c=_,u=k===(await (null==g.isRTL?void 0:g.isRTL(b.floating))?"start":"end")?"left":"right"):(u=_,c="end"===k?"top":"bottom");let E=ab(w.left,0),$=ab(w.right,0),I=ab(w.top,0),M=ab(w.bottom,0),j={availableHeight:f.floating.height-(["left","right"].includes(h)?2*(0!==I||0!==M?I+M:ab(w.top,w.bottom)):w[c]),availableWidth:f.floating.width-(["top","bottom"].includes(h)?2*(0!==E||0!==$?E+$:ab(w.left,w.right)):w[u])},D=await g.getDimensions(b.floating);null==v||v({...t,...j});let F=await g.getDimensions(b.floating);return D.width!==F.width||D.height!==F.height?{reset:{rects:!0}}:{}}},en?floating_ui_react_dom_esm_arrow({element:en,padding:L}):void 0,index_module_$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:eo,arrowHeight:ea}),K?P({strategy:"referenceHidden"}):void 0].filter($cf1ac5d9fe0e8206$var$isDefined)});ah(()=>{ed(J.anchor)},[ed,J.anchor]);let ev=null!==ef&&null!==eg,[ex,ew]=index_module_$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(em),eS=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Y);ah(()=>{ev&&(null==eS||eS())},[ev,eS]);let e_=null===(f=eb.arrow)||void 0===f?void 0:f.x,ek=null===(g=eb.arrow)||void 0===g?void 0:g.y,eC=(null===(b=eb.arrow)||void 0===b?void 0:b.centerOffset)!==0,[eP,eE]=(0,U.useState)();ah(()=>{Q&&eE(window.getComputedStyle(Q).zIndex)},[Q]);let{hasParent:e$,positionUpdateFns:eT}=aR(aj,I),eI=!e$;(0,U.useLayoutEffect)(()=>{if(!eI)return eT.add(ey),()=>{eT.delete(ey)}},[eI,eT,ey]),ah(()=>{eI&&ev&&Array.from(eT).reverse().forEach(t=>requestAnimationFrame(t))},[eI,ev,eT]);let eA={"data-side":ex,"data-align":ew,...X,ref:et,style:{...X.style,animation:ev?void 0:"none",opacity:null!==(v=eb.hide)&&void 0!==v&&v.referenceHidden?0:void 0}};return(0,U.createElement)("div",{ref:ep,"data-radix-popper-content-wrapper":"",style:{position:eh,left:0,top:0,transform:ev?`translate3d(${Math.round(ef)}px, ${Math.round(eg)}px, 0)`:"translate3d(0, -200%, 0)",minWidth:"max-content",zIndex:eP,"--radix-popper-transform-origin":[null===(x=eb.transformOrigin)||void 0===x?void 0:x.x,null===(w=eb.transformOrigin)||void 0===w?void 0:w.y].join(" ")},dir:t.dir},(0,U.createElement)(aD,{scope:I,placedSide:ex,onArrowChange:er,arrowX:e_,arrowY:ek,shouldHideArrow:eC},eI?(0,U.createElement)(aF,{scope:I,hasParent:!0,positionUpdateFns:eT},(0,U.createElement)(ar.div,eA)):(0,U.createElement)(ar.div,eA)))}),aN={top:"bottom",right:"left",bottom:"top",left:"right"};function $cf1ac5d9fe0e8206$var$isDefined(t){return void 0!==t}function index_module_$cf1ac5d9fe0e8206$var$isNotNull(t){return null!==t}let index_module_$cf1ac5d9fe0e8206$var$transformOrigin=t=>({name:"transformOrigin",options:t,fn(c){var u,h,f,g,b;let{placement:v,rects:x,middlewareData:w}=c,_=(null===(u=w.arrow)||void 0===u?void 0:u.centerOffset)!==0,k=_?0:t.arrowWidth,E=_?0:t.arrowHeight,[$,T]=index_module_$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(v),I={start:"0%",center:"50%",end:"100%"}[T],M=(null!==(h=null===(f=w.arrow)||void 0===f?void 0:f.x)&&void 0!==h?h:0)+k/2,j=(null!==(g=null===(b=w.arrow)||void 0===b?void 0:b.y)&&void 0!==g?g:0)+E/2,D="",F="";return"bottom"===$?(D=_?I:`${M}px`,F=`${-E}px`):"top"===$?(D=_?I:`${M}px`,F=`${x.floating.height+E}px`):"right"===$?(D=`${-E}px`,F=_?I:`${j}px`):"left"===$&&(D=`${x.floating.width+E}px`,F=_?I:`${j}px`),{data:{x:D,y:F}}}});function index_module_$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(t){let[c,u="center"]=t.split("-");return[c,u]}let index_module_$cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=t=>{let{__scopePopper:c,children:u}=t,[h,f]=(0,U.useState)(null);return(0,U.createElement)(aI,{scope:c,anchor:h,onAnchorChange:f},u)},az=(0,U.forwardRef)((t,c)=>{var u;let{container:h=null==globalThis?void 0:null===(u=globalThis.document)||void 0===u?void 0:u.body,...f}=t;return h?X.createPortal((0,U.createElement)(ar.div,_extends({},f,{ref:c})),h):null});function index_module_$fe963b355347cc68$export$3e6543de14f8614f(t,c){return(0,U.useReducer)((t,u)=>{let h=c[t][u];return null!=h?h:t},t)}let index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b=t=>{let{present:c,children:u}=t,h=index_module_$921a889cee6df7e8$var$usePresence(c),f="function"==typeof u?u({present:h.isPresent}):U.Children.only(u),g=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(h.ref,f.ref),b="function"==typeof u;return b||h.isPresent?(0,U.cloneElement)(f,{ref:g}):null};function index_module_$921a889cee6df7e8$var$usePresence(t){let[c,u]=(0,U.useState)(),h=(0,U.useRef)({}),f=(0,U.useRef)(t),g=(0,U.useRef)("none"),b=t?"mounted":"unmounted",[v,x]=index_module_$fe963b355347cc68$export$3e6543de14f8614f(b,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return(0,U.useEffect)(()=>{let t=index_module_$921a889cee6df7e8$var$getAnimationName(h.current);g.current="mounted"===v?t:"none"},[v]),ah(()=>{let c=h.current,u=f.current,b=u!==t;if(b){let h=g.current,b=index_module_$921a889cee6df7e8$var$getAnimationName(c);t?x("MOUNT"):"none"===b||(null==c?void 0:c.display)==="none"?x("UNMOUNT"):u&&h!==b?x("ANIMATION_OUT"):x("UNMOUNT"),f.current=t}},[t,x]),ah(()=>{if(c){let handleAnimationEnd=t=>{let u=index_module_$921a889cee6df7e8$var$getAnimationName(h.current),f=u.includes(t.animationName);t.target===c&&f&&(0,X.flushSync)(()=>x("ANIMATION_END"))},handleAnimationStart=t=>{t.target===c&&(g.current=index_module_$921a889cee6df7e8$var$getAnimationName(h.current))};return c.addEventListener("animationstart",handleAnimationStart),c.addEventListener("animationcancel",handleAnimationEnd),c.addEventListener("animationend",handleAnimationEnd),()=>{c.removeEventListener("animationstart",handleAnimationStart),c.removeEventListener("animationcancel",handleAnimationEnd),c.removeEventListener("animationend",handleAnimationEnd)}}x("ANIMATION_END")},[c,x]),{isPresent:["mounted","unmountSuspended"].includes(v),ref:(0,U.useCallback)(t=>{t&&(h.current=getComputedStyle(t)),u(t)},[])}}function index_module_$921a889cee6df7e8$var$getAnimationName(t){return(null==t?void 0:t.animationName)||"none"}function index_module_$71cd76cc60e0454e$export$6f32135080cb4c3({prop:t,defaultProp:c,onChange:u=()=>{}}){let[h,f]=index_module_$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:c,onChange:u}),g=void 0!==t,b=g?t:h,v=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(u),x=(0,U.useCallback)(c=>{if(g){let u="function"==typeof c?c(t):c;u!==t&&v(u)}else f(c)},[g,t,f,v]);return[b,x]}function index_module_$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:t,onChange:c}){let u=(0,U.useState)(t),[h]=u,f=(0,U.useRef)(h),g=index_module_$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(c);return(0,U.useEffect)(()=>{f.current!==h&&(g(h),f.current=h)},[h,f,g]),u}index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";let aB="Popover",[aG,aH]=index_module_$c512c27ab02ef895$export$50c7b4e9d9f19c1(aB,[aT]),aU=aT(),[aV,aW]=aG(aB),aK=(0,U.forwardRef)((t,c)=>{let{__scopePopover:u,...h}=t,f=aW("PopoverTrigger",u),g=aU(u),b=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,f.triggerRef),v=(0,U.createElement)(ar.button,_extends({type:"button","aria-haspopup":"dialog","aria-expanded":f.open,"aria-controls":f.contentId,"data-state":$cb5cc270b50c6fcd$var$getState(f.open)},h,{ref:b,onClick:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onClick,f.onOpenToggle)}));return f.hasCustomAnchor?v:(0,U.createElement)(aM,_extends({asChild:!0},g),v)}),aZ="PopoverPortal",[aY,aq]=aG(aZ,{forceMount:void 0}),aX="PopoverContent",aJ=(0,U.forwardRef)((t,c)=>{let u=aq(aX,t.__scopePopover),{forceMount:h=u.forceMount,...f}=t,g=aW(aX,t.__scopePopover);return(0,U.createElement)(index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:h||g.open},g.modal?(0,U.createElement)(aQ,_extends({},f,{ref:c})):(0,U.createElement)(a0,_extends({},f,{ref:c})))}),aQ=(0,U.forwardRef)((t,c)=>{let u=aW(aX,t.__scopePopover),h=(0,U.useRef)(null),f=index_module_$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,h),g=(0,U.useRef)(!1);return(0,U.useEffect)(()=>{let t=h.current;if(t)return hideOthers(t)},[]),(0,U.createElement)(ek,{as:at,allowPinchZoom:!0},(0,U.createElement)(a1,_extends({},t,{ref:f,trapFocus:u.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onCloseAutoFocus,t=>{var c;t.preventDefault(),g.current||null===(c=u.triggerRef.current)||void 0===c||c.focus()}),onPointerDownOutside:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDownOutside,t=>{let c=t.detail.originalEvent,u=0===c.button&&!0===c.ctrlKey,h=2===c.button||u;g.current=h},{checkForDefaultPrevented:!1}),onFocusOutside:index_module_$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocusOutside,t=>t.preventDefault(),{checkForDefaultPrevented:!1})})))}),a0=(0,U.forwardRef)((t,c)=>{let u=aW(aX,t.__scopePopover),h=(0,U.useRef)(!1),f=(0,U.useRef)(!1);return(0,U.createElement)(a1,_extends({},t,{ref:c,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var g,b;null===(g=t.onCloseAutoFocus)||void 0===g||g.call(t,c),c.defaultPrevented||(h.current||null===(b=u.triggerRef.current)||void 0===b||b.focus(),c.preventDefault()),h.current=!1,f.current=!1},onInteractOutside:c=>{var g,b;null===(g=t.onInteractOutside)||void 0===g||g.call(t,c),c.defaultPrevented||(h.current=!0,"pointerdown"!==c.detail.originalEvent.type||(f.current=!0));let v=c.target,x=null===(b=u.triggerRef.current)||void 0===b?void 0:b.contains(v);x&&c.preventDefault(),"focusin"===c.detail.originalEvent.type&&f.current&&c.preventDefault()}}))}),a1=(0,U.forwardRef)((t,c)=>{let{__scopePopover:u,trapFocus:h,onOpenAutoFocus:f,onCloseAutoFocus:g,disableOutsidePointerEvents:b,onEscapeKeyDown:v,onPointerDownOutside:x,onFocusOutside:w,onInteractOutside:_,...k}=t,E=aW(aX,u),$=aU(u);return index_module_$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),(0,U.createElement)(ad,{asChild:!0,loop:!0,trapped:h,onMountAutoFocus:f,onUnmountAutoFocus:g},(0,U.createElement)(aa,{asChild:!0,disableOutsidePointerEvents:b,onInteractOutside:_,onEscapeKeyDown:v,onPointerDownOutside:x,onFocusOutside:w,onDismiss:()=>E.onOpenChange(!1)},(0,U.createElement)(aL,_extends({"data-state":$cb5cc270b50c6fcd$var$getState(E.open),role:"dialog",id:E.contentId},$,k,{ref:c,style:{...k.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function $cb5cc270b50c6fcd$var$getState(t){return t?"open":"closed"}let $cb5cc270b50c6fcd$export$be92b6f5f03c0fe9=t=>{let{__scopePopover:c,children:u,open:h,defaultOpen:f,onOpenChange:g,modal:b=!1}=t,v=aU(c),x=(0,U.useRef)(null),[w,_]=(0,U.useState)(!1),[k=!1,E]=index_module_$71cd76cc60e0454e$export$6f32135080cb4c3({prop:h,defaultProp:f,onChange:g});return(0,U.createElement)(index_module_$cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,v,(0,U.createElement)(aV,{scope:c,contentId:index_module_$1746a345f3d73bb7$export$f680877a34711e37(),triggerRef:x,open:k,onOpenChange:E,onOpenToggle:(0,U.useCallback)(()=>E(t=>!t),[E]),hasCustomAnchor:w,onCustomAnchorAdd:(0,U.useCallback)(()=>_(!0),[]),onCustomAnchorRemove:(0,U.useCallback)(()=>_(!1),[]),modal:b},u))},$cb5cc270b50c6fcd$export$602eac185826482c=t=>{let{__scopePopover:c,forceMount:u,children:h,container:f}=t,g=aW(aZ,c);return(0,U.createElement)(aY,{scope:c,forceMount:u},(0,U.createElement)(index_module_$921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:u||g.open},(0,U.createElement)(az,{asChild:!0,container:f},h)))},Popover=({id:t,children:c,onOpenChange:u})=>{let[h,f]=useMenuIsOpen(t,u);return(0,G.jsx)($cb5cc270b50c6fcd$export$be92b6f5f03c0fe9,{onOpenChange:f,open:h,children:(0,G.jsx)("div",{className:"tlui-popover",children:c})})},PopoverTrigger=({children:t,disabled:c,"data-testid":u})=>(0,G.jsx)(aK,{"data-testid":u,disabled:c,asChild:!0,dir:"ltr",children:t}),PopoverContent=({side:t,children:c,align:u="center",sideOffset:h=8,alignOffset:f=0})=>{let g=useContainer();return(0,G.jsx)($cb5cc270b50c6fcd$export$602eac185826482c,{dir:"ltr",container:g,children:(0,G.jsx)(aJ,{className:"tlui-popover__content",side:t,sideOffset:h,align:u,alignOffset:f,dir:"ltr",children:c})})},a2=(0,U.memo)(function(){let t=useTranslation(),c=useContainer(),u=useActionsMenuSchema(),h=useReadonly();function getActionMenuItem(c){if(h&&!c.readonlyOk)return null;if("item"===c.type){let{id:u,icon:h,label:f,kbd:g,onSelect:b}=c.actionItem;return(0,G.jsx)(nU,{className:"tlui-button-grid__button","data-testid":`menu-item.${c.id}`,icon:h,title:f?g?`${t(f)} ${kbdStr(g)}`:`${t(f)}`:g?`${kbdStr(g)}`:"",onClick:()=>b("actions-menu"),disabled:c.disabled},u)}}return(0,G.jsxs)(Popover,{id:"actions menu",children:[(0,G.jsx)(PopoverTrigger,{children:(0,G.jsx)(nU,{className:"tlui-menu__trigger","data-testid":"main.action-menu",icon:"dots-vertical",title:t("actions-menu.title"),smallIcon:!0})}),(0,G.jsx)($cb5cc270b50c6fcd$export$602eac185826482c,{dir:"ltr",container:c,children:(0,G.jsx)(aJ,{className:"tlui-popover__content",side:"bottom",dir:"ltr",sideOffset:6,children:(0,G.jsx)("div",{className:"tlui-actions-menu tlui-button-grid__four",children:u.map(getActionMenuItem)})})})]})}),a3=(0,eJ.j)(function(){let t=(0,e8.j)(),c=useActions(),u=useTranslation(),h=c.duplicate;return(0,G.jsx)(nU,{icon:h.icon,onClick:()=>h.onSelect("quick-actions"),disabled:!(t.isIn("select")&&t.selectedShapeIds.length>0),title:`${u(h.label)} ${kbdStr(h.kbd)}`,smallIcon:!0})}),a5=U.memo(function(){let t=useTranslation();return(0,G.jsxs)(Root,{id:"main menu",children:[(0,G.jsx)(Trigger,{children:(0,G.jsx)(nU,{className:"tlui-menu__trigger","data-testid":"main.menu",title:t("menu.title"),icon:"menu"})}),(0,G.jsx)(Content,{alignOffset:0,sideOffset:6,children:(0,G.jsx)(MenuContent,{})})]})});function MenuContent(){let t=(0,e8.j)(),c=useTranslation(),u=useMenuSchema(),h=useBreakpoint(),f=useReadonly();function getMenuItem(t,u,g,b){switch(u.type){case"custom":if(f&&!u.readonlyOk)return null;if("LANGUAGE_MENU"===u.id)return(0,G.jsx)(LanguageMenu,{},"item");return null;case"group":if(f&&!u.readonlyOk)return null;return(0,G.jsx)(Group,{size:b<=1?"medium":h<3||g?.type==="submenu"&&b>2?"tiny":"medium",children:u.children.map(c=>getMenuItem(t,c,u,b+1))},u.id);case"submenu":if(f&&!u.readonlyOk)return null;return(0,G.jsxs)(Sub,{id:`main menu ${g?g.id+" ":""}${u.id}`,children:[(0,G.jsx)(SubTrigger,{label:u.label,"data-testid":`menu-item.${u.id}`}),(0,G.jsx)(SubContent,{sideOffset:-4,alignOffset:-1,children:u.children.map(c=>getMenuItem(t,c,u,b+1))})]},u.id);case"item":{if(f&&!u.readonlyOk)return null;let{id:t,checkbox:h,menuLabel:g,label:b,onSelect:v,kbd:x}=u.actionItem,w=g??b,_=w?c(w):void 0;if(h)return(0,G.jsxs)(CheckboxItem,{onSelect:()=>v("menu"),title:_||"",checked:u.checked,disabled:u.disabled,children:[_&&(0,G.jsx)("span",{children:_}),x&&(0,G.jsx)(Kbd,{children:x})]},t);return(0,G.jsx)(Item,{"data-testid":`menu-item.${u.id}`,kbd:x,label:w,onClick:()=>v("menu"),disabled:u.disabled},t)}}}return(0,G.jsx)(G.Fragment,{children:u.map(c=>getMenuItem(t,c,null,0))})}let PageItemInput=function({name:t,id:c,isCurrentPage:u}){let h=(0,e8.j)(),f=(0,U.useRef)(null),g=(0,U.useCallback)(t=>{h.renamePage(c,t||"New Page",{ephemeral:!0})},[h,c]),b=(0,U.useCallback)(t=>{h.mark("rename page"),h.renamePage(c,t||"New Page",{ephemeral:!1})},[h,c]);return(0,G.jsx)(oE,{className:"tlui-page-menu__item__input",ref:t=>f.current=t,defaultValue:t,onValueChange:g,onComplete:b,onCancel:b,shouldManuallyMaintainScrollPositionWhenFocused:!0,autofocus:u,autoselect:!0})},onMovePage=(t,c,u,h)=>{let f;let g=t.pages,b=u>h?g[h-1]:g[h],v=u>h?g[h]:g[h+1];(f=b&&!v?(0,nj._L)(b.index):!b&&v?(0,nj.Xg)(g[0].index):(0,nj.eI)(b.index,v.index))!==g[u].index&&(t.mark("moving page"),t.updatePage({id:c,index:f}))},a4=(0,eJ.j)(function({index:t,listSize:c,item:u,onRename:h}){let f=(0,e8.j)(),g=useTranslation(),b=f.pages,v=(0,U.useCallback)(()=>{f.mark("creating page");let t=e0.ez.createId();f.duplicatePage(u.id,t)},[f,u]),x=(0,U.useCallback)(()=>{onMovePage(f,u.id,t,t-1)},[f,u,t]),w=(0,U.useCallback)(()=>{onMovePage(f,u.id,t,t+1)},[f,u,t]),_=(0,U.useCallback)(()=>{f.mark("deleting page"),f.deletePage(u.id)},[f,u]);return(0,G.jsxs)(Root,{id:`page item submenu ${t}`,children:[(0,G.jsx)(Trigger,{children:(0,G.jsx)(nU,{title:g("page-menu.submenu.title"),icon:"dots-vertical"})}),(0,G.jsxs)(Content,{alignOffset:0,children:[(0,G.jsxs)(Group,{children:[h&&(0,G.jsx)(id,{dir:"ltr",onSelect:h,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:"page-menu.submenu.rename"})}),(0,G.jsx)(id,{dir:"ltr",onSelect:v,disabled:b.length>=to.Et,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:"page-menu.submenu.duplicate-page"})}),t>0&&(0,G.jsx)(id,{dir:"ltr",onSelect:x,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:"page-menu.submenu.move-up"})}),t<c-1&&(0,G.jsx)(id,{dir:"ltr",onSelect:w,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:"page-menu.submenu.move-down"})})]}),c>1&&(0,G.jsx)(Group,{children:(0,G.jsx)(id,{dir:"ltr",onSelect:_,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:"page-menu.submenu.delete"})})})]})]})}),PageMenu=function(){let t=(0,e8.j)(),c=useTranslation(),u=useBreakpoint(),h=(0,U.useCallback)(()=>I(!1),[]),[f,g]=useMenuIsOpen("page-menu",h),b=u<5?36:40,v=(0,U.useRef)(null),x=(0,eJ.Hg)("pages",()=>t.pages,[t]),w=(0,eJ.Hg)("currentPage",()=>t.currentPage,[t]),_=(0,eJ.Hg)("currentPageId",()=>t.currentPageId,[t]),k=useReadonly(),E=(0,eJ.Hg)("maxPageCountReached",()=>t.pages.length>=to.Et,[t]),$=(0,eJ.Hg)("isCoarsePointer",()=>t.instanceState.isCoarsePointer,[t]),[T,I]=(0,U.useState)(!1),M=(0,U.useCallback)(()=>{k||I(t=>!t)},[k]),j=(0,U.useRef)({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[D,F]=(0,U.useState)(Object.fromEntries(x.map((t,c)=>[t.id,{y:c*b,offsetY:0,isSelected:!1}])));(0,U.useLayoutEffect)(()=>{F(Object.fromEntries(x.map((t,c)=>[t.id,{y:c*b,offsetY:0,isSelected:!1}])))},[b,x]),(0,U.useEffect)(()=>{f&&requestAnimationFrame(()=>{let t=document.querySelector(`[data-testid="page-menu-item-${_}"]`);if(t){let c=v.current;if(!c)return;let u=t.offsetTop,h=c.scrollTop;u<h&&c.scrollTo({top:u});let f=u+b,g=c.scrollTop+c.offsetHeight;f>g&&c.scrollTo({top:f-c.offsetHeight})}})},[b,_,f]);let L=(0,U.useCallback)(t=>{let{clientY:c,currentTarget:u}=t,{dataset:{id:h,index:f}}=u;if(!h||!f)return;let g=j.current;setPointerCapture(t.currentTarget,t),g.status="pointing",g.pointing={id:h,index:+f};let v=D[h],w=v.y;g.startY=c,g.startIndex=Math.max(0,Math.min(Math.round(w/b),x.length-1))},[b,x.length,D]),B=(0,U.useCallback)(t=>{let c=j.current;if("pointing"===c.status){let{clientY:u}=t,h=u-c.startY;Math.abs(h)>5&&(c.status="dragging")}if("dragging"===c.status){let{clientY:u}=t,h=u-c.startY,f=D[c.pointing.id],{startIndex:g,pointing:v}=c,w=f.y+h,_=Math.max(0,Math.min(Math.round(w/b),x.length-1)),k={...D};if(k[v.id]={y:f.y,offsetY:h,isSelected:!0},_!==c.dragIndex){c.dragIndex=_;for(let t=0;t<x.length;t++){let u=x[t];if(u.id===c.pointing.id)continue;let{y:h}=k[u.id];_===g?h=t*b:_<g?h=_<=t&&t<g?(t+1)*b:t*b:_>g&&(h=_>=t&&t>g?(t-1)*b:t*b),h!==k[u.id].y&&(k[u.id]={y:h,offsetY:0,isSelected:!0})}}F(k)}},[b,x,D]),V=(0,U.useCallback)(c=>{let u=j.current;if("dragging"===u.status){let{id:c,index:h}=u.pointing;onMovePage(t,c,h,u.dragIndex)}releasePointerCapture(c.currentTarget,c),u.status="idle"},[t]),K=(0,U.useCallback)(t=>{let c=j.current;"Escape"===t.key&&("dragging"===c.status&&F(Object.fromEntries(x.map((t,c)=>[t.id,{y:c*b,offsetY:0,isSelected:!1}]))),c.status="idle")},[b,x]),Z=(0,U.useCallback)(()=>{k||t.batch(()=>{t.mark("creating page");let u=e0.ez.createId();t.createPage({name:c("page-menu.new-page-initial-name"),id:u}),t.setCurrentPage(u),I(!0)})},[t,c,k]);return(0,G.jsxs)(Popover,{id:"page menu",onOpenChange:g,open:f,children:[(0,G.jsx)(PopoverTrigger,{children:(0,G.jsx)(nU,{className:"tlui-page-menu__trigger tlui-menu__trigger","data-testid":"main.page-menu",icon:"chevron-down",title:w.name,children:(0,G.jsx)("div",{className:"tlui-page-menu__name",children:w.name})})}),(0,G.jsx)(PopoverContent,{side:"bottom",align:"start",sideOffset:6,children:(0,G.jsxs)("div",{className:"tlui-page-menu__wrapper",children:[(0,G.jsxs)("div",{className:"tlui-page-menu__header",children:[(0,G.jsx)("div",{className:"tlui-page-menu__header__title",children:c("page-menu.title")}),!k&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(nU,{"data-testid":"page-menu.edit",title:c(T?"page-menu.edit-done":"page-menu.edit-start"),icon:T?"check":"edit",onClick:M}),(0,G.jsx)(nU,{"data-testid":"page-menu.create",icon:"plus",title:c(E?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:E,onClick:Z})]})]}),(0,G.jsx)("div",{className:"tlui-page-menu__list tlui-menu__group",style:{height:b*x.length+4},ref:v,children:x.map((h,f)=>{let g=D[h.id]??{position:40*f,offsetY:0};return T?(0,G.jsxs)("div",{"data-testid":`page-menu-item-${h.id}`,className:"tlui-page_menu__item__sortable",style:{zIndex:h.id===w.id?888:f,transform:`translate(0px, ${g.y+g.offsetY}px)`},children:[(0,G.jsx)(nU,{tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",icon:"drag-handle-dots",onPointerDown:L,onPointerUp:V,onPointerMove:B,onKeyDown:K,"data-id":h.id,"data-index":f}),u<5&&$?(0,G.jsx)(nU,{className:"tlui-page-menu__item__button",onClick:()=>{let c=window.prompt("Rename page",h.name);c&&c!==h.name&&t.renamePage(h.id,c)},onDoubleClick:M,isChecked:h.id===w.id,children:(0,G.jsx)("span",{children:h.name})}):(0,G.jsx)("div",{className:"tlui-page_menu__item__sortable__title",style:{height:b},children:(0,G.jsx)(PageItemInput,{id:h.id,name:h.name,isCurrentPage:h.id===w.id})}),!k&&(0,G.jsx)("div",{className:"tlui-page_menu__item__submenu","data-isediting":T,children:(0,G.jsx)(a4,{index:f,item:h,listSize:x.length})})]},h.id+"_editing"):(0,G.jsxs)("div",{"data-testid":`page-menu-item-${h.id}`,className:"tlui-page-menu__item",children:[(0,G.jsxs)(nU,{className:"tlui-page-menu__item__button tlui-page-menu__item__button__checkbox",onClick:()=>t.setCurrentPage(h.id),onDoubleClick:M,isChecked:h.id===w.id,title:c("page-menu.go-to-page"),children:[(0,G.jsx)("div",{className:"tlui-page-menu__item__button__check",children:h.id===w.id&&(0,G.jsx)(nz,{icon:"check"})}),(0,G.jsx)("span",{children:h.name})]}),!k&&(0,G.jsx)("div",{className:"tlui-page_menu__item__submenu",children:(0,G.jsx)(a4,{index:f,item:h,listSize:x.length,onRename:()=>{if(t.environment.isIos){let c=window.prompt("Rename page",h.name);c&&c!==h.name&&t.renamePage(h.id,c)}else t.batch(()=>{I(!0),t.setCurrentPage(h.id)})}})})]},h.id)})})]})})]})},a8=(0,U.memo)(function(){let t=useTranslation(),c=useCanRedo(),u=useActions(),h=u.redo;return(0,G.jsx)(nU,{"data-testid":"main.redo",icon:h.icon,title:`${t(h.label)} ${kbdStr(h.kbd)}`,disabled:!c,onClick:()=>h.onSelect("quick-actions"),smallIcon:!0})}),a6=(0,eJ.j)(function(){let t=(0,e8.j)(),c=useActions(),u=useTranslation(),h=c.delete,f=useReadonly();return f?null:(0,G.jsx)(nU,{icon:h.icon,onClick:()=>h.onSelect("quick-actions"),disabled:!(t.isIn("select")&&t.selectedShapeIds.length>0),title:`${u(h.label)} ${kbdStr(h.kbd)}`,smallIcon:!0})}),a7=(0,U.memo)(function(){let t=useTranslation(),c=useCanUndo(),u=useActions(),h=u.undo;return(0,G.jsx)(nU,{"data-testid":"main.undo",icon:h.icon,title:`${t(h.label)} ${kbdStr(h.kbd)}`,disabled:!c,onClick:()=>h.onSelect("quick-actions"),smallIcon:!0})}),a9=(0,eJ.j)(function(){let t=(0,e8.j)(),c=useBreakpoint(),u=useReadonly();return(0,G.jsx)("div",{className:"tlui-menu-zone",children:(0,G.jsxs)("div",{className:"tlui-menu-zone__controls",children:[(0,G.jsx)(a5,{}),(0,G.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,G.jsx)(PageMenu,{}),c>=6&&!u&&!t.isInAny("hand","zoom")&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{className:"tlui-menu-zone__divider"}),(0,G.jsx)(a7,{}),(0,G.jsx)(a8,{}),(0,G.jsx)(a6,{}),(0,G.jsx)(a3,{}),(0,G.jsx)(a2,{})]})]})})});function useLocalStorageState(t,c){let[u,h]=U.useState(c);U.useLayoutEffect(()=>{let c=localStorage.getItem(t);if(c)try{h(JSON.parse(c))}catch(c){console.error(`Could not restore value ${t} from local storage.`)}},[t]);let f=U.useCallback(c=>{h(u=>{let h="function"==typeof c?c(u):c;return localStorage.setItem(t,JSON.stringify(h)),h})},[t]);return[u,f]}let MinimapManager=class MinimapManager{constructor(t){this.editor=t}dpr=1;colors={shapeFill:"rgba(144, 144, 144, .1)",selectFill:"#2f80ed",viewportFill:"rgba(144, 144, 144, .1)"};id=(0,tK.E)();cvs=null;pageBounds=[];collaborators=[];canvasScreenBounds=new nS.No;canvasPageBounds=new nS.No;contentPageBounds=new nS.No;contentScreenBounds=new nS.No;originPagePoint=new tn.G;originPageCenter=new tn.G;isInViewport=!1;debug=!1;setDpr(t){this.dpr=+t.toFixed(2)}updateContentScreenBounds=()=>{let{contentScreenBounds:t,contentPageBounds:c,canvasScreenBounds:u}=this,{x:h,y:f,w:g,h:b}=t;if(c.w>c.h){let t=u.w/(c.w/c.h);t>u.h?(h=(u.w-u.w*(u.h/t))/2,f=0,g=u.w*(u.h/t),b=u.h):(h=0,f=(u.h-t)/2,g=u.w,b=t)}else if(c.w<c.h){let t=u.h/(c.h/c.w);h=(u.w-t)/2,f=0,g=t,b=u.h}else h=u.h/2,f=0,g=u.h,b=u.h;t.set(h,f,g,b)};updateCanvasPageBounds=()=>{let{canvasPageBounds:t,canvasScreenBounds:c,contentPageBounds:u,contentScreenBounds:h}=this;t.set(0,0,u.width/(h.width/c.width),u.height/(h.height/c.height)),t.center=u.center};getScreenPoint=(t,c)=>{let{canvasScreenBounds:u}=this,h=(t-u.minX)*this.dpr,f=(c-u.minY)*this.dpr;return{x:h,y:f}};getPagePoint=(t,c)=>{let{contentPageBounds:u,contentScreenBounds:h,canvasPageBounds:f}=this,{x:g,y:b}=this.getScreenPoint(t,c);return new tn.G(f.minX+g*u.width/h.width,f.minY+b*u.height/h.height,1)};minimapScreenPointToPagePoint=(t,c,u=!1,h=!1)=>{let{editor:f}=this,{viewportPageBounds:g}=f,{x:b,y:v}=this.getPagePoint(t,c);if(h){let t=this.editor.currentPageBounds,c=(t?.minX??0)-g.width/2,u=(t?.maxX??0)+g.width/2,h=(t?.minY??0)-g.height/2,f=(t?.maxY??0)+g.height/2,x=Math.max(0,c+g.width-b),w=Math.max(0,-(u-g.width-b)),_=Math.max(0,h+g.height-v),k=Math.max(0,-(f-g.height-v)),E=Math.max(0,x-w),$=Math.max(0,w-x),T=Math.max(0,_-k),I=Math.max(0,k-_);E&&E>$?b+=E/2:$&&(b-=$/2),T&&T>I?v+=T/2:I&&(v-=I/2),b=(0,tt.uZ)(b,c,u),v=(0,tt.uZ)(v,h,f)}if(u){let{originPagePoint:t}=this,c=Math.abs(b-t.x),u=Math.abs(v-t.y);c>u?v=t.y:b=t.x}return new tn.G(b,v)};render=()=>{let t,c;let{cvs:u,pageBounds:h}=this;this.updateCanvasPageBounds();let{editor:f,canvasScreenBounds:g,canvasPageBounds:b,contentPageBounds:v,contentScreenBounds:x}=this,{width:w,height:_}=g,{viewportPageBounds:k,selectedShapeIds:E}=f;if(!u||!h)return;let $=u.getContext("2d");if(!$)throw Error("Minimap (shapes): Could not get context");$.resetTransform(),$.globalAlpha=1,$.clearRect(0,0,w,_);let T=x.width/v.width,I=x.height/v.height;$.translate((w-x.width)/2,(_-x.height)/2),$.scale(T,I),$.translate(-v.minX,-v.minY);let M=8/T,j=8/T,D=1/T,F=1/T,L=M/4,B=j/4,G=new Path2D,U=new Path2D,{shapeFill:V,selectFill:K,viewportFill:Z}=this.colors;for(let c=0,u=h.length;c<u;c++)t=h[c],MinimapManager.roundedRect(E.includes(t.id)?U:G,t.minX,t.minY,t.width,t.height,(0,tt.uZ)(M,D,t.width/L),(0,tt.uZ)(j,F,t.height/B));if($.fillStyle=V,$.fill(G),$.fillStyle=K,$.fill(U),this.debug){let t=nS.No.Common(h),{minX:c,minY:u,width:f,height:g}=t;$.strokeStyle="green",$.lineWidth=2/T,$.strokeRect(c+1/T,u+1/I,f-2/T,g-2/I)}{let{brush:t}=f.instanceState;if(t){let{x:c,y:u,w:h,h:f}=t;$.beginPath(),MinimapManager.sharpRect($,c,u,h,f),$.closePath(),$.fillStyle=Z,$.fill()}}{let{minX:t,minY:c,width:u,height:h}=k;$.beginPath();let f=12/T,g=12/T;MinimapManager.roundedRect($,t,c,u,h,Math.min(u/4,f),Math.min(h/4,g)),$.closePath(),$.fillStyle=Z,$.fill(),this.debug&&($.strokeStyle="orange",$.strokeRect(t+1/T,c+1/I,u-2/T,h-2/I))}let Y=2.5/T,X=2.5/I,{currentPageId:J}=f;for(let t=0;t<this.collaborators.length;t++)(c=this.collaborators[t]).currentPageId===J&&($.beginPath(),$.ellipse((0,tt.uZ)(c.cursor.x,b.minX+Y,b.maxX-Y),(0,tt.uZ)(c.cursor.y,b.minY+X,b.maxY-X),5/T,5/I,0,0,tt.yo),$.fillStyle=c.color,$.fill());if(this.debug){$.lineWidth=2/T;{let{minX:t,minY:c,width:u,height:h}=v;$.strokeStyle="red",$.strokeRect(t+1/T,c+1/I,u-2/T,h-2/I)}{let{minX:t,minY:c,width:u,height:h}=b;$.strokeStyle="blue",$.strokeRect(t+1/T,c+1/I,u-2/T,h-2/I)}}};static roundedRect(t,c,u,h,f,g,b){if(g<1&&b<1){t.rect(c,u,h,f);return}t.moveTo(c+g,u),t.lineTo(c+h-g,u),t.quadraticCurveTo(c+h,u,c+h,u+b),t.lineTo(c+h,u+f-b),t.quadraticCurveTo(c+h,u+f,c+h-g,u+f),t.lineTo(c+g,u+f),t.quadraticCurveTo(c,u+f,c,u+f-b),t.lineTo(c,u+b),t.quadraticCurveTo(c,u,c+g,u)}static sharpRect(t,c,u,h,f,g,b){t.rect(c,u,h,f)}};function Minimap({shapeFill:t,selectFill:c,viewportFill:u}){let h=(0,e8.j)(),f=U.useRef(null),g=U.useRef(!1),b=useIsDarkMode(),v=(0,eJ.vc)("dpr",()=>h.instanceState.devicePixelRatio,[h]),x=U.useMemo(()=>h.store.query.records("instance_presence"),[h]),w=U.useMemo(()=>new MinimapManager(h),[h]);U.useEffect(()=>{let f=requestAnimationFrame(()=>{let f=getComputedStyle(h.getContainer());w.colors={shapeFill:f.getPropertyValue(t).trim(),selectFill:f.getPropertyValue(c).trim(),viewportFill:f.getPropertyValue(u).trim()},w.render()});return()=>{cancelAnimationFrame(f)}},[h,c,t,u,w,b]);let _=U.useCallback(t=>{if(!h.currentPageShapeIds.size)return;let c=w.minimapScreenPointToPagePoint(t.clientX,t.clientY,!1,!1),u=w.minimapScreenPointToPagePoint(t.clientX,t.clientY,!1,!0);w.originPagePoint.setTo(u),w.originPageCenter.setTo(h.viewportPageBounds.center),h.centerOnPoint(c,{duration:to.KD})},[h,w]),k=U.useCallback(t=>{let c=t.currentTarget;if(setPointerCapture(c,t),!h.currentPageShapeIds.size)return;g.current=!0,w.isInViewport=!1;let u=w.minimapScreenPointToPagePoint(t.clientX,t.clientY,!1,!1),f=w.minimapScreenPointToPagePoint(t.clientX,t.clientY,!1,!0),b=h.viewportPageBounds;if(w.isInViewport=b.containsPoint(f),w.isInViewport)w.originPagePoint.setTo(f),w.originPageCenter.setTo(b.center);else{let t=tn.G.Sub(b.center,b.point),c=tn.G.Add(u,t);w.originPagePoint.setTo(c),w.originPageCenter.setTo(u),h.centerOnPoint(u,{duration:to.KD})}function release(t){c&&releasePointerCapture(c,t),g.current=!1,document.body.removeEventListener("pointerup",release)}document.body.addEventListener("pointerup",release)},[h,w]),E=U.useCallback(t=>{let c=w.minimapScreenPointToPagePoint(t.clientX,t.clientY,t.shiftKey,!0);if(g.current){if(w.isInViewport){let t=w.originPagePoint.clone().sub(w.originPageCenter);h.centerOnPoint(tn.G.Sub(c,t));return}h.centerOnPoint(c)}let u=w.getPagePoint(t.clientX,t.clientY),f=h.pageToScreen(u),b={type:"pointer",target:"canvas",name:"pointer_move",...getPointerInfo(t),point:f,isPen:h.instanceState.isPenMode};h.dispatch(b)},[h,w]),$=U.useCallback(t=>{let c=normalizeWheel(t);h.dispatch({type:"wheel",name:"wheel",delta:c,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey})},[h]);return(0,eJ.BK)("update when dpr changes",()=>{let t=v.value;w.setDpr(t);let c=f.current,u=c.getBoundingClientRect(),h=u.width*t,g=u.height*t;c.width=h,c.height=g,w.canvasScreenBounds.set(u.x,u.y,h,g),w.cvs=f.current},[v,w]),(0,eJ.BK)("minimap render when pagebounds or collaborators changes",()=>{let{currentPageShapeIds:t,viewportPageBounds:c,currentPageBounds:u}=h;v.value,w.contentPageBounds=u?nS.No.Expand(u,c):c,w.updateContentScreenBounds();let f=[];t.forEach(t=>{let c=h.getShapePageBounds(t);if(!c)return;let u=h.getShapeMask(t);if(u){let t=(0,nm.tY)(u,c.corners);if(!t)return;c=nS.No.FromPoints(t)}c&&(c.id=t,f.push(c))}),w.pageBounds=f,w.collaborators=x.value,w.render()},[h,w]),(0,G.jsx)("div",{className:"tlui-minimap",children:(0,G.jsx)("canvas",{ref:f,className:"tlui-minimap__canvas",onDoubleClick:_,onPointerMove:E,onPointerDown:k,onWheel:$})})}let se=(0,eJ.j)(function(){let t=(0,e8.j)(),c=useTranslation(),u=useBreakpoint(),h=t.zoomLevel,f=t.currentPageShapeIds.size>0,g=t.selectedShapeIds.length>0,b=1===t.zoomLevel,v=U.useCallback(()=>{t.resetZoom(t.viewportScreenCenter,{duration:to.KD})},[t]);return(0,G.jsxs)(Root,{id:"zoom",children:[(0,G.jsx)(Trigger,{children:(0,G.jsx)(nU,{title:`${c("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu",className:u<5?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:v,icon:u<4?"zoom-in":void 0,children:u<4?null:(0,G.jsxs)("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(100*h),"%"]})})}),(0,G.jsx)(Content,{side:"top",align:"start",alignOffset:0,children:(0,G.jsxs)(Group,{children:[(0,G.jsx)(ZoomMenuItem,{action:"zoom-in","data-testid":"minimap.zoom-menu.zoom-in",noClose:!0}),(0,G.jsx)(ZoomMenuItem,{action:"zoom-out","data-testid":"minimap.zoom-menu.zoom-out",noClose:!0}),(0,G.jsx)(ZoomMenuItem,{action:"zoom-to-100","data-testid":"minimap.zoom-menu.zoom-to-100",noClose:!0,disabled:b}),(0,G.jsx)(ZoomMenuItem,{action:"zoom-to-fit",disabled:!f,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0}),(0,G.jsx)(ZoomMenuItem,{action:"zoom-to-selection",disabled:!g,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})]})})]})});function ZoomMenuItem(t){let{action:c,disabled:u=!1,noClose:h=!1}=t,f=useActions();return(0,G.jsx)(Item,{label:f[c].label,kbd:f[c].kbd,"data-testid":t["data-testid"],onClick:()=>f[c].onSelect("zoom-menu"),noClose:h,disabled:u})}let st=(0,U.memo)(function(){let t=useActions(),c=useTranslation(),u=useBreakpoint(),[h,f]=useLocalStorageState("minimap",!0),g=(0,U.useCallback)(()=>{f(t=>!t)},[f]);return u<4?null:(0,G.jsxs)("div",{className:"tlui-navigation-zone",children:[(0,G.jsx)("div",{className:"tlui-navigation-zone__controls",children:u<6?(0,G.jsx)(se,{}):h?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(se,{}),(0,G.jsx)(nU,{title:c("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle","data-testid":"minimap.toggle",onClick:g,icon:h?"chevrons-ne":"chevrons-sw"})]}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(nU,{icon:"minus","data-testid":"minimap.zoom-out",title:`${c(t["zoom-out"].label)} ${kbdStr(t["zoom-out"].kbd)}`,onClick:()=>t["zoom-out"].onSelect("navigation-zone")}),(0,G.jsx)(se,{}),(0,G.jsx)(nU,{icon:"plus","data-testid":"minimap.zoom-in",title:`${c(t["zoom-in"].label)} ${kbdStr(t["zoom-in"].kbd)}`,onClick:()=>t["zoom-in"].onSelect("navigation-zone")}),(0,G.jsx)(nU,{title:c("navigation-zone.toggle-minimap"),className:"tlui-navigation-zone__toggle",onClick:g,icon:h?"chevrons-ne":"chevrons-sw"})]})}),u>=6&&!h&&(0,G.jsx)(Minimap,{viewportFill:"--color-muted-1",selectFill:"--color-selected",shapeFill:"--color-text-3"})]})}),sn=(0,eJ.j)(function(){let t=(0,e8.j)(),c=t.instanceState.isPenMode,u=useActions();if(!c)return null;let h=u["exit-pen-mode"];return(0,G.jsx)(nU,{label:h.label,iconLeft:h.icon,onClick:()=>h.onSelect("helper-buttons")})}),sr=(0,eJ.j)(function(){let t=(0,e8.j)(),c=useActions();if(!t.instanceState.followingUserId)return null;let u=c["stop-following"];return(0,G.jsx)(nU,{label:u.label,iconLeft:u.icon,onClick:()=>u.onSelect("people-menu")})}),si=[e0.R_,e0.ci,e0.pp,e0.ST];function useRelevantStyles(){let t=(0,e8.j)();return(0,eJ.Hg)("getRelevantStyles",()=>{let c=new nT.o(t.sharedStyles),u=t.selectedShapeIds.length>0||!!t.root.current.value?.shapeType;if(0===c.size&&t.isIn("select")&&0===t.selectedShapeIds.length)for(let u of si)c.applyValue(u,t.getStyleForNextShape(u));return 0!==c.size||u?{styles:c,opacity:t.sharedOpacity}:null},[t])}function _ButtonPicker(t){let{uiType:c,items:u,title:h,style:f,value:g,columns:b=(0,tt.uZ)(u.length,2,4),onValueChange:v}=t,x=(0,e8.j)(),w=useTranslation(),_=(0,U.useRef)(!1),{handleButtonClick:k,handleButtonPointerDown:E,handleButtonPointerEnter:$,handleButtonPointerUp:T}=U.useMemo(()=>{let handlePointerUp=()=>{_.current=!1,window.removeEventListener("pointerup",handlePointerUp)};return{handleButtonClick:t=>{let{id:c}=t.currentTarget.dataset;("shared"!==g.type||g.value!==c)&&(x.mark("point picker item"),v(f,c,!1))},handleButtonPointerDown:t=>{let{id:c}=t.currentTarget.dataset;x.mark("point picker item"),v(f,c,!0),_.current=!0,window.addEventListener("pointerup",handlePointerUp)},handleButtonPointerEnter:t=>{if(!_.current)return;let{id:c}=t.currentTarget.dataset;v(f,c,!0)},handleButtonPointerUp:t=>{let{id:c}=t.currentTarget.dataset;v(f,c,!1)}}},[g,x,v,f]),I=(0,eJ.Hg)("theme",()=>(0,e0.y6)({isDarkMode:x.user.isDarkMode}),[x]);return(0,G.jsx)("div",{className:eX("tlui-button-grid",{"tlui-button-grid__two":2===b,"tlui-button-grid__three":3===b,"tlui-button-grid__four":4===b}),children:u.map(t=>(0,G.jsx)(nU,{"data-id":t.value,"data-testid":`style.${c}.${t.value}`,"aria-label":t.value,"data-state":"shared"===g.type&&g.value===t.value?"hinted":void 0,title:h+" — "+w(`${c}-style.${t.value}`),className:eX("tlui-button-grid__button"),style:f===e0.R_?{color:I[t.value].solid}:void 0,onPointerEnter:$,onPointerDown:E,onPointerUp:T,onClick:k,icon:t.icon},t.value))})}let so=U.memo(_ButtonPicker);function $ae6933e535247d3d$export$7d15b64cf5a3a4c4(t,[c,u]){return Math.min(u,Math.max(c,t))}function $010c2913dbd2fe3d$export$5cae361ad82dce8b(t){let c=(0,U.useRef)({value:t,previous:t});return(0,U.useMemo)(()=>(c.current.value!==t&&(c.current.previous=c.current.value,c.current.value=t),c.current.previous),[t])}let sa=["PageUp","PageDown"],ss=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],sl={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},sc="Slider",[su,sd,sp]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2(sc),[sh,sf]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(sc,[sp]),[sg,sm]=sh(sc),sb=(0,U.forwardRef)((t,c)=>{let{name:u,min:h=0,max:f=100,step:g=1,orientation:b="horizontal",disabled:v=!1,minStepsBetweenThumbs:x=0,defaultValue:w=[h],value:_,onValueChange:k=()=>{},onValueCommit:E=()=>{},inverted:$=!1,...T}=t,[I,M]=(0,U.useState)(null),j=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>M(t)),D=(0,U.useRef)(new Set),F=(0,U.useRef)(0),L=!I||!!I.closest("form"),B="horizontal"===b?sx:sw,[G=[],V]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:_,defaultProp:w,onChange:t=>{var c;let u=[...D.current];null===(c=u[F.current])||void 0===c||c.focus(),k(t)}}),K=(0,U.useRef)(G);function handleSlideStart(t){let c=$faa2e61a3361514f$var$getClosestValueIndex(G,t);updateValues(t,c)}function handleSlideMove(t){updateValues(t,F.current)}function handleSlideEnd(){let t=K.current[F.current],c=G[F.current];c!==t&&E(G)}function updateValues(t,c,{commit:u}={commit:!1}){let b=$faa2e61a3361514f$var$getDecimalCount(g),v=$faa2e61a3361514f$var$roundValue(Math.round((t-h)/g)*g+h,b),w=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(v,[h,f]);V((t=[])=>{let h=$faa2e61a3361514f$var$getNextSortedValues(t,w,c);if(!$faa2e61a3361514f$var$hasMinStepsBetweenValues(h,x*g))return t;{F.current=h.indexOf(w);let c=String(h)!==String(t);return c&&u&&E(h),c?h:t}})}return(0,U.createElement)(sg,{scope:t.__scopeSlider,disabled:v,min:h,max:f,valueIndexToChangeRef:F,thumbs:D.current,values:G,orientation:b},(0,U.createElement)(su.Provider,{scope:t.__scopeSlider},(0,U.createElement)(su.Slot,{scope:t.__scopeSlider},(0,U.createElement)(B,_extends({"aria-disabled":v,"data-disabled":v?"":void 0},T,{ref:j,onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(T.onPointerDown,()=>{v||(K.current=G)}),min:h,max:f,inverted:$,onSlideStart:v?void 0:handleSlideStart,onSlideMove:v?void 0:handleSlideMove,onSlideEnd:v?void 0:handleSlideEnd,onHomeKeyDown:()=>!v&&updateValues(h,0,{commit:!0}),onEndKeyDown:()=>!v&&updateValues(f,G.length-1,{commit:!0}),onStepKeyDown:({event:t,direction:c})=>{if(!v){let u=sa.includes(t.key),h=u||t.shiftKey&&ss.includes(t.key),f=F.current,b=G[f],v=g*(h?10:1)*c;updateValues(b+v,f,{commit:!0})}}})))),L&&G.map((t,c)=>(0,U.createElement)($faa2e61a3361514f$var$BubbleInput,{key:c,name:u?u+(G.length>1?"[]":""):void 0,value:t})))}),[sy,sv]=sh(sc,{startEdge:"left",endEdge:"right",size:"width",direction:1}),sx=(0,U.forwardRef)((t,c)=>{let{min:u,max:h,dir:f,inverted:g,onSlideStart:b,onSlideMove:v,onSlideEnd:x,onStepKeyDown:w,..._}=t,[k,E]=(0,U.useState)(null),$=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>E(t)),T=(0,U.useRef)(),I=$f631663db3294ace$export$b39126d51d94e6f3(f),M="ltr"===I,j=M&&!g||!M&&g;function getValueFromPointer(t){let c=T.current||k.getBoundingClientRect(),f=[0,c.width],g=$faa2e61a3361514f$var$linearScale(f,j?[u,h]:[h,u]);return T.current=c,g(t-c.left)}return(0,U.createElement)(sy,{scope:t.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width"},(0,U.createElement)(sS,_extends({dir:I,"data-orientation":"horizontal"},_,{ref:$,style:{..._.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:t=>{let c=getValueFromPointer(t.clientX);null==b||b(c)},onSlideMove:t=>{let c=getValueFromPointer(t.clientX);null==v||v(c)},onSlideEnd:()=>{T.current=void 0,null==x||x()},onStepKeyDown:t=>{let c=sl[j?"from-left":"from-right"].includes(t.key);null==w||w({event:t,direction:c?-1:1})}})))}),sw=(0,U.forwardRef)((t,c)=>{let{min:u,max:h,inverted:f,onSlideStart:g,onSlideMove:b,onSlideEnd:v,onStepKeyDown:x,...w}=t,_=(0,U.useRef)(null),k=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,_),E=(0,U.useRef)(),$=!f;function getValueFromPointer(t){let c=E.current||_.current.getBoundingClientRect(),f=[0,c.height],g=$faa2e61a3361514f$var$linearScale(f,$?[h,u]:[u,h]);return E.current=c,g(t-c.top)}return(0,U.createElement)(sy,{scope:t.__scopeSlider,startEdge:$?"bottom":"top",endEdge:$?"top":"bottom",size:"height",direction:$?1:-1},(0,U.createElement)(sS,_extends({"data-orientation":"vertical"},w,{ref:k,style:{...w.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:t=>{let c=getValueFromPointer(t.clientY);null==g||g(c)},onSlideMove:t=>{let c=getValueFromPointer(t.clientY);null==b||b(c)},onSlideEnd:()=>{E.current=void 0,null==v||v()},onStepKeyDown:t=>{let c=sl[$?"from-bottom":"from-top"].includes(t.key);null==x||x({event:t,direction:c?-1:1})}})))}),sS=(0,U.forwardRef)((t,c)=>{let{__scopeSlider:u,onSlideStart:h,onSlideMove:f,onSlideEnd:g,onHomeKeyDown:b,onEndKeyDown:v,onStepKeyDown:x,...w}=t,_=sm(sc,u);return(0,U.createElement)(ee.span,_extends({},w,{ref:c,onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onKeyDown,t=>{"Home"===t.key?(b(t),t.preventDefault()):"End"===t.key?(v(t),t.preventDefault()):sa.concat(ss).includes(t.key)&&(x(t),t.preventDefault())}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDown,t=>{let c=t.target;c.setPointerCapture(t.pointerId),t.preventDefault(),_.thumbs.has(c)?c.focus():h(t)}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerMove,t=>{let c=t.target;c.hasPointerCapture(t.pointerId)&&f(t)}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerUp,t=>{let c=t.target;c.hasPointerCapture(t.pointerId)&&(c.releasePointerCapture(t.pointerId),g(t))})}))}),s_=(0,U.forwardRef)((t,c)=>{let{__scopeSlider:u,...h}=t,f=sm("SliderTrack",u);return(0,U.createElement)(ee.span,_extends({"data-disabled":f.disabled?"":void 0,"data-orientation":f.orientation},h,{ref:c}))}),sk="SliderRange",sC=(0,U.forwardRef)((t,c)=>{let{__scopeSlider:u,...h}=t,f=sm(sk,u),g=sv(sk,u),b=(0,U.useRef)(null),v=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,b),x=f.values.length,w=f.values.map(t=>$faa2e61a3361514f$var$convertValueToPercentage(t,f.min,f.max));return(0,U.createElement)(ee.span,_extends({"data-orientation":f.orientation,"data-disabled":f.disabled?"":void 0},h,{ref:v,style:{...t.style,[g.startEdge]:(x>1?Math.min(...w):0)+"%",[g.endEdge]:100-Math.max(...w)+"%"}}))}),sP="SliderThumb",sE=(0,U.forwardRef)((t,c)=>{let u=sd(t.__scopeSlider),[h,f]=(0,U.useState)(null),g=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>f(t)),b=(0,U.useMemo)(()=>h?u().findIndex(t=>t.ref.current===h):-1,[u,h]);return(0,U.createElement)(s$,_extends({},t,{ref:g,index:b}))}),s$=(0,U.forwardRef)((t,c)=>{let{__scopeSlider:u,index:h,...f}=t,g=sm(sP,u),b=sv(sP,u),[v,x]=(0,U.useState)(null),w=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(c,t=>x(t)),_=$db6c3485150b8e66$export$1ab7ae714698c4b8(v),k=g.values[h],E=void 0===k?0:$faa2e61a3361514f$var$convertValueToPercentage(k,g.min,g.max),$=$faa2e61a3361514f$var$getLabel(h,g.values.length),T=null==_?void 0:_[b.size],I=T?$faa2e61a3361514f$var$getThumbInBoundsOffset(T,E,b.direction):0;return(0,U.useEffect)(()=>{if(v)return g.thumbs.add(v),()=>{g.thumbs.delete(v)}},[v,g.thumbs]),(0,U.createElement)("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[b.startEdge]:`calc(${E}% + ${I}px)`}},(0,U.createElement)(su.ItemSlot,{scope:t.__scopeSlider},(0,U.createElement)(ee.span,_extends({role:"slider","aria-label":t["aria-label"]||$,"aria-valuemin":g.min,"aria-valuenow":k,"aria-valuemax":g.max,"aria-orientation":g.orientation,"data-orientation":g.orientation,"data-disabled":g.disabled?"":void 0,tabIndex:g.disabled?void 0:0},f,{ref:w,style:void 0===k?{display:"none"}:t.style,onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onFocus,()=>{g.valueIndexToChangeRef.current=h})}))))}),$faa2e61a3361514f$var$BubbleInput=t=>{let{value:c,...u}=t,h=(0,U.useRef)(null),f=$010c2913dbd2fe3d$export$5cae361ad82dce8b(c);return(0,U.useEffect)(()=>{let t=h.current,u=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(u,"value"),b=g.set;if(f!==c&&b){let u=new Event("input",{bubbles:!0});b.call(t,c),t.dispatchEvent(u)}},[f,c]),(0,U.createElement)("input",_extends({style:{display:"none"}},u,{ref:h,defaultValue:c}))};function $faa2e61a3361514f$var$getNextSortedValues(t=[],c,u){let h=[...t];return h[u]=c,h.sort((t,c)=>t-c)}function $faa2e61a3361514f$var$convertValueToPercentage(t,c,u){return $ae6933e535247d3d$export$7d15b64cf5a3a4c4(100/(u-c)*(t-c),[0,100])}function $faa2e61a3361514f$var$getLabel(t,c){return c>2?`Value ${t+1} of ${c}`:2===c?["Minimum","Maximum"][t]:void 0}function $faa2e61a3361514f$var$getClosestValueIndex(t,c){if(1===t.length)return 0;let u=t.map(t=>Math.abs(t-c)),h=Math.min(...u);return u.indexOf(h)}function $faa2e61a3361514f$var$getThumbInBoundsOffset(t,c,u){let h=t/2,f=$faa2e61a3361514f$var$linearScale([0,50],[0,h]);return(h-f(c)*u)*u}function $faa2e61a3361514f$var$getStepsBetweenValues(t){return t.slice(0,-1).map((c,u)=>t[u+1]-c)}function $faa2e61a3361514f$var$hasMinStepsBetweenValues(t,c){if(c>0){let u=$faa2e61a3361514f$var$getStepsBetweenValues(t);return Math.min(...u)>=c}return!0}function $faa2e61a3361514f$var$linearScale(t,c){return u=>{if(t[0]===t[1]||c[0]===c[1])return c[0];let h=(c[1]-c[0])/(t[1]-t[0]);return c[0]+h*(u-t[0])}}function $faa2e61a3361514f$var$getDecimalCount(t){return(String(t).split(".")[1]||"").length}function $faa2e61a3361514f$var$roundValue(t,c){let u=Math.pow(10,c);return Math.round(t*u)/u}let sT=(0,U.memo)(function(t){let{title:c,steps:u,value:h,label:f,onValueChange:g}=t,b=(0,e8.j)(),v=useTranslation(),x=(0,U.useCallback)(t=>{g(t[0],!0)},[g]),w=(0,U.useCallback)(()=>{b.mark("click slider")},[b]),_=(0,U.useCallback)(()=>{h&&g(h,!1)},[h,g]);return(0,G.jsx)("div",{className:"tlui-slider__container",children:(0,G.jsxs)(sb,{"data-testid":t["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:u,step:1,value:h?[h]:void 0,onPointerDown:w,onValueChange:x,onPointerUp:_,title:c+" — "+v(f),children:[(0,G.jsx)(s_,{className:"tlui-slider__track",dir:"ltr",children:null!==h&&(0,G.jsx)(sC,{className:"tlui-slider__range",dir:"ltr"})}),null!==h&&(0,G.jsx)(sE,{className:"tlui-slider__thumb",dir:"ltr"})]})})}),sI=U.memo(function({label:t,uiTypeA:c,uiTypeB:u,labelA:h,labelB:f,itemsA:g,itemsB:b,styleA:v,styleB:x,valueA:w,valueB:_,onValueChange:k}){let E=useTranslation(),$=U.useMemo(()=>g.find(t=>"shared"===w.type&&w.value===t.value)?.icon??"mixed",[g,w]),T=U.useMemo(()=>b.find(t=>"shared"===_.type&&_.value===t.value)?.icon??"mixed",[b,_]);return void 0===w&&void 0===_?null:(0,G.jsxs)("div",{className:"tlui-style-panel__double-select-picker",children:[(0,G.jsx)("div",{title:E(t),className:"tlui-style-panel__double-select-picker-label",children:E(t)}),(0,G.jsxs)(Root,{id:`style panel ${c} A`,children:[(0,G.jsx)(il,{asChild:!0,onTouchEnd:t=>preventDefault(t),children:(0,G.jsx)(nU,{"data-testid":`style.${c}`,title:E(h)+" — "+(null===w?E("style-panel.mixed"):E(`${c}-style.${w}`)),icon:$,invertIcon:!0,smallIcon:!0})}),(0,G.jsx)(Content,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,G.jsx)("div",{className:eX("tlui-button-grid",{"tlui-button-grid__two":g.length<4,"tlui-button-grid__four":g.length>=4}),children:g.map(t=>(0,G.jsx)(Item,{className:"tlui-button-grid__button",title:E(h)+" — "+E(`${c}-style.${t.value}`),"data-testid":`style.${c}.${t.value}`,icon:t.icon,onClick:()=>k(v,t.value,!1),invertIcon:!0},t.value))})})]}),(0,G.jsxs)(Root,{id:`style panel ${u}`,children:[(0,G.jsx)(il,{asChild:!0,onTouchEnd:t=>preventDefault(t),children:(0,G.jsx)(nU,{"data-testid":`style.${u}`,title:E(f)+" — "+(null===_?E("style-panel.mixed"):E(`${u}-style.${_}`)),icon:T,smallIcon:!0})}),(0,G.jsx)(Content,{side:"bottom",align:"end",sideOffset:0,alignOffset:-2,children:(0,G.jsx)("div",{className:eX("tlui-button-grid",{"tlui-button-grid__two":g.length<4,"tlui-button-grid__four":g.length>=4}),children:b.map(t=>(0,G.jsx)(Item,{className:"tlui-button-grid__button",title:E(f)+" — "+E(`${u}-style.${t.value}`),"data-testid":`style.${u}.${t.value}`,icon:t.icon,onClick:()=>k(x,t.value,!1)},t.value))})})]})]})}),sA=U.memo(function({id:t,label:c,uiType:u,style:h,items:f,value:g,onValueChange:b}){let v=useTranslation(),x=U.useMemo(()=>f.find(t=>"shared"===g.type&&t.value===g.value)?.icon,[f,g]);return(0,G.jsxs)(Root,{id:`style panel ${t}`,children:[(0,G.jsx)(il,{asChild:!0,onTouchEnd:t=>preventDefault(t),children:(0,G.jsx)(nU,{"data-testid":`style.${u}`,title:"mixed"===g.type?v("style-panel.mixed"):v(`${u}-style.${g.value}`),label:c,icon:x??"mixed"})}),(0,G.jsx)(Content,{side:"left",align:"center",alignOffset:0,children:(0,G.jsx)("div",{className:eX("tlui-button-grid",{"tlui-button-grid__two":f.length<3,"tlui-button-grid__three":3==f.length,"tlui-button-grid__four":f.length>=4}),children:f.map(t=>(0,G.jsx)(Item,{className:"tlui-button-grid__button","data-testid":`style.${u}.${t.value}`,title:v(`${u}-style.${t.value}`),icon:t.icon,onClick:()=>b(h,t.value,!1)},t.value))})})]})}),sM={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],horizontalAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-center"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"cloud",icon:"geo-cloud"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"star",icon:"geo-star"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},StylePanel=function({isMobile:t}){let c=(0,e8.j)(),u=useRelevantStyles(),h=(0,U.useCallback)(()=>{t||c.updateInstanceState({isChangingStyle:!1})},[c,t]);if(!u)return null;let{styles:f,opacity:g}=u,b=f.get(e0.Zu),v=f.get(e0.ZJ),x=f.get(e0.TA),w=f.get(e0.t8),_=f.get(e0.Y8);return(0,G.jsxs)("div",{className:"tlui-style-panel","data-ismobile":t,onPointerLeave:h,children:[(0,G.jsx)(CommonStylePickerSet,{styles:f,opacity:g}),void 0!==_&&(0,G.jsx)(TextStylePickerSet,{styles:f}),!(void 0===b&&void 0===v&&void 0===x&&void 0===w)&&(0,G.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[(0,G.jsx)(GeoStylePickerSet,{styles:f}),(0,G.jsx)(ArrowheadStylePickerSet,{styles:f}),(0,G.jsx)(SplineStylePickerSet,{styles:f})]})]})};function useStyleChangeCallback(){let t=(0,e8.j)();return U.useMemo(()=>function(c,u,h){t.batch(()=>{t.isIn("select")&&t.setStyleForSelectedShapes(c,u,{squashing:h}),t.setStyleForNextShapes(c,u,{squashing:h}),t.updateInstanceState({isChangingStyle:!0})})},[t])}let sj=[.1,.25,.5,.75,1];function CommonStylePickerSet({styles:t,opacity:c}){let u=(0,e8.j)(),h=useTranslation(),f=useStyleChangeCallback(),g=U.useCallback((t,c)=>{let h=sj[t];u.batch(()=>{u.isIn("select")&&u.setOpacityForSelectedShapes(h,{ephemeral:c}),u.setOpacityForNextShapes(h,{ephemeral:c}),u.updateInstanceState({isChangingStyle:!0})})},[u]),b=t.get(e0.R_),v=t.get(e0.pp),x=t.get(e0.ci),w=t.get(e0.ST),_="mixed"===c.type?-1:sj.indexOf((0,e1.F)(sj,t=>Math.abs(t-c.value)));return(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles",children:[void 0===b?null:(0,G.jsx)(so,{title:h("style-panel.color"),uiType:"color",style:e0.R_,items:sM.color,value:b,onValueChange:f}),void 0===c?null:(0,G.jsx)(sT,{"data-testid":"style.opacity",value:_>=0?_:sj.length-1,label:"mixed"===c.type?"style-panel.mixed":`opacity-style.${c.value}`,onValueChange:g,steps:sj.length-1,title:h("style-panel.opacity")})]}),(void 0!==v||void 0!==x||void 0!==w)&&(0,G.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[void 0===v?null:(0,G.jsx)(so,{title:h("style-panel.fill"),uiType:"fill",style:e0.pp,items:sM.fill,value:v,onValueChange:f}),void 0===x?null:(0,G.jsx)(so,{title:h("style-panel.dash"),uiType:"dash",style:e0.ci,items:sM.dash,value:x,onValueChange:f}),void 0===w?null:(0,G.jsx)(so,{title:h("style-panel.size"),uiType:"size",style:e0.ST,items:sM.size,value:w,onValueChange:f})]})]})}function TextStylePickerSet({styles:t}){let c=useTranslation(),u=useStyleChangeCallback(),h=t.get(e0.Y8),f=t.get(e0.Xo),g=t.get(e0.HO);return void 0===h&&void 0===f?null:(0,G.jsxs)("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[void 0===h?null:(0,G.jsx)(so,{title:c("style-panel.font"),uiType:"font",style:e0.Y8,items:sM.font,value:h,onValueChange:u}),void 0===f?null:(0,G.jsxs)("div",{className:"tlui-style-panel__row",children:[(0,G.jsx)(so,{title:c("style-panel.align"),uiType:"align",style:e0.Xo,items:sM.horizontalAlign,value:f,onValueChange:u}),void 0===g?(0,G.jsx)(nU,{title:c("style-panel.vertical-align"),"data-testid":"vertical-align",icon:"vertical-align-center",disabled:!0}):(0,G.jsx)(sA,{id:"geo-vertical-alignment",uiType:"verticalAlign",style:e0.HO,items:sM.verticalAlign,value:g,onValueChange:u})]})]})}function GeoStylePickerSet({styles:t}){let c=useStyleChangeCallback(),u=t.get(e0.Zu);return void 0===u?null:(0,G.jsx)(sA,{id:"geo",label:"style-panel.geo",uiType:"geo",style:e0.Zu,items:sM.geo,value:u,onValueChange:c})}function SplineStylePickerSet({styles:t}){let c=useStyleChangeCallback(),u=t.get(e0.t8);return void 0===u?null:(0,G.jsx)(sA,{id:"spline",label:"style-panel.spline",uiType:"spline",style:e0.t8,items:sM.spline,value:u,onValueChange:c})}function ArrowheadStylePickerSet({styles:t}){let c=useStyleChangeCallback(),u=t.get(e0.ZJ),h=t.get(e0.TA);return u&&h?(0,G.jsx)(sI,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:e0.TA,itemsA:sM.arrowheadStart,valueA:h,uiTypeB:"arrowheadEnd",styleB:e0.ZJ,itemsB:sM.arrowheadEnd,valueB:u,onValueChange:c,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"}):null}function Toast({toast:t}){let{removeToast:c}=useToasts(),u=useTranslation(),h=t.actions&&t.actions.length>0;return(0,G.jsxs)(og,{onOpenChange:u=>{u||c(t.id)},className:"tlui-toast__container",duration:t.keepOpen?1/0:5e3,children:[t.icon&&(0,G.jsx)("div",{className:"tlui-toast__icon",children:(0,G.jsx)(nz,{icon:t.icon})}),(0,G.jsxs)("div",{className:"tlui-toast__main",children:[(0,G.jsxs)("div",{className:"tlui-toast__content",children:[t.title&&(0,G.jsx)(ov,{className:"tlui-toast__title",children:t.title}),t.description&&(0,G.jsx)(ox,{className:"tlui-toast__description",children:t.description})]}),t.actions&&(0,G.jsxs)("div",{className:"tlui-toast__actions",children:[t.actions.map((t,c)=>(0,G.jsx)(ow,{altText:t.label,asChild:!0,onClick:t.onClick,children:(0,G.jsx)(nU,{className:"warn"===t.type?"tlui-button__warning":"tlui-button__primary",children:t.label})},c)),h&&(0,G.jsx)(oS,{asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-toast__close",style:{marginLeft:"auto"},children:t.closeLabel??u("toast.close")})})]})]}),!h&&(0,G.jsx)(oS,{asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-toast__close",children:t.closeLabel??u("toast.close")})})]})}function _Toasts(){let{toasts:t}=useToasts();return(0,G.jsx)(G.Fragment,{children:t.map(t=>(0,G.jsx)(Toast,{toast:t},t.id))})}let sD=U.memo(_Toasts);function ToastViewport(){let{toasts:t}=useToasts(),[c,u]=U.useState(!1);return(U.useEffect(()=>{let c=!1;return t.length?u(!0):setTimeout(()=>{c||u(!1)},1e3),()=>{c=!0}},[t.length,u]),c)?(0,G.jsx)(op,{className:"tlui-toast__viewport"}):null}function useOpenMenuCloser(){let t=(0,e8.j)(),c=(0,U.useRef)(!1),u=(0,U.useCallback)(()=>{t.openMenus.length>0&&(t.updateInstanceState({openMenus:[]}),c.current=!0)},[t]),h=(0,U.useCallback)(t=>{c.current&&preventDefault(t),c.current=!1},[]);return{handlePointerDown:u,handleClick:h}}function MobileStylePanel(){let t=(0,e8.j)(),c=useTranslation(),u=useRelevantStyles(),h=u?.styles.get(e0.R_),f=(0,e0.y6)({isDarkMode:t.user.isDarkMode}),g=(h?.type==="shared"?f[h.value]:f.black).solid,b=(0,eJ.Hg)("isHandOrEraserToolActive",()=>t.isInAny("hand","zoom","eraser","laser"),[t]),v=(0,U.useCallback)(c=>{c||t.updateInstanceState({isChangingStyle:!1})},[t]),x=useOpenMenuCloser();return(0,G.jsxs)(Popover,{id:"style menu",onOpenChange:v,children:[(0,G.jsx)(PopoverTrigger,{disabled:b,children:(0,G.jsx)(nU,{className:"tlui-toolbar__tools__button tlui-toolbar__styles__button","data-testid":"mobile.styles",style:{color:b?"var(--color-muted-1)":g},title:c("style-panel.title"),...x,children:(0,G.jsx)(nz,{icon:b?"blob":h?.type==="mixed"?"mixed":"blob"})})}),(0,G.jsx)(PopoverContent,{side:"top",align:"end",children:(0,G.jsx)(StylePanel,{isMobile:!0})})]})}let sO=["select","hand","draw","eraser","text","zoom","laser","highlight"];function ToggleToolLockedButton({activeToolId:t}){let c=(0,e8.j)(),u=useBreakpoint(),h=useTranslation(),f=(0,eJ.Hg)("is tool locked",()=>c.instanceState.isToolLocked,[c]);return!t||sO.includes(t)?null:(0,G.jsx)(nU,{title:h("action.toggle-tool-lock"),className:eX("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":u<5}),icon:f?"lock":"unlock",onClick:()=>c.updateInstanceState({isToolLocked:!f}),smallIcon:!0})}let sF=(0,U.memo)(function(){let t=(0,e8.j)(),c=useTranslation(),u=useBreakpoint(),h=U.useRef(void 0),f=useReadonly(),g=useToolbarSchema(),b=g.find(t=>"laser"===t.toolItem.id),v=(0,eJ.Hg)("current tool id",()=>t.currentToolId,[t]),x=(0,eJ.Hg)("geo",()=>t.sharedStyles.getAsKnownValue(e0.Zu),[t]),getTitle=t=>t.label?`${c(t.label)} ${t.kbd?kbdStr(t.kbd):""}`:"",w=g.find(t=>isActiveTLUiToolItem(t.toolItem,v,x)),{itemsInPanel:_,itemsInDropdown:k,dropdownFirstItem:E}=U.useMemo(()=>{let t;let c=[],f=[],b=Math.min(8,5+u);for(let u=4;u<g.length;u++){let h=g[u];u<b?c.push(h):(h===w&&(t=h),f.push(h))}return t||(h.current||(h.current=f[0]),t=h.current,f.includes(t)||(t=f[0])),h.current=t,f.length<=2&&(c.push(...f),f.length=0),{itemsInPanel:c,itemsInDropdown:f,dropdownFirstItem:t}},[g,w,u]);return(0,G.jsx)("div",{className:"tlui-toolbar",children:(0,G.jsxs)("div",{className:"tlui-toolbar__inner",children:[(0,G.jsxs)("div",{className:"tlui-toolbar__left",children:[!f&&(0,G.jsxs)("div",{className:"tlui-toolbar__extras",children:[u<6&&!("hand"===v||"zoom"===v)&&(0,G.jsxs)("div",{className:"tlui-toolbar__extras__controls",children:[(0,G.jsx)(a7,{}),(0,G.jsx)(a8,{}),(0,G.jsx)(a6,{}),(0,G.jsx)(a3,{}),(0,G.jsx)(a2,{})]}),(0,G.jsx)(ToggleToolLockedButton,{activeToolId:v})]}),(0,G.jsxs)("div",{className:eX("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":u<5}),children:[g.slice(0,2).map(({toolItem:t})=>(0,G.jsx)(ToolbarButton,{item:t,title:getTitle(t),isSelected:isActiveTLUiToolItem(t,v,x)},t.id)),f&&b&&(0,G.jsx)(ToolbarButton,{item:b.toolItem,title:getTitle(b.toolItem),isSelected:isActiveTLUiToolItem(b.toolItem,v,x)},b.toolItem.id),!f&&(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)("div",{className:"tlui-toolbar__divider"}),g.slice(2,4).map(({toolItem:t})=>(0,G.jsx)(ToolbarButton,{item:t,title:getTitle(t),isSelected:isActiveTLUiToolItem(t,v,x)},t.id)),(0,G.jsx)("div",{className:"tlui-toolbar__divider"}),_.map(({toolItem:t})=>(0,G.jsx)(ToolbarButton,{item:t,title:getTitle(t),isSelected:isActiveTLUiToolItem(t,v,x)},t.id)),k.length?(0,G.jsxs)(G.Fragment,{children:[(0,G.jsx)(ToolbarButton,{item:E.toolItem,title:getTitle(E.toolItem),isSelected:isActiveTLUiToolItem(E.toolItem,v,x)},E.toolItem.id),(0,G.jsxs)(Root,{id:"toolbar overflow",modal:!1,children:[(0,G.jsx)(Trigger,{children:(0,G.jsx)(nU,{className:"tlui-toolbar__tools__button tlui-toolbar__overflow",icon:"chevron-up","data-testid":"tools.more",title:c("tool-panel.more")})}),(0,G.jsx)(Content,{side:"top",align:"center",children:(0,G.jsx)(sR,{toolbarItems:k})})]})]}):null]})]})]}),u<5&&!f&&(0,G.jsx)("div",{className:"tlui-toolbar__tools",children:(0,G.jsx)(MobileStylePanel,{})})]})})}),sR=(0,eJ.j)(function({toolbarItems:t}){let c=useTranslation();return(0,G.jsx)("div",{className:"tlui-button-grid__four tlui-button-grid__reverse",children:t.map(({toolItem:{id:t,meta:u,kbd:h,label:f,onSelect:g,icon:b}})=>(0,G.jsx)(Item,{className:"tlui-button-grid__button","data-testid":`tools.${t}`,"data-tool":t,"data-geo":u?.geo??"","aria-label":f,onClick:()=>g("toolbar"),title:f?`${c(f)} ${h?kbdStr(h):""}`:"",icon:b},t))})});function ToolbarButton({item:t,title:c,isSelected:u}){return(0,G.jsx)(nU,{className:"tlui-toolbar__tools__button","data-testid":`tools.${t.id}`,"data-tool":t.id,"data-geo":t.meta?.geo??"","aria-label":t.label,title:c,icon:t.icon,"data-state":u?"selected":void 0,onClick:()=>t.onSelect("toolbar"),onTouchStart:c=>{preventDefault(c),t.onSelect("toolbar")}})}let isActiveTLUiToolItem=(t,c,u)=>t.meta?.geo?"geo"===c&&u===t.meta?.geo:c===t.id;function useEditorEvents(){let t=(0,e8.j)(),{addToast:c}=useToasts();(0,U.useEffect)(()=>{function handleMaxShapes({name:t,count:u}){c({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${t} (${u}). Please delete some shapes or move to a different page to continue.`})}return t.addListener("max-shapes",handleMaxShapes),()=>{t.removeListener("max-shapes",handleMaxShapes)}},[t,c])}var sL="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function addEvent(t,c,u,h){t.addEventListener?t.addEventListener(c,u,h):t.attachEvent&&t.attachEvent("on".concat(c),function(){u(window.event)})}function getMods(t,c){for(var u=c.slice(0,c.length-1),h=0;h<u.length;h++)u[h]=t[u[h].toLowerCase()];return u}function getKeys(t){"string"!=typeof t&&(t="");for(var c=(t=t.replace(/\s/g,"")).split(","),u=c.lastIndexOf("");u>=0;)c[u-1]+=",",c.splice(u,1),u=c.lastIndexOf("");return c}function compareArray(t,c){for(var u=t.length>=c.length?t:c,h=t.length>=c.length?c:t,f=!0,g=0;g<u.length;g++)-1===h.indexOf(u[g])&&(f=!1);return f}for(var sN={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":sL?173:189,"=":sL?61:187,";":sL?59:186,"'":222,"[":219,"]":221,"\\":220},sz={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},sB={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},sG={16:!1,18:!1,17:!1,91:!1},sH={},sU=1;sU<20;sU++)sN["f".concat(sU)]=111+sU;var sV=[],sW=!1,sK="all",sZ=[],code=function(t){return sN[t.toLowerCase()]||sz[t.toLowerCase()]||t.toUpperCase().charCodeAt(0)};function setScope(t){sK=t||"all"}function getScope(){return sK||"all"}function deleteScope(t,c){var u,h;for(var f in t||(t=getScope()),sH)if(Object.prototype.hasOwnProperty.call(sH,f))for(h=0,u=sH[f];h<u.length;)u[h].scope===t?u.splice(h,1):h++;getScope()===t&&setScope(c||"all")}function clearModifier(t){var c=t.keyCode||t.which||t.charCode,u=sV.indexOf(c);if(u>=0&&sV.splice(u,1),t.key&&"meta"===t.key.toLowerCase()&&sV.splice(0,sV.length),(93===c||224===c)&&(c=91),c in sG)for(var h in sG[c]=!1,sz)sz[h]===c&&(hotkeys[h]=!1)}var eachUnbind=function(t){var c=t.key,u=t.scope,h=t.method,f=t.splitKey,g=void 0===f?"+":f;getKeys(c).forEach(function(t){var c=t.split(g),f=c.length,b=c[f-1],v="*"===b?"*":code(b);if(sH[v]){u||(u=getScope());var x=f>1?getMods(sz,c):[];sH[v]=sH[v].filter(function(t){return!((!h||t.method===h)&&t.scope===u&&compareArray(t.mods,x))})}})};function eventHandler(t,c,u,h){var f;if(c.element===h&&(c.scope===u||"all"===c.scope)){for(var g in f=c.mods.length>0,sG)Object.prototype.hasOwnProperty.call(sG,g)&&(!sG[g]&&c.mods.indexOf(+g)>-1||sG[g]&&-1===c.mods.indexOf(+g))&&(f=!1);(0!==c.mods.length||sG[16]||sG[18]||sG[17]||sG[91])&&!f&&"*"!==c.shortcut||(c.keys=[],c.keys=c.keys.concat(sV),!1===c.method(t,c)&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function dispatch(t,c){var u=sH["*"],h=t.keyCode||t.which||t.charCode;if(hotkeys.filter.call(this,t)){if((93===h||224===h)&&(h=91),-1===sV.indexOf(h)&&229!==h&&sV.push(h),["ctrlKey","altKey","shiftKey","metaKey"].forEach(function(c){var u=sB[c];t[c]&&-1===sV.indexOf(u)?sV.push(u):!t[c]&&sV.indexOf(u)>-1?sV.splice(sV.indexOf(u),1):"metaKey"===c&&t[c]&&3===sV.length&&!(t.ctrlKey||t.shiftKey||t.altKey)&&(sV=sV.slice(sV.indexOf(u)))}),h in sG){for(var f in sG[h]=!0,sz)sz[f]===h&&(hotkeys[f]=!0);if(!u)return}for(var g in sG)Object.prototype.hasOwnProperty.call(sG,g)&&(sG[g]=t[sB[g]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(-1===sV.indexOf(17)&&sV.push(17),-1===sV.indexOf(18)&&sV.push(18),sG[17]=!0,sG[18]=!0);var b=getScope();if(u)for(var v=0;v<u.length;v++)u[v].scope===b&&("keydown"===t.type&&u[v].keydown||"keyup"===t.type&&u[v].keyup)&&eventHandler(t,u[v],b,c);if(h in sH){for(var x=0;x<sH[h].length;x++)if(("keydown"===t.type&&sH[h][x].keydown||"keyup"===t.type&&sH[h][x].keyup)&&sH[h][x].key){for(var w=sH[h][x],_=w.splitKey,k=w.key.split(_),E=[],$=0;$<k.length;$++)E.push(code(k[$]));E.sort().join("")===sV.sort().join("")&&eventHandler(t,w,b,c)}}}}function isElementBind(t){return sZ.indexOf(t)>-1}function hotkeys(t,c,u){sV=[];var h=getKeys(t),f=[],g="all",b=document,v=0,x=!1,w=!0,_="+",k=!1;for(void 0===u&&"function"==typeof c&&(u=c),"[object Object]"===Object.prototype.toString.call(c)&&(c.scope&&(g=c.scope),c.element&&(b=c.element),c.keyup&&(x=c.keyup),void 0!==c.keydown&&(w=c.keydown),void 0!==c.capture&&(k=c.capture),"string"==typeof c.splitKey&&(_=c.splitKey)),"string"==typeof c&&(g=c);v<h.length;v++)t=h[v].split(_),f=[],t.length>1&&(f=getMods(sz,t)),(t="*"===(t=t[t.length-1])?"*":code(t))in sH||(sH[t]=[]),sH[t].push({keyup:x,keydown:w,scope:g,mods:f,shortcut:h[v],method:u,key:h[v],splitKey:_,element:b});void 0!==b&&!isElementBind(b)&&window&&(sZ.push(b),addEvent(b,"keydown",function(t){dispatch(t,b)},k),sW||(sW=!0,addEvent(window,"focus",function(){sV=[]},k)),addEvent(b,"keyup",function(t){dispatch(t,b),clearModifier(t)},k))}var sY={getPressedKeyString:function(){return sV.map(function(t){return Object.keys(sN).find(function(c){return sN[c]===t})||Object.keys(sz).find(function(c){return sz[c]===t})||String.fromCharCode(t)})},setScope:setScope,getScope:getScope,deleteScope:deleteScope,getPressedKeyCodes:function(){return sV.slice(0)},getAllKeyCodes:function(){var t=[];return Object.keys(sH).forEach(function(c){sH[c].forEach(function(c){var u=c.key,h=c.scope,f=c.mods,g=c.shortcut;t.push({scope:h,shortcut:g,mods:f,keys:u.split("+").map(function(t){return code(t)})})})}),t},isPressed:function(t){return"string"==typeof t&&(t=code(t)),-1!==sV.indexOf(t)},filter:function(t){var c=t.target||t.srcElement,u=c.tagName,h=!0;return(c.isContentEditable||("INPUT"===u||"TEXTAREA"===u||"SELECT"===u)&&!c.readOnly)&&(h=!1),h},trigger:function(t){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(sH).forEach(function(u){sH[u].filter(function(u){return u.scope===c&&u.shortcut===t}).forEach(function(t){t&&t.method&&t.method()})})},unbind:function(t){if(void 0===t)Object.keys(sH).forEach(function(t){return delete sH[t]});else if(Array.isArray(t))t.forEach(function(t){t.key&&eachUnbind(t)});else if("object"==typeof t)t.key&&eachUnbind(t);else if("string"==typeof t){for(var c=arguments.length,u=Array(c>1?c-1:0),h=1;h<c;h++)u[h-1]=arguments[h];var f=u[0],g=u[1];"function"==typeof f&&(g=f,f=""),eachUnbind({key:t,scope:f,method:g,splitKey:"+"})}},keyMap:sN,modifier:sz,modifierMap:sB};for(var sq in sY)Object.prototype.hasOwnProperty.call(sY,sq)&&(hotkeys[sq]=sY[sq]);if("undefined"!=typeof window){var sX=window.hotkeys;hotkeys.noConflict=function(t){return t&&window.hotkeys===hotkeys&&(window.hotkeys=sX),hotkeys},window.hotkeys=hotkeys}let sJ=["copy","cut","paste","asset"];function useKeyboardShortcuts(){let t=(0,e8.j)(),c=useReadonly(),u=useActions(),h=useTools(),f=(0,eJ.Hg)("is focused",()=>t.instanceState.isFocused,[t]);(0,U.useEffect)(()=>{if(!f)return;let g=t.getContainer();hotkeys.setScope(t.store.id);let hot=(c,u)=>{hotkeys(c,{element:g,scope:t.store.id},u)},areShortcutsDisabled=()=>t.isMenuOpen||null!==t.editingShapeId||t.crashingError;for(let t of Object.values(u))t.kbd&&(!c||t.readonlyOk)&&(sJ.includes(t.id)||hot(getHotkeysStringFromKbd(t.kbd),c=>{areShortcutsDisabled()||(preventDefault(c),t.onSelect("kbd"))}));for(let c of Object.values(h))c.kbd&&(c.readonlyOk||!t.instanceState.isReadonly)&&(sJ.includes(c.id)||hot(getHotkeysStringFromKbd(c.kbd),t=>{areShortcutsDisabled()||(preventDefault(t),c.onSelect("kbd"))}));return()=>{hotkeys.deleteScope(t.store.id)}},[u,h,c,t,f])}function getHotkeysStringFromKbd(t){return useKeyboardShortcuts_getKeys(t).map(t=>{let c=t.split("");return 1===c.length?c[0]:"!"===c[0]?`shift+${c[1]}`:"?"===c[0]?3===c.length&&"!"===c[1]?`alt+shift+${c[2]}`:`alt+${c[1]}`:"$"===c[0]?"!"===c[1]?`cmd+shift+${c[2]},ctrl+shift+${c[2]}`:"?"===c[1]?`cmd+\u2325+${c[2]},ctrl+alt+${c[2]}`:`cmd+${c[1]},ctrl+${c[1]}`:t}).join(",")}function useKeyboardShortcuts_getKeys(t){"string"!=typeof t&&(t=""),t=t.replace(/\s/g,"");let c=t.split(","),u=c.lastIndexOf("");for(;u>=0;)c[u-1]+=",",c.splice(u,1),u=c.lastIndexOf("");return c}let sQ=U.memo(function({shareZone:t,topZone:c,renderDebugMenuItems:u,children:h,hideUi:f,...g}){return(0,G.jsx)(TldrawUiContextProvider,{...g,children:(0,G.jsx)(s0,{hideUi:f,shareZone:t,topZone:c,renderDebugMenuItems:u,children:h})})}),s0=U.memo(function({children:t,hideUi:c,...u}){return(0,G.jsxs)(G.Fragment,{children:[t,c?null:(0,G.jsx)(s1,{...u})]})}),s1=U.memo(function({shareZone:t,topZone:c,renderDebugMenuItems:u}){let h=(0,e8.j)(),f=useTranslation(),g=useBreakpoint(),b=(0,eJ.Hg)("isReadonlyMode",()=>h.instanceState.isReadonly,[h]),v=(0,eJ.Hg)("focus",()=>h.instanceState.isFocusMode,[h]),x=(0,eJ.Hg)("debug",()=>h.instanceState.isDebugMode,[h]);useKeyboardShortcuts(),useNativeClipboardEvents(),useEditorEvents();let{"toggle-focus-mode":w}=useActions();return(0,G.jsx)($054eb8030ebde76e$export$f5d03d415824e0e,{children:(0,G.jsxs)("div",{className:eX("tlui-layout",{"tlui-layout__mobile":g<5}),"data-breakpoint":g,children:[v?(0,G.jsx)("div",{className:"tlui-layout__top",children:(0,G.jsx)(nU,{className:"tlui-focus-button",title:`${f("focus-mode.toggle-focus-mode")}`,icon:"dot",onClick:()=>w.onSelect("menu")})}):(0,G.jsxs)(G.Fragment,{children:[(0,G.jsxs)("div",{className:"tlui-layout__top",children:[(0,G.jsxs)("div",{className:"tlui-layout__top__left",children:[(0,G.jsx)(a9,{}),(0,G.jsxs)("div",{className:"tlui-helper-buttons",children:[(0,G.jsx)(sn,{}),(0,G.jsx)(BackToContent,{}),(0,G.jsx)(sr,{})]})]}),(0,G.jsx)("div",{className:"tlui-layout__top__center",children:c}),(0,G.jsxs)("div",{className:"tlui-layout__top__right",children:[t,g>=5&&!b&&(0,G.jsx)("div",{className:"tlui-style-panel__wrapper",children:(0,G.jsx)(StylePanel,{})})]})]}),(0,G.jsxs)("div",{className:"tlui-layout__bottom",children:[(0,G.jsxs)("div",{className:"tlui-layout__bottom__main",children:[(0,G.jsx)(st,{}),(0,G.jsx)(sF,{}),g>=4&&(0,G.jsx)(ae,{})]}),x&&(0,G.jsx)(o4,{renderDebugMenuItems:u??null})]})]}),(0,G.jsx)(sD,{}),(0,G.jsx)(o9,{}),(0,G.jsx)(ToastViewport,{}),(0,G.jsx)(FollowingIndicator,{})]})})}),s2="ContextMenu",[s3,s5]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(s2,[rT]),s4=rT(),[s8,s6]=s3(s2),s7=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,disabled:h=!1,...f}=t,g=s6("ContextMenuTrigger",u),b=s4(u),v=(0,U.useRef)({x:0,y:0}),x=(0,U.useRef)({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...v.current})}),w=(0,U.useRef)(0),_=(0,U.useCallback)(()=>window.clearTimeout(w.current),[]),handleOpen=t=>{v.current={x:t.clientX,y:t.clientY},g.onOpenChange(!0)};return(0,U.useEffect)(()=>_,[_]),(0,U.useEffect)(()=>void(h&&_()),[h,_]),(0,U.createElement)(U.Fragment,null,(0,U.createElement)(rF,_extends({},b,{virtualRef:x})),(0,U.createElement)(ee.span,_extends({"data-state":g.open?"open":"closed","data-disabled":h?"":void 0},f,{ref:c,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:h?t.onContextMenu:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onContextMenu,t=>{_(),handleOpen(t),t.preventDefault()}),onPointerDown:h?t.onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerDown,$1b0217ee4a91d156$var$whenTouchOrPen(t=>{_(),w.current=window.setTimeout(()=>handleOpen(t),700)})),onPointerMove:h?t.onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerMove,$1b0217ee4a91d156$var$whenTouchOrPen(_)),onPointerCancel:h?t.onPointerCancel:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerCancel,$1b0217ee4a91d156$var$whenTouchOrPen(_)),onPointerUp:h?t.onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(t.onPointerUp,$1b0217ee4a91d156$var$whenTouchOrPen(_))})))}),s9=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,...h}=t,f=s6("ContextMenuContent",u),g=s4(u),b=(0,U.useRef)(!1);return(0,U.createElement)(rH,_extends({},g,h,{ref:c,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:c=>{var u;null===(u=t.onCloseAutoFocus)||void 0===u||u.call(t,c),!c.defaultPrevented&&b.current&&c.preventDefault(),b.current=!1},onInteractOutside:c=>{var u;null===(u=t.onInteractOutside)||void 0===u||u.call(t,c),c.defaultPrevented||f.modal||(b.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))}),le=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,...h}=t,f=s4(u);return(0,U.createElement)(rK,_extends({},f,h,{ref:c}))}),lt=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,...h}=t,f=s4(u);return(0,U.createElement)(rq,_extends({},f,h,{ref:c}))}),ln=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,...h}=t,f=s4(u);return(0,U.createElement)(rJ,_extends({},f,h,{ref:c}))}),lr=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,...h}=t,f=s4(u);return(0,U.createElement)(r9,_extends({},f,h,{ref:c}))}),li=(0,U.forwardRef)((t,c)=>{let{__scopeContextMenu:u,...h}=t,f=s4(u);return(0,U.createElement)(ie,_extends({},f,h,{ref:c,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}}))});function $1b0217ee4a91d156$var$whenTouchOrPen(t){return c=>"mouse"!==c.pointerType?t(c):void 0}let $1b0217ee4a91d156$export$be92b6f5f03c0fe9=t=>{let{__scopeContextMenu:c,children:u,onOpenChange:h,dir:f,modal:g=!0}=t,[b,v]=(0,U.useState)(!1),x=s4(c),w=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(h),_=(0,U.useCallback)(t=>{v(t),w(t)},[w]);return(0,U.createElement)(s8,{scope:c,open:b,onOpenChange:_,modal:g},(0,U.createElement)($6cc32821e9371a1c$export$be92b6f5f03c0fe9,_extends({},x,{dir:f,open:b,onOpenChange:_,modal:g}),u))},$1b0217ee4a91d156$export$602eac185826482c=t=>{let{__scopeContextMenu:c,...u}=t,h=s4(c);return(0,U.createElement)($6cc32821e9371a1c$export$602eac185826482c,_extends({},h,u))},$1b0217ee4a91d156$export$d7a01e11500dfb6f=t=>{let{__scopeContextMenu:c,children:u,onOpenChange:h,open:f,defaultOpen:g}=t,b=s4(c),[v,x]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:f,defaultProp:g,onChange:h});return(0,U.createElement)($6cc32821e9371a1c$export$d7a01e11500dfb6f,_extends({},b,{open:v,onOpenChange:x}),u)},lo=(0,eJ.j)(function(){let t=(0,e8.j)(),c=useContainer(),u=t.pages,h=t.currentPageId,f=useTranslation(),{addToast:g}=useToasts();return(0,G.jsxs)($1b0217ee4a91d156$export$d7a01e11500dfb6f,{children:[(0,G.jsx)(lr,{dir:"ltr",asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:"context-menu.move-to-page","data-testid":"menu-item.move-to-page",icon:"chevron-right"})}),(0,G.jsx)($1b0217ee4a91d156$export$602eac185826482c,{container:c,dir:"ltr",children:(0,G.jsxs)(li,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:[(0,G.jsx)(le,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.pages",children:u.map(c=>(0,G.jsx)(lt,{disabled:h===c.id,onSelect:()=>{t.mark("move_shapes_to_page"),t.moveShapesToPage(t.selectedShapeIds,c.id);let u=t.getPage(c.id);u&&g({title:"Changed Page",description:`Moved to ${u.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.mark("change-page"),t.setCurrentPage(h)}}]})},asChild:!0,children:(0,G.jsx)(nU,{title:c.name,className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:(0,G.jsx)("span",{children:c.name})})},c.id))},"pages"),(0,G.jsx)(le,{dir:"ltr",className:"tlui-menu__group","data-testid":"menu-item.new-page",children:(0,G.jsx)(lt,{onSelect:()=>{let c=e0.ez.createId(),u=t.selectedShapeIds;t.batch(()=>{t.mark("move_shapes_to_page"),t.createPage({name:"Page",id:c}),t.moveShapesToPage(u,c)})},asChild:!0,children:(0,G.jsx)(nU,{title:f("context.pages.new-page"),className:"tlui-menu__button tlui-context-menu__move-to-page__name",children:f("context.pages.new-page")})},"new-page")},"new-page")]})})]})}),ContextMenu=function({children:t}){let c=(0,e8.j)(),u=useContextMenuSchema(),h=(0,U.useCallback)(t=>{if(t){if(c.instanceState.isCoarsePointer){let{selectedShapes:t,inputs:{currentPagePoint:u}}=c,h=c.getShapesAtPoint(u);if(!c.selectedShapes.length||!h.some(c=>t.includes(c))){let t=h.filter(t=>c.isShapeOrAncestorLocked(t));t.length&&c.select(...t.map(t=>t.id))}}}else{let{onlySelectedShape:t}=c;t&&c.isShapeOrAncestorLocked(t)&&c.setSelectedShapes([])}},[c]),f=useContainer(),[g,b]=useMenuIsOpen("context menu",h),v=useReadonly(),x=0===u.length||v&&u.every(t=>!t.readonlyOk),w=(0,eJ.Hg)("isSelectToolActive",()=>"select"===c.currentToolId,[c]),_=!w||x;return(0,G.jsxs)($1b0217ee4a91d156$export$be92b6f5f03c0fe9,{dir:"ltr",onOpenChange:b,children:[(0,G.jsx)(s7,{onContextMenu:_?preventDefault:void 0,dir:"ltr",disabled:_,children:t}),(0,G.jsx)($1b0217ee4a91d156$export$602eac185826482c,{container:f,children:(0,G.jsx)(ContextMenuContent,{})})]})};function ContextMenuContent(){let t=(0,e8.j)(),c=useTranslation(),u=useContextMenuSchema(),[h,f]=useMenuIsOpen("context menu sub"),g=useReadonly(),b=useBreakpoint(),v=useContainer(),[x,w]=(0,U.useState)(!1);function getContextMenuItem(t,u,h,_){if(g&&!u.readonlyOk)return null;switch(u.type){case"custom":if("MOVE_TO_PAGE_MENU"===u.id)return(0,G.jsx)(lo,{},u.id);break;case"group":return(0,G.jsx)(le,{dir:"ltr",className:eX("tlui-menu__group",{"tlui-menu__group__small":h?.type==="submenu"}),"data-testid":`menu-item.${u.id}`,children:u.children.map(c=>getContextMenuItem(t,c,u,_+1))},u.id);case"submenu":return(0,G.jsxs)($1b0217ee4a91d156$export$d7a01e11500dfb6f,{onOpenChange:f,children:[(0,G.jsx)(lr,{dir:"ltr",disabled:u.disabled,asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button",label:u.label,"data-testid":`menu-item.${u.id}`,icon:"chevron-right"})}),(0,G.jsx)($1b0217ee4a91d156$export$602eac185826482c,{container:v,dir:"ltr",children:(0,G.jsx)(li,{className:"tlui-menu",sideOffset:-4,collisionPadding:4,children:u.children.map(c=>getContextMenuItem(t,c,u,_+1))})})]},u.id);case"item":{if(g&&!u.readonlyOk)return null;let{id:t,checkbox:h,contextMenuLabel:f,label:v,onSelect:k,kbd:E,icon:$}=u.actionItem,T=f??v,I=T?c(T):void 0;if(h)return(0,G.jsxs)(ln,{className:"tlui-button tlui-menu__button tlui-menu__checkbox-item",dir:"ltr",disabled:u.disabled,onSelect:t=>{k("context-menu"),preventDefault(t)},title:I||void 0,checked:u.checked,children:[(0,G.jsx)("div",{className:"tlui-menu__checkbox-item__check",style:{transformOrigin:"75% center",transform:`scale(${u.checked?1:.5})`,opacity:u.checked?1:.5},children:(0,G.jsx)(nz,{small:!0,icon:u.checked?"check":"checkbox-empty"})}),I&&(0,G.jsx)("span",{children:I}),E&&(0,G.jsx)(Kbd,{children:E})]},t);return(0,G.jsx)(lt,{dir:"ltr",asChild:!0,children:(0,G.jsx)(nU,{className:"tlui-menu__button","data-testid":`menu-item.${t}`,kbd:E,label:T,disabled:u.disabled,iconLeft:b<3&&_>2?$:void 0,onClick:()=>{x?w(!1):k("context-menu")}})},t)}}}return(0,G.jsx)($1b0217ee4a91d156$export$602eac185826482c,{dir:"ltr",container:v,children:(0,G.jsx)(s9,{className:"tlui-menu scrollable",alignOffset:-4,collisionPadding:4,onContextMenu:preventDefault,children:u.map(c=>getContextMenuItem(t,c,null,0))})})}var la=((_=la||{})[_.SUCCESS=0]="SUCCESS",_[_.FAILED=1]="FAILED",_[_.WAITING=2]="WAITING",_);let usePreloadFont=(t,c)=>{let[u,h]=(0,U.useState)(2);return(0,U.useEffect)(()=>{let{url:u,style:f="normal",weight:g="500",display:b,featureSettings:v,stretch:x,unicodeRange:w,variant:_}=c,k=!1;h(2);let E=new FontFace(t,`url(${u})`,{style:f,weight:g,display:b,featureSettings:v,stretch:x,unicodeRange:w,variant:_});return E.load().then(()=>{k||(document.fonts.add(E),h(0))}).catch(t=>{k||(console.error(t),h(1))}),E.$$_url=u,E.$$_fontface=`
@font-face {
	font-family: ${E.family};
	font-stretch: ${E.stretch};
	font-weight: ${E.weight};
	font-style: ${E.style};
	src: url("${u}") format("woff2")
}`,()=>{document.fonts.delete(E),k=!0}},[t,c]),u};function getTypefaces(t){return{draw:{url:t.fonts.draw},serif:{url:t.fonts.serif},sansSerif:{url:t.fonts.sansSerif},monospace:{url:t.fonts.monospace}}}function usePreloadAssets(t){let c=(0,U.useMemo)(()=>getTypefaces(t),[t]),u=[usePreloadFont("tldraw_draw",c.draw),usePreloadFont("tldraw_serif",c.serif),usePreloadFont("tldraw_sans",c.sansSerif),usePreloadFont("tldraw_mono",c.monospace)];return{error:u.some(t=>1===t),done:!u.some(t=>2===t)}}function Tldraw(t){let{children:c,maxImageDimension:u,maxAssetSize:h,acceptedImageMimeTypes:f,acceptedVideoMimeTypes:g,onMount:b,...v}=t,x={initialState:"select",...v,components:(0,U.useMemo)(()=>({Scribble:TldrawScribble,CollaboratorScribble:TldrawScribble,SelectionForeground:iS,SelectionBackground:TldrawSelectionBackground,Handles:TldrawHandles,HoveredShapeIndicator:TldrawHoveredShapeIndicator,...v.components}),[v.components]),shapeUtils:(0,U.useMemo)(()=>[...i3,...v.shapeUtils??[]],[v.shapeUtils]),tools:(0,U.useMemo)(()=>[...i9,...iO,...v.tools??[]],[v.tools])},w=useDefaultEditorAssetsWithOverrides(v.assetUrls),{done:_,error:k}=usePreloadAssets(w);return k?(0,G.jsx)(ErrorScreen,{children:"Could not load assets. Please refresh the page."}):_?(0,G.jsx)(ns,{...x,children:(0,G.jsxs)(sQ,{...x,children:[(0,G.jsx)(ContextMenu,{children:(0,G.jsx)(Canvas,{})}),(0,G.jsx)(InsideOfEditorContext,{maxImageDimension:u,maxAssetSize:h,acceptedImageMimeTypes:f,acceptedVideoMimeTypes:g,onMount:b}),c]})}):(0,G.jsx)(LoadingScreen,{children:"Loading assets..."})}function InsideOfEditorContext({maxImageDimension:t=1e3,maxAssetSize:c=10485760,acceptedImageMimeTypes:u=["image/jpeg","image/png","image/gif","image/svg+xml"],acceptedVideoMimeTypes:h=["video/mp4","video/quicktime"],onMount:f}){let g=(0,e8.j)(),b=Tldraw_useEvent(g=>{let b=[];return b.push(...registerDefaultSideEffects(g)),registerDefaultExternalContentHandlers(g,{maxImageDimension:t,maxAssetSize:c,acceptedImageMimeTypes:u,acceptedVideoMimeTypes:h}),b.push(f?.(g)),()=>{b.forEach(t=>t?.())}});return(0,U.useLayoutEffect)(()=>{if(g)return b?.(g)},[g,b]),null}function Tldraw_useEvent(t){let c=(0,U.useRef)();return(0,U.useLayoutEffect)(()=>{c.current=t}),(0,U.useDebugValue)(t),(0,U.useCallback)((...t)=>{let u=c.current;return(0,e1.hu)(u,"fn does not exist"),u(...t)},[])}function OfflineIndicator(){let t=useTranslation(),c=(0,U.useRef)(null);return(0,G.jsxs)("div",{className:eX("tlui-offline-indicator"),ref:c,children:[t("status.offline"),(0,G.jsx)(nz,{"aria-label":"offline",icon:"status-offline",small:!0})]})}function buildFromV1Document(t,c){t.batch(()=>{c=migrate(c,15.5),t.cancel().cancel().cancel().cancel();let u=t.pages[0].id;for(let c of(t.setCurrentPage(u),t.pages.slice(1)))t.deletePage(c.id);t.selectAll(),t.deleteShapes(t.selectedShapeIds);let h=new Map;Object.values(c.assets??{}).forEach(c=>{switch(c.type){case"image":{let u=e0.Yk.createId();h.set(c.id,u);let f={id:u,typeName:"asset",type:"image",props:{w:coerceDimension(c.size[0]),h:coerceDimension(c.size[1]),name:c.fileName??"Untitled",isAnimated:!1,mimeType:null,src:c.src},meta:{}};t.createAssets([f]),tryMigrateAsset(t,f);break}case"video":{let u=e0.Yk.createId();h.set(c.id,u),t.createAssets([{id:u,typeName:"asset",type:"video",props:{w:coerceDimension(c.size[0]),h:coerceDimension(c.size[1]),name:c.fileName??"Untitled",isAnimated:!0,mimeType:null,src:c.src},meta:{}}])}}});let f=new Map;Object.values(c.pages??{}).sort((t,c)=>(t.childIndex??1)<(c.childIndex??1)?-1:1).forEach((c,u)=>{if(0===u)f.set(c.id,t.currentPageId);else{let u=e0.ez.createId();f.set(c.id,u),t.createPage({name:c.name??"Page",id:u})}}),Object.values(c.pages??{}).sort((t,c)=>(t.childIndex??1)<(c.childIndex??1)?-1:1).forEach(c=>{t.setCurrentPage(f.get(c.id));let u=new Map,g=new Map,b=Object.values(c.shapes??{}).sort((t,c)=>t.childIndex<c.childIndex?-1:1).slice(0,to.kx);function decideNotToCreateShape(t){u.delete(t.id);let c=g.has(t.parentId);if(c){let c=g.get(t.parentId).filter(c=>c!==t.id);g.set(t.parentId,c)}}b.forEach(t=>{if("group"!==t.type)return;let c=(0,e0.F1)();u.set(t.id,c),g.set(t.id,[])}),b.forEach(b=>{if("group"===b.type)return;let v=(0,e0.F1)();u.set(b.id,v),b.parentId!==c.id&&(g.has(b.parentId)?g.get(b.parentId).push(b.id):console.warn("parent does not exist",b));let x=f.get(c.id),w={id:v,parentId:x,x:coerceNumber(b.point[0]),y:coerceNumber(b.point[1]),rotation:0,isLocked:!!b.isLocked};switch(b.type){case"sticky":t.createShapes([{...w,type:"note",props:{text:b.text??"",color:getV2Color(b.style.color),size:getV2Size(b.style.size),font:getV2Font(b.style.font),align:getV2Align(b.style.textAlign)}}]);break;case"rectangle":{t.createShapes([{...w,type:"geo",props:{geo:"rectangle",w:coerceDimension(b.size[0]),h:coerceDimension(b.size[1]),text:b.label??"",fill:getV2Fill(b.style.isFilled,b.style.color),labelColor:getV2Color(b.style.color),color:getV2Color(b.style.color),size:getV2Size(b.style.size),font:getV2Font(b.style.font),dash:getV2Dash(b.style.dash),align:"middle"}}]);let c=t.getShapePageBounds(w.id);if(t.updateShapes([{id:w.id,type:"geo",props:{text:b.label??""}}]),c.width===c.height){let c=t.getShape(w.id),{growY:u}=c.props,h=coerceDimension(c.props.w),f=coerceDimension(c.props.h),g=h+u/2,b=f+u/2;t.updateShapes([{id:w.id,type:"geo",x:coerceNumber(c.x)-(g-h)/2,y:coerceNumber(c.y)-(b-f)/2,props:{w:g,h:b}}])}break}case"triangle":{t.createShapes([{...w,type:"geo",props:{geo:"triangle",w:coerceDimension(b.size[0]),h:coerceDimension(b.size[1]),fill:getV2Fill(b.style.isFilled,b.style.color),labelColor:getV2Color(b.style.color),color:getV2Color(b.style.color),size:getV2Size(b.style.size),font:getV2Font(b.style.font),dash:getV2Dash(b.style.dash),align:"middle"}}]);let c=t.getShapePageBounds(w.id);if(t.updateShapes([{id:w.id,type:"geo",props:{text:b.label??""}}]),c.width===c.height){let c=t.getShape(w.id),{growY:u}=c.props,h=coerceDimension(c.props.w),f=coerceDimension(c.props.h),g=h+u/2,b=f+u/2;t.updateShapes([{id:w.id,type:"geo",x:coerceNumber(c.x)-(g-h)/2,y:coerceNumber(c.y)-(b-f)/2,props:{w:g,h:b}}])}break}case"ellipse":{t.createShapes([{...w,type:"geo",props:{geo:"ellipse",w:2*coerceDimension(b.radius[0]),h:2*coerceDimension(b.radius[1]),fill:getV2Fill(b.style.isFilled,b.style.color),labelColor:getV2Color(b.style.color),color:getV2Color(b.style.color),size:getV2Size(b.style.size),font:getV2Font(b.style.font),dash:getV2Dash(b.style.dash),align:"middle"}}]);let c=t.getShapePageBounds(w.id);if(t.updateShapes([{id:w.id,type:"geo",props:{text:b.label??""}}]),c.width===c.height){let c=t.getShape(w.id),{growY:u}=c.props,h=coerceDimension(c.props.w),f=coerceDimension(c.props.h),g=h+u/2,b=f+u/2;t.updateShapes([{id:w.id,type:"geo",x:coerceNumber(c.x)-(g-h)/2,y:coerceNumber(c.y)-(b-f)/2,props:{w:g,h:b}}])}break}case"draw":if(0===b.points.length){decideNotToCreateShape(b);break}t.createShapes([{...w,type:"draw",props:{fill:getV2Fill(b.style.isFilled,b.style.color),color:getV2Color(b.style.color),size:getV2Size(b.style.size),dash:getV2Dash(b.style.dash),isPen:!1,isComplete:b.isComplete,segments:[{type:"free",points:b.points.map(getV2Point)}]}}]);break;case"arrow":{let c=coerceNumber(b.bend),u=getV2Point(b.handles.start.point),h=getV2Point(b.handles.end.point),f=tn.G.Dist(u,h);t.createShapes([{...w,type:"arrow",props:{text:b.label??"",color:getV2Color(b.style.color),labelColor:getV2Color(b.style.color),size:getV2Size(b.style.size),font:getV2Font(b.style.font),dash:getV2Dash(b.style.dash),arrowheadStart:getV2Arrowhead(b.decorations?.start),arrowheadEnd:getV2Arrowhead(b.decorations?.end),start:{type:"point",x:coerceNumber(b.handles.start.point[0]),y:coerceNumber(b.handles.start.point[1])},end:{type:"point",x:coerceNumber(b.handles.end.point[0]),y:coerceNumber(b.handles.end.point[1])},bend:-(f*c)/2}}]);break}case"text":t.createShapes([{...w,type:"text",props:{text:b.text??" ",color:getV2Color(b.style.color),size:getV2TextSize(b.style.size),font:getV2Font(b.style.font),align:getV2Align(b.style.textAlign),scale:b.style.scale??1}}]);break;case"image":{let c=h.get(b.assetId);if(!c){console.warn("Could not find asset id",b.assetId);return}t.createShapes([{...w,type:"image",props:{w:coerceDimension(b.size[0]),h:coerceDimension(b.size[1]),assetId:c}}]);break}case"video":{let c=h.get(b.assetId);if(!c){console.warn("Could not find asset id",b.assetId);return}t.createShapes([{...w,type:"video",props:{w:coerceDimension(b.size[0]),h:coerceDimension(b.size[1]),assetId:c}}])}}let _=coerceNumber(b.rotation);0!==_&&(t.select(v),t.rotateShapesBy([v],_))}),g.forEach((h,f)=>{let g=h.map(t=>u.get(t)),b=u.get(f);t.groupShapes(g,b);let v=c.shapes[f],x=coerceNumber(v.rotation);0!==x&&(t.select(b),t.rotateShapesBy([b],x))}),b.forEach(h=>{if("arrow"!==h.type)return;let f=u.get(h.id),g=t.getShapeUtil("arrow");for(let b of(t.inputs.ctrlKey=!1,["start","end"])){let v=h.handles[b].bindingId;if(v){let h=c.bindings[v];if(!h)continue;let x=u.get(h.toId),w=t.getShape(x);if(!w)continue;if(x){let c=t.getShapePageBounds(x),u=t.getShape(f),v=(0,tt.uZ)((coerceNumber(h.point[0])+.5)/2,.2,.8),w=(0,tt.uZ)((coerceNumber(h.point[1])+.5)/2,.2,.8),_=t.getPointInShapeSpace(u,{x:c.minX+c.width*v,y:c.minY+c.height*w}),k=t.getShapeHandles(u),E=g.onHandleChange(u,{handle:{...k.find(t=>t.id===b),x:_.x,y:_.y},isPrecise:.5!==_.x||.5!==_.y});if(E){if(E.props?.[b]){let t=E.props?.[b];"binding"===t.type&&(t.isExact=0===h.distance,t.boundShapeId!==x&&(console.warn("Hit the wrong shape!"),t.boundShapeId=x,t.normalizedAnchor={x:.5,y:.5}))}t.updateShapes([E])}}}}})}),t.setCurrentPage(u),t.history.clear(),t.selectNone(),t.updateViewportScreenBounds();let g=t.currentPageBounds;g&&t.zoomToBounds(g,1)})}function coerceNumber(t){return"number"!=typeof t||Number.isNaN(t)||!Number.isFinite(t)?0:t}function coerceDimension(t){let c=coerceNumber(t);return c<=0?1:c}async function tryMigrateAsset(t,c){try{if("bookmark"===c.type||!c.props.src)return;let u=await fetch(c.props.src);if(!u.ok)return;let h=new File([await u.blob()],c.props.name,{type:u.headers.get("content-type")??c.props.mimeType??void 0}),f=await t.getAssetForExternalContent({type:"file",file:h});if(!f)throw Error("Could not get asset for external content");if("bookmark"===f.type)return;t.updateAssets([{id:c.id,type:c.type,props:{...f.props,name:c.props.name}}])}catch(t){}}function migrate(t,c){let{version:u=0}=t;t.assets||(t.assets={});let h=new Set;return Object.values(t.pages).forEach(t=>Object.values(t.shapes).forEach(c=>{let{parentId:u,children:f,assetId:g}=c;g&&h.add(g),u===t.id||t.shapes[u]||(console.warn("Encountered a shape with a missing parent!"),c.parentId=t.id),"group"===c.type&&f&&f.forEach(u=>{t.shapes[u]||(console.warn("Encountered a parent with a missing child!",c.id,u),f?.splice(f.indexOf(u),1))})})),Object.keys(t.assets).forEach(c=>{h.has(c)||delete t.assets[c]}),u!==c&&(u<14&&Object.values(t.pages).forEach(t=>{Object.values(t.shapes).filter(t=>"text"===t.type).forEach(t=>{void 0===t.style.font&&t.style.font})}),u<=13&&Object.values(t.pages).forEach(t=>{Object.values(t.bindings).forEach(t=>{Object.assign(t,t.meta)}),Object.values(t.shapes).forEach(t=>{Object.entries(t.style).forEach(([c,u])=>{"string"==typeof u&&(t.style[c]=u.toLowerCase())}),"arrow"===t.type&&t.decorations&&Object.entries(t.decorations).forEach(([c,u])=>{"Arrow"===u&&(t.decorations={...t.decorations,[c]:"arrow"})})})}),u<=13.1&&null==t.name&&(t.name="New Document"),u<15&&null==t.assets&&(t.assets={}),Object.values(t.pages).forEach(t=>{Object.values(t.shapes).forEach(t=>{u<15.2&&("image"===t.type||"video"===t.type)&&null==t.style.isFilled&&(t.style.isFilled=!0),u<15.3&&("rectangle"===t.type||"triangle"===t.type||"ellipse"===t.type||"arrow"===t.type)&&("text"in t&&"string"==typeof t.text&&(t.label=t.text),t.label||(t.label=""),t.labelPoint||(t.labelPoint=[.5,.5]))})})),Object.values(t.pageStates).forEach(c=>{c.selectedIds=c.selectedIds.filter(u=>void 0!==t.pages[c.id].shapes[u]),c.bindingId=void 0,c.editingId=void 0,c.hoveredId=void 0,c.pointedId=void 0}),t.version=c,t}var ls=((k=ls||{}).Sticky="sticky",k.Ellipse="ellipse",k.Rectangle="rectangle",k.Triangle="triangle",k.Draw="draw",k.Arrow="arrow",k.Text="text",k.Group="group",k.Image="image",k.Video="video",k),ll=((E=ll||{}).White="white",E.LightGray="lightGray",E.Gray="gray",E.Black="black",E.Green="green",E.Cyan="cyan",E.Blue="blue",E.Indigo="indigo",E.Violet="violet",E.Red="red",E.Orange="orange",E.Yellow="yellow",E),lc=(($=lc||{}).Small="small",$.Medium="medium",$.Large="large",$),lu=((T=lu||{}).Draw="draw",T.Solid="solid",T.Dashed="dashed",T.Dotted="dotted",T),ld=((I=ld||{}).Start="start",I.Middle="middle",I.End="end",I.Justify="justify",I),lp=((M=lp||{}).Script="script",M.Sans="sans",M.Serif="serif",M.Mono="mono",M),lh=((j=lh||{}).Arrow="arrow",j),lf=((D=lf||{}).Image="image",D.Video="video",D);let lg={white:"black",black:"black",lightGray:"grey",gray:"grey",green:"light-green",cyan:"green",blue:"light-blue",indigo:"blue",orange:"orange",yellow:"yellow",red:"red",violet:"light-violet"},lm={mono:"mono",sans:"sans",script:"draw",serif:"serif"},lb={start:"start",middle:"middle",end:"end",justify:"start"},ly={small:"s",medium:"l",large:"xl"},lv={small:"m",medium:"l",large:"xl"},lx={solid:"solid",dashed:"dashed",dotted:"dotted",draw:"draw"};function getV2Color(t){return t?lg[t]??"black":"black"}function getV2Font(t){return t?lm[t]??"draw":"draw"}function getV2Align(t){return t?lb[t]??"middle":"middle"}function getV2TextSize(t){return t?ly[t]??"m":"m"}function getV2Size(t){return t?lv[t]??"l":"l"}function getV2Dash(t){return t?lx[t]??"draw":"draw"}function getV2Point(t){return{x:coerceNumber(t[0]),y:coerceNumber(t[1]),z:null==t[2]?.5:coerceNumber(t[2])}}function getV2Arrowhead(t){return"arrow"===t?"arrow":"none"}function getV2Fill(t,c){return t?"black"===c||"white"===c?"semi":"solid":"none"}let lw=".tldr",lS=e2.T.object({tldrawFileFormatVersion:e2.T.nonZeroInteger,schema:e2.T.object({schemaVersion:e2.T.positiveInteger,storeVersion:e2.T.positiveInteger,recordVersions:e2.T.dict(e2.T.string,e2.T.object({version:e2.T.positiveInteger,subTypeVersions:e2.T.dict(e2.T.string,e2.T.positiveInteger).optional(),subTypeKey:e2.T.string.optional()}))}),records:e2.T.arrayOf(e2.T.object({id:e2.T.string,typeName:e2.T.string}).allowUnknownProperties())});function isV1File(t){try{if(t.document?.version)return!0;return!1}catch(t){return!1}}function parseTldrawJsonFile({json:t,schema:c}){let u,h;try{u=lS.validate(JSON.parse(t))}catch(c){try{if(u=JSON.parse(t),isV1File(u))return e1.x4.err({type:"v1File",data:u})}catch(t){}return e1.x4.err({type:"notATldrawFile",cause:c})}if(u.tldrawFileFormatVersion>1)return e1.x4.err({type:"fileFormatVersionTooNew",version:u.tldrawFileFormatVersion});try{let t=Object.fromEntries(u.records.map(t=>[t.id,t]));h=c.migrateStoreSnapshot({store:t,schema:u.schema})}catch(t){return e1.x4.err({type:"invalidRecords",cause:t})}if("error"===h.type)return e1.x4.err({type:"migrationFailed",reason:h.reason});try{return e1.x4.ok(createTLStore({initialData:h.value,schema:c}))}catch(t){return e1.x4.err({type:"invalidRecords",cause:t})}}async function serializeTldrawJson(t){let c=[],u=new Set,h=[];for(let f of t.allRecords())switch(f.typeName){case"asset":if("bookmark"!==f.type&&f.props.src&&!f.props.src.startsWith("data:")){let t;try{t=await e1.P6.fileToBase64(await (await fetch(f.props.src)).blob())}catch{t=f.props.src}h.push({...f,props:{...f.props,src:t}})}else h.push(f);break;case"shape":"assetId"in f.props&&u.add(f.props.assetId),c.push(f);break;default:c.push(f)}let f=c.concat(h.filter(t=>u.has(t.id)));return JSON.stringify({tldrawFileFormatVersion:1,schema:t.schema.serialize(),records:f})}async function serializeTldrawJsonBlob(t){return new Blob([await serializeTldrawJson(t)],{type:"application/vnd.tldraw+json"})}async function parseAndLoadDocument(t,c,u,h,f,g){let b=parseTldrawJsonFile({schema:t.store.schema,json:c});if(!b.ok){let c;switch(b.error.type){case"notATldrawFile":t.annotateError(b.error.cause,{origin:"file-system.open.parse",willCrashApp:!1,tags:{parseErrorType:b.error.type}}),reportError(b.error.cause),c=u("file-system.file-open-error.not-a-tldraw-file");break;case"fileFormatVersionTooNew":c=u("file-system.file-open-error.file-format-version-too-new");break;case"migrationFailed":c=u(b.error.reason===eQ.qx.TargetVersionTooNew?"file-system.file-open-error.file-format-version-too-new":"file-system.file-open-error.generic-corrupted-file");break;case"invalidRecords":t.annotateError(b.error.cause,{origin:"file-system.open.parse",willCrashApp:!1,tags:{parseErrorType:b.error.type}}),reportError(b.error.cause),c=u("file-system.file-open-error.generic-corrupted-file");break;case"v1File":buildFromV1Document(t,b.error.data.document),f?.();return;default:(0,e1.iP)(b.error,"type")}h({title:u("file-system.file-open-error.title"),description:c});return}(0,eJ.ay)(()=>{t.store.clear();let[c,u]=(0,e1.uK)(b.value.allRecords(),t=>"shape"===t.typeName);t.store.put(u,"initialize"),t.store.ensureStoreIsUsable(),t.store.put(c,"initialize"),t.history.clear(),t.updateViewportScreenBounds(),t.updateRenderingBounds();let h=t.currentPageBounds;h&&t.zoomToBounds(h,1)}),g&&t.user.updateUserPreferences({isDarkMode:!0})}},6579:function(t,c,u){"use strict";u.d(c,{ZJ:function(){return eW},TA:function(){return eV},Yk:function(){return eI},AN:function(){return _},R_:function(){return eR},qi:function(){return eF},ci:function(){return eN},pp:function(){return ez},p6:function(){return eG},Y8:function(){return eB},Xo:function(){return ti},ST:function(){return eH},HO:function(){return to},_A:function(){return eb},Lu:function(){return e6},$I:function(){return EnumStyleProp},Zu:function(){return ta},iS:function(){return er},AM:function(){return ep},a2:function(){return tj},t8:function(){return tx},ez:function(){return K},zh:function(){return es},fV:function(){return StyleProp},G4:function(){return ey},PQ:function(){return X},LV:function(){return el},z:function(){return j},Vm:function(){return eX},si:function(){return eZ},_3:function(){return f},TD:function(){return eT},$A:function(){return eE},h9:function(){return e0},qU:function(){return eJ},tF:function(){return E},MN:function(){return D},tL:function(){return createAssetValidator},GP:function(){return createPresenceStateDerivation},F1:function(){return createShapeId},JY:function(){return createShapeValidator},HH:function(){return createTLSchema},_l:function(){return e5},wu:function(){return e2},BF:function(){return tt},gB:function(){return e7},DW:function(){return e9},gR:function(){return tr},k7:function(){return tn},P3:function(){return tc},eG:function(){return ts},y6:function(){return getDefaultColorTheme},Bz:function(){return getDefaultTranslationLocale},DR:function(){return getShapePropKeysByStyle},c4:function(){return td},A7:function(){return tu},J1:function(){return th},VW:function(){return tp},yd:function(){return idValidator},y5:function(){return tb},Fc:function(){return tg},r5:function(){return isPageId},VV:function(){return isShape},YT:function(){return isShapeId},FH:function(){return t_},BG:function(){return tw},C_:function(){return tP},m0:function(){return tk},jm:function(){return M},CF:function(){return B},Mv:function(){return J},cL:function(){return eM},gw:function(){return L},u5:function(){return Q},pL:function(){return tT},XB:function(){return tE},tn:function(){return k},lY:function(){return tM},p$:function(){return tI}});var h=u(5958);function idValidator(t){return h.T.string.refine(c=>{if(!c.startsWith(`${t}:`))throw Error(`${t} ID must start with "${t}:"`);return c})}let f=idValidator("asset");function createAssetValidator(t,c){return h.T.object({id:f,typeName:h.T.literal("asset"),type:h.T.literal(t),props:c,meta:h.T.jsonValue})}var g=u(9957),b=u(932);let v=h.T.model("camera",h.T.object({typeName:h.T.literal("camera"),id:idValidator("camera"),x:h.T.number,y:h.T.number,z:h.T.number,meta:h.T.jsonValue})),x={AddMeta:1},w=(0,b.zn)({currentVersion:x.AddMeta,migrators:{[x.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})}}}),_=(0,b.ju)("camera",{validator:v,migrations:w,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),k=h.T.object({x:h.T.number,y:h.T.number,z:h.T.number.optional()}),E=h.T.object({x:h.T.number,y:h.T.number,w:h.T.number,h:h.T.number}),$=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),T=h.T.setEnum($),I=h.T.object({type:T,rotation:h.T.number}),M=h.T.number.check(t=>{if(t<0||t>1)throw new h.T.ValidationError("Opacity must be between 0 and 1")}),j=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),D=h.T.setEnum(j),F=new Set(["starting","paused","active","stopping"]),L=h.T.object({points:h.T.arrayOf(k),size:h.T.positiveNumber,color:D,opacity:h.T.number,state:h.T.setEnum(F),delay:h.T.number}),B=idValidator("page"),G=h.T.model("page",h.T.object({typeName:h.T.literal("page"),id:B,name:h.T.string,index:h.T.string,meta:h.T.jsonValue})),U={AddMeta:1},V=(0,b.zn)({currentVersion:U.AddMeta,migrators:{[U.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})}}}),K=(0,b.ju)("page",{validator:G,migrations:V,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function isPageId(t){return K.isId(t)}function createInstanceRecordType(t){let c={};for(let[u,f]of t)c[u]=h.T.optional(f);let u=h.T.model("instance",h.T.object({typeName:h.T.literal("instance"),id:idValidator("instance"),currentPageId:B,followingUserId:h.T.string.nullable(),brush:E.nullable(),opacityForNextShape:M,stylesForNextShape:h.T.object(c),cursor:I,scribble:L.nullable(),isFocusMode:h.T.boolean,isDebugMode:h.T.boolean,isToolLocked:h.T.boolean,exportBackground:h.T.boolean,screenBounds:E,zoomBrush:E.nullable(),isPenMode:h.T.boolean,isGridMode:h.T.boolean,chatMessage:h.T.string,isChatting:h.T.boolean,highlightedUserIds:h.T.arrayOf(h.T.string),canMoveCamera:h.T.boolean,isFocused:h.T.boolean,devicePixelRatio:h.T.number,isCoarsePointer:h.T.boolean,isHoveringCanvas:h.T.boolean.nullable(),openMenus:h.T.arrayOf(h.T.string),isChangingStyle:h.T.boolean,isReadonly:h.T.boolean,meta:h.T.jsonValue}));return(0,b.ju)("instance",{migrations:Y,validator:u,scope:"session"}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribble:null,cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],canMoveCamera:!0,isFocused:!1,devicePixelRatio:"undefined"==typeof window?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{}}))}idValidator("instance");let Z={AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21},Y=(0,b.zn)({currentVersion:Z.AddHoveringCanvas,migrators:{[Z.AddTransparentExportBgs]:{up:t=>({...t,exportBackground:!0}),down:({exportBackground:t,...c})=>c},[Z.RemoveDialog]:{up:({dialog:t,...c})=>c,down:t=>({...t,dialog:null})},[Z.AddToolLockMode]:{up:t=>({...t,isToolLocked:!1}),down:({isToolLocked:t,...c})=>c},[Z.RemoveExtraPropsForNextShape]:{up:({propsForNextShape:t,...c})=>({...c,propsForNextShape:Object.fromEntries(Object.entries(t).filter(([t])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(t)))}),down:t=>t},[Z.AddLabelColor]:{up:({propsForNextShape:t,...c})=>({...c,propsForNextShape:{...t,labelColor:"black"}}),down:t=>{let{labelColor:c,...u}=t.propsForNextShape;return{...t,propsForNextShape:{...u}}}},[Z.AddFollowingUserId]:{up:t=>({...t,followingUserId:null}),down:({followingUserId:t,...c})=>c},[Z.RemoveAlignJustify]:{up:t=>{let c=t.propsForNextShape.align;return"justify"===c&&(c="start"),{...t,propsForNextShape:{...t.propsForNextShape,align:c}}},down:t=>({...t})},[Z.AddZoom]:{up:t=>({...t,zoomBrush:null}),down:({zoomBrush:t,...c})=>c},[Z.AddVerticalAlign]:{up:t=>({...t,propsForNextShape:{...t.propsForNextShape,verticalAlign:"middle"}}),down:t=>{let{verticalAlign:c,...u}=t.propsForNextShape;return{...t,propsForNextShape:u}}},[Z.AddScribbleDelay]:{up:t=>null!==t.scribble?{...t,scribble:{...t.scribble,delay:0}}:{...t},down:t=>{if(null!==t.scribble){let{delay:c,...u}=t.scribble;return{...t,scribble:u}}return{...t}}},[Z.RemoveUserId]:{up:({userId:t,...c})=>c,down:t=>({...t,userId:"user:none"})},[Z.AddIsPenModeAndIsGridMode]:{up:t=>({...t,isPenMode:!1,isGridMode:!1}),down:({isPenMode:t,isGridMode:c,...u})=>u},[Z.HoistOpacity]:{up:({propsForNextShape:{opacity:t,...c},...u})=>({...u,opacityForNextShape:Number(t??"1"),propsForNextShape:c}),down:({opacityForNextShape:t,...c})=>({...c,propsForNextShape:{...c.propsForNextShape,opacity:t<.175?"0.1":t<.375?"0.25":t<.625?"0.5":t<.875?"0.75":"1"}})},[Z.AddChat]:{up:t=>({...t,chatMessage:"",isChatting:!1}),down:({chatMessage:t,isChatting:c,...u})=>u},[Z.AddHighlightedUserIds]:{up:t=>({...t,highlightedUserIds:[]}),down:({highlightedUserIds:t,...c})=>c},[Z.ReplacePropsForNextShapeWithStylesForNextShape]:{up:({propsForNextShape:t,...c})=>({...c,stylesForNextShape:{}}),down:({stylesForNextShape:t,...c})=>({...c,propsForNextShape:{color:"black",labelColor:"black",dash:"draw",fill:"none",size:"m",icon:"file",font:"draw",align:"middle",verticalAlign:"middle",geo:"rectangle",arrowheadStart:"none",arrowheadEnd:"arrow",spline:"line"}})},[Z.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})},[Z.RemoveCursorColor]:{up:t=>{let{color:c,...u}=t.cursor;return{...t,cursor:u}},down:t=>({...t,cursor:{...t.cursor,color:"black"}})},[Z.AddLonelyProperties]:{up:t=>({...t,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1}),down:({canMoveCamera:t,isFocused:c,devicePixelRatio:u,isCoarsePointer:h,openMenus:f,isChangingStyle:g,isReadOnly:b,...v})=>({...v})},[Z.ReadOnlyReadonly]:{up:({isReadOnly:t,...c})=>({...c,isReadonly:t}),down:({isReadonly:t,...c})=>({...c,isReadOnly:t})},[Z.AddHoveringCanvas]:{up:t=>({...t,isHoveringCanvas:null}),down:({isHoveringCanvas:t,...c})=>({...c})}}}),X="instance:instance",J=h.T.string.refine(t=>{if(!t.startsWith("page:")&&!t.startsWith("shape:"))throw Error('Parent ID must start with "page:" or "shape:"');return t}),Q=idValidator("shape");function createShapeValidator(t,c,u){return h.T.object({id:Q,typeName:h.T.literal("shape"),x:h.T.number,y:h.T.number,rotation:h.T.number,index:h.T.string,parentId:J,type:h.T.literal(t),isLocked:h.T.boolean,opacity:M,props:c?h.T.object(c):h.T.jsonValue,meta:u?h.T.object(u):h.T.jsonValue})}let ee=h.T.model("instance_page_state",h.T.object({typeName:h.T.literal("instance_page_state"),id:idValidator("instance_page_state"),pageId:B,selectedShapeIds:h.T.arrayOf(Q),hintingShapeIds:h.T.arrayOf(Q),erasingShapeIds:h.T.arrayOf(Q),hoveredShapeId:Q.nullable(),editingShapeId:Q.nullable(),croppingShapeId:Q.nullable(),focusedGroupId:Q.nullable(),meta:h.T.jsonValue})),et={AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5},en=(0,b.zn)({currentVersion:et.RenamePropertiesAgain,migrators:{[et.AddCroppingId]:{up:t=>({...t,croppingShapeId:null}),down:({croppingShapeId:t,...c})=>c},[et.RemoveInstanceIdAndCameraId]:{up:({instanceId:t,cameraId:c,...u})=>u,down:t=>({...t,instanceId:X,cameraId:_.createId("void")})},[et.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})},[et.RenameProperties]:{up:t=>{let{selectedShapeIds:c,hintingShapeIds:u,erasingShapeIds:h,hoveredShapeId:f,editingShapeId:g,croppingShapeId:b,focusedGroupId:v,...x}=t;return{selectedShapeIds:c,hintingShapeIds:u,erasingShapeIds:h,hoveredShapeId:f,editingShapeId:g,croppingShapeId:b,focusedGroupId:v,...x}},down:t=>{let{selectedShapeIds:c,hintingShapeIds:u,erasingShapeIds:h,hoveredShapeId:f,editingShapeId:g,croppingShapeId:b,focusedGroupId:v,...x}=t;return{selectedShapeIds:c,hintingShapeIds:u,erasingShapeIds:h,hoveredShapeId:f,editingShapeId:g,croppingShapeId:b,focusedGroupId:v,...x}}},[et.RenamePropertiesAgain]:{up:t=>{let{selectedIds:c,hintingIds:u,erasingIds:h,hoveredId:f,editingId:g,croppingId:b,focusLayerId:v,...x}=t;return{...x,selectedShapeIds:c,hintingShapeIds:u,erasingShapeIds:h,hoveredShapeId:f,editingShapeId:g,croppingShapeId:b,focusedGroupId:v}},down:t=>{let{selectedShapeIds:c,hintingShapeIds:u,erasingShapeIds:h,hoveredShapeId:f,editingShapeId:g,croppingShapeId:b,focusedGroupId:v,...x}=t;return{...x,selectedIds:c,hintingIds:u,erasingIds:h,hoveredId:f,editingId:g,croppingId:b,focusLayerId:v}}}}}),er=(0,b.ju)("instance_page_state",{migrations:en,validator:ee,scope:"session"}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),ei=h.T.model("pointer",h.T.object({typeName:h.T.literal("pointer"),id:idValidator("pointer"),x:h.T.number,y:h.T.number,lastActivityTimestamp:h.T.number,meta:h.T.jsonValue})),eo={AddMeta:1},ea=(0,b.zn)({currentVersion:eo.AddMeta,migrators:{[eo.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})}}}),es=(0,b.ju)("pointer",{validator:ei,migrations:ea,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),el=es.createId("pointer"),ec=h.T.model("instance_presence",h.T.object({typeName:h.T.literal("instance_presence"),id:idValidator("instance_presence"),userId:h.T.string,userName:h.T.string,lastActivityTimestamp:h.T.number,followingUserId:h.T.string.nullable(),cursor:h.T.object({x:h.T.number,y:h.T.number,type:T,rotation:h.T.number}),color:h.T.string,camera:h.T.object({x:h.T.number,y:h.T.number,z:h.T.number}),screenBounds:E,selectedShapeIds:h.T.arrayOf(idValidator("shape")),currentPageId:idValidator("page"),brush:E.nullable(),scribble:L.nullable(),chatMessage:h.T.string,meta:h.T.jsonValue})),eu={AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5},ed=(0,b.zn)({currentVersion:eu.RenameSelectedShapeIds,migrators:{[eu.AddScribbleDelay]:{up:t=>null!==t.scribble?{...t,scribble:{...t.scribble,delay:0}}:{...t},down:t=>{if(null!==t.scribble){let{delay:c,...u}=t.scribble;return{...t,scribble:u}}return{...t}}},[eu.RemoveInstanceId]:{up:({instanceId:t,...c})=>c,down:t=>({...t,instanceId:X})},[eu.AddChatMessage]:{up:t=>({...t,chatMessage:""}),down:({chatMessage:t,...c})=>c},[eu.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})},[eu.RenameSelectedShapeIds]:{up:t=>{let{selectedShapeIds:c,...u}=t;return{selectedShapeIds:c,...u}},down:t=>{let{selectedShapeIds:c,...u}=t;return{selectedShapeIds:c,...u}}}}}),ep=(0,b.ju)("instance_presence",{migrations:ed,validator:ec,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribble:null,chatMessage:"",meta:{}})),createPresenceStateDerivation=(t,c)=>u=>(0,g.Fl)("instancePresence",()=>{let h=u.get(X),f=u.get(er.createId(h?.currentPageId)),g=u.get(_.createId(h?.currentPageId)),b=u.get(el),v=t.value;return f&&h&&g&&b&&v?ep.create({id:c??ep.createId(u.id),selectedShapeIds:f.selectedShapeIds,brush:h.brush,scribble:h.scribble,userId:v.id,userName:v.name,followingUserId:h.followingUserId,camera:{x:g.x,y:g.y,z:g.z},color:v.color,currentPageId:h.currentPageId,cursor:{x:b.x,y:b.y,rotation:h.cursor.rotation,type:h.cursor.type},lastActivityTimestamp:b.lastActivityTimestamp,screenBounds:h.screenBounds,chatMessage:h.chatMessage,meta:{}}):null});var eh=u(7110);let ef=h.T.model("document",h.T.object({typeName:h.T.literal("document"),id:h.T.literal("document:document"),gridSize:h.T.number,name:h.T.string,meta:h.T.jsonValue})),eg={AddName:1,AddMeta:2},em=(0,b.zn)({currentVersion:eg.AddMeta,migrators:{[eg.AddName]:{up:t=>({...t,name:""}),down:({name:t,...c})=>c},[eg.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})}}}),eb=(0,b.ju)("document",{migrations:em,validator:ef,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),ey=eb.createId("document");function sortByIndex(t,c){return t.index<c.index?-1:t.index>c.index?1:0}function redactRecordForErrorReporting(t){"asset"===t.typeName&&("src"in t&&(t.src="<redacted>"),"src"in t.props&&(t.props.src="<redacted>"))}let onValidationFailure=({error:t,phase:c,record:u,recordBefore:h})=>{throw(0,eh.lw)(t,{tags:{origin:"store.validateRecord",storePhase:c,isExistingValidationIssue:"initialize"===c},extras:{recordBefore:h?redactRecordForErrorReporting((0,eh.v4)(h)):void 0,recordAfter:redactRecordForErrorReporting((0,eh.v4)(u))}}),t};function getDefaultPages(){return[K.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function createIntegrityChecker(t){let c=t.query.ids("page"),ensureStoreIsUsable=()=>{if(!t.has(ey))return t.put([eb.create({id:ey,name:t.props.defaultName})]),ensureStoreIsUsable();if(!t.has(el))return t.put([es.create({id:el})]),ensureStoreIsUsable();let u=c.value;if(0===u.size)return t.put(getDefaultPages()),ensureStoreIsUsable();let h=t.get(X);if(!h)return t.put([t.schema.types.instance.create({id:X,currentPageId:[...u].map(c=>t.get(c)).sort(sortByIndex)[0].id,exportBackground:!0})]),ensureStoreIsUsable();if(!u.has(h.currentPageId))return t.put([{...h,currentPageId:[...u].map(c=>t.get(c)).sort(sortByIndex)[0].id}]),ensureStoreIsUsable();let f=new Set,g=new Set;for(let c of u){let u=er.createId(c);t.has(u)||f.add(u);let h=_.createId(c);t.has(h)||g.add(h)}f.size>0&&t.put([...f].map(t=>er.create({id:t,pageId:er.parseId(t)}))),g.size>0&&t.put([...g].map(t=>_.create({id:t})))};return ensureStoreIsUsable}let ev=createAssetValidator("bookmark",h.T.object({title:h.T.string,description:h.T.string,image:h.T.string,src:h.T.string.nullable()})),ex=(0,b.zn)({}),ew=createAssetValidator("image",h.T.object({w:h.T.number,h:h.T.number,name:h.T.string,isAnimated:h.T.boolean,mimeType:h.T.string.nullable(),src:h.T.string.nullable()})),eS={AddIsAnimated:1,RenameWidthHeight:2},e_=(0,b.zn)({currentVersion:eS.RenameWidthHeight,migrators:{[eS.AddIsAnimated]:{up:t=>({...t,props:{...t.props,isAnimated:!1}}),down:t=>{let{isAnimated:c,...u}=t.props;return{...t,props:u}}},[eS.RenameWidthHeight]:{up:t=>{let{width:c,height:u,...h}=t.props;return{...t,props:{w:c,h:u,...h}}},down:t=>{let{w:c,h:u,...h}=t.props;return{...t,props:{width:c,height:u,...h}}}}}}),ek=createAssetValidator("video",h.T.object({w:h.T.number,h:h.T.number,name:h.T.string,isAnimated:h.T.boolean,mimeType:h.T.string.nullable(),src:h.T.string.nullable()})),eC={AddIsAnimated:1,RenameWidthHeight:2},eP=(0,b.zn)({currentVersion:eC.RenameWidthHeight,migrators:{[eC.AddIsAnimated]:{up:t=>({...t,props:{...t.props,isAnimated:!1}}),down:t=>{let{isAnimated:c,...u}=t.props;return{...t,props:u}}},[eC.RenameWidthHeight]:{up:t=>{let{width:c,height:u,...h}=t.props;return{...t,props:{w:c,h:u,...h}}},down:t=>{let{w:c,h:u,...h}=t.props;return{...t,props:{width:c,height:u,...h}}}}}}),eE=h.T.model("asset",h.T.union("type",{image:ew,video:ek,bookmark:ev})),e$={AddMeta:1},eT=(0,b.zn)({subTypeKey:"type",subTypeMigrations:{image:e_,video:eP,bookmark:ex},currentVersion:e$.AddMeta,migrators:{[e$.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})}}}),eI=(0,b.ju)("asset",{migrations:eT,validator:eE,scope:"document"}).withDefaultProperties(()=>({meta:{}})),nanoid=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((t,c)=>((c&=63)<36?t+=c.toString(36):c<62?t+=(c-26).toString(36).toUpperCase():c>62?t+="-":t+="_",t),"");let StyleProp=class StyleProp{constructor(t,c,u){this.id=t,this.defaultValue=c,this.type=u}static define(t,c){let{defaultValue:u,type:f=h.T.any}=c;return new StyleProp(t,u,f)}static defineEnum(t,c){let{defaultValue:u,values:h}=c;return new EnumStyleProp(t,u,h)}validate(t){return this.type.validate(t)}};let EnumStyleProp=class EnumStyleProp extends StyleProp{constructor(t,c,u){super(t,c,h.T.literalEnum(...u)),this.values=u}};let eA={AddIsLocked:1,HoistOpacity:2,AddMeta:3},eM=(0,b.zn)({currentVersion:eA.AddMeta,migrators:{[eA.AddIsLocked]:{up:t=>({...t,isLocked:!1}),down:t=>{let{isLocked:c,...u}=t;return{...u}}},[eA.HoistOpacity]:{up:({props:{opacity:t,...c},...u})=>({...u,opacity:Number(t??"1"),props:c}),down:({opacity:t,...c})=>({...c,props:{...c.props,opacity:t<.175?"0.1":t<.375?"0.25":t<.625?"0.5":t<.875?"0.75":"1"}})},[eA.AddMeta]:{up:t=>({...t,meta:{}}),down:({meta:t,...c})=>({...c})}}});function isShape(t){return!!t&&"shape"===t.typeName}function isShapeId(t){return!!t&&t.startsWith("shape:")}function createShapeId(t){return`shape:${t??nanoid()}`}function getShapePropKeysByStyle(t){let c=new Map;for(let[u,h]of Object.entries(t))if(h instanceof StyleProp){if(c.has(h))throw Error(`Duplicate style prop ${h.id}. Each style prop can only be used once within a shape.`);c.set(h,u)}return c}function createShapeRecordType(t){return(0,b.ju)("shape",{migrations:(0,b.zn)({currentVersion:eM.currentVersion,firstVersion:eM.firstVersion,migrators:eM.migrators,subTypeKey:"type",subTypeMigrations:(0,eh.Fm)(t,(t,c)=>c.migrations??(0,b.zn)({}))}),scope:"document",validator:h.T.model("shape",h.T.union("type",(0,eh.Fm)(t,(t,{props:c,meta:u})=>createShapeValidator(t,c,u))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}let ej={RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4},eD=(0,b.zn)({currentVersion:ej.RemoveUserDocument,migrators:{[ej.RemoveCodeAndIconShapeTypes]:{up:t=>Object.fromEntries(Object.entries(t).filter(([t,c])=>"shape"!==c.typeName||"icon"!==c.type&&"code"!==c.type)),down:t=>t},[ej.AddInstancePresenceType]:{up:t=>t,down:t=>Object.fromEntries(Object.entries(t).filter(([t,c])=>"instance_presence"!==c.typeName))},[ej.RemoveTLUserAndPresenceAndAddPointer]:{up:t=>Object.fromEntries(Object.entries(t).filter(([t,c])=>!c.typeName.match(/^(user|user_presence)$/))),down:t=>Object.fromEntries(Object.entries(t).filter(([t,c])=>"pointer"!==c.typeName))},[ej.RemoveUserDocument]:{up:t=>Object.fromEntries(Object.entries(t).filter(([t,c])=>!c.typeName.match("user_document"))),down:t=>t}}});function createTLSchema({shapes:t}){let c=new Map;for(let u of(0,eh.UM)(t))for(let t of getShapePropKeysByStyle(u.props??{}).keys()){if(c.has(t.id)&&c.get(t.id)!==t)throw Error(`Multiple StyleProp instances with the same id: ${t.id}`);c.set(t.id,t)}let u=createShapeRecordType(t),h=createInstanceRecordType(c);return b.sS.create({asset:eI,camera:_,document:eb,instance:h,instance_page_state:er,page:K,shape:u,instance_presence:ep,pointer:es},{snapshotMigrations:eD,onValidationFailure:onValidationFailure,createIntegrityChecker:createIntegrityChecker})}let eO=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red"],eF={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4263eb",semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#adb5bd",semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4dabf7",semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#40c057",semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#ff8787",semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e599f7",semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#f76707",semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#ffc078",semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}}},darkMode:{id:"dark",text:"#f8f9fa",background:"#212529",solid:"#28292e",black:{solid:"#e1e1e1",semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4156be",semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#3b7b5e",semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#93989f",semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#588fc9",semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#599f57",semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#c67877",semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#b583c9",semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#bf612e",semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#aa3c37",semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#873fa3",semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#cba371",semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}}}};function getDefaultColorTheme(t){return t.isDarkMode?eF.darkMode:eF.lightMode}let eR=StyleProp.defineEnum("tldraw:color",{defaultValue:"black",values:eO}),eL=StyleProp.defineEnum("tldraw:labelColor",{defaultValue:"black",values:eO}),eN=StyleProp.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),ez=StyleProp.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern"]}),eB=StyleProp.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),eG={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},eH=StyleProp.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),eU=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],eV=StyleProp.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:eU}),eW=StyleProp.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:eU}),eK=h.T.union("type",{binding:h.T.object({type:h.T.literal("binding"),boundShapeId:Q,normalizedAnchor:k,isExact:h.T.boolean}),point:h.T.object({type:h.T.literal("point"),x:h.T.number,y:h.T.number})}),eZ={labelColor:eL,color:eR,fill:ez,dash:eN,size:eH,arrowheadStart:eV,arrowheadEnd:eW,font:eB,start:eK,end:eK,bend:h.T.number,text:h.T.string},eY={AddLabelColor:1},eX=(0,b.zn)({currentVersion:eY.AddLabelColor,migrators:{[eY.AddLabelColor]:{up:t=>({...t,props:{...t.props,labelColor:"black"}}),down:t=>{let{labelColor:c,...u}=t.props;return{...t,props:u}}}}}),eJ={w:h.T.nonZeroNumber,h:h.T.nonZeroNumber,assetId:f.nullable(),url:h.T.string},eQ={NullAssetId:1},e0=(0,b.zn)({currentVersion:eQ.NullAssetId,migrators:{[eQ.NullAssetId]:{up:t=>void 0===t.props.assetId?{...t,props:{...t.props,assetId:null}}:t,down:t=>{if(null===t.props.assetId){let{assetId:c,...u}=t.props;return{...t,props:u}}return t}}}}),e1=h.T.object({type:h.T.literalEnum("free","straight"),points:h.T.arrayOf(k)}),e2={color:eR,fill:ez,dash:eN,size:eH,segments:h.T.arrayOf(e1),isComplete:h.T.boolean,isClosed:h.T.boolean,isPen:h.T.boolean},e3={AddInPen:1},e5=(0,b.zn)({currentVersion:e3.AddInPen,migrators:{[e3.AddInPen]:{up:t=>{let{points:c}=t.props.segments[0];if(0===c.length)return{...t,props:{...t.props,isPen:!1}};let u=!(0===c[0].z||.5===c[0].z);return c[1]&&(u=u&&!(0===c[1].z||.5===c[1].z)),{...t,props:{...t.props,isPen:u}}},down:t=>{let{isPen:c,...u}=t.props;return{...t,props:{...u}}}}}});var e4=u(2601);let e8=/(^\/r\/[^/]+\/?$)/,safeParseUrl=t=>{try{return new URL(t)}catch(t){return}},e6=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(e8))return t},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(e8))return t}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:t=>{if(t.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!t.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${t}`},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/^\/embed\/?$/)){let t=c.searchParams.get("url");if(t)return t}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{if(t.includes("/maps/")){let c;let u=t.match(/@(.*),(.*),(.*)z/);if(u){let[,h,f,g]=u,b=new URL(t).host.replace("www.","");c=`https://${b}/maps/embed/v1/view?key=${e4.env.NEXT_PUBLIC_GC_API_KEY}&center=${h},${f}&zoom=${g}`}else c="";return c}},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(!c)return;let u=c.pathname.match(/^\/maps\/embed\/v1\/view\/?$/);if(u&&c.searchParams.has("center")&&c.searchParams.get("zoom")){let t=c.searchParams.get("zoom"),[u,h]=c.searchParams.get("center").split(",");return`https://www.google.com/maps/@${u},${h},${t}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=safeParseUrl(t),u=c&&c.pathname.match(/\/v\/([^/]+)\/?/);if(u)return`https://www.val.town/embed/${u[1]}`},fromEmbedUrl:t=>{let c=safeParseUrl(t),u=c&&c.pathname.match(/\/embed\/([^/]+)\/?/);if(u)return`https://www.val.town/v/${u[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=safeParseUrl(t),u=c&&c.pathname.match(/\/s\/([^/]+)\/?/);if(u)return`https://codesandbox.io/embed/${u[1]}`},fromEmbedUrl:t=>{let c=safeParseUrl(t),u=c&&c.pathname.match(/\/embed\/([^/]+)\/?/);if(u)return`https://codesandbox.io/s/${u[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=t.match(/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/);if(c){let[t,u,h]=c;return`https://codepen.io/${u}/embed/${h}`}},fromEmbedUrl:t=>{let c=t.match(/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/);if(c){let[t,u,h]=c;return`https://codepen.io/${u}/pen/${h}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,canUnmount:!1,toEmbedUrl:t=>{let c=t.match(/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/);if(c){let[t,u]=c;return`https://scratch.mit.edu/projects/embed/${u}`}},fromEmbedUrl:t=>{let c=t.match(/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/);if(c){let[t,u]=c;return`https://scratch.mit.edu/projects/${u}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,canUnmount:!1,overridePermissions:{"allow-presentation":!0},isAspectRatioLocked:!0,toEmbedUrl:t=>{let c=safeParseUrl(t);if(!c)return;let u=c.hostname.replace(/^www./,"");if("youtu.be"===u){let t=c.pathname.split("/").filter(Boolean)[0];return`https://www.youtube.com/embed/${t}`}if(("youtube.com"===u||"m.youtube.com"===u)&&c.pathname.match(/^\/watch/)){let t=c.searchParams.get("v");return`https://www.youtube.com/embed/${t}`}},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(!c)return;let u=c.hostname.replace(/^www./,"");if("youtube.com"===u){let t=c.pathname.match(/^\/embed\/([^/]+)\/?/);if(t)return`https://www.youtube.com/watch?v=${t[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",toEmbedUrl:t=>{let c=safeParseUrl(t),u=c?.searchParams.get("cid");if(c?.pathname.match(/\/calendar\/u\/0/)&&u){c.pathname="/calendar/embed";let t=Array.from(c.searchParams.keys());for(let u of t)c.searchParams.delete(u);return c.searchParams.set("src",u),c.href}},fromEmbedUrl:t=>{let c=safeParseUrl(t),u=c?.searchParams.get("src");if(c?.pathname.match(/\/calendar\/embed/)&&u){c.pathname="/calendar/u/0";let t=Array.from(c.searchParams.keys());for(let u of t)c.searchParams.delete(u);return c.searchParams.set("cid",u),c.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c?.pathname.match(/^\/presentation/)&&c?.pathname.match(/\/pub\/?$/)){c.pathname=c.pathname.replace(/\/pub$/,"/embed");let t=Array.from(c.searchParams.keys());for(let u of t)c.searchParams.delete(u);return c.href}},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c?.pathname.match(/^\/presentation/)&&c?.pathname.match(/\/embed\/?$/)){c.pathname=c.pathname.replace(/\/embed$/,"/pub");let t=Array.from(c.searchParams.keys());for(let u of t)c.searchParams.delete(u);return c.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,canUnmount:!0,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!t.split("/").pop())return;return t}},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/\/([^/]+)\/([^/]+)/)){if(!t.split("/").pop())return;return t}}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${t}?embed=true`},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/\/@([^/]+)\/([^/]+)/)&&c.searchParams.has("embed"))return c.searchParams.delete("embed"),c.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/^\/map\//))return c.origin+"/embed"+c.pathname},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/^\/embed\/map\//))return c.pathname=c.pathname.replace(/^\/embed/,""),c.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,canUnmount:!1,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/^\/(artist|album)\//))return c.origin+"/embed"+c.pathname},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/^\/embed\/(artist|album)\//))return c.origin+c.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&"vimeo.com"===c.hostname&&c.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+c.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&"player.vimeo.com"===c.hostname){let t=c.pathname.match(/^\/video\/([^/]+)\/?$/);if(t)return"https://vimeo.com/"+t[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!0,toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.hash.match(/#room=/))return t},fromEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.hash.match(/#room=/))return t}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,canUnmount:!1,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:t=>{let c=safeParseUrl(t);if(c&&c.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${c.origin}/embed${c.pathname}?cell=*`;if(c&&c.pathname.match(/^\/d\/([^/]+)\/?$/)){let t=c.pathname.replace(/^\/d/,"");return`${c.origin}/embed${t}?cell=*`}},fromEmbedUrl:t=>{let c=safeParseUrl(t);return c&&c.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/)?`${c.origin}${c.pathname.replace("/embed","")}#cell-*`:c&&c.pathname.match(/^\/embed\/([^/]+)\/?$/)?`${c.origin}${c.pathname.replace("/embed","/d")}#cell-*`:void 0}}],e7={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},e9={w:h.T.nonZeroNumber,h:h.T.nonZeroNumber,url:h.T.string},te={GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4},tt=(0,b.zn)({currentVersion:te.RemovePermissionOverrides,migrators:{[te.GenOriginalUrlInEmbed]:{up:t=>{let c;let u=t.props.url,h=new URL(u).host.replace("www.","");for(let t of e6)if(t.hostnames.includes(h))try{c=t.fromEmbedUrl(u)}catch(t){console.warn(t)}return{...t,props:{...t.props,tmpOldUrl:t.props.url,url:c??""}}},down:t=>{let c=t.props.tmpOldUrl;if(!c||""===c){let u=t.props.url,h=new URL(u).host.replace("www.","");for(let t of e6)if(t.hostnames.includes(h))try{c=t.toEmbedUrl(u)}catch(t){console.warn(t)}}let{tmpOldUrl:u,...h}=t.props;return{...t,props:{...h,url:c??""}}}},[te.RemoveDoesResize]:{up:t=>{let{doesResize:c,...u}=t.props;return{...t,props:{...u}}},down:t=>({...t,props:{...t.props,doesResize:!0}})},[te.RemoveTmpOldUrl]:{up:t=>{let{tmpOldUrl:c,...u}=t.props;return{...t,props:{...u}}},down:t=>({...t,props:{...t.props}})},[te.RemovePermissionOverrides]:{up:t=>{let{overridePermissions:c,...u}=t.props;return{...t,props:{...u}}},down:t=>({...t,props:{...t.props}})}}}),tn={w:h.T.nonZeroNumber,h:h.T.nonZeroNumber,name:h.T.string},tr=(0,b.zn)({}),ti=StyleProp.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),to=StyleProp.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),ta=StyleProp.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box"]}),ts={geo:ta,labelColor:eL,color:eR,fill:ez,dash:eN,size:eH,font:eB,align:ti,verticalAlign:to,url:h.T.string,w:h.T.nonZeroNumber,h:h.T.nonZeroNumber,growY:h.T.positiveNumber,text:h.T.string},tl={AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7},tc=(0,b.zn)({currentVersion:tl.AddCloud,migrators:{[tl.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{let{url:c,...u}=t.props;return{...t,props:u}}},[tl.AddLabelColor]:{up:t=>({...t,props:{...t.props,labelColor:"black"}}),down:t=>{let{labelColor:c,...u}=t.props;return{...t,props:u}}},[tl.RemoveJustify]:{up:t=>{let c=t.props.align;return"justify"===c&&(c="start"),{...t,props:{...t.props,align:c}}},down:t=>({...t})},[tl.AddCheckBox]:{up:t=>({...t}),down:t=>({...t,props:{...t.props,geo:"check-box"===t.props.geo?"rectangle":t.props.geo}})},[tl.AddVerticalAlign]:{up:t=>({...t,props:{...t.props,verticalAlign:"middle"}}),down:t=>{let{verticalAlign:c,...u}=t.props;return{...t,props:u}}},[tl.MigrateLegacyAlign]:{up:t=>{let c;switch(t.props.align){case"start":c="start-legacy";break;case"end":c="end-legacy";break;default:c="middle-legacy"}return{...t,props:{...t.props,align:c}}},down:t=>{let c;switch(t.props.align){case"start-legacy":c="start";break;case"end-legacy":c="end";break;case"middle-legacy":c="middle";break;default:c=t.props.align}return{...t,props:{...t.props,align:c}}}},[tl.AddCloud]:{up:t=>t,down:t=>{if("cloud"===t.props.geo)return{...t,props:{...t.props,geo:"rectangle"}}}}}}),tu={},td=(0,b.zn)({}),tp={color:eR,size:eH,segments:h.T.arrayOf(e1),isComplete:h.T.boolean,isPen:h.T.boolean},th=(0,b.zn)({}),tf=h.T.object({topLeft:k,bottomRight:k}),tg={w:h.T.nonZeroNumber,h:h.T.nonZeroNumber,playing:h.T.boolean,url:h.T.string,assetId:f.nullable(),crop:tf.nullable()},tm={AddUrlProp:1,AddCropProp:2},tb=(0,b.zn)({currentVersion:tm.AddCropProp,migrators:{[tm.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{let{url:c,...u}=t.props;return{...t,props:u}}},[tm.AddCropProp]:{up:t=>({...t,props:{...t.props,crop:null}}),down:t=>{let{crop:c,...u}=t.props;return{...t,props:u}}}}}),ty=new Set(["vertex","virtual","create"]),tv=h.T.object({id:h.T.string,type:h.T.setEnum(ty),canBind:h.T.boolean.optional(),canSnap:h.T.boolean.optional(),index:h.T.string,x:h.T.number,y:h.T.number}),tx=StyleProp.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),tw={color:eR,dash:eN,size:eH,spline:tx,handles:h.T.dict(h.T.string,tv)},tS={AddSnapHandles:1},t_=(0,b.zn)({currentVersion:tS.AddSnapHandles,migrators:{[tS.AddSnapHandles]:{up:t=>{let c=(0,eh.p$)(t.props.handles);for(let t in c)c[t].canSnap=!0;return{...t,props:{...t.props,handles:c}}},down:t=>{let c=(0,eh.p$)(t.props.handles);for(let t in c)delete c[t].canSnap;return{...t,props:{...t.props,handles:c}}}}}}),tk={color:eR,size:eH,font:eB,align:ti,verticalAlign:to,growY:h.T.positiveNumber,url:h.T.string,text:h.T.string},tC={AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4},tP=(0,b.zn)({currentVersion:tC.AddVerticalAlign,migrators:{[tC.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{let{url:c,...u}=t.props;return{...t,props:u}}},[tC.RemoveJustify]:{up:t=>{let c=t.props.align;return"justify"===c&&(c="start"),{...t,props:{...t.props,align:c}}},down:t=>({...t})},[tC.MigrateLegacyAlign]:{up:t=>{let c;switch(t.props.align){case"start":c="start-legacy";break;case"end":c="end-legacy";break;default:c="middle-legacy"}return{...t,props:{...t.props,align:c}}},down:t=>{let c;switch(t.props.align){case"start-legacy":c="start";break;case"end-legacy":c="end";break;case"middle-legacy":c="middle";break;default:c=t.props.align}return{...t,props:{...t.props,align:c}}}},[tC.AddVerticalAlign]:{up:t=>({...t,props:{...t.props,verticalAlign:"middle"}}),down:t=>{let{verticalAlign:c,...u}=t.props;return{...t,props:u}}}}}),tE={color:eR,size:eH,font:eB,align:ti,w:h.T.nonZeroNumber,text:h.T.string,scale:h.T.nonZeroNumber,autoSize:h.T.boolean},t$={RemoveJustify:1},tT=(0,b.zn)({currentVersion:t$.RemoveJustify,migrators:{[t$.RemoveJustify]:{up:t=>{let c=t.props.align;return"justify"===c&&(c="start"),{...t,props:{...t.props,align:c}}},down:t=>({...t})}}}),tI={w:h.T.nonZeroNumber,h:h.T.nonZeroNumber,time:h.T.number,playing:h.T.boolean,url:h.T.string,assetId:f.nullable()},tA={AddUrlProp:1},tM=(0,b.zn)({currentVersion:tA.AddUrlProp,migrators:{[tA.AddUrlProp]:{up:t=>({...t,props:{...t.props,url:""}}),down:t=>{let{url:c,...u}=t.props;return{...t,props:u}}}}}),tj=[{locale:"ar",label:"عربي"},{locale:"ca",label:"Catal\xe0"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Espa\xf1ol"},{locale:"fa",label:"فارسی"},{locale:"fi",label:"Suomi"},{locale:"fr",label:"Fran\xe7ais"},{locale:"gl",label:"Galego"},{locale:"he",label:"עברית"},{locale:"it",label:"Italiano"},{locale:"ja",label:"日本語"},{locale:"ko-kr",label:"한국어"},{locale:"ku",label:"کوردی"},{locale:"hi-in",label:"हिन्दी"},{locale:"hu",label:"Magyar"},{locale:"my",label:"မြန်မာစာ"},{locale:"ne",label:"नेपाली"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Portugu\xeas - Brasil"},{locale:"pt-pt",label:"Portugu\xeas - Europeu"},{locale:"ro",label:"Rom\xe2nă"},{locale:"ru",label:"Russian"},{locale:"sv",label:"Svenska"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"tr",label:"T\xfcrk\xe7e"},{locale:"uk",label:"Ukrainian"},{locale:"vi",label:"Tiếng Việt"},{locale:"zh-cn",label:"Chinese - Simplified"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function getDefaultTranslationLocale(){let t="undefined"!=typeof window?window.navigator.languages??["en"]:["en"];return _getDefaultTranslationLocale(t)}function _getDefaultTranslationLocale(t){for(let c of t){let t=getSupportedLocale(c);if(t)return t}return"en"}let tD={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function getSupportedLocale(t){let c=tj.find(c=>c.locale===t.toLowerCase());if(c)return c.locale;let[u,h]=t.split(/[-_]/).map(t=>t.toLowerCase());if(h){let t=tj.find(t=>t.locale===u);if(t)return t.locale}return u in tD?tD[u]:null}},7110:function(t,c,u){"use strict";let h;function rotateArray(t,c){return t.map((u,h)=>t[(h+c)%t.length])}function dedupe(t,c){let u=[];t:for(let h of t){for(let t of u)if(c?c(h,t):h===t)continue t;u.push(h)}return u}function compact(t){return t.filter(t=>null!=t)}function last(t){return t[t.length-1]}function minBy(t,c){let u;let h=1/0;for(let f of t){let t=c(f);t<h&&(u=f,h=t)}return u}function partition(t,c){let u=[],h=[];for(let f of t)c(f)?u.push(f):h.push(f);return[u,h]}function throttle(t,c){let u,h;return function(...f){return u||(u=!0,setTimeout(()=>u=!1,c),h=t(...f)),h}}function omitFromStackTrace(t){let wrappedFn=(...c)=>{try{return t(...c)}catch(t){throw t instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(t,wrappedFn),t}};return wrappedFn}function noop(){}u.d(c,{P6:function(){return FileHelpers},xe:function(){return MediaHelpers},bM:function(){return PngHelpers},x4:function(){return f},lw:function(){return annotateError},hu:function(){return g},kP:function(){return b},oA:function(){return compact},Ds:function(){return debounce},D8:function(){return dedupe},p$:function(){return deepCopy},iP:function(){return exhaustiveSwitchError},H4:function(){return filterEntries},wi:function(){return getErrorAnnotations},lr:function(){return getFirstFromIterable},pT:function(){return getHashForObject},jK:function(){return getHashForString},eg:function(){return getOwnProperty},nr:function(){return object_hasOwnProperty},$K:function(){return isDefined},GT:function(){return isNonNull},cF:function(){return isNonNullish},jv:function(){return isValidUrl},Z$:function(){return last},t7:function(){return lerp},L8:function(){return lns},Fm:function(){return mapObjectMapValues},F:function(){return minBy},vm:function(){return modulate},ZT:function(){return noop},EP:function(){return objectMapEntries},Ls:function(){return objectMapFromEntries},GH:function(){return objectMapKeys},UM:function(){return objectMapValues},fP:function(){return omitFromStackTrace},uK:function(){return partition},un:function(){return promiseWithResolve},TE:function(){return rafThrottle},Vk:function(){return rng},R8:function(){return rotateArray},uv:function(){return sortById},v4:function(){return E},P2:function(){return throttle},xP:function(){return throttledRaf}});let f={ok:t=>({ok:!0,value:t}),err:t=>({ok:!1,error:t})};function exhaustiveSwitchError(t,c){let u=c&&t&&"object"==typeof t&&c in t?t[c]:t;throw Error(`Unknown switch case ${u}`)}let g=omitFromStackTrace((t,c)=>{if(!t)throw Error(c||"Assertion Error")}),b=omitFromStackTrace((t,c)=>{if(null==t)throw Error(c??"value must be defined");return t});function promiseWithResolve(){let t,c;let u=new Promise((u,h)=>{t=u,c=h});return Object.assign(u,{resolve:t,reject:c})}function debounce(t,c){let u;let fn=(...h)=>(u||((u={}).promise=new Promise((t,c)=>{u.resolve=t,u.reject=c})),clearTimeout(u.timeout),u.latestArgs=h,u.timeout=setTimeout(()=>{let c=u;u=void 0;try{c.resolve(t(...c.latestArgs))}catch(t){c.reject(t)}},c),u.promise);return fn.cancel=()=>{u&&clearTimeout(u.timeout)},fn}let v=new WeakMap;function annotateError(t,c){if("object"!=typeof t||null===t)return;let u=v.get(t);u||(u={tags:{},extras:{}},v.set(t,u)),c.tags&&(u.tags={...u.tags,...c.tags}),c.extras&&(u.extras={...u.extras,...c.extras})}function getErrorAnnotations(t){return v.get(t)??{tags:{},extras:{}}}let FileHelpers=class FileHelpers{static async base64ToFile(t){return fetch(t).then(function(t){return t.arrayBuffer()})}static async fileToBase64(t){return await new Promise((c,u)=>{if(t){let h=new FileReader;h.readAsDataURL(t),h.onload=()=>c(h.result),h.onerror=t=>u(t),h.onabort=t=>u(t)}})}};function getHashForString(t){let c=0;for(let u=0;u<t.length;u++)c=(c<<5)-c+t.charCodeAt(u)|0;return c+""}function getHashForObject(t){return getHashForString(JSON.stringify(t))}function lns(t){let c=t.split("");return c.push(...c.splice(0,Math.round(c.length/5))),c.push(...c.splice(0,Math.round(c.length/4))),c.push(...c.splice(0,Math.round(c.length/3))),c.push(...c.splice(0,Math.round(c.length/2))),c.reverse().map(t=>+t?5>+t?5+ +t:+t>5?+t-5:t:t).join("")}function getFirstFromIterable(t){return t.values().next().value}let x=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(x=new Int32Array(x));let crc=(t,c)=>{let u=0===c?0:-1^~~c;for(let c=0;c<t.length;c++)u=x[(u^t[c])&255]^u>>>8;return -1^u};let PngHelpers=class PngHelpers{static isPng(t,c){return 137===t.getUint8(c+0)&&80===t.getUint8(c+1)&&78===t.getUint8(c+2)&&71===t.getUint8(c+3)&&13===t.getUint8(c+4)&&10===t.getUint8(c+5)&&26===t.getUint8(c+6)&&10===t.getUint8(c+7)}static getChunkType(t,c){return[String.fromCharCode(t.getUint8(c)),String.fromCharCode(t.getUint8(c+1)),String.fromCharCode(t.getUint8(c+2)),String.fromCharCode(t.getUint8(c+3))].join("")}static readChunks(t,c=0){let u={};if(!PngHelpers.isPng(t,c))throw Error("Not a PNG");for(c+=8;c<=t.buffer.byteLength;){let h=c,f=t.getInt32(c);c+=4;let g=PngHelpers.getChunkType(t,c);if("IDAT"===g&&u[g]){c+=f+4+4;continue}if("IEND"===g)break;u[g]={start:h,dataOffset:c+4,size:f},c+=f+4+4}return u}static parsePhys(t,c){return{ppux:t.getUint32(c),ppuy:t.getUint32(c+4),unit:t.getUint8(c+4)}}static findChunk(t,c){let u=PngHelpers.readChunks(t);return u[c]}static setPhysChunk(t,c=1,u){let h=46,f=0,g=PngHelpers.findChunk(t,"pHYs");g&&(h=g.start,f=g.size);let b=PngHelpers.findChunk(t,"IDAT");b&&(h=b.start,f=0);let v=new ArrayBuffer(21),x=new DataView(v);x.setUint32(0,9),x.setUint8(4,112),x.setUint8(5,72),x.setUint8(6,89),x.setUint8(7,115),x.setInt32(8,2835.5*c),x.setInt32(12,2835.5*c),x.setInt8(16,1);let w=new Uint8Array(v.slice(4,17));x.setInt32(17,crc(w));let _=t.buffer.slice(0,h),k=t.buffer.slice(h+f);return new Blob([_,v,k],u)}};let MediaHelpers=class MediaHelpers{static async getVideoSizeFromSrc(t){return await new Promise((c,u)=>{let h=document.createElement("video");h.onloadeddata=()=>c({w:h.videoWidth,h:h.videoHeight}),h.onerror=t=>{console.error(t),u(Error("Could not get video size"))},h.crossOrigin="anonymous",h.src=t})}static async getImageSizeFromSrc(t){return await new Promise((c,u)=>{let h=new Image;h.onload=async()=>{try{let u=await FileHelpers.base64ToFile(t),f=new DataView(u);if(PngHelpers.isPng(f,0)){let t=PngHelpers.findChunk(f,"pHYs");if(t){let u=PngHelpers.parsePhys(f,t.dataOffset);if(0===u.unit&&u.ppux===u.ppuy){let t=Math.round(u.ppux/2834.5);c({w:h.width/t,h:h.height/t});return}}}c({w:h.width,h:h.height})}catch(t){console.error(t),c({w:h.width,h:h.height})}},h.onerror=t=>{console.error(t),u(Error("Could not get image size"))},h.crossOrigin="anonymous",h.src=t})}};function lerp(t,c,u){return t+(c-t)*u}function rng(t=""){let c=0,u=0,h=0,f=0;function next(){let t=c^c<<11;return c=u,u=h,h=f,(f^=(f>>>19^t^t>>>8)>>>0)/4294967296*2}for(let u=0;u<t.length+64;u++)c^=0|t.charCodeAt(u),next();return next}function modulate(t,c,u,h=!1){let[f,g]=c,[b,v]=u,x=b+(t-f)/(g-f)*(v-b);return h?b<v?Math.max(Math.min(x,v),b):Math.max(Math.min(x,b),v):x}function object_hasOwnProperty(t,c){return Object.prototype.hasOwnProperty.call(t,c)}function getOwnProperty(t,c){if(object_hasOwnProperty(t,c))return t[c]}function deepCopy(t){if(!t)return t;if(Array.isArray(t)){let c=[],u=t.length;for(let h=0;h<u;h++)c.push(deepCopy(t[h]));return c}if("object"==typeof t){let c=Object.keys(t),u=c.length,h={};for(let f=0;f<u;f++){let u=c[f];h[u]=deepCopy(t[u])}return h}return t}function objectMapKeys(t){return Object.keys(t)}function objectMapValues(t){return Object.values(t)}function objectMapEntries(t){return Object.entries(t)}function objectMapFromEntries(t){return Object.fromEntries(t)}function filterEntries(t,c){let u={},h=!1;for(let[f,g]of objectMapEntries(t))c(f,g)?u[f]=g:h=!0;return h?u:t}function mapObjectMapValues(t,c){let u={};for(let[h,f]of objectMapEntries(t)){let t=c(h,f);u[h]=t}return u}var w=u(2601);let isTest=()=>void 0!==w&&!1,_=[],tick=()=>{let t=_.splice(0,_.length);for(let c of t)c()};function raf(){h||(h=requestAnimationFrame(()=>{h=void 0,tick()}))}function rafThrottle(t){return isTest()?t:()=>{_.includes(t)||(_.push(t),raf())}}function throttledRaf(t){if(isTest())return t();_.includes(t)||(_.push(t),raf())}function sortById(t,c){return t.id>c.id?1:-1}let k=new RegExp(/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i);function isValidUrl(t){return k.test(t)}function isDefined(t){return void 0!==t}function isNonNull(t){return null!==t}function isNonNullish(t){return null!=t}let E="undefined"!=typeof window&&window.structuredClone?window.structuredClone:t=>t?JSON.parse(JSON.stringify(t)):t},5958:function(t,c,u){"use strict";u.d(c,{UR:function(){return ArrayOfValidator},oy:function(){return DictValidator},kx:function(){return ObjectValidator},T:function(){return h},zr:function(){return UnionValidator},cX:function(){return Validator}});var h={};u.r(h),u.d(h,{ArrayOfValidator:function(){return ArrayOfValidator},DictValidator:function(){return DictValidator},ObjectValidator:function(){return ObjectValidator},UnionValidator:function(){return UnionValidator},ValidationError:function(){return ValidationError},Validator:function(){return Validator},any:function(){return b},array:function(){return M},arrayOf:function(){return arrayOf},bigint:function(){return I},boolean:function(){return T},dict:function(){return dict},integer:function(){return k},jsonDict:function(){return jsonDict},jsonValue:function(){return D},literal:function(){return literal},literalEnum:function(){return literalEnum},model:function(){return model},nonZeroInteger:function(){return $},nonZeroNumber:function(){return _},nullable:function(){return nullable},number:function(){return x},object:function(){return object},optional:function(){return optional},positiveInteger:function(){return E},positiveNumber:function(){return w},setEnum:function(){return setEnum},string:function(){return v},union:function(){return union},unknown:function(){return g},unknownObject:function(){return j}});var f=u(7110);function formatPath(t){if(!t.length)return null;let c="";for(let u of t)"number"==typeof u?c+=`.${u}`:u.startsWith("(")?c.endsWith(")")?c=`${c.slice(0,-1)}, ${u.slice(1)}`:c+=u:c+=`.${u}`;return c.startsWith(".")?c.slice(1):c}let ValidationError=class ValidationError extends Error{constructor(t,c=[]){let u=formatPath(c),h=t.split("\n").map((t,c)=>0===c?t:`  ${t}`).join("\n");super(c?`At ${u}: ${h}`:h),this.rawMessage=t,this.path=c}name="ValidationError"};function prefixError(t,c){try{return c()}catch(c){if(c instanceof ValidationError)throw new ValidationError(c.rawMessage,[t,...c.path]);throw new ValidationError(c.toString(),[t])}}function typeToString(t){if(null===t)return"null";if(Array.isArray(t))return"an array";let c=typeof t;switch(c){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${c}`;case"object":return`an ${c}`;case"undefined":return"undefined";default:(0,f.iP)(c)}}let Validator=class Validator{constructor(t){this.validationFn=t}validate(t){let c=this.validationFn(t);return c}nullable(){return nullable(this)}optional(){return optional(this)}refine(t){return new Validator(c=>t(this.validate(c)))}check(t,c){return"string"==typeof t?this.refine(u=>(prefixError(`(check ${t})`,()=>c(u)),u)):this.refine(c=>(t(c),c))}};let ArrayOfValidator=class ArrayOfValidator extends Validator{constructor(t){super(c=>{let u=M.validate(c);for(let c=0;c<u.length;c++)prefixError(c,()=>t.validate(u[c]));return u}),this.itemValidator=t}nonEmpty(){return this.check(t=>{if(0===t.length)throw new ValidationError("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(t=>{if(t.length<=1)throw new ValidationError("Expected an array with length greater than 1")})}};let ObjectValidator=class ObjectValidator extends Validator{constructor(t,c=!1){super(u=>{if("object"!=typeof u||null===u)throw new ValidationError(`Expected object, got ${typeToString(u)}`);for(let[c,h]of Object.entries(t))prefixError(c,()=>{h.validate((0,f.eg)(u,c))});if(!c){for(let c of Object.keys(u))if(!(0,f.nr)(t,c))throw new ValidationError("Unexpected property",[c])}return u}),this.config=t,this.shouldAllowUnknownProperties=c}allowUnknownProperties(){return new ObjectValidator(this.config,!0)}extend(t){return new ObjectValidator({...this.config,...t})}};let UnionValidator=class UnionValidator extends Validator{constructor(t,c,u){super(u=>{if("object"!=typeof u||null===u)throw new ValidationError(`Expected an object, got ${typeToString(u)}`,[]);let h=(0,f.eg)(u,t);if("string"!=typeof h)throw new ValidationError(`Expected a string for key "${t}", got ${typeToString(h)}`);let g=(0,f.nr)(c,h)?c[h]:void 0;return void 0===g?this.unknownValueValidation(u,h):prefixError(`(${t} = ${h})`,()=>g.validate(u))}),this.key=t,this.config=c,this.unknownValueValidation=u}validateUnknownVariants(t){return new UnionValidator(this.key,this.config,t)}};let DictValidator=class DictValidator extends Validator{constructor(t,c){super(u=>{if("object"!=typeof u||null===u)throw new ValidationError(`Expected object, got ${typeToString(u)}`);for(let[h,f]of Object.entries(u))prefixError(h,()=>{t.validate(h),c.validate(f)});return u}),this.keyValidator=t,this.valueValidator=c}};function typeofValidator(t){return new Validator(c=>{if(typeof c!==t)throw new ValidationError(`Expected ${t}, got ${typeToString(c)}`);return c})}let g=new Validator(t=>t),b=new Validator(t=>t),v=typeofValidator("string"),x=typeofValidator("number").check(t=>{if(Number.isNaN(t))throw new ValidationError("Expected a number, got NaN");if(!Number.isFinite(t))throw new ValidationError(`Expected a finite number, got ${t}`)}),w=x.check(t=>{if(t<0)throw new ValidationError(`Expected a positive number, got ${t}`)}),_=x.check(t=>{if(t<=0)throw new ValidationError(`Expected a non-zero positive number, got ${t}`)}),k=x.check(t=>{if(!Number.isInteger(t))throw new ValidationError(`Expected an integer, got ${t}`)}),E=k.check(t=>{if(t<0)throw new ValidationError(`Expected a positive integer, got ${t}`)}),$=k.check(t=>{if(t<=0)throw new ValidationError(`Expected a non-zero positive integer, got ${t}`)}),T=typeofValidator("boolean"),I=typeofValidator("bigint");function literal(t){return new Validator(c=>{if(c!==t)throw new ValidationError(`Expected ${t}, got ${JSON.stringify(c)}`);return t})}let M=new Validator(t=>{if(!Array.isArray(t))throw new ValidationError(`Expected an array, got ${typeToString(t)}`);return t});function arrayOf(t){return new ArrayOfValidator(t)}let j=new Validator(t=>{if("object"!=typeof t||null===t)throw new ValidationError(`Expected object, got ${typeToString(t)}`);return t});function object(t){return new ObjectValidator(t)}function isValidJson(t){return null===t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t||(Array.isArray(t)?t.every(isValidJson):"object"==typeof t&&Object.values(t).every(isValidJson))}let D=new Validator(t=>{if(isValidJson(t))return t;throw new ValidationError(`Expected json serializable value, got ${typeof t}`)});function jsonDict(){return dict(v,D)}function dict(t,c){return new DictValidator(t,c)}function union(t,c){return new UnionValidator(t,c,(u,h)=>{throw new ValidationError(`Expected one of ${Object.keys(c).map(t=>JSON.stringify(t)).join(" or ")}, got ${JSON.stringify(h)}`,[t])})}function model(t,c){return new Validator(u=>{let h=u&&"object"==typeof u&&"id"in u&&"string"==typeof u.id?`${t}(id = ${u.id})`:t;return prefixError(h,()=>c.validate(u))})}function setEnum(t){return new Validator(c=>{if(!t.has(c)){let u=Array.from(t,t=>JSON.stringify(t)).join(" or ");throw new ValidationError(`Expected ${u}, got ${c}`)}return c})}function optional(t){return new Validator(c=>{if(void 0!==c)return t.validate(c)})}function nullable(t){return new Validator(c=>null===c?null:t.validate(c))}function literalEnum(...t){return setEnum(new Set(t))}}}]);